import{a as oe}from"./chunk-TP7GN7OO.js";import{a as G,b as I,c as j,d as W,f as H,g as Y,h as J,i as K,j as Q,k as X,l as Z,o as ee,p as te,q as ie}from"./chunk-7VH5JHQP.js";import{a as ne}from"./chunk-P7VF2DIM.js";import{Ea as $,G as _,H as v,I as O,J as E,K as w,Ka as q,L as h,M as i,N as t,O as d,S as P,U as u,W as c,aa as y,ca as r,da as x,ea as p,ga as A,ha as k,ia as V,j as F,ja as D,k as g,l as b,o as C,sa as N,t as s,ta as B,w as z,za as L}from"./chunk-IWV4FJLC.js";import"./chunk-X5YLR3NI.js";import{a as T,b as R,i as M}from"./chunk-ODN5LVDJ.js";var re=(l,n)=>n.id;function se(l,n){if(l&1){let e=P();i(0,"div",14)(1,"div",92)(2,"div",60)(3,"label",93),r(4,"Buscar"),t(),i(5,"div",94)(6,"span",95),d(7,"i",96),t(),i(8,"input",97),D("ngModelChange",function(a){g(e);let m=c();return V(m.searchTermValue,a)||(m.searchTermValue=a),b(a)}),u("ngModelChange",function(){g(e);let a=c();return b(a.applyFilters())}),t()()(),i(9,"div",98)(10,"label",99),r(11,"Rol"),t(),i(12,"select",100),D("ngModelChange",function(a){g(e);let m=c();return V(m.selectedRoleValue,a)||(m.selectedRoleValue=a),b(a)}),u("ngModelChange",function(){g(e);let a=c();return b(a.applyFilters())}),i(13,"option",101),r(14,"Todos"),t(),i(15,"option",68),r(16,"Admin"),t(),i(17,"option",67),r(18,"Usuario"),t(),i(19,"option",69),r(20,"Invitado"),t()()(),i(21,"div",98)(22,"label",102),r(23,"Estado"),t(),i(24,"select",103),D("ngModelChange",function(a){g(e);let m=c();return V(m.selectedStatusValue,a)||(m.selectedStatusValue=a),b(a)}),u("ngModelChange",function(){g(e);let a=c();return b(a.applyFilters())}),i(25,"option",101),r(26,"Todos"),t(),i(27,"option",104),r(28,"Activo"),t(),i(29,"option",105),r(30,"Inactivo"),t()()()()()}if(l&2){let e=c();s(8),k("ngModel",e.searchTermValue),s(4),k("ngModel",e.selectedRoleValue),s(12),k("ngModel",e.selectedStatusValue)}}function le(l,n){l&1&&(i(0,"div",43)(1,"div",106)(2,"span",107),r(3,"Cargando..."),t()(),i(4,"p",108),r(5,"Cargando usuarios..."),t()())}function de(l,n){l&1&&(i(0,"div",43),d(1,"i",109),i(2,"h5",110),r(3,"No hay usuarios"),t(),i(4,"p",111),r(5,"No se encontraron usuarios con los filtros aplicados"),t()())}function me(l,n){if(l&1&&(i(0,"span",125),r(1),t()),l&2){let e=n.$implicit;s(),p(" ",e," ")}}function ce(l,n){if(l&1&&(i(0,"p",121),d(1,"i",133),r(2),t()),l&2){let e=c().$implicit;s(2),p("",e.username," ")}}function ue(l,n){if(l&1&&(i(0,"p",5),r(1),t()),l&2){let e=c().$implicit;s(),x(e.notes)}}function pe(l,n){if(l&1){let e=P();i(0,"div",113)(1,"div",119)(2,"div",16)(3,"h6",120),r(4),t(),i(5,"p",121),r(6),t(),i(7,"div",122)(8,"span",123),r(9),t(),i(10,"span",123),r(11),t()(),i(12,"div",124),E(13,me,2,1,"span",125,O),t()(),i(15,"div",126)(16,"button",127),d(17,"i",128),t(),i(18,"ul",129)(19,"li")(20,"button",130),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.openEditModal(a))}),d(21,"i",131),r(22,"Editar "),t()(),i(23,"li")(24,"button",130),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.toggleUserStatus(a))}),d(25,"i",50),r(26),t()(),i(27,"li")(28,"button",132),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.openDeleteModal(a))}),d(29,"i",90),r(30,"Eliminar "),t()()()()(),_(31,ce,3,1,"p",121),_(32,ue,2,1,"p",5),t()}if(l&2){let e=n.$implicit,o=c(2);s(4),x(e.display_name||e.username||"Sin nombre"),s(2),x(e.email),s(2),h("ngClass",o.getRoleBadgeClass(e.role)),s(),p(" ",o.getRoleLabel(e.role)," "),s(),h("ngClass",e.active?"bg-success":"bg-danger"),s(),p(" ",e.active?"Activo":"Inactivo"," "),s(2),w(e.permissions),s(12),h("ngClass",e.active?"bi-eye-slash":"bi-eye"),s(),p(" ",e.active?"Desactivar":"Activar"," "),s(5),v(e.username?31:-1),s(),v(e.notes?32:-1)}}function ge(l,n){if(l&1&&(i(0,"div",139),d(1,"i",133),r(2),t()),l&2){let e=c().$implicit;s(2),p("",e.username," ")}}function be(l,n){if(l&1&&(i(0,"span",141),r(1),t()),l&2){let e=n.$implicit;s(),p(" ",e," ")}}function _e(l,n){l&1&&(i(0,"span",142),d(1,"i",151),r(2,"Activo "),t())}function ve(l,n){l&1&&(i(0,"span",143),d(1,"i",151),r(2,"Inactivo "),t())}function he(l,n){if(l&1){let e=P();i(0,"tr")(1,"td",134)(2,"div",15)(3,"div",135),d(4,"i",136),t(),i(5,"div")(6,"div",137),r(7),t(),i(8,"div",138),r(9),t(),_(10,ge,3,1,"div",139),t()()(),i(11,"td",134)(12,"span",123),r(13),t()(),i(14,"td",134)(15,"div",140),E(16,be,2,1,"span",141,O),t()(),i(18,"td",134),_(19,_e,3,0,"span",142)(20,ve,3,0,"span",143),t(),i(21,"td",134)(22,"div",111),r(23),t()(),i(24,"td",144)(25,"div",145)(26,"button",146),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.openEditModal(a))}),d(27,"i",147),t(),i(28,"button",148),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.toggleUserStatus(a))}),d(29,"i",38),t(),i(30,"button",149),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.openDeleteModal(a))}),d(31,"i",150),t()()()()}if(l&2){let e=n.$implicit,o=c(2);s(7),x(e.display_name||e.username||"Sin nombre"),s(2),x(e.email),s(),v(e.username?10:-1),s(2),h("ngClass",o.getRoleBadgeClass(e.role)),s(),p(" ",o.getRoleLabel(e.role)," "),s(3),w(e.permissions),s(3),v(e.active?19:20),s(4),x(o.formatDate(e.created_at)),s(5),h("title",e.active?"Desactivar usuario":"Activar usuario"),s(),h("ngClass",e.active?"bi-eye-slash":"bi-eye")}}function fe(l,n){if(l&1&&(i(0,"div",112),E(1,pe,33,10,"div",113,re),t(),i(3,"div",114)(4,"table",115)(5,"thead",116)(6,"tr")(7,"th",117),r(8,"Usuario"),t(),i(9,"th",117),r(10,"Rol"),t(),i(11,"th",117),r(12,"Permisos"),t(),i(13,"th",117),r(14,"Estado"),t(),i(15,"th",117),r(16,"Registro"),t(),i(17,"th",118),r(18,"Acciones"),t()()(),i(19,"tbody"),E(20,he,32,9,"tr",null,re),t()()()),l&2){let e=c();s(),w(e.users()),s(19),w(e.users())}}function Ce(l,n){if(l&1){let e=P();i(0,"li",154)(1,"button",159),u("click",function(){let a=g(e).$implicit,m=c(2);return b(m.goToPage(a))}),r(2),t()()}if(l&2){let e=n.$implicit,o=c(2);y("active",e===o.currentPage()),s(2),x(e)}}function xe(l,n){if(l&1){let e=P();i(0,"div",44)(1,"div",32)(2,"div",60)(3,"p",5),r(4),t()(),i(5,"div",60)(6,"nav",152)(7,"ul",153)(8,"li",154)(9,"button",155),u("click",function(){g(e);let a=c();return b(a.goToPage(a.currentPage()-1))}),d(10,"i",156),t()(),E(11,Ce,3,3,"li",157,O),i(13,"li",154)(14,"button",155),u("click",function(){g(e);let a=c();return b(a.goToPage(a.currentPage()+1))}),d(15,"i",158),t()()()()()()()}if(l&2){let e=c();s(4),A(" Mostrando ",(e.currentPage()-1)*e.pageSize()+1," - ",e.getEndItem()," de ",e.totalUsers()," usuarios "),s(4),y("disabled",!e.hasPreviousPage()),s(),h("disabled",!e.hasPreviousPage()),s(2),w(e.getPaginationRange()),s(2),y("disabled",!e.hasNextPage()),s(),h("disabled",!e.hasNextPage())}}function Me(l,n){l&1&&r(0," El email es requerido ")}function ye(l,n){l&1&&r(0," Formato de email inv\xE1lido ")}function Se(l,n){if(l&1&&(i(0,"div",59),_(1,Me,1,0),_(2,ye,1,0),t()),l&2){let e,o,a=c();s(),v(!((e=a.userForm.get("email"))==null||e.errors==null)&&e.errors.required?1:-1),s(),v(!((o=a.userForm.get("email"))==null||o.errors==null)&&o.errors.email?2:-1)}}function Ee(l,n){l&1&&(i(0,"div",59),r(1," El rol es requerido "),t())}function we(l,n){if(l&1&&(i(0,"div",59),r(1),t()),l&2){let e=c();s(),p(" ",e.getFieldError("permissions")," ")}}function Pe(l,n){l&1&&d(0,"span",80)}function Ue(l,n){if(l&1&&(i(0,"div",88)(1,"strong"),r(2),t(),d(3,"br"),i(4,"small",75),r(5),t()()),l&2){let e,o,a=c();s(2),x(((e=a.userToDelete())==null?null:e.display_name)||((e=a.userToDelete())==null?null:e.username)||((e=a.userToDelete())==null?null:e.email)),s(3),x((o=a.userToDelete())==null?null:o.email)}}var ae=class l{userService=F(oe);authService=F(ne);fb=F(ee);users=this.userService.users;loading=this.userService.loading;error=this.userService.error;totalUsers=this.userService.totalUsers;currentPage=this.userService.currentPage;pageSize=this.userService.pageSize;totalPages=this.userService.totalPages;hasNextPage=this.userService.hasNextPage;hasPreviousPage=this.userService.hasPreviousPage;activeUsersCount=this.userService.activeUsersCount;adminUsersCount=this.userService.adminUsersCount;selectedUser=C(null);isEditing=C(!1);showDeleteModal=C(!1);userToDelete=C(null);searchTerm=C("");selectedRole=C("");selectedStatus=C("");showFilters=C(!1);showUserModal=C(!1);formSubmitting=C(!1);userForm;filterForm;userModal;deleteModal;filteredUsers=N(()=>{let n=this.users(),e=this.searchTerm();return e&&(n=n.filter(o=>o.email.toLowerCase().includes(e.toLowerCase())||o.username&&o.username.toLowerCase().includes(e.toLowerCase())||o.display_name&&o.display_name.toLowerCase().includes(e.toLowerCase()))),n});userStats=N(()=>({total:this.totalUsers(),active:this.activeUsersCount(),inactive:this.totalUsers()-this.activeUsersCount(),admins:this.adminUsersCount()}));constructor(){this.initializeForms(),B(()=>{let n=this.error();n&&this.showToast(n,"error")})}ngOnInit(){this.loadUsers(),this.initializeBootstrapModals()}ngOnDestroy(){this.destroyBootstrapModals()}initializeForms(){this.userForm=this.fb.group({email:["",[I.required,I.email]],username:[""],display_name:[""],role:["user",I.required],notes:[""],permissions:["certificate"]}),this.filterForm=this.fb.group({search:[""],role:[""],status:[""]})}initializeBootstrapModals(){setTimeout(()=>{let n=document.getElementById("userModal"),e=document.getElementById("deleteModal");n&&(this.userModal=new bootstrap.Modal(n)),e&&(this.deleteModal=new bootstrap.Modal(e))},100)}destroyBootstrapModals(){this.userModal&&this.userModal.dispose(),this.deleteModal&&this.deleteModal.dispose()}loadUsers(){return M(this,null,function*(){try{yield this.userService.getUsers()}catch(n){console.error("Error loading users:",n)}})}openCreateModal(){this.isEditing.set(!1),this.selectedUser.set(null),this.userForm.reset({role:"user",permissions:"certificate"}),this.showUserModal.set(!0),this.userModal?.show()}openEditModal(n){this.isEditing.set(!0),this.selectedUser.set(n),this.userForm.patchValue({email:n.email,username:n.username||"",display_name:n.display_name||"",role:n.role,notes:n.notes||"",permissions:n.permissions?.join(", ")||"certificate"}),this.showUserModal.set(!0),this.userModal?.show()}onSubmitUser(){return M(this,null,function*(){if(this.userForm.invalid){this.markFormGroupTouched(this.userForm);return}try{this.formSubmitting.set(!0);let n=this.userForm.value,o=(n.permissions||"certificate").split(",").map(m=>m.trim()).filter(m=>m.length>0),a=R(T({},n),{permissions:o});if(this.isEditing()){let m=this.selectedUser();if(m){let f=T({id:m.id},a);yield this.userService.updateUser(f),this.showToast("Usuario actualizado exitosamente","success")}}else{let m=T({},a);yield this.userService.createUser(m),this.showToast("Usuario creado exitosamente","success")}this.closeUserModal()}catch(n){this.showToast(n.message||"Error al guardar usuario","error")}finally{this.formSubmitting.set(!1)}})}openDeleteModal(n){this.userToDelete.set(n),this.showDeleteModal.set(!0),this.deleteModal?.show()}confirmDelete(){return M(this,null,function*(){let n=this.userToDelete();if(n)try{yield this.userService.deleteUser(n.id),this.showToast("Usuario eliminado exitosamente","success"),this.closeDeleteModal()}catch(e){this.showToast(e.message||"Error al eliminar usuario","error")}})}toggleUserStatus(n){return M(this,null,function*(){try{yield this.userService.toggleUserStatus(n.id);let e=n.active?"desactivado":"activado";this.showToast(`Usuario ${e} exitosamente`,"success")}catch(e){this.showToast(e.message||"Error al cambiar estado del usuario","error")}})}goToPage(n){return M(this,null,function*(){yield this.userService.goToPage(n)})}changePageSize(n){return M(this,null,function*(){let e=n.target,o=parseInt(e.value);yield this.userService.changePageSize(o)})}get pageNumbers(){let n=this.totalPages(),e=this.currentPage(),o=[],a=Math.max(1,e-2),m=Math.min(n,e+2);e<=3&&(m=Math.min(n,5)),e>n-3&&(a=Math.max(1,n-4));for(let f=a;f<=m;f++)o.push(f);return o}getPaginationRange(){return this.pageNumbers}saveUser(){this.onSubmitUser()}applyFilters(){return M(this,null,function*(){let n={},e=this.searchTerm();e&&(n.search=e);let o=this.selectedRole();o&&(n.role=o);let a=this.selectedStatus();a==="active"&&(n.active=!0),a==="inactive"&&(n.active=!1),yield this.userService.applyFilters(n)})}clearFilters(){this.searchTerm.set(""),this.selectedRole.set(""),this.selectedStatus.set(""),this.userService.applyFilters({})}closeUserModal(){this.showUserModal.set(!1),this.userModal?.hide(),this.userForm.reset(),this.selectedUser.set(null)}closeDeleteModal(){this.showDeleteModal.set(!1),this.deleteModal?.hide(),this.userToDelete.set(null)}onModalHidden(){this.showUserModal.set(!1),this.showDeleteModal.set(!1)}markFormGroupTouched(n){Object.keys(n.controls).forEach(e=>{n.get(e)?.markAsTouched()})}getFieldError(n){let e=this.userForm.get(n);if(e?.invalid&&e?.touched){if(e.errors?.required)return"Este campo es requerido";if(e.errors?.email)return"Email inv\xE1lido"}return null}hasFieldError(n){let e=this.userForm.get(n);return!!(e?.invalid&&e?.touched)}showToast(n,e="success"){let o=document.getElementById("toast-container");if(!o)return;let a=`toast-${Date.now()}`,S=`
      <div id="${a}" class="toast align-items-center text-white ${e==="success"?"bg-success":e==="error"?"bg-danger":"bg-warning"}" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
          <div class="toast-body">
            <i class="bi ${e==="success"?"bi-check-circle":e==="error"?"bi-exclamation-triangle":"bi-info-circle"} me-2"></i>
            ${n}
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    `;o.insertAdjacentHTML("beforeend",S);let U=document.getElementById(a);U&&(new bootstrap.Toast(U,{autohide:!0,delay:4e3}).show(),U.addEventListener("hidden.bs.toast",()=>{U.remove()}))}get roleOptions(){return[{value:"admin",label:"Administrador"},{value:"user",label:"Usuario"},{value:"guest",label:"Invitado"}]}getRoleBadgeClass(n){switch(n){case"admin":return"bg-danger";case"user":return"bg-primary";case"guest":return"bg-secondary";default:return"bg-secondary"}}getRoleLabel(n){switch(n){case"admin":return"Administrador";case"user":return"Usuario";case"guest":return"Invitado";default:return n}}formatDate(n){return n?new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}getEndItem(){return Math.min(this.currentPage()*this.pageSize(),this.totalUsers())}get searchTermValue(){return this.searchTerm()}set searchTermValue(n){this.searchTerm.set(n)}get selectedRoleValue(){return this.selectedRole()}set selectedRoleValue(n){this.selectedRole.set(n)}get selectedStatusValue(){return this.selectedStatus()}set selectedStatusValue(n){this.selectedStatus.set(n)}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=z({type:l,selectors:[["app-user-management"]],decls:166,vars:25,consts:[[1,"container-fluid","py-3","mt-5"],[1,"row","mb-3"],[1,"col-sm-8"],[1,"h4","mb-1","text-dark","fw-bold"],[1,"bi","bi-people-fill","me-2","text-primary"],[1,"text-muted","small","mb-0"],[1,"col-sm-4","text-sm-end","mt-2","mt-sm-0"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"bi","bi-person-plus","me-1"],[1,"d-none","d-sm-inline"],[1,"d-sm-none"],[1,"row","g-2","mb-3"],[1,"col-6","col-sm-3"],[1,"card","border-0","bg-primary","bg-opacity-10","h-100","stats-card"],[1,"card-body","p-3"],[1,"d-flex","align-items-center"],[1,"flex-grow-1"],[1,"small","text-primary","fw-semibold","text-uppercase","mb-1"],[1,"h5","mb-0","fw-bold","text-dark"],[1,"ms-2"],[1,"bi","bi-people","fs-4","text-primary","opacity-75"],[1,"card","border-0","bg-success","bg-opacity-10","h-100","stats-card"],[1,"small","text-success","fw-semibold","text-uppercase","mb-1"],[1,"bi","bi-person-check","fs-4","text-success","opacity-75"],[1,"card","border-0","bg-info","bg-opacity-10","h-100","stats-card"],[1,"small","text-info","fw-semibold","text-uppercase","mb-1"],[1,"bi","bi-shield-check","fs-4","text-info","opacity-75"],[1,"card","border-0","bg-warning","bg-opacity-10","h-100","stats-card"],[1,"small","text-warning","fw-semibold","text-uppercase","mb-1"],[1,"bi","bi-person-x","fs-4","text-warning","opacity-75"],[1,"card","border-0","shadow-sm","mb-3"],[1,"card-header","bg-light","border-0","py-2"],[1,"row","align-items-center"],[1,"col"],[1,"mb-0","fw-semibold","text-dark"],[1,"bi","bi-funnel","me-2","text-primary"],[1,"col-auto"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"bi",3,"ngClass"],[1,"card","border-0","shadow-sm"],[1,"bi","bi-table","me-2","text-primary"],[1,"badge","bg-primary"],[1,"card-body","p-0"],[1,"text-center","py-5"],[1,"card-footer","bg-light","border-0","py-2"],["id","userModal","tabindex","-1","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","border-0","shadow"],[1,"modal-header","bg-primary","text-white","border-0"],[1,"modal-title","fw-semibold"],[1,"bi","me-2",3,"ngClass"],["type","button","data-bs-dismiss","modal",1,"btn-close","btn-close-white"],[3,"ngSubmit","formGroup"],[1,"modal-body","p-4"],[1,"row","g-3"],[1,"col-12"],["for","email",1,"form-label","fw-semibold"],[1,"text-danger"],["type","email","id","email","formControlName","email","placeholder","usuario@ejemplo.com",1,"form-control"],[1,"invalid-feedback"],[1,"col-sm-6"],["for","username",1,"form-label","fw-semibold"],["type","text","id","username","formControlName","username","placeholder","Nombre de usuario",1,"form-control"],["for","display_name",1,"form-label","fw-semibold"],["type","text","id","display_name","formControlName","display_name","placeholder","Nombre completo para mostrar",1,"form-control"],["for","role",1,"form-label","fw-semibold"],["id","role","formControlName","role",1,"form-select"],["value","user"],["value","admin"],["value","guest"],["for","notes",1,"form-label","fw-semibold"],["id","notes","formControlName","notes","rows","3","placeholder","Informaci\xF3n adicional sobre el usuario",1,"form-control"],["for","permissions",1,"form-label","fw-semibold"],[1,"bi","bi-shield-check","me-2"],["id","permissions","formControlName","permissions","rows","3","placeholder","Escribe las rutas separadas por comas (ej: certificate, admin, dashboard, reports, users, profile)",1,"form-control"],[1,"text-muted"],[1,"bi","bi-info-circle","me-1"],[1,"modal-footer","border-0","bg-light"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"spinner-border","spinner-border-sm","me-2"],["id","deleteModal","tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-sm"],[1,"modal-header","bg-danger","text-white","border-0"],[1,"bi","bi-exclamation-triangle","me-2"],[1,"modal-body","p-4","text-center"],[1,"bi","bi-person-x","display-1","text-danger","opacity-75","mb-3"],[1,"mb-3"],[1,"bg-light","rounded","p-2","mb-3"],["type","button",1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash","me-2"],[1,"toast-container","position-fixed","top-0","end-0","p-3",2,"z-index","9999"],[1,"row","g-2"],["for","search",1,"form-label","small"],[1,"input-group","input-group-sm"],[1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-search","text-muted"],["type","text","id","search","placeholder","Email, nombre...",1,"form-control","border-start-0",3,"ngModelChange","ngModel"],[1,"col-sm-3"],["for","roleFilter",1,"form-label","small"],["id","roleFilter",1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],["value",""],["for","statusFilter",1,"form-label","small"],["id","statusFilter",1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],["value","active"],["value","inactive"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-2","mb-0","small"],[1,"bi","bi-people","display-1","text-muted","opacity-50"],[1,"text-muted","mt-3"],[1,"text-muted","small"],[1,"d-block","d-sm-none"],[1,"border-bottom","p-3"],[1,"table-responsive","d-none","d-sm-block"],[1,"table","table-sm","table-hover","mb-0"],[1,"table-light"],[1,"border-0","fw-semibold","small"],[1,"border-0","fw-semibold","small","text-center"],[1,"d-flex","justify-content-between","align-items-start","mb-2"],[1,"mb-1","fw-semibold"],[1,"text-muted","small","mb-1"],[1,"d-flex","gap-1","flex-wrap","mb-2"],[1,"badge","badge-sm",3,"ngClass"],[1,"d-flex","gap-1","flex-wrap"],[1,"badge","bg-secondary","badge-sm",2,"font-size","0.6rem"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-secondary"],[1,"bi","bi-three-dots-vertical"],[1,"dropdown-menu","dropdown-menu-end"],[1,"dropdown-item",3,"click"],[1,"bi","bi-pencil","me-2"],[1,"dropdown-item","text-danger",3,"click"],[1,"bi","bi-at","me-1"],[1,"border-0","py-2"],[1,"bg-primary","bg-opacity-10","rounded-circle","d-flex","align-items-center","justify-content-center","me-2",2,"width","32px","height","32px"],[1,"bi","bi-person-fill","text-primary","small"],[1,"fw-semibold","text-dark","small"],[1,"text-muted",2,"font-size","0.75rem"],[1,"text-muted",2,"font-size","0.7rem"],[1,"d-flex","flex-wrap","gap-1"],[1,"badge","bg-secondary","badge-sm",2,"font-size","0.65rem"],[1,"badge","bg-success","badge-sm"],[1,"badge","bg-danger","badge-sm"],[1,"border-0","py-2","text-center"],[1,"btn-group","btn-group-sm"],["type","button","title","Editar usuario",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bi","bi-pencil"],["type","button",1,"btn","btn-outline-warning","btn-sm",3,"click","title"],["type","button","title","Eliminar usuario",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],[1,"bi","bi-circle-fill","me-1",2,"font-size","0.6rem"],["aria-label","Paginaci\xF3n"],[1,"pagination","pagination-sm","justify-content-end","mb-0"],[1,"page-item"],[1,"page-link",3,"click","disabled"],[1,"bi","bi-chevron-left"],[1,"page-item",3,"active"],[1,"bi","bi-chevron-right"],[1,"page-link",3,"click"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),d(4,"i",4),r(5," Gesti\xF3n de Usuarios "),t(),i(6,"p",5),r(7,"Administrar usuarios y permisos del sistema"),t()(),i(8,"div",6)(9,"button",7),u("click",function(){return o.openCreateModal()}),d(10,"i",8),i(11,"span",9),r(12,"Nuevo Usuario"),t(),i(13,"span",10),r(14,"Nuevo"),t()()()(),i(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14)(19,"div",15)(20,"div",16)(21,"div",17),r(22," Total "),t(),i(23,"div",18),r(24),t()(),i(25,"div",19),d(26,"i",20),t()()()()(),i(27,"div",12)(28,"div",21)(29,"div",14)(30,"div",15)(31,"div",16)(32,"div",22),r(33," Activos "),t(),i(34,"div",18),r(35),t()(),i(36,"div",19),d(37,"i",23),t()()()()(),i(38,"div",12)(39,"div",24)(40,"div",14)(41,"div",15)(42,"div",16)(43,"div",25),r(44," Admins "),t(),i(45,"div",18),r(46),t()(),i(47,"div",19),d(48,"i",26),t()()()()(),i(49,"div",12)(50,"div",27)(51,"div",14)(52,"div",15)(53,"div",16)(54,"div",28),r(55," Inactivos "),t(),i(56,"div",18),r(57),t()(),i(58,"div",19),d(59,"i",29),t()()()()()(),i(60,"div",30)(61,"div",31)(62,"div",32)(63,"div",33)(64,"h6",34),d(65,"i",35),r(66," Filtros "),t()(),i(67,"div",36)(68,"button",37),u("click",function(){return o.showFilters.set(!o.showFilters())}),d(69,"i",38),t()()()(),_(70,se,31,3,"div",14),t(),i(71,"div",39)(72,"div",31)(73,"div",32)(74,"div",33)(75,"h6",34),d(76,"i",40),r(77," Usuarios "),t()(),i(78,"div",36)(79,"span",41),r(80),t()()()(),i(81,"div",42),_(82,le,6,0,"div",43)(83,de,6,0,"div",43)(84,fe,22,0),t(),_(85,xe,16,9,"div",44),t()(),i(86,"div",45)(87,"div",46)(88,"div",47)(89,"div",48)(90,"h5",49),d(91,"i",50),r(92),t(),d(93,"button",51),t(),i(94,"form",52),u("ngSubmit",function(){return o.saveUser()}),i(95,"div",53)(96,"div",54)(97,"div",55)(98,"label",56),r(99,"Email "),i(100,"span",57),r(101,"*"),t()(),d(102,"input",58),_(103,Se,3,2,"div",59),t(),i(104,"div",60)(105,"label",61),r(106,"Nombre de Usuario"),t(),d(107,"input",62),t(),i(108,"div",60)(109,"label",63),r(110,"Nombre para Mostrar"),t(),d(111,"input",64),t(),i(112,"div",60)(113,"label",65),r(114,"Rol "),i(115,"span",57),r(116,"*"),t()(),i(117,"select",66)(118,"option",67),r(119,"Usuario"),t(),i(120,"option",68),r(121,"Administrador"),t(),i(122,"option",69),r(123,"Invitado"),t()(),_(124,Ee,2,0,"div",59),t(),i(125,"div",55)(126,"label",70),r(127,"Notas"),t(),d(128,"textarea",71),t(),i(129,"div",55)(130,"label",72),d(131,"i",73),r(132," Permisos de Rutas "),t(),d(133,"textarea",74),_(134,we,2,1,"div",59),i(135,"small",75),d(136,"i",76),r(137," Rutas disponibles: certificate, admin, dashboard, reports, users, profile "),t()()()(),i(138,"div",77)(139,"button",78),r(140," Cancelar "),t(),i(141,"button",79),_(142,Pe,1,0,"span",80),r(143),t()()()()()(),i(144,"div",81)(145,"div",82)(146,"div",47)(147,"div",83)(148,"h5",49),d(149,"i",84),r(150," Confirmar Eliminaci\xF3n "),t(),d(151,"button",51),t(),i(152,"div",85),d(153,"i",86),i(154,"p",87),r(155,"\xBFEst\xE1s seguro de que deseas eliminar este usuario?"),t(),_(156,Ue,6,2,"div",88),i(157,"p",5),r(158,"Esta acci\xF3n no se puede deshacer."),t()(),i(159,"div",77)(160,"button",78),r(161," Cancelar "),t(),i(162,"button",89),u("click",function(){return o.confirmDelete()}),d(163,"i",90),r(164," Eliminar "),t()()()()(),d(165,"div",91)),e&2){let a,m,f,S;s(24),p(" ",o.userStats().total," "),s(11),p(" ",o.userStats().active," "),s(11),p(" ",o.userStats().admins," "),s(11),p(" ",o.userStats().inactive," "),s(12),h("ngClass",o.showFilters()?"bi-chevron-up":"bi-chevron-down"),s(),v(o.showFilters()?70:-1),s(10),p("",o.totalUsers()," usuarios"),s(2),v(o.loading()?82:o.users().length===0?83:84),s(3),v(o.users().length>0?85:-1),s(6),h("ngClass",o.isEditing()?"bi-pencil":"bi-person-plus"),s(),p(" ",o.isEditing()?"Editar Usuario":"Nuevo Usuario"," "),s(2),h("formGroup",o.userForm),s(8),y("is-invalid",((a=o.userForm.get("email"))==null?null:a.invalid)&&((a=o.userForm.get("email"))==null?null:a.touched)),s(),v((m=o.userForm.get("email"))!=null&&m.invalid&&((m=o.userForm.get("email"))!=null&&m.touched)?103:-1),s(14),y("is-invalid",((f=o.userForm.get("role"))==null?null:f.invalid)&&((f=o.userForm.get("role"))==null?null:f.touched)),s(7),v((S=o.userForm.get("role"))!=null&&S.invalid&&((S=o.userForm.get("role"))!=null&&S.touched)?124:-1),s(9),y("is-invalid",o.hasFieldError("permissions")),s(),v(o.hasFieldError("permissions")?134:-1),s(7),h("disabled",o.userForm.invalid||o.formSubmitting()),s(),v(o.formSubmitting()?142:-1),s(),p(" ",o.isEditing()?"Actualizar":"Crear"," "),s(13),v(o.userToDelete()?156:-1)}},dependencies:[$,L,te,Y,X,Z,G,Q,j,W,H,ie,J,K,q],styles:[".table-sm[_ngcontent-%COMP%]{font-size:.875rem}.table-sm[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-sm[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .75rem;vertical-align:middle}.table-sm[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;background-color:#f8f9fa}.table-sm[_ngcontent-%COMP%]   .badge-sm[_ngcontent-%COMP%]{font-size:.7rem;padding:.25em .5em}.badge.badge-sm[_ngcontent-%COMP%]{font-size:.65rem;padding:.25em .4em;font-weight:500}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem;border-radius:.25rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:not(:first-child):not(:last-child){border-radius:0}.form-check[_ngcontent-%COMP%]{padding:.5rem 0}.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin-top:.25rem}.form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]{font-weight:500;color:#495057;cursor:pointer}.form-check[_ngcontent-%COMP%]   .form-check-label[_ngcontent-%COMP%]:hover{color:#0d6efd}.route-permissions-section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border-color:#dee2e6}.route-permissions-section[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:#f8f9fa}.route-permissions-section[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]{margin-bottom:.75rem}.route-permissions-section[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]:last-child{margin-bottom:0}.route-permissions-section[_ngcontent-%COMP%]   small.text-muted[_ngcontent-%COMP%]{font-size:.75rem;margin-left:1.75rem;margin-top:.25rem}.stats-card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;font-weight:600;text-transform:uppercase;font-size:.75rem;letter-spacing:.5px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.badge[_ngcontent-%COMP%]{font-weight:500;font-size:.75rem}.badge.bg-primary[_ngcontent-%COMP%]{background-color:#0d6efd!important}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.badge.bg-danger[_ngcontent-%COMP%]{background-color:#dc3545!important}.badge.bg-info[_ngcontent-%COMP%]{background-color:#0dcaf0!important}.badge.bg-warning[_ngcontent-%COMP%]{background-color:#ffc107!important;color:#000!important}.modal-content[_ngcontent-%COMP%]{border-radius:.5rem}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:.5rem .5rem 0 0}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-weight:600}.modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{border-radius:0 0 .5rem .5rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:.375rem}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#86b7fe;box-shadow:0 0 0 .25rem #0d6efd40}.btn[_ngcontent-%COMP%]{border-radius:.375rem;font-weight:500}.btn.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem}.toast-container[_ngcontent-%COMP%]{z-index:9999}@media (max-width: 576px){.modal-dialog[_ngcontent-%COMP%]{margin:1rem .5rem}.table-responsive[_ngcontent-%COMP%]{border-radius:.375rem}.route-permissions-section[_ngcontent-%COMP%]   .form-check[_ngcontent-%COMP%]{margin-bottom:1rem}.route-permissions-section[_ngcontent-%COMP%]   small.text-muted[_ngcontent-%COMP%]{margin-left:1.25rem}}"]})};export{ae as UserManagementComponent};
