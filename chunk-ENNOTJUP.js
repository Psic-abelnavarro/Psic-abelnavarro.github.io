import{b as R}from"./chunk-PJLGVUHH.js";import{a as L}from"./chunk-MXHSEERB.js";import"./chunk-MPC7SZEK.js";import{c as A,d as P}from"./chunk-CF2QCA26.js";import{f as U,i as N,l as T}from"./chunk-NUA5R5QO.js";import{Ac as w,Bb as D,Da as a,Eb as b,Fb as i,Gb as d,Ha as p,Hb as m,Na as I,Q as x,R as g,Ra as v,Rb as C,da as S,ea as E,f,gb as c,hb as t,ib as e,jb as l,qb as h,rb as y,tb as u,uc as _}from"./chunk-6O7NOF42.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-FK42CRUA.js";var F=o=>["/usuarios",o,"editar"];function M(o,r){o&1&&(t(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6),i(4,"Cargando..."),e()(),t(5,"p",7),i(6,"Cargando informaci\xF3n del usuario..."),e()()())}function O(o,r){if(o&1){let n=h();t(0,"div",3)(1,"div",8)(2,"div",9),l(3,"i",10),i(4),t(5,"div",11)(6,"button",12),l(7,"i",13),i(8," Volver a la lista "),e(),t(9,"button",14),y("click",function(){S(n);let j=u();return E(j.loadUser())}),l(10,"i",15),i(11," Reintentar "),e()()()()()}if(o&2){let n=u();a(4),m(" ",n.error," ")}}function V(o,r){o&1&&(t(0,"span",77),l(1,"i",78),i(2," Verificado "),e())}function B(o,r){o&1&&(t(0,"span",79),l(1,"i",80),i(2," Sin verificar "),e())}function $(o,r){if(o&1&&(t(0,"div",46)(1,"span",81),i(2),e(),i(3),e()),o&2){let n=u(2);a(2),d(n.getDocumentTypeLabel(n.user.documentType)),a(),m(" ",n.user.documentNumber," ")}}function z(o,r){o&1&&(t(0,"div",23),i(1,"No especificado"),e())}function G(o,r){if(o&1&&(t(0,"div")(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"button",20),l(6,"i",21),e(),t(7,"div")(8,"h1",22),i(9),e(),t(10,"div",23),l(11,"i",24),i(12),e()()(),t(13,"div",25)(14,"button",26),l(15,"i",27),i(16," Editar "),e(),t(17,"div",28)(18,"button",29),l(19,"i",30),e(),t(20,"ul",31)(21,"li")(22,"a",32),l(23,"i",33),i(24,"Restablecer contrase\xF1a"),e()(),t(25,"li")(26,"a",32),l(27,"i",34),i(28,"Cambiar rol"),e()(),t(29,"li"),l(30,"hr",35),e(),t(31,"li")(32,"a",36),l(33,"i",37),i(34,"Desactivar usuario"),e()()()()()()()(),t(35,"div",38)(36,"div",8)(37,"div",39)(38,"div",40)(39,"h5",41),l(40,"i",42),i(41," Informaci\xF3n Personal "),e()(),t(42,"div",43)(43,"div",38)(44,"div",44)(45,"label",45),i(46,"Nombre completo"),e(),t(47,"div",46),i(48),e()(),t(49,"div",44)(50,"label",45),i(51,"Email"),e(),t(52,"div",19)(53,"span",47),i(54),e(),v(55,V,3,0,"span",48)(56,B,3,0,"span",49),e()(),t(57,"div",44)(58,"label",45),i(59,"Tel\xE9fono"),e(),t(60,"div",46),i(61),e()(),t(62,"div",44)(63,"label",45),i(64,"Documento"),e(),v(65,$,4,2,"div",50)(66,z,2,0,"div",51),e()()()(),t(67,"div",39)(68,"div",40)(69,"h5",41),l(70,"i",52),i(71," Ubicaci\xF3n "),e()(),t(72,"div",43)(73,"div",38)(74,"div",44)(75,"label",45),i(76,"Departamento"),e(),t(77,"div",46),i(78),e()(),t(79,"div",44)(80,"label",45),i(81,"Provincia"),e(),t(82,"div",53),i(83,"No especificado"),e()()()()(),t(84,"div",39)(85,"div",40)(86,"h5",41),l(87,"i",54),i(88," Informaci\xF3n Profesional "),e()(),t(89,"div",43)(90,"div",38)(91,"div",44)(92,"label",45),i(93,"Instituci\xF3n"),e(),t(94,"div",46),i(95),e()(),t(96,"div",44)(97,"label",45),i(98,"Cargo"),e(),t(99,"div",46),i(100),e()()()()(),t(101,"div",39)(102,"div",40)(103,"h5",41),l(104,"i",55),i(105," Actividad "),e()(),t(106,"div",43)(107,"div",38)(108,"div",44)(109,"label",45),i(110,"Eventos asistidos"),e(),t(111,"div",46),i(112),e()(),t(113,"div",44)(114,"label",45),i(115,"Certificados obtenidos"),e(),t(116,"div",46),i(117),e()(),t(118,"div",44)(119,"label",45),i(120,"\xDAltimo acceso"),e(),t(121,"div",46),i(122),e()(),t(123,"div",44)(124,"label",45),i(125,"Fecha de registro"),e(),t(126,"div",46),i(127),e()()()()()(),t(128,"div",56)(129,"div",39)(130,"div",40)(131,"h6",41),i(132,"Estado y Permisos"),e()(),t(133,"div",57)(134,"div",58),i(135),e(),t(136,"div",59)(137,"span"),l(138,"i",60),i(139),e()(),t(140,"div",59)(141,"span"),i(142),e()(),t(143,"div",59)(144,"label",61),i(145,"Completitud del perfil"),e(),t(146,"div",62),l(147,"div",63),e(),t(148,"small",23),i(149),e()()()(),t(150,"div",39)(151,"div",40)(152,"h6",41),i(153,"Acciones R\xE1pidas"),e()(),t(154,"div",43)(155,"div",64)(156,"button",65),l(157,"i",66),i(158," Enviar Email "),e(),t(159,"button",67),l(160,"i",68),i(161," Ver Eventos "),e(),t(162,"button",69),l(163,"i",70),i(164," Ver Certificados "),e(),l(165,"hr"),t(166,"button",71),l(167,"i",33),i(168," Restablecer Contrase\xF1a "),e()()()(),t(169,"div",72)(170,"div",40)(171,"h6",41),i(172,"Informaci\xF3n del Sistema"),e()(),t(173,"div",43)(174,"div",73)(175,"div",74)(176,"small",23),i(177,"ID del usuario:"),e(),t(178,"div",75),i(179),e()(),t(180,"div",74)(181,"small",23),i(182,"Creado:"),e(),t(183,"div",76),i(184),e()(),t(185,"div",17)(186,"small",23),i(187,"Actualizado:"),e(),t(188,"div",76),i(189),e()()()()()()()()),o&2){let n=u();a(9),d(n.user.fullName),a(3),m(" ",n.user.email," "),a(2),c("routerLink",C(32,F,n.user.id)),a(34),d(n.user.fullName),a(6),d(n.user.email),a(),c("ngIf",n.user.emailVerified),a(),c("ngIf",!n.user.emailVerified),a(5),m(" ",n.user.phone||"No especificado"," "),a(4),c("ngIf",n.user.documentNumber),a(),c("ngIf",!n.user.documentNumber),a(12),m(" ",(n.user.departmentInfo==null?null:n.user.departmentInfo.name)||n.getDepartmentName(n.user.departmentId)," "),a(17),m(" ",n.user.institution||"No especificado"," "),a(5),m(" ",n.user.jobTitle||"No especificado"," "),a(12),d(n.user.eventsAttended),a(5),d(n.user.certificatesEarned),a(5),d(n.formatDateTime(n.user.lastLogin)),a(5),d(n.formatDate(n.user.createdAt)),a(8),m(" ",n.user.fullName.charAt(0).toUpperCase()," "),a(2),b(n.getStatusBadgeClass(n.user.isActive)),a(2),m(" ",n.getStatusText(n.user.isActive)," "),a(2),b(n.getRoleBadgeClass(n.user.role)),a(),m(" ",n.getUserRoleLabel(n.user.role)," "),a(5),b(n.getProfileCompletionClass()),D("width",n.getProfileCompletionPercentage(),"%"),a(2),m("",n.getProfileCompletionPercentage(),"% completado"),a(30),d(n.user.id),a(5),d(n.formatDateTime(n.user.createdAt)),a(5),d(n.formatDateTime(n.user.updatedAt))}}var k=class o{constructor(r,n,s){this.route=r;this.userService=n;this.staticDataService=s}destroy$=new f;user=null;loading=!1;error=null;departments=[];UserRole=A;DocumentType=P;ngOnInit(){this.loadStaticData(),this.loadUser()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadStaticData(){this.staticDataService.getDepartmentsList().pipe(g(this.destroy$)).subscribe(r=>{this.departments=r})}loadUser(){this.loading=!0,this.error=null,this.route.params.pipe(x(r=>{let n=+r.id;return this.userService.getUserById(n)}),g(this.destroy$)).subscribe({next:r=>{this.user=r,this.loading=!1},error:r=>{this.error=r.message||"Error cargando usuario",this.loading=!1,console.error("Error cargando usuario:",r)}})}getUserRoleLabel(r){return{admin:"Administrador",organizer:"Organizador",participant:"Participante"}[r]||r}getDocumentTypeLabel(r){return{DNI:"DNI",CE:"Carn\xE9 de Extranjer\xEDa",PASSPORT:"Pasaporte",RUC:"RUC"}[r]||r}getDepartmentName(r){return this.departments.find(s=>parseInt(s.code)===r)?.name||"N/A"}getRoleBadgeClass(r){return{admin:"badge bg-primary",organizer:"badge bg-info",participant:"badge bg-secondary"}[r]||"badge bg-secondary"}getStatusBadgeClass(r){return r?"badge bg-success":"badge bg-danger"}getStatusText(r){return r?"Activo":"Inactivo"}formatDate(r){return r?new Date(r).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"}):"N/A"}formatDateTime(r){return r?new Date(r).toLocaleString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}getProfileCompletionPercentage(){if(!this.user)return 0;let r=0,n=8;return this.user.fullName&&r++,this.user.email&&r++,this.user.phone&&r++,this.user.documentNumber&&r++,this.user.departmentId&&r++,this.user.institution&&r++,this.user.jobTitle&&r++,this.user.emailVerified&&r++,Math.round(r/n*100)}getProfileCompletionClass(){let r=this.getProfileCompletionPercentage();return r>=80?"bg-success":r>=60?"bg-warning":"bg-danger"}static \u0275fac=function(n){return new(n||o)(p(U),p(R),p(L))};static \u0275cmp=I({type:o,selectors:[["app-user-detail"]],decls:4,vars:3,consts:[[1,"container-fluid","py-4"],["class","row justify-content-center",4,"ngIf"],[4,"ngIf"],[1,"row","justify-content-center"],[1,"col-md-8","text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"col-md-8"],["role","alert",1,"alert","alert-danger"],[1,"bi","bi-exclamation-triangle","me-2"],[1,"mt-3"],["type","button","routerLink","/usuarios",1,"btn","btn-outline-primary","me-2"],[1,"bi","bi-arrow-left","me-1"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-start"],[1,"d-flex","align-items-center"],["type","button","routerLink","/usuarios",1,"btn","btn-outline-secondary","me-3"],[1,"bi","bi-arrow-left"],[1,"h3","mb-1"],[1,"text-muted"],[1,"bi","bi-envelope","me-1"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-outline-primary",3,"routerLink"],[1,"bi","bi-pencil","me-2"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","dropdown-toggle"],[1,"bi","bi-three-dots"],[1,"dropdown-menu"],["href","#",1,"dropdown-item"],[1,"bi","bi-key","me-2"],[1,"bi","bi-shield-check","me-2"],[1,"dropdown-divider"],["href","#",1,"dropdown-item","text-danger"],[1,"bi","bi-trash","me-2"],[1,"row"],[1,"card","mb-4"],[1,"card-header"],[1,"card-title","mb-0"],[1,"bi","bi-person","me-2"],[1,"card-body"],[1,"col-md-6","mb-3"],[1,"form-label","text-muted"],[1,"fw-semibold"],[1,"fw-semibold","me-2"],["class","badge bg-success",4,"ngIf"],["class","badge bg-warning",4,"ngIf"],["class","fw-semibold",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"bi","bi-geo-alt","me-2"],[1,"fw-semibold","text-muted"],[1,"bi","bi-briefcase","me-2"],[1,"bi","bi-activity","me-2"],[1,"col-md-4"],[1,"card-body","text-center"],[1,"bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","mx-auto","mb-3",2,"width","80px","height","80px","font-size","2rem"],[1,"mb-3"],[1,"bi","bi-circle-fill","me-1",2,"font-size","0.5rem"],[1,"form-label","text-muted","small"],[1,"progress",2,"height","8px"],[1,"progress-bar"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-primary","btn-sm"],[1,"bi","bi-envelope","me-2"],["type","button",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-calendar-event","me-2"],["type","button",1,"btn","btn-outline-info","btn-sm"],[1,"bi","bi-award","me-2"],["type","button",1,"btn","btn-outline-warning","btn-sm"],[1,"card"],[1,"row","g-0"],[1,"col-12","mb-2"],[1,"font-monospace"],[1,"small"],[1,"badge","bg-success"],[1,"bi","bi-check-circle","me-1"],[1,"badge","bg-warning"],[1,"bi","bi-exclamation-triangle","me-1"],[1,"badge","bg-light","text-dark","me-2"]],template:function(n,s){n&1&&(t(0,"div",0),v(1,M,7,0,"div",1)(2,O,12,1,"div",1)(3,G,190,34,"div",2),e()),n&2&&(a(),c("ngIf",s.loading),a(),c("ngIf",s.error&&!s.loading),a(),c("ngIf",s.user&&!s.loading&&!s.error))},dependencies:[w,_,T,N],encapsulation:2})};export{k as UserDetailComponent};
