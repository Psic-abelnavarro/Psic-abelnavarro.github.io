import{b as k}from"./chunk-7M4K7CII.js";import{a as j}from"./chunk-CYLPXQIR.js";import"./chunk-MPC7SZEK.js";import{a as f}from"./chunk-TMGCMHHJ.js";import{c as M,d as L}from"./chunk-IIPOJGOQ.js";import{f as R,i as A,l as P}from"./chunk-C3HOFUSH.js";import{Bc as T,Cb as w,Da as r,Fb as x,Gb as i,Hb as m,Ib as s,Na as y,Q as S,Sb as N,_ as u,ac as U,bb as v,cb as g,da as E,ea as h,hb as D,ia as C,ib as t,jb as e,kb as l,ma as b,rb as I,sb as _,ub as p}from"./chunk-5W5GNUFO.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-FK42CRUA.js";var V=d=>["/usuarios",d,"editar"];function B(d,a){d&1&&(t(0,"div",1)(1,"div",3)(2,"div",4)(3,"span",5),i(4,"Cargando..."),e()(),t(5,"p",6),i(6,"Cargando usuario..."),e()()())}function z(d,a){if(d&1){let n=I();t(0,"div",2)(1,"div",7)(2,"div",8),l(3,"i",9),t(4,"div",10)(5,"h6",11),i(6,"Error al cargar"),e(),t(7,"p",12),i(8),e(),t(9,"div",13)(10,"button",14),_("click",function(){E(n);let c=p();return h(c.retry())}),l(11,"i",15),i(12," Reintentar "),e(),t(13,"button",16),l(14,"i",17),i(15," Volver a la lista "),e()()()()()()}if(d&2){let n=p();r(8),m(n.error())}}function G(d,a){d&1&&(t(0,"span",50),l(1,"i",76),i(2," Verificado "),e())}function Z(d,a){d&1&&(t(0,"span",51),l(1,"i",77),i(2," Sin verificar "),e())}function q(d,a){if(d&1&&(t(0,"div",48)(1,"span",78),i(2),e(),i(3),e()),d&2){let n=p(),o=p();r(2),m(o.getDocumentTypeLabel(n.documentType)),r(),s(" ",n.documentNumber," ")}}function H(d,a){d&1&&(t(0,"div",6),i(1,"No especificado"),e())}function J(d,a){if(d&1&&(t(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"button",22),l(5,"i",23),e(),t(6,"div")(7,"h1",24),i(8),e(),t(9,"div",25),l(10,"i",26),i(11),e()()(),t(12,"div",13)(13,"button",27),l(14,"i",28),i(15," Editar "),e(),t(16,"div",29)(17,"button",30),l(18,"i",31),e(),t(19,"ul",32)(20,"li")(21,"a",33),l(22,"i",34),i(23,"Restablecer contrase\xF1a"),e()(),t(24,"li")(25,"a",33),l(26,"i",35),i(27,"Cambiar rol"),e()(),t(28,"li"),l(29,"hr",36),e(),t(30,"li")(31,"a",37),l(32,"i",38),i(33,"Desactivar usuario"),e()()()()()()()(),t(34,"div",39)(35,"div",40)(36,"div",41)(37,"div",42)(38,"h6",43),l(39,"i",44),i(40," Informaci\xF3n Personal "),e()(),t(41,"div",45)(42,"div",39)(43,"div",46)(44,"label",47),i(45,"Nombre completo"),e(),t(46,"div",48),i(47),e()(),t(48,"div",46)(49,"label",47),i(50,"Email"),e(),t(51,"div",21)(52,"span",49),i(53),e(),v(54,G,3,0,"span",50)(55,Z,3,0,"span",51),e()(),t(56,"div",46)(57,"label",47),i(58,"Tel\xE9fono"),e(),t(59,"div",48),i(60),e()(),t(61,"div",46)(62,"label",47),i(63,"Documento"),e(),v(64,q,4,2,"div",48)(65,H,2,0,"div",6),e()()()(),t(66,"div",41)(67,"div",42)(68,"h6",43),l(69,"i",52),i(70," Ubicaci\xF3n "),e()(),t(71,"div",45)(72,"div",39)(73,"div",46)(74,"label",47),i(75,"Departamento"),e(),t(76,"div",48),i(77),e()(),t(78,"div",46)(79,"label",47),i(80,"Provincia"),e(),t(81,"div",53),i(82,"No especificado"),e()()()()(),t(83,"div",41)(84,"div",42)(85,"h6",43),l(86,"i",54),i(87," Informaci\xF3n Profesional "),e()(),t(88,"div",45)(89,"div",39)(90,"div",46)(91,"label",47),i(92,"Instituci\xF3n"),e(),t(93,"div",48),i(94),e()(),t(95,"div",46)(96,"label",47),i(97,"Cargo"),e(),t(98,"div",48),i(99),e()()()()(),t(100,"div",41)(101,"div",42)(102,"h6",43),l(103,"i",55),i(104," Actividad "),e()(),t(105,"div",45)(106,"div",39)(107,"div",46)(108,"label",47),i(109,"Eventos asistidos"),e(),t(110,"div",48),i(111),e()(),t(112,"div",46)(113,"label",47),i(114,"Certificados obtenidos"),e(),t(115,"div",48),i(116),e()(),t(117,"div",46)(118,"label",47),i(119,"\xDAltimo acceso"),e(),t(120,"div",48),i(121),e()(),t(122,"div",46)(123,"label",47),i(124,"Fecha de registro"),e(),t(125,"div",48),i(126),e()()()()()(),t(127,"div",56)(128,"div",41)(129,"div",42)(130,"h6",43),i(131,"Estado y Permisos"),e()(),t(132,"div",57)(133,"div",58),i(134),e(),t(135,"div",59)(136,"span"),l(137,"i",60),i(138),e()(),t(139,"div",59)(140,"span"),i(141),e()(),t(142,"div",59)(143,"label",47),i(144,"Completitud del perfil"),e(),t(145,"div",61),l(146,"div",62),e(),t(147,"small",6),i(148),e()()()(),t(149,"div",41)(150,"div",42)(151,"h6",43),i(152,"Acciones R\xE1pidas"),e()(),t(153,"div",45)(154,"div",63)(155,"button",64),l(156,"i",26),i(157," Enviar Email "),e(),t(158,"button",65),l(159,"i",66),i(160," Ver Eventos "),e(),t(161,"button",67),l(162,"i",68),i(163," Ver Certificados "),e(),l(164,"hr"),t(165,"button",69),l(166,"i",70),i(167," Restablecer Contrase\xF1a "),e()()()(),t(168,"div",71)(169,"div",42)(170,"h6",43),i(171,"Informaci\xF3n del Sistema"),e()(),t(172,"div",45)(173,"div",72)(174,"div",73)(175,"small",6),i(176,"ID del usuario:"),e(),t(177,"div",74),i(178),e()(),t(179,"div",73)(180,"small",6),i(181,"Creado:"),e(),t(182,"div",75),i(183),e()(),t(184,"div",19)(185,"small",6),i(186,"Actualizado:"),e(),t(187,"div",75),i(188),e()()()()()()()),d&2){let n=a,o=p();r(8),m(n.fullName),r(3),s(" ",n.email," "),r(2),D("routerLink",N(30,V,n.id)),r(34),m(n.fullName),r(6),m(n.email),r(),g(n.emailVerified?54:55),r(6),s(" ",n.phone||"No especificado"," "),r(4),g(n.documentNumber?64:65),r(13),s(" ",(n.departmentInfo==null?null:n.departmentInfo.name)||o.getDepartmentName(n.departmentId)," "),r(17),s(" ",n.institution||"No especificado"," "),r(5),s(" ",n.jobTitle||"No especificado"," "),r(12),m(n.eventsAttended),r(5),m(n.certificatesEarned),r(5),m(o.formatDateTime(n.lastLogin)),r(5),m(o.formatDate(n.createdAt)),r(8),s(" ",n.fullName.charAt(0).toUpperCase()," "),r(2),x(o.getStatusBadgeClass(n.isActive)),r(2),s(" ",o.getStatusText(n.isActive)," "),r(2),x(o.getRoleBadgeClass(n.role)),r(),s(" ",o.getUserRoleLabel(n.role)," "),r(5),x(o.getProfileCompletionClass()),w("width",o.getProfileCompletionPercentage(),"%"),r(2),s("",o.getProfileCompletionPercentage(),"% completado"),r(30),m(n.id),r(5),m(o.formatDateTime(n.createdAt)),r(5),m(o.formatDateTime(n.updatedAt))}}var F=class d{route=u(R);destroyRef=u(C);userService=u(k);staticDataService=u(j);userSig=b(null);loadingSig=b(!1);errorSig=b(null);departmentsSig=b([]);departmentMapSig=U(()=>{let a=this.departmentsSig(),n={};return a.forEach((o,c)=>{let O=c+1;n[O]=o}),n});UserRole=M;DocumentType=L;constructor(){}ngOnInit(){this.loadStaticData(),this.loadUser()}user(){return this.userSig()}loading(){return this.loadingSig()}error(){return this.errorSig()}departments(){return this.departmentsSig()}departmentMap(){return this.departmentMapSig()}retry(){this.loadUser()}clearError(){this.errorSig.set(null)}loadStaticData(){this.staticDataService.getDepartmentsList().pipe(f(this.destroyRef)).subscribe(a=>{this.departmentsSig.set(a)})}loadUser(){this.loadingSig.set(!0),this.errorSig.set(null),this.route.params.pipe(S(a=>{let n=+a.id;return this.userService.getUserById(n)}),f(this.destroyRef)).subscribe({next:a=>{this.userSig.set(a),this.loadingSig.set(!1)},error:a=>{this.errorSig.set(a.message||"Error cargando usuario"),this.loadingSig.set(!1),console.error("Error cargando usuario:",a)}})}getUserRoleLabel(a){return{admin:"Administrador",organizer:"Organizador",participant:"Participante"}[a]||a}getDocumentTypeLabel(a){return{DNI:"DNI",CE:"Carn\xE9 de Extranjer\xEDa",PASSPORT:"Pasaporte",RUC:"RUC"}[a]||a}getDepartmentName(a){return this.departmentsSig().find(c=>parseInt(c.code)===a)?.name||"N/A"}getRoleBadgeClass(a){return{admin:"badge bg-primary",organizer:"badge bg-info",participant:"badge bg-secondary"}[a]||"badge bg-secondary"}getStatusBadgeClass(a){return a?"badge bg-success":"badge bg-danger"}getStatusText(a){return a?"Activo":"Inactivo"}formatDate(a){return a?new Date(a).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"}):"N/A"}formatDateTime(a){return a?new Date(a).toLocaleString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}getProfileCompletionPercentage(){let a=this.userSig();if(!a)return 0;let n=0,o=8;return a.fullName&&n++,a.email&&n++,a.phone&&n++,a.documentNumber&&n++,a.departmentId&&n++,a.institution&&n++,a.jobTitle&&n++,a.emailVerified&&n++,Math.round(n/o*100)}getProfileCompletionClass(){let a=this.getProfileCompletionPercentage();return a>=80?"bg-success":a>=60?"bg-warning":"bg-danger"}static \u0275fac=function(n){return new(n||d)};static \u0275cmp=y({type:d,selectors:[["app-user-detail"]],decls:4,vars:2,consts:[[1,"container-fluid","py-3"],[1,"d-flex","justify-content-center","align-items-center","py-5",2,"min-height","400px"],[1,"row","justify-content-center"],[1,"text-center"],["role","status",1,"spinner-border","text-primary","mb-3",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"text-muted"],[1,"col-md-6"],["role","alert",1,"alert","alert-danger","d-flex","align-items-center"],[1,"bi","bi-exclamation-triangle-fill","me-3","fs-4"],[1,"flex-grow-1"],[1,"alert-heading","mb-1"],[1,"mb-2"],[1,"d-flex","gap-2"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-arrow-clockwise","me-1"],["routerLink","/usuarios",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-arrow-left","me-1"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-start"],[1,"d-flex","align-items-center"],["type","button","routerLink","/usuarios",1,"btn","btn-outline-secondary","btn-sm","me-3"],[1,"bi","bi-arrow-left"],[1,"h4","mb-1"],[1,"text-muted","small"],[1,"bi","bi-envelope","me-1"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"routerLink"],[1,"bi","bi-pencil","me-1"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","btn-sm","dropdown-toggle"],[1,"bi","bi-three-dots"],[1,"dropdown-menu"],["href","#",1,"dropdown-item"],[1,"bi","bi-key","me-2"],[1,"bi","bi-shield-check","me-2"],[1,"dropdown-divider"],["href","#",1,"dropdown-item","text-danger"],[1,"bi","bi-trash","me-2"],[1,"row"],[1,"col-md-8"],[1,"card","mb-4"],[1,"card-header"],[1,"card-title","mb-0"],[1,"bi","bi-person","me-2"],[1,"card-body"],[1,"col-md-6","mb-3"],[1,"form-label","text-muted","small"],[1,"fw-semibold"],[1,"fw-semibold","me-2"],[1,"badge","bg-success"],[1,"badge","bg-warning"],[1,"bi","bi-geo-alt","me-2"],[1,"fw-semibold","text-muted"],[1,"bi","bi-briefcase","me-2"],[1,"bi","bi-activity","me-2"],[1,"col-md-4"],[1,"card-body","text-center"],[1,"bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","mx-auto","mb-3",2,"width","80px","height","80px","font-size","2rem"],[1,"mb-3"],[1,"bi","bi-circle-fill","me-1",2,"font-size","0.5rem"],[1,"progress",2,"height","8px"],[1,"progress-bar"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-primary","btn-sm"],["type","button",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-calendar-event","me-1"],["type","button",1,"btn","btn-outline-info","btn-sm"],[1,"bi","bi-award","me-1"],["type","button",1,"btn","btn-outline-warning","btn-sm"],[1,"bi","bi-key","me-1"],[1,"card"],[1,"row","g-0"],[1,"col-12","mb-2"],[1,"font-monospace"],[1,"small"],[1,"bi","bi-check-circle","me-1"],[1,"bi","bi-exclamation-triangle","me-1"],[1,"badge","bg-light","text-dark","me-2"]],template:function(n,o){if(n&1&&(t(0,"div",0),v(1,B,7,0,"div",1)(2,z,16,1,"div",2),v(3,J,189,32),e()),n&2){let c;r(),g(o.loading()?1:o.error()?2:-1),r(2),g((c=o.user())?3:-1,c)}},dependencies:[T,P,A],encapsulation:2})};export{F as UserDetailComponent};
