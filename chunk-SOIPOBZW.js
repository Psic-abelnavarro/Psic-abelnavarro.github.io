import{b as oe}from"./chunk-RI2EYGR4.js";import{a as C,c as P}from"./chunk-IYGYDPGO.js";import{b as $,c as B,d as c,e as U,f as H,h as j,i as z,k as K,l as J,m as W,n as X,o as Y,p as Z,q as ee,r as te,s as ie,u as ne}from"./chunk-GFCFUV6K.js";import{a as re}from"./chunk-MXHSEERB.js";import"./chunk-MPC7SZEK.js";import{b as Q}from"./chunk-CF2QCA26.js";import{h as w,i as G,l as O}from"./chunk-NUA5R5QO.js";import{$a as y,Ab as T,Ac as A,Cb as s,Da as l,Fb as i,Gb as D,Na as M,Ra as _,Ub as F,Vb as I,Xb as N,_ as p,bb as f,cb as b,da as E,ea as x,eb as h,fb as k,gb as d,hb as t,ia as V,ib as e,jb as m,ma as g,qb as q,rb as S,tb as u,uc as L,yc as R}from"./chunk-6O7NOF42.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-FK42CRUA.js";var le=(a,n)=>n.key;function me(a,n){if(a&1&&(t(0,"option",35),i(1),e()),a&2){let o=n.$implicit;d("value",o.key),l(),D(o.value.name)}}function de(a,n){if(a&1&&(h(0,me,2,2,"option",35,le),F(2,"keyvalue")),a&2){let o=u(2);k(I(2,0,o.eventTypes()))}}function ce(a,n){a&1&&(t(0,"span"),i(1,"Crear r\xE1pido"),e())}function se(a,n){a&1&&(m(0,"span",36),i(1,"Guardando\u2026 "))}function ue(a,n){if(a&1){let o=q();t(0,"form",15),S("ngSubmit",function(){E(o);let v=u();return x(v.onQuickSubmit())}),t(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"div",20)(6,"label",21),i(7,"T\xEDtulo"),e(),m(8,"input",22),t(9,"div",23),i(10,"T\xEDtulo es requerido (m\xEDn. 5 caracteres)."),e()(),t(11,"div",20)(12,"label",21),i(13,"Tipo de evento"),e(),t(14,"select",24)(15,"option",25),i(16,"Seleccione\u2026"),e(),f(17,de,3,2),e(),t(18,"div",23),i(19,"Seleccione un tipo."),e()(),t(20,"div",20)(21,"label",21),i(22,"Descripci\xF3n (opcional)"),e(),m(23,"textarea",26),e()()()(),t(24,"div",27)(25,"div",28)(26,"div",19)(27,"p",29),i(28,"Crea un evento con valores por defecto. Podr\xE1s completarlo luego."),e(),t(29,"ul",30)(30,"li"),i(31,"Estado inicial: borrador"),e(),t(32,"li"),i(33,"Visibilidad: p\xFAblica"),e(),t(34,"li"),i(35,"Fechas y dem\xE1s se configuran despu\xE9s"),e()()()(),t(36,"div",31)(37,"button",32),_(38,ce,2,0,"span",33)(39,se,2,0,"ng-template",null,0,N),e(),t(41,"a",34),i(42,"Cancelar"),e()()()()()}if(a&2){let o=T(40),r=u();d("formGroup",r.quickForm),l(8),s("is-invalid",r.quickInvalid("title")),l(6),s("is-invalid",r.quickInvalid("eventTypeId")),l(3),b(r.eventTypes()?17:-1),l(20),d("disabled",r.isQuickSubmitting()||r.quickForm.invalid),l(),d("ngIf",!r.isQuickSubmitting())("ngIfElse",o)}}function pe(a,n){if(a&1&&(t(0,"option",35),i(1),e()),a&2){let o=n.$implicit;d("value",o.key),l(),D(o.value.name)}}function ve(a,n){if(a&1&&(h(0,pe,2,2,"option",35,le),F(2,"keyvalue")),a&2){let o=u(2);k(I(2,0,o.eventTypes()))}}function fe(a,n){a&1&&(t(0,"span"),i(1,"Crear"),e())}function be(a,n){a&1&&(m(0,"span",36),i(1,"Guardando\u2026 "))}function Se(a,n){if(a&1){let o=q();t(0,"form",37),S("ngSubmit",function(){E(o);let v=u();return x(v.onSubmit())}),t(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"div",20)(6,"label",21),i(7,"T\xEDtulo"),e(),m(8,"input",22),t(9,"div",23),i(10,"T\xEDtulo es requerido (m\xEDn. 5 caracteres)."),e()(),t(11,"div",20)(12,"label",21),i(13,"Descripci\xF3n corta"),e(),m(14,"input",38),e(),t(15,"div",20)(16,"label",21),i(17,"Descripci\xF3n"),e(),m(18,"textarea",39),e(),t(19,"div",16)(20,"div",40)(21,"label",21),i(22,"Tipo de evento"),e(),t(23,"select",24)(24,"option",25),i(25,"Seleccione\u2026"),e(),f(26,ve,3,2),e(),t(27,"div",23),i(28,"Seleccione un tipo."),e()(),t(29,"div",41)(30,"label",21),i(31,"Inicio"),e(),m(32,"input",42),t(33,"div",23),i(34,"Fecha de inicio requerida."),e()(),t(35,"div",41)(36,"label",21),i(37,"Fin"),e(),m(38,"input",43),t(39,"div",23),i(40,"Fecha de fin requerida."),e()()(),t(41,"div",44)(42,"div",27)(43,"label",21),i(44,"Ubicaci\xF3n"),e(),t(45,"select",45)(46,"option",25),i(47,"Seleccione\u2026"),e(),t(48,"option",35),i(49,"Presencial"),e(),t(50,"option",35),i(51,"Virtual"),e(),t(52,"option",35),i(53,"H\xEDbrido"),e()(),t(54,"div",23),i(55,"Seleccione la ubicaci\xF3n."),e()(),t(56,"div",27)(57,"label",21),i(58,"Aforo m\xE1ximo"),e(),m(59,"input",46),e(),t(60,"div",27)(61,"label",21),i(62,"Costo (PEN)"),e(),m(63,"input",47),e()()()()(),t(64,"div",27)(65,"div",28)(66,"div",19)(67,"div",48),m(68,"input",49),t(69,"label",50),i(70,"Evento p\xFAblico"),e()(),t(71,"div",48),m(72,"input",51),t(73,"label",52),i(74,"Requiere aprobaci\xF3n"),e()(),t(75,"div",53),m(76,"input",54),t(77,"label",55),i(78,"Emite certificado"),e()()()(),t(79,"div",31)(80,"button",32),_(81,fe,2,0,"span",33)(82,be,2,0,"ng-template",null,1,N),e(),t(84,"a",34),i(85,"Cancelar"),e()()()()()}if(a&2){let o=T(83),r=u();d("formGroup",r.form),l(8),s("is-invalid",r.invalid("title")),l(15),s("is-invalid",r.invalid("eventTypeId")),l(3),b(r.eventTypes()?26:-1),l(6),s("is-invalid",r.invalid("startDate")),l(6),s("is-invalid",r.invalid("endDate")),l(7),s("is-invalid",r.invalid("locationType")),l(3),d("value",r.LocationType.PRESENCIAL),l(2),d("value",r.LocationType.VIRTUAL),l(2),d("value",r.LocationType.HIBRIDO),l(28),d("disabled",r.isSubmitting()||r.form.invalid),l(),d("ngIf",!r.isSubmitting())("ngIfElse",o)}}var ae=class a{fb=p(ie);router=p(w);destroyRef=p(V);staticData=p(re);eventService=p(oe);LocationType=Q;form;quickForm;submittingSig=g(!1);quickSubmittingSig=g(!1);modeSig=g("quick");eventTypesSig=P(this.staticData.eventTypes$,{initialValue:null});isLoadingSig=P(this.eventService.loading$,{initialValue:!1});ngOnInit(){this.form=this.fb.group({title:["",[c.required,c.minLength(5)]],shortDescription:[""],description:[""],eventTypeId:["",c.required],startDate:["",c.required],endDate:["",c.required],locationType:["",c.required],maxParticipants:[null],cost:[0,[c.min(0)]],isPublic:[!0],requiresApproval:[!1],requiresCertificate:[!1]}),this.quickForm=this.fb.group({title:["",[c.required,c.minLength(5)]],eventTypeId:["",c.required],description:[""]}),this.staticData.loadEventTypes().pipe(C(this.destroyRef)).subscribe()}eventTypes(){return this.eventTypesSig()}isSubmitting(){return this.submittingSig()}isQuickSubmitting(){return this.quickSubmittingSig()}mode(){return this.modeSig()}setMode(n){this.modeSig.set(n)}invalid(n){let o=this.form.get(n);return!!o&&o.invalid&&(o.dirty||o.touched)}quickInvalid(n){let o=this.quickForm.get(n);return!!o&&o.invalid&&(o.dirty||o.touched)}toIso(n){if(n)return new Date(n+"T00:00:00").toISOString()}onSubmit(){if(this.form.invalid||this.isSubmitting())return;this.submittingSig.set(!0);let n=this.form.value,o={title:n.title.trim(),shortDescription:n.shortDescription||void 0,description:n.description||void 0,eventTypeId:Number(n.eventTypeId),startDate:this.toIso(n.startDate),endDate:this.toIso(n.endDate),locationType:n.locationType,maxParticipants:n.maxParticipants?Number(n.maxParticipants):void 0,cost:n.cost!==null&&n.cost!==void 0?Number(n.cost):0,isPublic:!!n.isPublic,requiresApproval:!!n.requiresApproval,requiresCertificate:!!n.requiresCertificate};this.eventService.createEvent(o).pipe(C(this.destroyRef)).subscribe({next:r=>{this.router.navigate(["/eventos",r.id])},error:r=>{console.error("Crear evento error",r),this.submittingSig.set(!1)},complete:()=>this.submittingSig.set(!1)})}onQuickSubmit(){if(this.quickForm.invalid||this.isQuickSubmitting())return;this.quickSubmittingSig.set(!0);let n=this.quickForm.value,o={title:n.title.trim(),description:n.description||void 0,eventTypeId:Number(n.eventTypeId)};this.eventService.createQuickEvent(o).pipe(C(this.destroyRef)).subscribe({next:r=>{this.router.navigate(["/eventos",r.id,"editar"])},error:r=>{console.error("Crear r\xE1pido error",r),this.quickSubmittingSig.set(!1)},complete:()=>this.quickSubmittingSig.set(!1)})}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=M({type:a,selectors:[["app-event-create"]],decls:22,vars:8,consts:[["quickSaving",""],["saving",""],[1,"container","py-3"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/"],["routerLink","/eventos"],["aria-current","page",1,"breadcrumb-item","active"],[1,"h4","mb-3"],["role","tablist","aria-label","Modo de creaci\xF3n",1,"nav","nav-tabs","mb-3"],["role","presentation",1,"nav-item"],["type","button",1,"nav-link",3,"click"],["novalidate","","aria-label","Formulario de creaci\xF3n r\xE1pida de evento",1,"needs-validation",3,"formGroup"],["novalidate","","aria-label","Formulario de creaci\xF3n de evento",1,"needs-validation",3,"formGroup"],["novalidate","","aria-label","Formulario de creaci\xF3n r\xE1pida de evento",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-12","col-md-8"],[1,"card"],[1,"card-body"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","title","required","",1,"form-control"],[1,"invalid-feedback"],["formControlName","eventTypeId","required","",1,"form-select"],["value",""],["rows","3","formControlName","description",1,"form-control"],[1,"col-12","col-md-4"],[1,"card","mb-3"],[1,"mb-2","small","text-muted"],[1,"small","text-muted","mb-0"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],[4,"ngIf","ngIfElse"],["routerLink","/events",1,"btn","btn-outline-secondary"],[3,"value"],["aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],["novalidate","","aria-label","Formulario de creaci\xF3n de evento",1,"needs-validation",3,"ngSubmit","formGroup"],["type","text","formControlName","shortDescription","maxlength","160",1,"form-control"],["rows","4","formControlName","description",1,"form-control"],[1,"col-12","col-md-6"],[1,"col-6","col-md-3"],["type","date","formControlName","startDate","required","",1,"form-control"],["type","date","formControlName","endDate","required","",1,"form-control"],[1,"row","g-3","mt-1"],["formControlName","locationType","required","",1,"form-select"],["type","number","min","1","formControlName","maxParticipants",1,"form-control"],["type","number","min","0","step","0.01","formControlName","cost",1,"form-control"],[1,"form-check","form-switch","mb-2"],["type","checkbox","id","isPublic","formControlName","isPublic",1,"form-check-input"],["for","isPublic",1,"form-check-label"],["type","checkbox","id","requiresApproval","formControlName","requiresApproval",1,"form-check-input"],["for","requiresApproval",1,"form-check-label"],[1,"form-check","form-switch"],["type","checkbox","id","requiresCertificate","formControlName","requiresCertificate",1,"form-check-input"],["for","requiresCertificate",1,"form-check-label"]],template:function(o,r){o&1&&(t(0,"div",2)(1,"nav",3)(2,"ol",4)(3,"li",5)(4,"a",6),i(5,"Inicio"),e()(),t(6,"li",5)(7,"a",7),i(8,"Eventos"),e()(),t(9,"li",8),i(10,"Crear evento"),e()()(),t(11,"h2",9),i(12,"Nuevo evento"),e(),t(13,"ul",10)(14,"li",11)(15,"button",12),S("click",function(){return r.setMode("quick")}),i(16,"Crear r\xE1pido"),e()(),t(17,"li",11)(18,"button",12),S("click",function(){return r.setMode("advanced")}),i(19,"Crear avanzado"),e()()(),f(20,ue,43,9,"form",13),f(21,Se,86,18,"form",14),e()),o&2&&(l(15),s("active",r.mode()==="quick"),y("aria-selected",r.mode()==="quick"),l(3),s("active",r.mode()==="advanced"),y("aria-selected",r.mode()==="advanced"),l(2),b(r.mode()==="quick"?20:-1),l(),b(r.mode()==="advanced"?21:-1))},dependencies:[A,L,ne,j,X,Y,B,z,$,W,U,H,ee,te,Z,K,J,O,G,R],encapsulation:2})};export{ae as EventCreateComponent};
