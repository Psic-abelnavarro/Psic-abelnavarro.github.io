import{b as ae}from"./chunk-B45V5YRI.js";import{b as ne}from"./chunk-ZS5CCIUB.js";import{b as ie}from"./chunk-663N75WB.js";import{b as ee}from"./chunk-3AZUY6EQ.js";import{a as te}from"./chunk-GY3IPELX.js";import"./chunk-MPC7SZEK.js";import{a as w}from"./chunk-TVASKIN6.js";import{h as J,m as X}from"./chunk-EDRQHDMA.js";import{f as Q,h as W,i as q,l as Z}from"./chunk-PZ46FPEX.js";import{A as y,Aa as G,Cc as Y,Da as o,Db as H,Fb as f,Gb as r,Hb as g,I as M,Ib as u,Na as z,Ob as N,Q as B,S as O,_ as x,ab as A,ac as v,bb as m,cb as p,da as _,ea as C,fb as V,gb as P,hb as E,ia as U,ib as i,jb as n,k as D,kb as d,ma as S,rb as I,sb as h,ub as s,wb as j,xb as K,yb as $}from"./chunk-DCXCOY7M.js";import"./chunk-LJ5XHLMQ.js";import{a as T,b as k}from"./chunk-FK42CRUA.js";var re=["actionButtonContainer"];function le(a,t){a&1&&(i(0,"div",2)(1,"div",6)(2,"div",7),d(3,"span",8)(4,"span",9)(5,"span",10),n()(),i(6,"div",6)(7,"div",11)(8,"div",7),d(9,"div",12),n(),i(10,"div",13),d(11,"span",14)(12,"br")(13,"span",15),n()()(),i(14,"div",16)(15,"div",17)(16,"div",18)(17,"div",7),d(18,"span",19)(19,"span",20)(20,"span",21),n()()()(),i(21,"div",16)(22,"div",17)(23,"div",18)(24,"div",7),d(25,"span",22)(26,"span",23)(27,"span",24),n()()()()())}function ce(a,t){if(a&1&&(i(0,"div",3),d(1,"i",25),i(2,"span",26),r(3),n()()),a&2){let e=s();o(3),g(e.error())}}function de(a,t){if(a&1&&(i(0,"div",4),d(1,"i",27),i(2,"span",26),r(3),n()()),a&2){let e=s();o(3),g(e.success())}}function se(a,t){if(a&1&&(i(0,"span"),d(1,"i"),r(2),n()),a&2){let e=s(2);f(N("badge text-bg-",e.registrationStateInfo().color," d-flex align-items-center gap-1 fs-8")),o(),f(N("bi bi-",e.registrationStateInfo().icon)),o(),u(" ",e.registrationStateInfo().name," ")}}function me(a,t){a&1&&d(0,"span",48)}function pe(a,t){a&1&&d(0,"i",49)}function ge(a,t){if(a&1&&(i(0,"div",84),d(1,"i",89),r(2),n()),a&2){let e=s(4);o(2),u(" ",e.userInfo().institution," ")}}function ue(a,t){if(a&1&&(i(0,"div"),d(1,"i",90),r(2),n()),a&2){let e=s(4);o(2),u(" ",e.userInfo().documentNumber," ")}}function fe(a,t){if(a&1){let e=I();i(0,"div",69)(1,"div",80)(2,"span",81),r(3),n()(),i(4,"div",82)(5,"h6",83),r(6),n(),i(7,"div",44)(8,"div",84),d(9,"i",85),i(10,"a",86),r(11),n()(),m(12,ge,3,1,"div",84),m(13,ue,3,1,"div"),n()(),i(14,"button",87),h("click",function(){_(e);let c=s(3);return C(c.goToUser())}),d(15,"i",88),n()()}if(a&2){let e=s(3);o(3),g(e.userInfo().initials),o(3),g(e.userInfo().fullName),o(4),E("href",N("mailto:",e.userInfo().email),G),o(),u(" ",e.userInfo().email," "),o(),p(e.userInfo().hasInstitution?12:-1),o(),p(e.userInfo().hasDocumentNumber?13:-1)}}function ve(a,t){if(a&1&&(i(0,"div",84),d(1,"i",95),r(2),n()),a&2){let e=s(4);o(2),u(" ",e.formatCurrency(e.eventInfo().cost)," ")}}function xe(a,t){if(a&1&&(i(0,"div"),d(1,"i",96),i(2,"span"),r(3),n()()),a&2){let e=s(4);o(),f(e.getEventStatusInfo().class),o(),f(e.getEventStatusInfo().class),o(),g(e.getEventStatusInfo().text)}}function _e(a,t){if(a&1){let e=I();i(0,"div",69)(1,"div",91),d(2,"i",92),n(),i(3,"div",82)(4,"h6",83),r(5),n(),i(6,"div",44)(7,"div",84),d(8,"i",93),r(9),n(),m(10,ve,3,1,"div",84),m(11,xe,4,5,"div"),n()(),i(12,"button",94),h("click",function(){_(e);let c=s(3);return C(c.goToEvent())}),d(13,"i",88),n()()}if(a&2){let e=s(3);o(5),g(e.eventInfo().title),o(4),u(" ",e.formatDate(e.eventInfo().startDate)," "),o(),p(e.eventInfo().cost&&e.eventInfo().cost>0?10:-1),o(),p(e.getEventStatusInfo()?11:-1)}}function Ce(a,t){if(a&1&&(i(0,"p",101),r(1),n()),a&2){let e=s(4);o(),g(e.registrationStateInfo().description)}}function he(a,t){if(a&1&&(i(0,"div",74)(1,"div",97)(2,"div",98),d(3,"i",99),n()(),i(4,"h6",100),r(5),n(),m(6,Ce,2,1,"p",101),n()),a&2){let e=s(3);o(3),f("bi-"+e.registrationStateInfo().icon+" text-"+e.registrationStateInfo().color),o(2),g(e.registrationStateInfo().name),o(),p(e.registrationStateInfo().description?6:-1)}}function be(a,t){if(a&1&&(i(0,"div",77)(1,"label",78),r(2,"Fecha de Confirmaci\xF3n"),n(),i(3,"p",79),r(4),n()()),a&2){let e=s(3);o(4),g(e.formatDate(e.registration().confirmationDate))}}function Se(a,t){if(a&1&&(i(0,"div",77)(1,"label",78),r(2,"Fecha de Check-in"),n(),i(3,"p",79),r(4),n()()),a&2){let e=s(3);o(4),g(e.formatDate(e.registration().checkInDate))}}function Ee(a,t){if(a&1&&(i(0,"div",77)(1,"label",78),r(2,"Asistencia Verificada"),n(),i(3,"p",79),r(4),i(5,"span",102),r(6),n()()()),a&2){let e=s(3);o(4),u(" ",e.formatDate(e.registration().attendanceVerifiedDate)," "),o(2),u("",e.registration().attendancePercentage,"%")}}function Ie(a,t){if(a&1&&(i(0,"div",73)(1,"label",78),r(2,"M\xE9todo de Pago"),n(),i(3,"p",107),r(4),n()()),a&2){let e=s(4);o(4),g(e.paymentInfo().paymentMethod)}}function De(a,t){if(a&1&&(i(0,"div",73)(1,"label",78),r(2,"Referencia"),n(),i(3,"p",108),r(4),n()()),a&2){let e=s(4);o(4),g(e.paymentInfo().paymentReference)}}function ye(a,t){if(a&1&&(i(0,"div",73)(1,"label",78),r(2,"Fecha de Pago"),n(),i(3,"p",109),r(4),n()()),a&2){let e=s(4);o(4),g(e.formatDate(e.paymentInfo().paymentDate))}}function we(a,t){if(a&1&&(i(0,"div",6)(1,"div",17)(2,"div",66)(3,"h6",67),d(4,"i",103),r(5," Informaci\xF3n de Pago "),n()(),i(6,"div",18)(7,"div",76)(8,"div",104)(9,"label",78),r(10,"Costo del Evento"),n(),i(11,"p",79),r(12),n()(),i(13,"div",104)(14,"label",78),r(15,"Monto Pagado"),n(),i(16,"p",105),r(17),n()(),i(18,"div",104)(19,"label",78),r(20,"Monto Pendiente"),n(),i(21,"p",79),r(22),n()(),i(23,"div",104)(24,"label",78),r(25,"Estado"),n(),i(26,"span",106),r(27),n()(),m(28,Ie,5,1,"div",73),m(29,De,5,1,"div",73),m(30,ye,5,1,"div",73),n()()()()),a&2){let e=s(3);o(12),g(e.formatCurrency(e.paymentInfo().eventCost,e.paymentInfo().currency)),o(5),g(e.formatCurrency(e.paymentInfo().amountPaid,e.paymentInfo().currency)),o(4),f(e.paymentInfo().pendingAmount>0?"text-warning":"text-success"),o(),u(" ",e.formatCurrency(e.paymentInfo().pendingAmount,e.paymentInfo().currency)," "),o(4),f(e.paymentInfo().isFullyPaid?"text-bg-success":"text-bg-warning"),o(),u(" ",e.paymentInfo().isFullyPaid?"Pagado Completo":"Pago Pendiente"," "),o(),p(e.paymentInfo().paymentMethod?28:-1),o(),p(e.paymentInfo().paymentReference?29:-1),o(),p(e.paymentInfo().paymentDate?30:-1)}}function Re(a,t){if(a&1&&(i(0,"div",16)(1,"div",65)(2,"div",66)(3,"h6",67),d(4,"i",68),r(5," Informaci\xF3n del Participante "),n()(),i(6,"div",18),m(7,fe,16,7,"div",69),n()()(),i(8,"div",16)(9,"div",65)(10,"div",66)(11,"h6",67),d(12,"i",70),r(13," Informaci\xF3n del Evento "),n()(),i(14,"div",18),m(15,_e,14,4,"div",69),n()()(),i(16,"div",6)(17,"div",17)(18,"div",66)(19,"h6",67),d(20,"i",71),r(21," Estado de la Inscripci\xF3n "),n()(),i(22,"div",18)(23,"div",72)(24,"div",73),m(25,he,7,4,"div",74),n(),i(26,"div",75)(27,"div",76)(28,"div",77)(29,"label",78),r(30,"Fecha de Registro"),n(),i(31,"p",79),r(32),n()(),m(33,be,5,1,"div",77),m(34,Se,5,1,"div",77),m(35,Ee,7,2,"div",77),n()()()()()(),m(36,we,31,11,"div",6)),a&2){let e=s(2);o(7),p(e.userInfo()?7:-1),o(8),p(e.eventInfo()?15:-1),o(10),p(e.registrationStateInfo()?25:-1),o(7),g(e.formatDate(e.registration().registrationDate)),o(),p(e.registration().confirmationDate?33:-1),o(),p(e.registration().checkInDate?34:-1),o(),p(e.registration().attendanceVerifiedDate?35:-1),o(),p(e.paymentInfo()&&(e.paymentInfo().eventCost>0||e.paymentInfo().hasPayment)?36:-1)}}function Te(a,t){if(a&1&&(i(0,"p",101),r(1),n()),a&2){let e=s().$implicit;o(),g(e.description)}}function ke(a,t){a&1&&(i(0,"span",120),r(1,"Estado Actual"),n())}function Me(a,t){if(a&1&&(i(0,"div",114)(1,"div",115)(2,"div",116),d(3,"i",117),n()(),i(4,"div",82)(5,"div",118)(6,"div",18)(7,"div",119)(8,"h6",79),r(9),n(),i(10,"small",44),r(11),n()(),m(12,Te,2,1,"p",101),m(13,ke,2,0,"span",120),n()()()()),a&2){let e=t.$implicit,l=s(4);o(2),f("bg-"+e.color),H("border-primary",e.isCurrentState),o(),f("bi-"+e.icon),o(6),g(e.title),o(2),g(l.formatDateShort(e.date)),o(),p(e.description?12:-1),o(),p(e.isCurrentState?13:-1)}}function Ne(a,t){if(a&1&&(i(0,"div",111),d(1,"div",113),V(2,Me,14,10,"div",114,A().trackByTimelineId,!0),n()),a&2){let e=s(3);o(2),P(e.timeline())}}function Ae(a,t){a&1&&(i(0,"div",112),d(1,"i",121),i(2,"p",122),r(3,"No hay eventos en la cronolog\xEDa"),n()())}function Ve(a,t){if(a&1&&(i(0,"div",6)(1,"div",17)(2,"div",66)(3,"h6",67),d(4,"i",110),r(5," Cronolog\xEDa de Estados "),n()(),i(6,"div",18),m(7,Ne,4,0,"div",111)(8,Ae,4,0,"div",112),n()()()),a&2){let e=s(2);o(7),p(e.timeline().length>0?7:8)}}function Pe(a,t){if(a&1&&(i(0,"tr")(1,"td",127),r(2,"Estado Anterior ID:"),n(),i(3,"td",128),r(4),n()()),a&2){let e=s(3);o(4),g(e.registration().previousStateId)}}function Fe(a,t){if(a&1&&(i(0,"tr")(1,"td",127),r(2,"Estado Cambiado:"),n(),i(3,"td",128),r(4),n()()),a&2){let e=s(3);o(4),g(e.formatDate(e.registration().stateChangedAt))}}function Le(a,t){if(a&1&&(i(0,"div",6)(1,"label",78),r(2,"Notas:"),n(),i(3,"div",131)(4,"p",107),r(5),n()()()),a&2){let e=s(3);o(5),g(e.registration().notes)}}function Be(a,t){if(a&1&&(i(0,"div",6)(1,"div",17)(2,"div",66)(3,"h6",67),d(4,"i",123),r(5," Informaci\xF3n T\xE9cnica "),n()(),i(6,"div",18)(7,"div",76)(8,"div",124)(9,"div",125)(10,"table",126)(11,"tbody")(12,"tr")(13,"td",127),r(14,"ID de Inscripci\xF3n:"),n(),i(15,"td",128),r(16),n()(),i(17,"tr")(18,"td",127),r(19,"ID de Usuario:"),n(),i(20,"td",128),r(21),n()(),i(22,"tr")(23,"td",127),r(24,"ID de Evento:"),n(),i(25,"td",128),r(26),n()(),i(27,"tr")(28,"td",127),r(29,"Rol Participante:"),n(),i(30,"td",128),r(31),n()(),i(32,"tr")(33,"td",127),r(34,"Estado Actual ID:"),n(),i(35,"td",128),r(36),n()(),m(37,Pe,5,1,"tr"),n()()()(),i(38,"div",124)(39,"div",125)(40,"table",126)(41,"tbody")(42,"tr")(43,"td",127),r(44,"Creado:"),n(),i(45,"td",128),r(46),n()(),i(47,"tr")(48,"td",127),r(49,"Actualizado:"),n(),i(50,"td",128),r(51),n()(),m(52,Fe,5,1,"tr"),i(53,"tr")(54,"td",127),r(55,"Elegible Certificado:"),n(),i(56,"td",129)(57,"span",130),r(58),n()()(),i(59,"tr")(60,"td",127),r(61,"Certificado Emitido:"),n(),i(62,"td",129)(63,"span",130),r(64),n()()(),i(65,"tr")(66,"td",127),r(67,"Asistencia Verificada:"),n(),i(68,"td",129)(69,"span",130),r(70),n()()()()()()(),m(71,Le,6,1,"div",6),n()()()()),a&2){let e=s(2);o(16),u("#",e.registration().id),o(5),g(e.registration().userId),o(5),g(e.registration().eventId),o(5),g(e.registration().participantRoleId),o(5),g(e.registration().currentStateId),o(),p(e.registration().previousStateId?37:-1),o(9),g(e.formatDate(e.registration().createdAt)),o(5),g(e.formatDate(e.registration().updatedAt)),o(),p(e.registration().stateChangedAt?52:-1),o(5),f(e.registration().certificateEligible?"text-bg-success":"text-bg-secondary"),o(),u(" ",e.registration().certificateEligible?"S\xED":"No"," "),o(5),f(e.registration().certificateIssued?"text-bg-success":"text-bg-secondary"),o(),u(" ",e.registration().certificateIssued?"S\xED":"No"," "),o(5),f(e.registration().attendanceVerified?"text-bg-success":"text-bg-secondary"),o(),u(" ",e.registration().attendanceVerified?"S\xED":"No"," "),o(),p(e.registration().notes?71:-1)}}function Oe(a,t){a&1&&d(0,"span",48)}function Ue(a,t){if(a&1&&d(0,"i",138),a&2){let e=s().$implicit;f("bi-"+e.icon)}}function Ge(a,t){if(a&1){let e=I();i(0,"button",136),h("click",function(){let c=_(e).$implicit;return C(c.action())}),m(1,Oe,1,0,"span",48)(2,Ue,1,2,"i",137),i(3,"span",81),r(4),n()()}if(a&2){let e=t.$implicit,l=s(3);f("btn-"+(e.variant==="danger"?"outline-"+e.variant:e.variant)),E("disabled",e.loading||l.actionLoading()),o(),p(e.loading?1:2),o(3),g(e.label)}}function ze(a,t){if(a&1&&(i(0,"div",64,0)(2,"div",132)(3,"h6",133),d(4,"i",63),r(5," Acciones Disponibles "),n()(),i(6,"div",18)(7,"div",134),V(8,Ge,5,5,"button",135,A().trackByActionId,!0),n()()()),a&2){let e=s(2);o(8),P(e.actionButtons())}}function je(a,t){if(a&1){let e=I();i(0,"nav",28)(1,"ol",29)(2,"li",30)(3,"a",31),d(4,"i",32),i(5,"span",33),r(6,"Inicio"),n()()(),i(7,"li",30)(8,"a",34),d(9,"i",35),i(10,"span",33),r(11,"Inscripciones"),n()()(),i(12,"li",36),r(13),n()()(),i(14,"div",37)(15,"div",38)(16,"div",11)(17,"div",39),d(18,"i",40),n(),i(19,"div")(20,"h6",41),r(21),n(),i(22,"div",42),m(23,se,3,7,"span",43),i(24,"small",44),d(25,"i",45),r(26),n()()()()(),i(27,"div",46)(28,"button",47),h("click",function(){_(e);let c=s();return C(c.refreshData())}),m(29,me,1,0,"span",48)(30,pe,1,0,"i",49),i(31,"span",50),r(32,"Actualizar"),n()(),i(33,"button",51),h("click",function(){_(e);let c=s();return C(c.navigateBack())}),d(34,"i",52),i(35,"span",50),r(36,"Volver"),n()()()(),i(37,"div",53)(38,"div",18)(39,"div",54)(40,"input",55),h("change",function(){_(e);let c=s();return C(c.changeViewMode("overview"))}),n(),i(41,"label",56),d(42,"i",57),i(43,"span",50),r(44,"Vista General"),n()(),i(45,"input",58),h("change",function(){_(e);let c=s();return C(c.changeViewMode("timeline"))}),n(),i(46,"label",59),d(47,"i",60),i(48,"span",50),r(49,"Cronolog\xEDa"),n()(),i(50,"input",61),h("change",function(){_(e);let c=s();return C(c.changeViewMode("technical"))}),n(),i(51,"label",62),d(52,"i",63),i(53,"span",50),r(54,"T\xE9cnico"),n()()()()(),i(55,"div",2),m(56,Re,37,8),m(57,Ve,9,1,"div",6),m(58,Be,72,19,"div",6),n(),m(59,ze,10,0,"div",64)}if(a&2){let e=s();o(13),u(" Detalle #",e.registration().id," "),o(8),u(" Inscripci\xF3n #",e.registration().id," "),o(2),p(e.registrationStateInfo()?23:-1),o(3),u(" Creado ",e.formatDateShort(e.registration().createdAt)," "),o(2),E("disabled",e.loading()),o(),p(e.loading()?29:30),o(11),E("checked",e.viewMode()==="overview"),o(5),E("checked",e.viewMode()==="timeline"),o(5),E("checked",e.viewMode()==="technical"),o(6),p(e.viewMode()==="overview"?56:-1),o(),p(e.viewMode()==="timeline"?57:-1),o(),p(e.viewMode()==="technical"?58:-1),o(),p(e.actionButtons().length>0?59:-1)}}function Ke(a,t){if(a&1){let e=I();i(0,"div",5)(1,"div",139),d(2,"i",140),i(3,"h6",83),r(4,"Inscripci\xF3n no encontrada"),n(),i(5,"p",141),r(6,"No se pudo cargar la informaci\xF3n de la inscripci\xF3n solicitada."),n(),i(7,"button",142),h("click",function(){_(e);let c=s();return C(c.navigateBack())}),d(8,"i",52),i(9,"span",81),r(10,"Volver a Inscripciones"),n()()()()}}var oe=class a{destroyRef=x(U);route=x(Q);router=x(W);registrationService=x(ne);eventService=x(ie);userService=x(ee);certificateService=x(ae);authService=x(X);staticDataService=x(te);actionButtonContainer=S(null);loadingState=S({main:!1,action:!1,certificate:!1,stateChange:!1});loading=v(()=>this.loadingState().main);actionLoading=v(()=>this.loadingState().action||this.loadingState().certificate||this.loadingState().stateChange);error=S(null);success=S(null);registrationId=S(null);viewMode=S("overview");registration=S(null);currentUser=v(()=>this.authService.currentUser);permissions=v(()=>{let t=this.registration(),e=this.currentUser();if(!t||!e)return{canEdit:!1,canCancel:!1,canConfirm:!1,canCheckIn:!1,canMarkAttended:!1,canMarkNoShow:!1,canGenerateCertificate:!1,canChangeState:!1,reason:"Informaci\xF3n no disponible"};let l=e.role==="admin",c=e.role==="organizer",R=e.id===t.userId,b=t.currentState?.stateKey,F=t.event?.endDate?new Date>new Date(t.event.endDate):!1,L=t.event?.startDate?new Date>new Date(t.event.startDate):!1;return{canEdit:(l||c||R)&&J.includes(b),canCancel:(l||c||R)&&["draft","pending_validation","confirmed","payment_pending"].includes(b),canConfirm:(l||c)&&b==="pending_validation",canCheckIn:(l||c)&&b==="confirmed"&&L&&!F,canMarkAttended:(l||c)&&b==="checked_in"&&L,canMarkNoShow:(l||c)&&["confirmed","checked_in"].includes(b)&&F,canGenerateCertificate:(l||c)&&t.certificateEligible&&!t.certificateIssued&&b==="attended",canChangeState:l||c}});registrationStateInfo=v(()=>{let t=this.registration();if(!t?.currentState?.stateKey)return null;let e=t.currentState.stateKey,c={draft:{color:"secondary",icon:"file-text"},pending_validation:{color:"warning",icon:"clock"},payment_required:{color:"danger",icon:"credit-card"},payment_pending:{color:"warning",icon:"hourglass-split"},payment_failed:{color:"danger",icon:"x-circle"},confirmed:{color:"success",icon:"check-circle"},waitlist:{color:"info",icon:"list-ul"},checked_in:{color:"info",icon:"box-arrow-in-right"},attended:{color:"success",icon:"check-all"},no_show:{color:"danger",icon:"x-octagon"},cancelled_by_user:{color:"secondary",icon:"x-circle"},cancelled_by_admin:{color:"dark",icon:"ban"}}[e]||{color:"secondary",icon:"circle"};return{key:e,name:t.currentState.displayName||e,description:t.currentState.description,color:c.color,icon:c.icon,badgeClass:`bg-${c.color}`}});eventInfo=v(()=>{let t=this.registration();if(!t?.event)return null;let e=new Date,l=new Date(t.event.startDate),c=new Date(t.event.endDate);return k(T({},t.event),{hasStarted:e>=l,hasEnded:e>c,isOngoing:e>=l&&e<=c,daysUntilStart:Math.ceil((l.getTime()-e.getTime())/(1e3*60*60*24)),daysSinceEnd:Math.ceil((e.getTime()-c.getTime())/(1e3*60*60*24))})});userInfo=v(()=>{let t=this.registration();return t?.user?k(T({},t.user),{initials:this.getUserInitials(t.user.fullName),hasInstitution:!!t.user.institution,hasDocumentNumber:!!t.user.documentNumber}):null});paymentInfo=v(()=>{let t=this.registration();if(!t)return null;let e=t.event?.cost||0,l=t.amountPaid||0,c=Math.max(0,e-l);return{eventCost:e,amountPaid:l,pendingAmount:c,isFullyPaid:c===0,hasPayment:l>0,paymentMethod:t.paymentMethod,paymentReference:t.paymentReference,paymentDate:t.paymentDate,currency:t.currency||"PEN"}});actionButtons=v(()=>{let t=this.permissions(),e=this.actionLoading();return[{id:"edit",label:"Editar",icon:"pencil-square",variant:"primary",action:()=>this.goToEdit(),visible:t.canEdit},{id:"confirm",label:"Confirmar",icon:"check-circle",variant:"success",action:()=>this.confirmRegistration(),visible:t.canConfirm,loading:this.loadingState().stateChange},{id:"checkin",label:"Check-in",icon:"box-arrow-in-right",variant:"info",action:()=>this.checkInRegistration(),visible:t.canCheckIn,loading:this.loadingState().stateChange},{id:"attended",label:"Marcar Asistido",icon:"check-all",variant:"success",action:()=>this.markAsAttended(),visible:t.canMarkAttended,loading:this.loadingState().stateChange},{id:"noshow",label:"Marcar No Show",icon:"x-octagon",variant:"warning",action:()=>this.markAsNoShow(),visible:t.canMarkNoShow,loading:this.loadingState().stateChange},{id:"certificate",label:"Generar Certificado",icon:"award",variant:"info",action:()=>this.generateCertificate(),visible:t.canGenerateCertificate,loading:this.loadingState().certificate},{id:"cancel",label:"Cancelar Inscripci\xF3n",icon:"x-circle",variant:"danger",action:()=>this.cancelRegistration(),visible:t.canCancel,loading:this.loadingState().stateChange}].filter(l=>l.visible)});timeline=v(()=>{let t=this.registration();if(!t)return[];let e=[],l=t.currentState?.stateKey;e.push({id:"registration",title:"Inscripci\xF3n Creada",description:"Se cre\xF3 la inscripci\xF3n en el sistema",date:t.registrationDate,icon:"plus-circle",color:"primary"}),t.confirmationDate&&e.push({id:"confirmation",title:"Inscripci\xF3n Confirmada",description:"La inscripci\xF3n fue confirmada oficialmente",date:t.confirmationDate,icon:"check-circle",color:"success"}),t.paymentDate&&e.push({id:"payment",title:"Pago Procesado",description:`Pago de ${this.formatCurrency(t.amountPaid)} procesado exitosamente`,date:t.paymentDate,icon:"credit-card",color:"info"}),t.checkInDate&&e.push({id:"checkin",title:"Check-in Realizado",description:"El participante se registr\xF3 en el evento",date:t.checkInDate,icon:"box-arrow-in-right",color:"info"}),t.attendanceVerifiedDate&&e.push({id:"attendance",title:"Asistencia Verificada",description:`Asistencia del ${t.attendancePercentage}% verificada`,date:t.attendanceVerifiedDate,icon:"check-all",color:"success"});let c=e[e.length-1];return c&&(c.isCurrentState=!0),e.sort((R,b)=>new Date(R.date).getTime()-new Date(b.date).getTime())});hasUnsavedChanges=v(()=>!1);ngOnInit(){this.loadRegistration()}loadRegistration(){this.setLoadingState("main",!0),this.error.set(null),this.route.params.pipe(O(t=>{let e=parseInt(t.id,10);this.registrationId.set(e)}),B(t=>{let e=parseInt(t.id,10);if(isNaN(e))throw new Error("ID de inscripci\xF3n inv\xE1lido");return this.registrationService.getRegistrationById(e)}),y(t=>(console.error("Error loading registration:",t),this.error.set(t.message||"Error al cargar los detalles de la inscripci\xF3n. Por favor, intente nuevamente."),D(null))),w(this.destroyRef)).subscribe(t=>{this.registration.set(t),this.setLoadingState("main",!1)})}refreshData(){let t=this.registrationId();t&&(this.setLoadingState("main",!0),this.registrationService.getRegistrationById(t).pipe(y(e=>(console.error("Error refreshing registration:",e),this.error.set("Error al actualizar los datos"),D(null))),M(()=>this.setLoadingState("main",!1)),w(this.destroyRef)).subscribe(e=>{this.registration.set(e),this.success.set("Datos actualizados exitosamente"),setTimeout(()=>this.success.set(null),3e3)}))}confirmRegistration(){this.changeRegistrationState("confirmed","Inscripci\xF3n confirmada exitosamente")}checkInRegistration(){this.changeRegistrationState("checked_in","Check-in realizado exitosamente")}markAsAttended(){this.changeRegistrationState("attended","Asistencia registrada exitosamente")}markAsNoShow(){confirm('\xBFEst\xE1 seguro de marcar esta inscripci\xF3n como "No Show"? Esta acci\xF3n no se puede deshacer.')&&this.changeRegistrationState("no_show",'Inscripci\xF3n marcada como "No Show"')}cancelRegistration(){confirm("\xBFEst\xE1 seguro de cancelar esta inscripci\xF3n? Esta acci\xF3n no se puede deshacer.")&&this.changeRegistrationState("cancelled_by_admin","Inscripci\xF3n cancelada exitosamente")}changeRegistrationState(t,e){let l=this.registration();l&&(this.setLoadingState("stateChange",!0),this.error.set(null),this.registrationService.changeRegistrationState(l.id,t).pipe(y(c=>(console.error("Error changing registration state:",c),this.error.set(c.error?.message||"Error al cambiar el estado de la inscripci\xF3n. Por favor, intente nuevamente."),D(null))),M(()=>this.setLoadingState("stateChange",!1)),w(this.destroyRef)).subscribe(c=>{c?.success?(this.success.set(e),this.refreshData()):c?.message&&this.error.set(c.message)}))}generateCertificate(){let t=this.registration();if(!t)return;this.setLoadingState("certificate",!0),this.error.set(null);let e={userId:t.userId,eventId:t.eventId,participantRoleId:t.participantRoleId};this.certificateService.generateCertificate(e).pipe(y(l=>(console.error("Error generating certificate:",l),this.error.set(l.error?.message||"Error al generar el certificado. Por favor, intente nuevamente."),D(null))),M(()=>this.setLoadingState("certificate",!1)),w(this.destroyRef)).subscribe(l=>{l&&(this.success.set("Certificado generado exitosamente"),this.refreshData())})}goToEdit(){let t=this.registration();t&&this.router.navigate(["/inscripciones",t.id,"editar"])}goToEvent(){let t=this.registration();t?.event&&this.router.navigate(["/eventos",t.event.id])}goToUser(){let t=this.registration();t?.user&&this.router.navigate(["/usuarios",t.user.id])}navigateBack(){this.router.navigate(["/inscripciones"])}setLoadingState(t,e){this.loadingState.update(l=>k(T({},l),{[t]:e}))}changeViewMode(t){this.viewMode.set(t)}formatDate(t){return t?new Intl.DateTimeFormat("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(t)):"No disponible"}formatDateShort(t){return t?new Intl.DateTimeFormat("es-PE",{year:"numeric",month:"short",day:"numeric"}).format(new Date(t)):"No disponible"}formatCurrency(t,e="PEN"){return new Intl.NumberFormat("es-PE",{style:"currency",currency:e}).format(t)}getUserInitials(t){if(!t)return"U";let e=t.trim().split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():e[0][0].toUpperCase()}getEventStatusInfo(){let t=this.eventInfo();if(!t)return null;if(t.isOngoing)return{text:"En curso",class:"text-success",icon:"play-circle"};if(t.hasEnded)return{text:"Finalizado",class:"text-muted",icon:"stop-circle"};if(t.hasStarted)return{text:"Iniciado",class:"text-info",icon:"play"};{let e=t.daysUntilStart;return e===0?{text:"Hoy",class:"text-warning",icon:"calendar-event"}:e===1?{text:"Ma\xF1ana",class:"text-warning",icon:"calendar-plus"}:e>0?{text:`En ${e} d\xEDas`,class:"text-primary",icon:"calendar"}:{text:"Fecha pasada",class:"text-danger",icon:"calendar-x"}}}trackByActionId(t,e){return e.id}trackByTimelineId(t,e){return e.id}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=z({type:a,selectors:[["app-registration-detail"]],viewQuery:function(e,l){if(e&1&&j(re,5),e&2){let c;K(c=$())&&(l.actionButtonContainer=c.first)}},decls:6,vars:3,consts:[["actionButtonContainer",""],[1,"container-fluid","py-3"],[1,"row","g-3"],["role","alert",1,"alert","alert-danger","border-0","shadow-sm","d-flex","align-items-center","py-2"],["role","alert",1,"alert","alert-success","border-0","shadow-sm","d-flex","align-items-center","py-2"],[1,"d-flex","justify-content-center","align-items-center",2,"min-height","50vh"],[1,"col-12"],[1,"placeholder-glow"],[1,"placeholder","placeholder-sm","col-2"],[1,"placeholder","placeholder-sm","col-1","ms-2"],[1,"placeholder","placeholder-sm","col-3","ms-2"],[1,"d-flex","align-items-center","gap-2"],[1,"placeholder","bg-secondary","rounded-circle",2,"width","32px","height","32px"],[1,"placeholder-glow","flex-grow-1"],[1,"placeholder","col-4"],[1,"placeholder","placeholder-sm","col-3"],[1,"col-12","col-lg-6"],[1,"card","border-0","shadow-sm"],[1,"card-body","py-2"],[1,"placeholder","col-5","mb-2"],[1,"placeholder","placeholder-sm","col-7"],[1,"placeholder","placeholder-sm","col-4"],[1,"placeholder","col-6","mb-2"],[1,"placeholder","placeholder-sm","col-8"],[1,"placeholder","placeholder-sm","col-5"],[1,"bi","bi-exclamation-triangle","me-1","fs-6"],[1,"small"],[1,"bi","bi-check-circle","me-1","fs-6"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb","mb-0","fs-7"],[1,"breadcrumb-item"],["routerLink","/",1,"text-decoration-none","link-primary"],[1,"bi","bi-house-door","me-1"],[1,"d-none","d-sm-inline"],["routerLink","/inscripciones",1,"text-decoration-none","link-primary"],[1,"bi","bi-person-badge","me-1"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","flex-column","flex-sm-row","align-items-start","align-items-sm-center","justify-content-between","gap-2","mb-3"],[1,"order-1","order-sm-0"],[1,"bg-primary","rounded-circle","d-flex","align-items-center","justify-content-center",2,"width","32px","height","32px"],[1,"bi","bi-person-badge","text-white","fs-7"],[1,"fw-normal","small","mb-1"],[1,"d-flex","flex-wrap","align-items-center","gap-1"],[3,"class"],[1,"text-muted","fs-8"],[1,"bi","bi-calendar","me-1"],[1,"d-flex","flex-wrap","gap-1","order-0","order-sm-1"],["type","button","title","Actualizar datos",1,"btn","btn-outline-secondary","btn-sm","px-2",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"d-none","d-sm-inline","fs-8"],["type","button","title","Volver a la lista",1,"btn","btn-outline-secondary","btn-sm","px-2",3,"click"],[1,"bi","bi-arrow-left","me-1"],[1,"card","border-0","shadow-sm","mb-3"],["role","group","aria-label","Modos de vista",1,"btn-group","w-100"],["type","radio","id","overview","autocomplete","off",1,"btn-check","form-check-input-sm",3,"change","checked"],["for","overview",1,"btn","btn-outline-primary","btn-sm"],[1,"bi","bi-grid-3x3-gap","me-1"],["type","radio","id","timeline","autocomplete","off",1,"btn-check","form-check-input-sm",3,"change","checked"],["for","timeline",1,"btn","btn-outline-primary","btn-sm"],[1,"bi","bi-clock-history","me-1"],["type","radio","id","technical","autocomplete","off",1,"btn-check","form-check-input-sm",3,"change","checked"],["for","technical",1,"btn","btn-outline-primary","btn-sm"],[1,"bi","bi-gear","me-1"],[1,"card","border-0","shadow-sm","mt-4"],[1,"card","border-0","shadow-sm","h-100"],[1,"card-header","bg-light","border-0","py-2"],[1,"card-title","mb-0","d-flex","align-items-center","fw-normal","small"],[1,"bi","bi-person","me-1","text-primary"],[1,"d-flex","align-items-start","gap-2"],[1,"bi","bi-calendar-event","me-1","text-primary"],[1,"bi","bi-clipboard-check","me-1","text-primary"],[1,"row","g-3","align-items-center"],[1,"col-12","col-md-4"],[1,"text-center","py-3","bg-light","rounded"],[1,"col-12","col-md-8"],[1,"row","g-2"],[1,"col-6"],[1,"form-label","text-muted","fs-8","mb-1"],[1,"mb-0","fw-normal","fs-7"],[1,"bg-primary","rounded-circle","d-flex","align-items-center","justify-content-center","text-white","flex-shrink-0","fw-normal",2,"width","32px","height","32px"],[1,"fs-8"],[1,"flex-grow-1"],[1,"mb-2","fw-normal","fs-7"],[1,"mb-1"],[1,"bi","bi-envelope","me-1","text-primary"],[1,"text-decoration-none",3,"href"],["type","button","title","Ver perfil completo",1,"btn","btn-outline-primary","btn-sm","px-2",3,"click"],[1,"bi","bi-arrow-right"],[1,"bi","bi-building","me-1","text-primary"],[1,"bi","bi-card-text","me-1","text-primary"],[1,"bg-success","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","32px","height","32px"],[1,"bi","bi-calendar-event","text-white","fs-8"],[1,"bi","bi-calendar","me-1","text-success"],["type","button","title","Ver evento completo",1,"btn","btn-outline-success","btn-sm","px-2",3,"click"],[1,"bi","bi-credit-card","me-1","text-success"],[1,"bi"],[1,"mb-2"],[1,"bg-white","rounded-circle","d-flex","align-items-center","justify-content-center","shadow-sm",2,"width","48px","height","48px"],[1,"bi","fs-5"],[1,"fw-normal","fs-7","mb-1"],[1,"text-muted","fs-8","mb-0"],[1,"badge","text-bg-success","ms-1","fs-8"],[1,"bi","bi-credit-card","me-1","text-primary"],[1,"col-12","col-md-3"],[1,"mb-0","fw-normal","fs-7","text-success"],[1,"badge","fs-8"],[1,"mb-0","fs-8"],[1,"mb-0","font-monospace","fs-8"],[1,"mb-0","fs-7"],[1,"bi","bi-clock-history","me-1","text-primary"],[1,"position-relative"],[1,"text-center","py-5"],[1,"position-absolute","start-0","top-0","bottom-0","bg-primary","opacity-25",2,"width","2px","left","15px"],[1,"d-flex","gap-2","mb-3","position-relative"],[1,"flex-shrink-0","position-relative"],[1,"rounded-circle","d-flex","align-items-center","justify-content-center","border","border-2","border-white","shadow-sm",2,"width","32px","height","32px"],[1,"bi","text-white","fs-8"],[1,"card","border-0","bg-light"],[1,"d-flex","justify-content-between","align-items-start","mb-1"],[1,"badge","bg-primary","mt-2","fs-8"],[1,"bi","bi-clock-history","text-muted","mb-3",2,"font-size","2.5rem"],[1,"text-muted","fs-7"],[1,"bi","bi-gear","me-1","text-primary"],[1,"col-12","col-md-6"],[1,"table-responsive"],[1,"table","table-sm","border-0"],[1,"text-muted","border-0","ps-0","fs-8"],[1,"border-0","pe-0","fw-normal","fs-7"],[1,"border-0","pe-0"],[1,"fs-8","px-1","rounded"],[1,"p-2","bg-light","rounded"],[1,"card-header","bg-primary","text-white","py-2"],[1,"mb-0","fw-normal","fs-7","d-flex","align-items-center"],[1,"d-flex","flex-wrap","gap-2"],["type","button",1,"btn","btn-sm","px-2",3,"class","disabled"],["type","button",1,"btn","btn-sm","px-2",3,"click","disabled"],[1,"bi","me-1",3,"class"],[1,"bi","me-1"],[1,"text-center"],[1,"bi","bi-exclamation-triangle","text-warning","mb-3",2,"font-size","2.5rem"],[1,"text-muted","fs-8","mb-3"],[1,"btn","btn-primary","btn-sm","px-2",3,"click"]],template:function(e,l){e&1&&(i(0,"div",1),m(1,le,28,0,"div",2)(2,ce,4,1,"div",3),m(3,de,4,1,"div",4),m(4,je,60,13)(5,Ke,11,0,"div",5),n()),e&2&&(o(),p(l.loading()?1:l.error()?2:-1),o(2),p(l.success()?3:-1),o(),p(l.registration()?4:l.loading()?-1:5))},dependencies:[Y,Z,q],encapsulation:2,changeDetection:0})};export{oe as RegistrationDetailComponent};
