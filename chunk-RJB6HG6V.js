import{b as Se}from"./chunk-663N75WB.js";import{b as oe,c as le,d as c,e as de,f as se,g as K,h as u,j as me,k as ue,m as ce,n as pe,o as ve,p as ge,q as Ce,s as fe,t as he,u as ye,w as be,x as _e}from"./chunk-XPHFKPJP.js";import{a as Ee}from"./chunk-GY3IPELX.js";import"./chunk-MPC7SZEK.js";import{a as _,c as ae}from"./chunk-TVASKIN6.js";import{b as ie,c as re}from"./chunk-EDRQHDMA.js";import{h as ee,i as te,l as ne}from"./chunk-PZ46FPEX.js";import{$a as Q,Ac as X,Cc as Z,D as G,Da as l,Db as C,Gb as r,H,Hb as $,Na as J,Vb as z,Wb as W,_ as x,ac as k,bb as v,cb as g,cc as f,da as F,ea as T,fb as j,fc as V,gb as U,gc as L,hb as b,ia as Y,ib as n,jb as i,kb as s,ma as S,o as R,rb as N,sb as D,ub as y}from"./chunk-DCXCOY7M.js";import"./chunk-LJ5XHLMQ.js";import{a as B,h as O}from"./chunk-FK42CRUA.js";var Fe=(a,e)=>e.key;function Te(a,e){a&1&&(n(0,"div",1)(1,"div",2),s(2,"div",3),n(3,"p",4),r(4,"Cargando tipos de evento..."),i()()())}function De(a,e){a&1&&r(0," El t\xEDtulo es requerido ")}function ke(a,e){a&1&&r(0," El t\xEDtulo debe tener al menos 5 caracteres ")}function we(a,e){if(a&1&&(n(0,"div",41),v(1,De,1,0),v(2,ke,1,0),i()),a&2){let t,o,d=y(3);l(),g(!((t=d.quickForm.get("title"))==null||t.errors==null)&&t.errors.required?1:-1),l(),g(!((o=d.quickForm.get("title"))==null||o.errors==null)&&o.errors.minlength?2:-1)}}function qe(a,e){if(a&1&&(n(0,"option",58),r(1),i()),a&2){let t=e.$implicit;b("value",t.key),l(),$(t.value.name)}}function Me(a,e){a&1&&(j(0,qe,2,2,"option",58,Fe),z(2,"keyvalue")),a&2&&U(W(2,0,e))}function Ie(a,e){a&1&&(n(0,"div",41),r(1,"Seleccione un tipo de evento"),i())}function Pe(a,e){a&1&&(s(0,"i",27),n(1,"span",16),r(2,"Crear R\xE1pido"),i())}function Ae(a,e){a&1&&(s(0,"span",59),n(1,"span",16),r(2,"Guardando..."),i())}function Ne(a,e){if(a&1){let t=N();n(0,"form",31),D("ngSubmit",function(){F(t);let d=y(2);return T(d.onQuickSubmit())}),n(1,"div",32)(2,"div",33)(3,"div",34)(4,"div",19)(5,"h6",35),s(6,"i",36),r(7," Informaci\xF3n B\xE1sica "),i()(),n(8,"div",37)(9,"div",38)(10,"label",39),r(11,"T\xEDtulo del evento"),i(),s(12,"input",40),v(13,we,3,2,"div",41),i(),n(14,"div",38)(15,"label",39),r(16,"Tipo de evento"),i(),n(17,"select",42)(18,"option",43),r(19,"Seleccione un tipo..."),i(),v(20,Me,3,2),i(),v(21,Ie,2,0,"div",41),i(),n(22,"div",44)(23,"label",39),r(24,"Descripci\xF3n (opcional)"),i(),s(25,"textarea",45),n(26,"div",46),r(27,"Esta informaci\xF3n puede completarse posteriormente."),i()()()()(),n(28,"div",47)(29,"div",48)(30,"div",49)(31,"h6",50),s(32,"i",51),r(33," Informaci\xF3n "),i()(),n(34,"div",37)(35,"p",52),r(36,"Crea un evento con valores por defecto. Podr\xE1s completarlo despu\xE9s."),i(),n(37,"ul",53)(38,"li"),r(39,"Estado inicial: borrador"),i(),n(40,"li"),r(41,"Visibilidad: p\xFAblica"),i(),n(42,"li"),r(43,"Moneda: PEN (Soles Peruanos)"),i(),n(44,"li"),r(45,"Fechas y ubicaci\xF3n se configuran despu\xE9s"),i()()()(),n(46,"div",54)(47,"button",55),v(48,Pe,3,0)(49,Ae,3,0),i(),n(50,"a",56),s(51,"i",57),n(52,"span",16),r(53,"Cancelar"),i()()()()()()}if(a&2){let t,o,d,h,E,p=y(2);b("formGroup",p.quickForm),l(12),C("is-invalid",((t=p.quickForm.get("title"))==null?null:t.invalid)&&((t=p.quickForm.get("title"))==null?null:t.touched)),l(),g((o=p.quickForm.get("title"))!=null&&o.errors&&((o=p.quickForm.get("title"))!=null&&o.touched)?13:-1),l(4),C("is-invalid",((d=p.quickForm.get("eventTypeId"))==null?null:d.invalid)&&((d=p.quickForm.get("eventTypeId"))==null?null:d.touched)),l(3),g((h=p.eventTypesMap())?20:-1,h),l(),g((E=p.quickForm.get("eventTypeId"))!=null&&E.errors&&((E=p.quickForm.get("eventTypeId"))!=null&&E.touched)?21:-1),l(26),b("disabled",p.isSubmitting()||p.quickForm.invalid),l(),g(p.isSubmitting()?49:48),l(2),C("disabled",p.isSubmitting())}}function Ve(a,e){a&1&&r(0," El t\xEDtulo es requerido ")}function Le(a,e){a&1&&r(0," El t\xEDtulo debe tener al menos 5 caracteres ")}function Be(a,e){if(a&1&&(n(0,"div",41),v(1,Ve,1,0),v(2,Le,1,0),i()),a&2){let t,o,d=y(3);l(),g(!((t=d.advancedForm.get("title"))==null||t.errors==null)&&t.errors.required?1:-1),l(),g(!((o=d.advancedForm.get("title"))==null||o.errors==null)&&o.errors.minlength?2:-1)}}function Oe(a,e){if(a&1&&(n(0,"option",58),r(1),i()),a&2){let t=e.$implicit;b("value",t.key),l(),$(t.value.name)}}function Re(a,e){a&1&&(j(0,Oe,2,2,"option",58,Fe),z(2,"keyvalue")),a&2&&U(W(2,0,e))}function Ge(a,e){a&1&&(n(0,"div",41),r(1,"Seleccione un tipo de evento"),i())}function He(a,e){a&1&&(n(0,"div",41),r(1,"Fecha de inicio requerida"),i())}function Qe(a,e){a&1&&(n(0,"div",41),r(1,"Fecha de fin requerida"),i())}function je(a,e){a&1&&(n(0,"div",41),r(1,"Seleccione la modalidad"),i())}function Ue(a,e){a&1&&(s(0,"i",90),n(1,"span",16),r(2,"Crear Evento"),i())}function $e(a,e){a&1&&(s(0,"span",59),n(1,"span",16),r(2,"Guardando..."),i())}function ze(a,e){if(a&1){let t=N();n(0,"form",60),D("ngSubmit",function(){F(t);let d=y(2);return T(d.onAdvancedSubmit())}),n(1,"div",32)(2,"div",33)(3,"div",34)(4,"div",19)(5,"h6",35),s(6,"i",61),r(7," Informaci\xF3n Completa del Evento "),i()(),n(8,"div",37)(9,"div",38)(10,"label",39),r(11,"T\xEDtulo del evento"),i(),s(12,"input",40),v(13,Be,3,2,"div",41),i(),n(14,"div",38)(15,"label",39),r(16,"Descripci\xF3n corta"),i(),s(17,"input",62),n(18,"div",46),r(19,"M\xE1ximo 160 caracteres para vista previa"),i()(),n(20,"div",38)(21,"label",39),r(22,"Descripci\xF3n completa"),i(),s(23,"textarea",63),i(),n(24,"div",64)(25,"div",65)(26,"label",39),r(27,"Tipo de evento"),i(),n(28,"select",42)(29,"option",43),r(30,"Seleccione un tipo..."),i(),v(31,Re,3,2),i(),v(32,Ge,2,0,"div",41),i(),n(33,"div",66)(34,"label",39),r(35,"Fecha inicio"),i(),s(36,"input",67),v(37,He,2,0,"div",41),i(),n(38,"div",66)(39,"label",39),r(40,"Fecha fin"),i(),s(41,"input",68),v(42,Qe,2,0,"div",41),i()(),n(43,"div",69)(44,"div",70)(45,"label",39),r(46,"Modalidad"),i(),n(47,"select",71)(48,"option",43),r(49,"Seleccione modalidad..."),i(),n(50,"option",72),r(51,"Presencial"),i(),n(52,"option",73),r(53,"Virtual"),i(),n(54,"option",74),r(55,"H\xEDbrido"),i()(),v(56,je,2,0,"div",41),i(),n(57,"div",75)(58,"label",39),r(59,"Aforo m\xE1ximo"),i(),s(60,"input",76),n(61,"div",46),r(62,"Opcional"),i()(),n(63,"div",75)(64,"label",39),r(65,"Costo (PEN)"),i(),s(66,"input",77),n(67,"div",46),r(68,"0 = Gratuito - Moneda: Soles Peruanos"),i()()()()()(),n(69,"div",47)(70,"div",48)(71,"div",19)(72,"h6",35),s(73,"i",78),r(74," Configuraci\xF3n del Evento "),i()(),n(75,"div",37)(76,"div",79),s(77,"input",80),n(78,"label",81),s(79,"i",82),r(80," Evento p\xFAblico "),i(),n(81,"div",46),r(82,"Visible para todos los usuarios"),i()(),n(83,"div",79),s(84,"input",83),n(85,"label",84),s(86,"i",85),r(87," Requiere aprobaci\xF3n "),i(),n(88,"div",46),r(89,"Las inscripciones deben ser aprobadas"),i()(),n(90,"div",86),s(91,"input",87),n(92,"label",88),s(93,"i",89),r(94," Emite certificado "),i(),n(95,"div",46),r(96,"Genera certificados autom\xE1ticamente"),i()()()(),n(97,"div",54)(98,"button",55),v(99,Ue,3,0)(100,$e,3,0),i(),n(101,"a",56),s(102,"i",57),n(103,"span",16),r(104,"Cancelar"),i()()()()()()}if(a&2){let t,o,d,h,E,p,w,q,M,I,P,A,m=y(2);b("formGroup",m.advancedForm),l(12),C("is-invalid",((t=m.advancedForm.get("title"))==null?null:t.invalid)&&((t=m.advancedForm.get("title"))==null?null:t.touched)),l(),g((o=m.advancedForm.get("title"))!=null&&o.errors&&((o=m.advancedForm.get("title"))!=null&&o.touched)?13:-1),l(4),C("is-invalid",((d=m.advancedForm.get("shortDescription"))==null?null:d.invalid)&&((d=m.advancedForm.get("shortDescription"))==null?null:d.touched)),l(11),C("is-invalid",((h=m.advancedForm.get("eventTypeId"))==null?null:h.invalid)&&((h=m.advancedForm.get("eventTypeId"))==null?null:h.touched)),l(3),g((E=m.eventTypesMap())?31:-1,E),l(),g((p=m.advancedForm.get("eventTypeId"))!=null&&p.errors&&((p=m.advancedForm.get("eventTypeId"))!=null&&p.touched)?32:-1),l(4),C("is-invalid",((w=m.advancedForm.get("startDate"))==null?null:w.invalid)&&((w=m.advancedForm.get("startDate"))==null?null:w.touched)),l(),g((q=m.advancedForm.get("startDate"))!=null&&q.errors&&((q=m.advancedForm.get("startDate"))!=null&&q.touched)?37:-1),l(4),C("is-invalid",((M=m.advancedForm.get("endDate"))==null?null:M.invalid)&&((M=m.advancedForm.get("endDate"))==null?null:M.touched)),l(),g((I=m.advancedForm.get("endDate"))!=null&&I.errors&&((I=m.advancedForm.get("endDate"))!=null&&I.touched)?42:-1),l(5),C("is-invalid",((P=m.advancedForm.get("locationType"))==null?null:P.invalid)&&((P=m.advancedForm.get("locationType"))==null?null:P.touched)),l(9),g((A=m.advancedForm.get("locationType"))!=null&&A.errors&&((A=m.advancedForm.get("locationType"))!=null&&A.touched)?56:-1),l(42),b("disabled",m.isSubmitting()||m.advancedForm.invalid),l(),g(m.isSubmitting()?100:99),l(2),C("disabled",m.isSubmitting())}}function We(a,e){if(a&1){let t=N();n(0,"nav",5)(1,"ol",6)(2,"li",7)(3,"a",8),s(4,"i",9),n(5,"span",10),r(6,"Inicio"),i()()(),n(7,"li",7)(8,"a",11),r(9,"Eventos"),i()(),n(10,"li",12),r(11,"Crear evento"),i()()(),n(12,"div",13)(13,"div")(14,"h1",14),s(15,"i",15),n(16,"span",16),r(17,"Nuevo Evento"),i()(),n(18,"p",17),r(19,"Crear un nuevo evento acad\xE9mico o corporativo"),i()()(),n(20,"div",18)(21,"div",19)(22,"div",20),s(23,"i",21),n(24,"h6",22),r(25,"Modo de Creaci\xF3n"),i()()(),n(26,"div",23)(27,"ul",24)(28,"li",25)(29,"button",26),D("click",function(){F(t);let d=y();return T(d.setMode("quick"))}),s(30,"i",27),n(31,"span",16),r(32,"Crear R\xE1pido"),i()()(),n(33,"li",25)(34,"button",26),D("click",function(){F(t);let d=y();return T(d.setMode("advanced"))}),s(35,"i",28),n(36,"span",16),r(37,"Crear Avanzado"),i()()()()()(),v(38,Ne,54,12,"form",29),v(39,ze,105,23,"form",30)}if(a&2){let t=y();l(29),C("active",t.mode()==="quick"),b("disabled",t.isSubmitting()),Q("aria-selected",t.mode()==="quick"),l(5),C("active",t.mode()==="advanced"),b("disabled",t.isSubmitting()),Q("aria-selected",t.mode()==="advanced"),l(4),g(t.mode()==="quick"?38:-1),l(),g(t.mode()==="advanced"?39:-1)}}var xe=class a{router=x(ee);destroyRef=x(Y);eventService=x(Se);staticDataService=x(Ee);initialMode=L("quick");showAdvancedInitially=L(!1);initialEventType=L();eventCreated=V();creationCancelled=V();modeChanged=V();LocationType=re;EventStatus=ie;maxTitleLength=150;maxDescriptionLength=1e3;maxShortDescriptionLength=300;maxParticipants=65e3;maxCost=999999;maxDurationHours=999;defaultCurrency="PEN";defaultMinAttendance=80;creationMode=S("quick");formStatus=S("idle");currentStep=S(1);totalSteps=S(3);eventTypesMap=ae(this.staticDataService.eventTypes$,{initialValue:{}});isLoadingEventTypes=k(()=>{let e=this.eventTypesMap();return!e||Object.keys(e).length===0});availableEventTypes=S([]);quickForm=new K({title:new u(null,[c.required,c.minLength(5),c.maxLength(this.maxTitleLength)]),eventTypeId:new u("",[c.required]),description:new u(null,[c.maxLength(this.maxDescriptionLength)])});advancedForm=new K({title:new u(null,[c.required,c.minLength(5),c.maxLength(this.maxTitleLength)]),shortDescription:new u(null,[c.maxLength(this.maxShortDescriptionLength)]),description:new u(null,[c.maxLength(this.maxDescriptionLength)]),eventTypeId:new u("",[c.required]),startDate:new u(null,[c.required]),endDate:new u(null,[c.required]),registrationStart:new u(null),registrationEnd:new u(null),locationType:new u("",[c.required]),venueName:new u(null),venueAddress:new u(null),venueCity:new u(null),maxParticipants:new u(null,[c.min(1),c.max(this.maxParticipants)]),cost:new u(0,[c.min(0),c.max(this.maxCost)]),currency:new u(this.defaultCurrency),earlyBirdCost:new u(null,[c.min(0),c.max(this.maxCost)]),earlyBirdDeadline:new u(null),durationHours:new u(null,[c.min(.5),c.max(this.maxDurationHours)]),minimumAttendancePercentage:new u(this.defaultMinAttendance,[c.min(0),c.max(100)]),isPublic:new u(!0),requiresApproval:new u(!1),requiresCertificate:new u(!0),tags:new u(null),keywords:new u(null)});creationState=S({mode:"quick",isSubmitting:!1,hasUnsavedChanges:!1});eventTypesOptions=f(()=>{let e=this.eventTypesMap();return!e||Object.keys(e).length===0?[]:Object.entries(e).map(([t,o])=>({id:parseInt(t),name:o.name,description:o.description||""}))});isQuickMode=f(()=>this.creationMode()==="quick");isAdvancedMode=f(()=>this.creationMode()==="advanced");isSubmitting=f(()=>this.formStatus()==="submitting");hasError=f(()=>this.formStatus()==="error");isSuccess=f(()=>this.formStatus()==="success");currentForm=f(()=>this.isQuickMode()?this.quickForm:this.advancedForm);isFormValid=f(()=>this.currentForm().valid);isFormDirty=f(()=>this.currentForm().dirty);hasUnsavedChanges=f(()=>this.isFormDirty()&&!this.isSuccess());canSubmit=f(()=>this.isFormValid()&&!this.isSubmitting());progressPercentage=f(()=>{let e=this.currentStep(),t=this.totalSteps();return Math.round(e/t*100)});trackByEventTypeId=(e,t)=>t.id;trackByLocationTypeId=(e,t)=>t.value||t;eventTypeCache=new Map;ngOnInit(){this.initializeFromInputs(),this.loadInitialData(),this.setupFormSubscriptions(),this.setupValidationWatchers()}initializeFromInputs(){let e=this.initialMode();e&&this.creationMode.set(e);let t=this.initialEventType();t&&(this.quickForm.patchValue({eventTypeId:t}),this.advancedForm.patchValue({eventTypeId:t})),this.showAdvancedInitially()&&this.creationMode.set("advanced")}loadInitialData(){this.staticDataService.eventTypes$.pipe(_(this.destroyRef)).subscribe({next:e=>{if(e){let t=Object.entries(e).map(([o,d])=>({id:parseInt(o),name:d.name,description:d.description||""}));this.availableEventTypes.set(t),this.preloadEventTypesCache()}},error:e=>console.error("Error loading event types:",e)})}setupFormSubscriptions(){this.quickForm.valueChanges.pipe(G(300),H(),_(this.destroyRef)).subscribe(()=>{this.updateCreationState({hasUnsavedChanges:this.quickForm.dirty})}),this.advancedForm.valueChanges.pipe(G(300),H(),_(this.destroyRef)).subscribe(()=>{this.updateCreationState({hasUnsavedChanges:this.advancedForm.dirty})})}setupValidationWatchers(){this.advancedForm.get("startDate")?.valueChanges.pipe(_(this.destroyRef)).subscribe(()=>{this.validateDateRange()}),this.advancedForm.get("endDate")?.valueChanges.pipe(_(this.destroyRef)).subscribe(()=>{this.validateDateRange()}),this.advancedForm.get("cost")?.valueChanges.pipe(_(this.destroyRef)).subscribe(()=>{this.validateEarlyBirdCost()}),this.advancedForm.get("earlyBirdCost")?.valueChanges.pipe(_(this.destroyRef)).subscribe(()=>{this.validateEarlyBirdCost()})}updateCreationState(e){this.creationState.update(t=>B(B({},t),e))}ngOnDestroy(){this.clearCaches()}clearCaches(){this.eventTypeCache.clear()}preloadEventTypesCache(){this.eventTypesOptions().forEach(e=>{this.eventTypeCache.set(e.id,e)})}validateDateRange(){let e=this.advancedForm.get("startDate")?.value,t=this.advancedForm.get("endDate")?.value;if(e&&t){let o=new Date(e),d=new Date(t);if(o>=d)this.advancedForm.get("endDate")?.setErrors({dateRange:!0});else{let h=this.advancedForm.get("endDate");h?.errors?.dateRange&&(delete h.errors.dateRange,Object.keys(h.errors).length===0&&h.setErrors(null))}}}validateEarlyBirdCost(){let e=this.advancedForm.get("cost")?.value,t=this.advancedForm.get("earlyBirdCost")?.value;if(e!=null&&t!=null&&t>=e)this.advancedForm.get("earlyBirdCost")?.setErrors({earlyBirdTooHigh:!0});else{let o=this.advancedForm.get("earlyBirdCost");o?.errors?.earlyBirdTooHigh&&(delete o.errors.earlyBirdTooHigh,Object.keys(o.errors).length===0&&o.setErrors(null))}}setMode(e){this.creationMode.set(e),this.modeChanged.emit(e),this.updateCreationState({mode:e})}resetForm(){this.isQuickMode()?this.quickForm.reset({title:null,eventTypeId:"",description:null}):this.advancedForm.reset({title:null,shortDescription:null,description:null,eventTypeId:"",startDate:null,endDate:null,registrationStart:null,registrationEnd:null,locationType:"",venueName:null,venueAddress:null,venueCity:null,maxParticipants:null,cost:0,currency:this.defaultCurrency,earlyBirdCost:null,earlyBirdDeadline:null,durationHours:null,minimumAttendancePercentage:this.defaultMinAttendance,isPublic:!0,requiresApproval:!1,requiresCertificate:!0,tags:null,keywords:null}),this.formStatus.set("idle"),this.updateCreationState({hasUnsavedChanges:!1})}cancelCreation(){this.hasUnsavedChanges()&&!confirm("\xBFEst\xE1s seguro de que quieres cancelar? Se perder\xE1n los cambios no guardados.")||(this.creationCancelled.emit(),this.router.navigate(["/eventos"]))}onQuickSubmit(){return O(this,null,function*(){if(!(!this.quickForm.valid||this.isSubmitting())){this.formStatus.set("submitting"),this.updateCreationState({isSubmitting:!0});try{let e=this.quickForm.value,t={title:e.title?.trim(),description:e.description||void 0,eventTypeId:this.parseEventTypeId(e.eventTypeId),currency:this.defaultCurrency,cost:0,isPublic:!0,requiresCertificate:!0,minimumAttendancePercentage:this.defaultMinAttendance},o=yield R(this.eventService.createQuickEvent(t));this.formStatus.set("success"),this.eventCreated.emit(o),this.router.navigate(["/eventos",o.id,"editar"])}catch(e){console.error("Error creating quick event:",e),this.formStatus.set("error"),this.handleSubmissionError(e)}finally{this.updateCreationState({isSubmitting:!1})}}})}onAdvancedSubmit(){return O(this,null,function*(){if(!(!this.advancedForm.valid||this.isSubmitting())){this.formStatus.set("submitting"),this.updateCreationState({isSubmitting:!0});try{let e=this.advancedForm.value,t={title:e.title?.trim(),shortDescription:e.shortDescription||void 0,description:e.description||void 0,eventTypeId:this.parseEventTypeId(e.eventTypeId),startDate:e.startDate?this.toISOString(e.startDate):void 0,endDate:e.endDate?this.toISOString(e.endDate):void 0,registrationStart:e.registrationStart?this.toISOString(e.registrationStart):void 0,registrationEnd:e.registrationEnd?this.toISOString(e.registrationEnd):void 0,locationType:e.locationType,venueName:e.venueName||void 0,venueAddress:e.venueAddress||void 0,venueCity:e.venueCity||void 0,maxParticipants:e.maxParticipants||void 0,cost:e.cost||0,currency:e.currency||this.defaultCurrency,earlyBirdCost:e.earlyBirdCost||void 0,earlyBirdDeadline:e.earlyBirdDeadline?this.toISOString(e.earlyBirdDeadline):void 0,durationHours:e.durationHours||void 0,minimumAttendancePercentage:e.minimumAttendancePercentage||this.defaultMinAttendance,isPublic:e.isPublic??!0,requiresApproval:e.requiresApproval??!1,requiresCertificate:e.requiresCertificate??!0,tags:e.tags?e.tags.split(",").map(d=>d.trim()).filter(d=>d):void 0,keywords:e.keywords||void 0},o=yield R(this.eventService.createEvent(t));this.formStatus.set("success"),this.eventCreated.emit(o),this.router.navigate(["/eventos",o.id])}catch(e){console.error("Error creating advanced event:",e),this.formStatus.set("error"),this.handleSubmissionError(e)}finally{this.updateCreationState({isSubmitting:!1})}}})}parseEventTypeId(e){if(e===null||e===""||e===void 0)return;let t=typeof e=="string"?parseInt(e):e;return isNaN(t)?void 0:t}toISOString(e){return e?(e.includes("T")?new Date(e):new Date(e+"T00:00:00")).toISOString():""}handleSubmissionError(e){let t="Error al crear el evento";e.status===400?t="Datos de evento inv\xE1lidos. Verifica la informaci\xF3n ingresada.":e.status===401||e.status===403?t="No tienes permisos para crear eventos.":e.status>=500?t="Error del servidor. Intenta nuevamente en unos momentos.":e.status===0&&(t="Error de conexi\xF3n. Verifica tu conexi\xF3n a internet."),alert(t)}isFieldInvalid(e){if(this.isQuickMode()){let t=this.quickForm.get(e);return!!(t&&t.invalid&&(t.dirty||t.touched))}else{let t=this.advancedForm.get(e);return!!(t&&t.invalid&&(t.dirty||t.touched))}}getFieldError(e){let t;if(this.isQuickMode()?t=this.quickForm.get(e):t=this.advancedForm.get(e),!t||!t.errors||!t.touched)return null;let o=t.errors;return o.required?"Este campo es obligatorio":o.minlength?`M\xEDnimo ${o.minlength.requiredLength} caracteres`:o.maxlength?`M\xE1ximo ${o.maxlength.requiredLength} caracteres`:o.min?`Valor m\xEDnimo: ${o.min.min}`:o.max?`Valor m\xE1ximo: ${o.max.max}`:o.dateRange?"La fecha de fin debe ser posterior a la de inicio":o.earlyBirdTooHigh?"El precio promocional debe ser menor al precio regular":"Campo inv\xE1lido"}getEventTypeName(e){let t=this.eventTypeCache.get(e);if(t)return t.name;let o=this.eventTypesOptions().find(d=>d.id===e);return o?(this.eventTypeCache.set(e,o),o.name):"Tipo desconocido"}formatCurrency(e){try{return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}catch{return`S/${e.toLocaleString()}`}}mode=k(()=>this.creationMode());eventTypes=k(()=>this.eventTypesOptions());isFormSubmitting=k(()=>this.isSubmitting());setMode_legacy(e){this.setMode(e)}invalid(e){return this.isFieldInvalid(e)}quickInvalid(e){return this.isFieldInvalid(e)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=J({type:a,selectors:[["app-event-create"]],inputs:{initialMode:[1,"initialMode"],showAdvancedInitially:[1,"showAdvancedInitially"],initialEventType:[1,"initialEventType"]},outputs:{eventCreated:"eventCreated",creationCancelled:"creationCancelled",modeChanged:"modeChanged"},decls:3,vars:1,consts:[[1,"container-fluid","py-3"],[1,"d-flex","justify-content-center","py-5"],[1,"text-center"],["role","status","aria-hidden","true",1,"spinner-border","text-primary","mb-3"],[1,"text-muted","small","mb-0"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb","mb-0","small"],[1,"breadcrumb-item"],["routerLink","/",1,"text-decoration-none","link-primary"],[1,"bi","bi-house-door","me-1"],[1,"d-none","d-sm-inline"],["routerLink","/eventos",1,"text-decoration-none","link-primary"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","justify-content-between","gap-2","mb-4"],[1,"h6","mb-1","fw-normal","d-flex","align-items-center"],[1,"bi","bi-plus-circle","me-2","text-primary"],[1,"small"],[1,"text-muted","fs-8","mb-0"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-light","border-0","py-2"],[1,"d-flex","align-items-center","gap-2"],[1,"bi","bi-toggles","text-primary"],[1,"mb-0","fw-normal","small"],[1,"card-body","py-2"],["role","tablist","aria-label","Modo de creaci\xF3n",1,"nav","nav-pills","nav-fill","small"],["role","presentation",1,"nav-item"],["type","button",1,"nav-link","btn-sm",3,"click","disabled"],[1,"bi","bi-lightning-charge","me-1"],[1,"bi","bi-gear","me-1"],["novalidate","","aria-label","Formulario de creaci\xF3n r\xE1pida de evento",1,"needs-validation",3,"formGroup"],["novalidate","","aria-label","Formulario de creaci\xF3n avanzada de evento",1,"needs-validation",3,"formGroup"],["novalidate","","aria-label","Formulario de creaci\xF3n r\xE1pida de evento",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-12","col-lg-8"],[1,"card","border-0","shadow-sm"],[1,"mb-0","fw-normal","small","d-flex","align-items-center"],[1,"bi","bi-lightning-charge","me-1","text-warning"],[1,"card-body","py-3"],[1,"mb-3"],[1,"form-label","fw-normal","small","mb-1"],["type","text","formControlName","title","required","","placeholder","Ingrese el t\xEDtulo del evento...",1,"form-control","form-control-sm"],[1,"invalid-feedback","fs-8"],["formControlName","eventTypeId","required","",1,"form-select","form-select-sm"],["value",""],[1,"mb-0"],["rows","3","formControlName","description","placeholder","Descripci\xF3n del evento...",1,"form-control","form-control-sm"],[1,"form-text","fs-8"],[1,"col-12","col-lg-4"],[1,"card","border-0","shadow-sm","mb-3"],[1,"card-header","bg-info","bg-opacity-10","border-0","py-2"],[1,"mb-0","fw-normal","small","d-flex","align-items-center","text-info"],[1,"bi","bi-info-circle","me-1"],[1,"mb-2","fs-8","text-muted"],[1,"fs-8","text-muted","mb-0","ps-3"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled"],["routerLink","/eventos",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-x","me-1"],[3,"value"],["aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],["novalidate","","aria-label","Formulario de creaci\xF3n avanzada de evento",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"bi","bi-gear","me-1","text-primary"],["type","text","formControlName","shortDescription","maxlength","160","placeholder","Resumen breve del evento...",1,"form-control","form-control-sm"],["rows","4","formControlName","description","placeholder","Descripci\xF3n detallada del evento...",1,"form-control","form-control-sm"],[1,"row","g-2"],[1,"col-12","col-md-6"],[1,"col-6","col-md-3"],["type","date","formControlName","startDate","required","",1,"form-control","form-control-sm"],["type","date","formControlName","endDate","required","",1,"form-control","form-control-sm"],[1,"row","g-2","mt-2"],[1,"col-12","col-md-4"],["formControlName","locationType","required","",1,"form-select","form-select-sm"],["value","PRESENCIAL"],["value","VIRTUAL"],["value","HIBRIDO"],[1,"col-6","col-md-4"],["type","number","min","1","formControlName","maxParticipants","placeholder","Ej: 50",1,"form-control","form-control-sm"],["type","number","min","0","step","0.01","formControlName","cost","placeholder","0.00",1,"form-control","form-control-sm"],[1,"bi","bi-toggles","me-1","text-primary"],[1,"form-check","form-switch","mb-3"],["type","checkbox","id","isPublic","formControlName","isPublic",1,"form-check-input"],["for","isPublic",1,"form-check-label","fw-normal","small"],[1,"bi","bi-globe","me-1","text-info"],["type","checkbox","id","requiresApproval","formControlName","requiresApproval",1,"form-check-input"],["for","requiresApproval",1,"form-check-label","fw-normal","small"],[1,"bi","bi-check-circle","me-1","text-warning"],[1,"form-check","form-switch","mb-0"],["type","checkbox","id","requiresCertificate","formControlName","requiresCertificate",1,"form-check-input"],["for","requiresCertificate",1,"form-check-label","fw-normal","small"],[1,"bi","bi-award","me-1","text-success"],[1,"bi","bi-plus-circle","me-1"]],template:function(t,o){t&1&&(n(0,"div",0),v(1,Te,5,0,"div",1)(2,We,40,10),i()),t&2&&(l(),g(o.isLoadingEventTypes()?1:2))},dependencies:[Z,ne,te,_e,me,ge,Ce,le,ue,oe,ve,de,se,he,ye,fe,ce,pe,be,X],encapsulation:2,changeDetection:0})};export{xe as EventCreateComponent};
