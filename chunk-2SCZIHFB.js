import{a as Ee}from"./chunk-6ASH2DRA.js";import"./chunk-VF5TSERA.js";import"./chunk-YUNYRAF7.js";import"./chunk-FK6H3RFT.js";import{a as ye}from"./chunk-D3K6LS6Y.js";import{b as we}from"./chunk-G3PFGXX7.js";import{b as Se}from"./chunk-Q3GSZX6T.js";import{a as _e}from"./chunk-NNXQY67D.js";import{a as xe}from"./chunk-CXKTJJ36.js";import{c as ae,e as oe,f as le,g as se,h as x,j as ce,l as de,m as me,n as ue,o as pe,p as fe,q as ge,w as Ce,x as he}from"./chunk-AUZY6O5Y.js";import{b as be}from"./chunk-P2TS72RO.js";import{a as ve}from"./chunk-IWJALEKK.js";import"./chunk-MPC7SZEK.js";import{a as P}from"./chunk-G3MWZKLR.js";import{f as re,k as A}from"./chunk-2UJ2GV6T.js";import{h as te,i as ie,l as ne}from"./chunk-GBIZ2ZL5.js";import{$a as q,Ab as X,Bb as K,Cc as ee,D as $,Da as s,Db as D,Fb as T,Gb as l,H as G,Hb as b,Ib as E,Na as Q,Rb as U,Vb as M,Xb as k,_ as w,ab as B,ac as S,bb as C,cb as h,cc as V,da as u,dc as J,ea as p,eb as z,fb as I,fc as L,gb as F,gc as N,hb as g,hc as Y,ia as H,ib as n,jb as r,kb as d,ma as v,o as O,rb as _,sb as f,ub as m,zb as W,zc as Z}from"./chunk-DWRMJDZW.js";import"./chunk-LJ5XHLMQ.js";import{a as j,h as R}from"./chunk-FK42CRUA.js";var Ve=["confirmModal"],Fe=()=>[1,2,3,4,5,6,7,8],Re=(o,e)=>e.value;function De(o,e){if(o&1&&(n(0,"span",16),l(1),r()),o&2){let t=m();s(),b(t.totalItems())}}function Me(o,e){o&1&&d(0,"span",20)}function ke(o,e){o&1&&d(0,"i",21)}function Le(o,e){if(o&1){let t=_();n(0,"li")(1,"button",63),f("click",function(){u(t);let a=m(2);return p(a.exportSelectedToCSV())}),d(2,"i",65),n(3,"span",15),l(4),r()()()}if(o&2){let t=m(2);s(4),E("Solo seleccionados (",t.selectedCertificates().length,")")}}function Pe(o,e){if(o&1){let t=_();n(0,"div",25)(1,"button",60),d(2,"i",61),n(3,"span",22),l(4,"Exportar"),r()(),n(5,"ul",62)(6,"li")(7,"button",63),f("click",function(){u(t);let a=m();return p(a.exportToCSV())}),d(8,"i",64),n(9,"span",15),l(10,"Todos los certificados"),r()()(),C(11,Le,5,1,"li"),r()()}if(o&2){let t=m();s(11),h(t.selectedCertificates().length>0?11:-1)}}function Ne(o,e){if(o&1&&(n(0,"span",33),l(1),r()),o&2){let t=m();s(),b(t.activeFiltersCount())}}function Ae(o,e){if(o&1){let t=_();n(0,"button",66),f("click",function(){u(t);let a=m();return p(a.clearAllFilters())}),d(1,"i",67),r()}}function ze(o,e){if(o&1){let t=_();n(0,"button",93),f("click",function(){u(t),m();let a=K(10);return m().clearSearch(),p(a.focus())}),d(1,"i",94),r()}}function Oe(o,e){if(o&1&&(n(0,"option",46),l(1),r()),o&2){let t=e.$implicit;g("value",t.value),s(),b(t.label)}}function Be(o,e){if(o&1){let t=_();n(0,"div",38)(1,"form",68)(2,"div",69)(3,"div",70)(4,"label",71),l(5,"Buscar por texto"),r(),n(6,"div",72)(7,"span",73),d(8,"i",74),r(),d(9,"input",75,1),C(11,ze,2,0,"button",76),r()(),n(12,"div",77)(13,"label",71),l(14,"Evento"),r(),n(15,"div",72)(16,"span",78),d(17,"i",79),r(),n(18,"app-autocomplete",80),f("valueChange",function(a){u(t);let c=m();return p(c.onEventSelected(a))}),r()()(),n(19,"div",77)(20,"label",71),l(21,"Participante"),r(),n(22,"div",72)(23,"span",81),d(24,"i",82),r(),n(25,"app-autocomplete",83),f("valueChange",function(a){u(t);let c=m();return p(c.onUserSelected(a))}),r()()(),n(26,"div",77)(27,"label",71),l(28,"Rol del participante"),r(),n(29,"div",72)(30,"span",84),d(31,"i",85),r(),n(32,"app-autocomplete",80),f("valueChange",function(a){u(t);let c=m();return p(c.onRoleSelected(a))}),r()()(),n(33,"div",70)(34,"label",71),l(35,"Plantilla"),r(),n(36,"div",72)(37,"span",86),d(38,"i",87),r(),n(39,"app-autocomplete",80),f("valueChange",function(a){u(t);let c=m();return p(c.onTemplateSelected(a))}),r()()(),n(40,"div",70)(41,"label",71),l(42,"Estado"),r(),n(43,"select",88)(44,"option",89),l(45,"Todos los estados"),r(),I(46,Oe,2,2,"option",46,Re),r()(),n(48,"div",90)(49,"label",71),l(50,"Desde"),r(),d(51,"input",91),r(),n(52,"div",90)(53,"label",71),l(54,"Hasta"),r(),d(55,"input",92),r()()()()}if(o&2){let t,i=m();s(),g("formGroup",i.filtersForm),s(10),h((t=i.filtersForm.get("searchText"))!=null&&t.value?11:-1),s(7),g("options",i.availableEvents())("displayFn",i.displayEvent)("placeholder","Buscar eventos...")("minChars",i.autocompleteConfig.minCharsLocal)("maxHeight",i.autocompleteConfig.maxHeight)("noResultsMessage","No se encontraron eventos")("formControl",i.eventFilterControl)("inputClass","form-control border-start-0 bg-light form-control-sm")("size","sm")("autocomplete","off")("ariaDescribedBy","event-search-addon")("inInputGroup",!0)("cacheSize",100)("highlightSearch",!0)("loadingMessage","Buscando eventos..."),s(7),g("searchFn",i.searchUsers)("preloadFn",i.preloadUsers)("displayFn",i.displayUser)("placeholder","Buscar por DNI, email o nombres...")("minChars",i.autocompleteConfig.minCharsRemote)("searchLimit",i.autocompleteConfig.searchLimit)("debounceMs",i.autocompleteConfig.debounceTime)("maxHeight",i.autocompleteConfig.maxHeight)("noResultsMessage","No se encontraron usuarios")("enablePreload",!0)("formControl",i.userFilterControl)("inputClass","form-control border-start-0 bg-light form-control-sm")("size","sm")("autocomplete","off")("ariaDescribedBy","user-search-addon")("inInputGroup",!0)("cacheSize",100)("highlightSearch",!0)("loadingMessage","Buscando usuarios..."),s(7),g("options",i.availableRoles())("displayFn",i.displayRole)("placeholder","Seleccionar rol...")("minChars",i.autocompleteConfig.minCharsLocal)("maxHeight",i.autocompleteConfig.maxHeight)("noResultsMessage","No se encontraron roles")("formControl",i.roleFilterControl)("inputClass","form-control border-start-0 bg-light form-control-sm")("size","sm")("autocomplete","off")("ariaDescribedBy","role-search-addon")("inInputGroup",!0)("cacheSize",100)("highlightSearch",!0)("loadingMessage","Cargando roles..."),s(7),g("options",i.templatesWithId())("displayFn",i.displayTemplate)("placeholder","Seleccionar plantilla...")("minChars",i.autocompleteConfig.minCharsLocal)("maxHeight",i.autocompleteConfig.maxHeight)("noResultsMessage","No se encontraron plantillas")("formControl",i.templateFilterControl)("inputClass","form-control border-start-0 bg-light form-control-sm")("size","sm")("autocomplete","off")("ariaDescribedBy","template-search-addon")("inInputGroup",!0)("cacheSize",100)("highlightSearch",!0)("loadingMessage","Cargando plantillas..."),s(7),F(i.statusOptions())}}function Ue(o,e){if(o&1&&(n(0,"span",42),l(1),r()),o&2){let t=m();s(),b(t.totalItems())}}function je(o,e){if(o&1&&(n(0,"option",46),l(1),r()),o&2){let t=e.$implicit;g("value",t),s(),b(t)}}function $e(o,e){o&1&&d(0,"i",98)}function Ge(o,e){o&1&&d(0,"i",99)}function He(o,e){o&1&&d(0,"i",100)}function Qe(o,e){o&1&&d(0,"i",101)}function qe(o,e){o&1&&l(0," Error de Conexi\xF3n ")}function We(o,e){o&1&&l(0," Error de Validaci\xF3n ")}function Xe(o,e){o&1&&l(0," Sin Permisos ")}function Ke(o,e){o&1&&l(0," Error ")}function Je(o,e){if(o&1){let t=_();n(0,"button",107),f("click",function(){let a;u(t);let c=m(2);return p((a=c.errorState().action)==null?null:a())}),d(1,"i",21),l(2," Reintentar "),r()}}function Ye(o,e){if(o&1){let t=_();n(0,"div",95)(1,"div",96)(2,"div",97),C(3,$e,1,0,"i",98)(4,Ge,1,0,"i",99)(5,He,1,0,"i",100)(6,Qe,1,0,"i",101),r(),n(7,"div",102)(8,"h6",103),C(9,qe,1,0)(10,We,1,0)(11,Xe,1,0)(12,Ke,1,0),r(),n(13,"p",104),l(14),r(),C(15,Je,3,0,"button",105),n(16,"button",106),f("click",function(){u(t);let a=m();return p(a.refreshData())}),d(17,"i",21),l(18," Actualizar "),r()()()()}if(o&2){let t,i,a=m();D("alert-danger",a.errorState().type==="validation"||a.errorState().type==="permission")("alert-warning",a.errorState().type==="network")("alert-secondary",a.errorState().type==="unknown"),s(3),h((t=a.errorState().type)==="network"?3:t==="validation"?4:t==="permission"?5:6),s(6),h((i=a.errorState().type)==="network"?9:i==="validation"?10:i==="permission"?11:12),s(5),b(a.errorState().message),s(),h(a.errorState().canRetry&&a.errorState().action?15:-1)}}function Ze(o,e){o&1&&(n(0,"div",114)(1,"div",115)(2,"div",116)(3,"div",28),d(4,"span",117),n(5,"div",118),d(6,"span",119)(7,"span",120),r()()(),n(8,"div",121)(9,"div",122),d(10,"span",123),n(11,"div",102)(12,"div",124),d(13,"span",125)(14,"span",126),r(),n(15,"div",127),d(16,"span",128)(17,"span",129),r()()(),n(18,"div",130)(19,"div"),d(20,"span",131)(21,"div",132),r(),n(22,"div"),d(23,"span",131)(24,"div",132),r(),n(25,"div"),d(26,"span",131)(27,"div",132),r()()(),n(28,"div",133)(29,"div",134),d(30,"span",135)(31,"span",135)(32,"span",135),r()()()())}function et(o,e){o&1&&(n(0,"div",108),I(1,Ze,33,0,"div",114,z),r()),o&2&&(s(),F(U(0,Fe)))}function tt(o,e){o&1&&(n(0,"tr")(1,"td",144),d(2,"span",145),r(),n(3,"td",144)(4,"div",29),d(5,"span",146),n(6,"div",102)(7,"div",124),d(8,"span",147)(9,"span",148),r()()()(),n(10,"td",149)(11,"div",124),d(12,"span",150)(13,"span",151),r()(),n(14,"td",152),d(15,"span",153),r(),n(16,"td",144),d(17,"span",154),r(),n(18,"td",155)(19,"div",124),d(20,"span",148),r()(),n(21,"td",144)(22,"div",118),d(23,"span",135)(24,"span",135)(25,"span",135),r()()())}function it(o,e){o&1&&(n(0,"div",109)(1,"table",136)(2,"thead",137)(3,"tr")(4,"th",138),l(5,"Sel."),r(),n(6,"th",139),l(7,"Certificado"),r(),n(8,"th",140),l(9,"Evento"),r(),n(10,"th",141),l(11,"Rol"),r(),n(12,"th",139),l(13,"Estado"),r(),n(14,"th",142),l(15,"Fecha"),r(),n(16,"th",143),l(17,"Acciones"),r()()(),n(18,"tbody"),I(19,tt,26,0,"tr",null,z),r()()()),o&2&&(s(19),F(U(0,Fe)))}function nt(o,e){if(o&1&&(n(0,"div",57),C(1,et,3,1,"div",108)(2,it,21,1,"div",109),n(3,"div",110)(4,"div",111)(5,"span",112),l(6,"Cargando..."),r()(),n(7,"span",113),l(8,"Cargando certificados..."),r()()()),o&2){let t=m();s(),h(t.viewMode()==="cards"?1:2)}}function rt(o,e){if(o&1){let t=_();n(0,"div")(1,"h6",158),l(2,"No se encontraron certificados"),r(),n(3,"p",159),l(4," No hay certificados que coincidan con los filtros aplicados. "),r(),n(5,"div",160)(6,"button",161),f("click",function(){u(t);let a=m(2);return p(a.clearAllFilters())}),d(7,"i",162),l(8,"Limpiar filtros "),r(),n(9,"button",163),f("click",function(){u(t);let a=m(2);return p(a.refreshData())}),d(10,"i",21),l(11,"Actualizar "),r()()()}}function at(o,e){o&1&&(n(0,"div")(1,"h6",158),l(2,"No hay certificados"),r(),n(3,"p",159),l(4," A\xFAn no se han generado certificados."),d(5,"br"),l(6," Comienza creando los primeros certificados. "),r(),n(7,"a",164),d(8,"i",24),l(9,"Generar Certificados "),r()())}function ot(o,e){if(o&1&&(n(0,"div",58)(1,"div",156),d(2,"i",157),r(),C(3,rt,12,0,"div")(4,at,10,0,"div"),r()),o&2){let t=m();s(3),h(t.hasActiveFilters()?3:4)}}function lt(o,e){if(o&1){let t=_();n(0,"button",188),f("click",function(){u(t);let a=m().$implicit,c=m(3);return p(c.confirmRegenerateCertificate(a))}),d(1,"i",189),r()}}function st(o,e){if(o&1){let t=_();n(0,"button",190),f("click",function(){u(t);let a=m().$implicit,c=m(3);return p(c.confirmRevokeCertificate(a))}),d(1,"i",67),r()}if(o&2){let t=m(4);g("disabled",t.isLoading())}}function ct(o,e){if(o&1){let t=_();n(0,"div",114)(1,"div",115)(2,"div",165)(3,"div",166)(4,"input",167),f("change",function(){let a=u(t).$implicit,c=m(3);return p(c.toggleSelection(a.id))}),r()(),n(5,"span",168),d(6,"i",36),r()(),n(7,"div",121)(8,"div",169)(9,"div",170),d(10,"i",171),r(),n(11,"div",172)(12,"div",173),l(13),r(),n(14,"div",174),l(15),r()()(),n(16,"div",175)(17,"div",176),d(18,"i",177),n(19,"span",178),l(20),r()(),n(21,"div",179)(22,"span"),l(23),M(24,"date"),r(),n(25,"span",180),l(26),r()()(),n(27,"div",130)(28,"div")(29,"div",181),l(30),r(),n(31,"div",182),l(32,"Descargas"),r()(),n(33,"div")(34,"div",181),l(35),r(),n(36,"div",182),l(37,"Verificaciones"),r()(),n(38,"div")(39,"div",181),l(40),r(),n(41,"div",182),l(42,"Emitido"),r()()()(),n(43,"div",133)(44,"div",183)(45,"button",184),f("click",function(){let a=u(t).$implicit,c=m(3);return p(c.confirmDownloadCertificate(a))}),d(46,"i",185),r(),C(47,lt,2,0,"button",186),C(48,st,2,1,"button",187),r()()()()}if(o&2){let t=e.$implicit,i=m(3);s(),T(i.getTableRowClass(t.status)),D("border-primary",i.selectedCertificates().includes(t.id))("bg-primary-subtle",i.selectedCertificates().includes(t.id)),s(3),g("id","card-select-"+t.id)("checked",i.selectedCertificates().includes(t.id)),s(),T(i.getStatusBadgeClass(t.status)),s(),T("bi-"+i.getStatusIcon(t.status)),s(7),b(t.participantName),s(2),b(t.participantEmail),s(4),g("title",t.eventTitle),s(),E(" ",t.eventTitle," "),s(3),b(k(24,24,t.eventDate,"dd/MM/yyyy")),s(3),b(t.roleName),s(4),b(t.downloadCount),s(5),b(t.verificationCount),s(5),b(i.formatDate(t.issuedAt)),s(5),g("disabled",!i.canDownload(t)),s(2),h(i.canRegenerate(t)?47:-1),s(),h(i.canRevoke(t)?48:-1)}}function dt(o,e){if(o&1&&(n(0,"div",57)(1,"div",108),I(2,ct,49,27,"div",114,B().trackByCertificateId,!0),r()()),o&2){let t=m(2);s(2),F(t.certificates())}}function mt(o,e){if(o&1){let t=_();n(0,"button",188),f("click",function(){u(t);let a=m().$implicit,c=m(3);return p(c.confirmRegenerateCertificate(a))}),d(1,"i",189),r()}}function ut(o,e){if(o&1){let t=_();n(0,"button",190),f("click",function(){u(t);let a=m().$implicit,c=m(3);return p(c.confirmRevokeCertificate(a))}),d(1,"i",67),r()}if(o&2){let t=m(4);g("disabled",t.isLoading())}}function pt(o,e){if(o&1){let t=_();n(0,"tr")(1,"td",144)(2,"div",193)(3,"input",167),f("change",function(){let a=u(t).$implicit,c=m(3);return p(c.toggleSelection(a.id))}),r()()(),n(4,"td",144)(5,"div",29)(6,"div",201),d(7,"i",171),r(),n(8,"div",202)(9,"div",173),l(10),r(),n(11,"div",203),l(12),r(),n(13,"div",204),l(14),M(15,"date"),r()()()(),n(16,"td",149)(17,"div",202)(18,"div",205),l(19),r(),n(20,"div",113),l(21),M(22,"date"),r()()(),n(23,"td",152)(24,"span",42),l(25),r()(),n(26,"td",152)(27,"span",206),d(28,"i",207),l(29),r()(),n(30,"td",144)(31,"span",168),d(32,"i",36),n(33,"span",208),l(34),r()()(),n(35,"td",155)(36,"div",209)(37,"span",210),d(38,"i",61),l(39),r(),n(40,"span",210),d(41,"i",211),l(42),r()()(),n(43,"td",155)(44,"div",15)(45,"div",212),l(46),M(47,"date"),r(),n(48,"div",213),l(49),M(50,"date"),r()()(),n(51,"td",214)(52,"div",215)(53,"button",184),f("click",function(){let a=u(t).$implicit,c=m(3);return p(c.confirmDownloadCertificate(a))}),d(54,"i",185),r(),C(55,mt,2,0,"button",186),C(56,ut,2,1,"button",187),r()()()}if(o&2){let t=e.$implicit,i=m(3);T(i.getTableRowClass(t.status)),D("table-active",i.selectedCertificates().includes(t.id)),s(3),g("id","select-"+t.id)("checked",i.selectedCertificates().includes(t.id)),s(7),b(t.participantName),s(2),b(t.eventTitle),s(2),b(k(15,26,t.eventDate,"dd/MM/yyyy")),s(4),g("title",t.eventTitle),s(),E(" ",t.eventTitle," "),s(2),b(k(22,29,t.eventDate,"dd/MM/yyyy")),s(4),E(" ",t.roleName," "),s(4),E("",i.getTemplateName(t.templateUrl)," "),s(2),T(i.getStatusBadgeClass(t.status)),s(),T("bi-"+i.getStatusIcon(t.status)),s(2),b(i.getStatusLabel(t.status)),s(5),E("",t.downloadCount," "),s(3),E("",t.verificationCount," "),s(4),b(k(47,32,t.issuedAt,"dd/MM/yyyy")),s(3),b(k(50,35,t.issuedAt,"HH:mm")),s(4),g("disabled",!i.canDownload(t)),s(2),h(i.canRegenerate(t)?55:-1),s(),h(i.canRevoke(t)?56:-1)}}function ft(o,e){if(o&1){let t=_();n(0,"div",109)(1,"table",191)(2,"thead",137)(3,"tr")(4,"th",192)(5,"div",193)(6,"input",194),f("change",function(){u(t);let a=m(2);return p(a.toggleSelectAll())}),r()()(),n(7,"th",195),l(8,"Participante"),r(),n(9,"th",196),l(10,"Evento"),r(),n(11,"th",197),l(12,"Rol"),r(),n(13,"th",197),l(14,"Plantilla"),r(),n(15,"th",195),l(16,"Estado"),r(),n(17,"th",198),l(18,"Estad\xEDsticas"),r(),n(19,"th",198),l(20,"Fecha"),r(),n(21,"th",199),l(22,"Acciones"),r()()(),n(23,"tbody"),I(24,pt,57,38,"tr",200,B().trackByCertificateId,!0),r()()()}if(o&2){let t=m(2);s(6),g("checked",t.areAllSelected())("indeterminate",t.areSomeSelected()),s(18),F(t.certificates())}}function gt(o,e){if(o&1&&(C(0,dt,4,0,"div",57),C(1,ft,26,2,"div",109)),o&2){let t=m();h(t.viewMode()==="cards"?0:-1),s(),h(t.viewMode()==="table"?1:-1)}}function Ct(o,e){if(o&1){let t=_();n(0,"div",59)(1,"app-pagination",216),f("pageChange",function(a){u(t);let c=m();return p(c.goToPage(a))})("pageSizeChange",function(a){u(t);let c=m();return p(c.onPageSizeChange(a))}),r()()}if(o&2){let t=m();s(),g("totalItems",t.totalItems())("pageSize",t.pageSize())("currentPage",t.currentPage())("showPageSizeSelector",!0)("pageSizeOptions",t.pageSizeOptions)("showGoToPage",!0)("showRangeInfo",!0)("showFirstLastButtons",!0)("maxVisiblePages",5)("density","compact")}}var Ie=class o{router=w(te);destroyRef=w(H);certificateService=w(we);staticDataService=w(ve);eventService=w(Se);userService=w(be);CertificateGeneratorService=w(Ee);initialFilters=N();initialPageSize=N();initialViewMode=N();showFiltersInitially=N(!1);certificateSelected=L();filtersChanged=L();certificateDownloaded=L();certificateRegenerated=L();certificateRevoked=L();confirmModal=Y("confirmModal");pageSizeOptions=A.pagination.pageSizeOptions;autocompleteConfig=A.autocomplete;CertificateStatus=re;Math=Math;showFilters=v(!1);viewMode=v("cards");selectedCertificates=v([]);currentPage=v(1);pageSize=v(A.pagination.defaultPageSize);sortOptions=v({field:"issued_at",direction:"desc"});certificatesResource=J({loader:()=>R(this,null,function*(){try{return yield O(this.certificateService.getCertificates(this.currentPage(),this.pageSize(),this.buildFilters(),this.sortOptions()))}catch(e){let t=this.processResourceError(e);throw console.error("Certificates Resource Error:",t),t}}),defaultValue:{items:[],pagination:{currentPage:1,totalItems:0,totalPages:0,itemsPerPage:A.pagination.defaultPageSize,hasNextPage:!1,hasPrevPage:!1}}});processResourceError(e){if(!e){let c=new Error("Error desconocido en el recurso");return c.canRetry=!0,c}let t=e,i="Error al cargar los certificados";t.status===0||t.name==="NetworkError"?i="Error de conexi\xF3n. Verifica tu conexi\xF3n a internet.":t.status&&t.status>=400&&t.status<500?i=t.error?.message||"Error en la solicitud. Verifica los par\xE1metros.":t.status===401||t.status===403?i="No tienes permisos para acceder a esta informaci\xF3n.":t.status&&t.status>=500&&(i="Error del servidor. Intenta nuevamente en unos momentos.");let a=new Error(i);return a.originalError=t,a.canRetry=t.status!==401&&t.status!==403,a}certificates=S(()=>this.certificatesResource.value()?.items??[]);totalItems=S(()=>this.certificatesResource.value()?.pagination.totalItems??0);totalPages=S(()=>Math.ceil(this.totalItems()/this.pageSize()));isLoading=S(()=>this.certificatesResource.status()==="loading");resourceError=S(()=>this.certificatesResource.error());errorState=S(()=>{let e=this.resourceError();if(!e)return null;let t=e;return{message:e.message||"Error al cargar los certificados",canRetry:t.canRetry??!0,type:this.getErrorType(e),action:t.canRetry!==!1?()=>this.refreshCertificates():void 0}});getErrorType(e){let t=e;return t.status===0||t.name==="NetworkError"?"network":t.status&&t.status>=400&&t.status<500?"validation":t.status===401||t.status===403?"permission":"unknown"}availableEvents=v([]);availableRoles=v([]);availableTemplates=v([]);certificateTemplatesMap=v(null);templatesWithId=S(()=>{let e=this.certificateTemplatesMap();return e?Object.entries(e).map(([t,i])=>j({id:parseInt(t)},i)):[]});filtersForm=new se({searchText:new x(null),status:new x(""),eventId:new x(null),userId:new x(null),participantRoleId:new x(null),templateId:new x(null),issuedFrom:new x(null),issuedTo:new x(null)});eventFilterControl=new x(null);userFilterControl=new x(null);roleFilterControl=new x(null);templateFilterControl=new x(null);selectedEventState=v(null);selectedUserState=v(null);selectedRoleState=v(null);selectedTemplateState=v(null);templatesData=v([]);formFiltersState=v({searchText:null,status:"",eventId:null,userId:null,participantRoleId:null,templateId:null,issuedFrom:null,issuedTo:null});confirmAction=v({title:"Confirmar Acci\xF3n",message:"\xBFEst\xE1 seguro?",confirmText:"Confirmar",callback:()=>{}});statusOptions=S(()=>[{value:"valid",label:"V\xE1lido"},{value:"revoked",label:"Revocado"},{value:"expired",label:"Expirado"}]);statusSelectItems=S(()=>this.statusOptions().map(e=>({id:e.value,label:e.label,badge:{text:e.label,color:this.getStatusBadgeColorForMultiSelect(e.value)},icon:this.getStatusIcon(e.value)})));hasActiveFilters=V(()=>{let e=this.formFiltersState();return!!(e.searchText?.trim()||e.status||e.eventId||e.userId||e.participantRoleId||this.selectedTemplateState()||e.issuedFrom||e.issuedTo)});activeFiltersCount=V(()=>{let e=this.formFiltersState(),t=0;return e.searchText?.trim()&&t++,e.status&&t++,e.eventId&&t++,e.userId&&t++,e.participantRoleId&&t++,this.selectedTemplateState()&&t++,(e.issuedFrom||e.issuedTo)&&t++,t});paginationInfo=V(()=>{let e=this.totalItems(),t=this.pageSize(),i=this.currentPage(),a=Math.ceil(e/t);return{total:e,size:t,current:i,totalPages:a,hasItems:e>0,hasPagination:a>1,startItem:e>0?(i-1)*t+1:0,endItem:Math.min(i*t,e)}});selectionState=V(()=>{let e=this.certificates(),t=this.selectedCertificates(),i=e.map(c=>c.id),a=t.filter(c=>i.includes(c));return{allSelected:e.length>0&&e.every(c=>t.includes(c.id)),someSelected:a.length>0&&a.length<e.length,noneSelected:a.length===0,selectedCount:a.length,totalVisible:e.length}});areAllSelected=V(()=>this.selectionState().allSelected);areSomeSelected=V(()=>this.selectionState().someSelected);trackByCertificateId=(e,t)=>t.id;trackByTemplateId=(e,t)=>t.id;trackByStatusId=(e,t)=>t.id;statusBadgeClassCache=new Map;statusIconCache=new Map;statusLabelCache=new Map;ngOnInit(){this.initializeFromInputs(),this.formFiltersState.set(this.filtersForm.value),this.loadInitialData(),this.setupSubscriptions(),this.loadViewMode()}initializeFromInputs(){let e=this.initialFilters();if(e){let c=this.convertToFormFilters(e);this.filtersForm.patchValue(c),this.formFiltersState.set(this.filtersForm.value)}let t=this.initialPageSize();t&&this.pageSize.set(t);let i=this.initialViewMode();i&&this.viewMode.set(i),this.showFiltersInitially()&&this.showFilters.set(!0)}convertToFormFilters(e){return{searchText:e.searchText||null,status:e.status||null,eventId:typeof e.eventId=="number"?e.eventId:null,userId:typeof e.userId=="number"?e.userId:null,participantRoleId:typeof e.participantRoleId=="number"?e.participantRoleId:null,templateId:typeof e.templateId=="number"?e.templateId:null,issuedFrom:e.issuedFrom||null,issuedTo:e.issuedTo||null}}updateFiltersState(e){this.formFiltersState.set(e),this.currentPage.set(1),this.refreshCertificates();let t=this.buildFilters();this.filtersChanged.emit(t)}loadInitialData(){this.loadEvents(),this.staticDataService.certificateTemplates$.pipe(P(this.destroyRef)).subscribe({next:e=>{if(e){this.certificateTemplatesMap.set(e);let t=Object.entries(e).map(([i,a])=>({id:parseInt(i),name:a.name,description:a.description||""}));this.templatesData.set(t)}},error:e=>console.error("Error loading templates:",e)}),this.staticDataService.getParticipantRolesList().pipe(P(this.destroyRef)).subscribe({next:e=>{this.availableRoles.set(e)},error:e=>console.error("Error loading participant roles:",e)})}loadEvents(){return R(this,null,function*(){try{let e=yield O(this.eventService.preloadEventsForAutocomplete(100));this.availableEvents.set(e)}catch(e){console.error("Error loading events:",e)}})}setupSubscriptions(){this.filtersForm.valueChanges.pipe($(300),G(),P(this.destroyRef)).subscribe(e=>{this.updateFiltersState(e);let t=this.filtersForm.get("eventId")?.value;if(!t)this.selectedEventState.set(null),this.eventFilterControl.setValue(null);else{let i=this.selectedEventState();(!i||i.id!==t)&&(this.selectedEventState.set(null),this.eventFilterControl.setValue(null))}})}displayEvent=e=>{if(!e)return"";let t=new Date(e.startDate).toLocaleDateString("es-CO");return`${e.title} (${t})`};searchUsers=(e,t)=>{let i={query:e.trim(),limit:t};return this.userService.queryUsersForAutocomplete(i)};preloadUsers=()=>this.userService.preloadUsersForAutocomplete(15);displayUser=e=>e?`${e.fullName||"Sin nombre"} - ${e.email} - ${e.documentNumber||"Sin DNI"}`:"";onEventSelected(e){this.selectedEventState.set(e),e?this.filtersForm.patchValue({eventId:e.id},{emitEvent:!0}):this.filtersForm.patchValue({eventId:null},{emitEvent:!0})}onUserSelected(e){this.selectedUserState.set(e),e?this.filtersForm.patchValue({userId:e.id},{emitEvent:!0}):this.filtersForm.patchValue({userId:null},{emitEvent:!0})}displayRole=e=>e?`${e.name} - ${e.description}`:"";onRoleSelected(e){if(this.selectedRoleState.set(e),e){let t=this.getRoleId(e.name);this.filtersForm.patchValue({participantRoleId:t},{emitEvent:!0})}else this.filtersForm.patchValue({participantRoleId:null},{emitEvent:!0})}displayTemplate=e=>e?e.name:"";onTemplateSelected(e){if(this.selectedTemplateState.set(e),e){let t=this.getTemplateId(e.name);this.filtersForm.patchValue({templateId:t},{emitEvent:!0})}else this.filtersForm.patchValue({templateId:null},{emitEvent:!0})}getRoleId(e){let i=this.staticDataService.participantRolesSubject?.value;if(i){let a=Object.entries(i).find(([c,y])=>y.name===e);if(a)return parseInt(a[0])}return 1}getTemplateId(e){let i=this.staticDataService.certificateTemplatesSubject?.value;if(i){let a=Object.entries(i).find(([c,y])=>y.name===e);if(a)return parseInt(a[0])}return 1}loadViewMode(){let e=localStorage.getItem("certificate-view-mode");e&&this.viewMode.set(e)}handleResourceError(e){}processError(e){if(!e)return{message:"Error desconocido",canRetry:!0,type:"unknown"};let t=e,i="unknown",a="Ha ocurrido un error inesperado",c=!0;return t.status===0||t.name==="NetworkError"?(i="network",a="Error de conexi\xF3n. Verifica tu conexi\xF3n a internet.",c=!0):t.status&&t.status>=400&&t.status<500?(i="validation",a=t.error?.message||"Error en la solicitud. Verifica los datos enviados.",c=!1):t.status===401||t.status===403?(i="permission",a="No tienes permisos para realizar esta acci\xF3n.",c=!1):t.status&&t.status>=500&&(i="network",a="Error del servidor. Intenta nuevamente en unos momentos.",c=!0),{message:a,canRetry:c,type:i,action:c?()=>this.refreshCertificates():void 0}}refreshCertificates(){this.certificatesResource.reload()}buildFilters(){let e=this.filtersForm.value,t={};return e.searchText?.trim()&&(t.search=e.searchText.trim()),e.status&&e.status!==""&&(t.status=[e.status]),e.eventId!==null&&e.eventId!==void 0&&(t.eventId=e.eventId),e.userId!==null&&e.userId!==void 0&&(t.userId=e.userId),e.participantRoleId!==null&&e.participantRoleId!==void 0&&(t.participantRoleId=e.participantRoleId),e.templateId!==null&&e.templateId!==void 0&&(t.templateId=e.templateId),e.issuedFrom&&(t.issuedFrom=e.issuedFrom),e.issuedTo&&(t.issuedTo=e.issuedTo),t}toggleFiltersPanel(){this.showFilters.update(e=>!e)}clearAllFilters(){this.selectedCertificates.set([]),this.currentPage.set(1),this.formFiltersState.set({searchText:null,status:"",eventId:null,userId:null,participantRoleId:null,templateId:null,issuedFrom:null,issuedTo:null}),this.selectedEventState.set(null),this.selectedUserState.set(null),this.selectedRoleState.set(null),this.selectedTemplateState.set(null),this.eventFilterControl.setValue(null),this.userFilterControl.setValue(null),this.roleFilterControl.setValue(null),this.templateFilterControl.setValue(null),this.filtersForm.reset({searchText:null,status:"",eventId:null,userId:null,participantRoleId:null,issuedFrom:null,issuedTo:null})}clearSearch(){this.filtersForm.patchValue({searchText:""})}onSortChange(e){let t=e.target,[i,a]=t.value.split("|");this.sortOptions.set({field:i,direction:a}),this.refreshCertificates()}onPageSizeChange(e){if(typeof e=="number")this.pageSize.set(e);else{let t=e.target;this.pageSize.set(Number(t.value))}this.currentPage.set(1),this.refreshCertificates()}goToPage(e){e>=1&&e<=this.totalPages()&&(this.currentPage.set(e),this.refreshCertificates())}onPageChange(e){this.goToPage(e)}setViewMode(e){this.viewMode.set(e),localStorage.setItem("certificate-view-mode",e)}setPageSize(e){this.pageSize.set(Number(e)),this.currentPage.set(1),this.refreshCertificates()}toggleSelection(e){this.selectedCertificates.update(t=>t.indexOf(e)>=0?t.filter(a=>a!==e):[...t,e])}toggleSelectAll(){this.areAllSelected()?this.selectedCertificates.set([]):this.selectedCertificates.set(this.certificates().map(t=>t.id))}isSelected(e){return this.selectedCertificates().includes(e)}getStatusBadgeClass(e){if(this.statusBadgeClassCache.has(e))return this.statusBadgeClassCache.get(e);let t;switch(e){case"valid":t="bg-success-subtle text-success-emphasis border border-success-subtle";break;case"revoked":t="bg-danger-subtle text-danger-emphasis border border-danger-subtle";break;case"expired":t="bg-warning-subtle text-warning-emphasis border border-warning-subtle";break;default:t="bg-secondary-subtle text-secondary-emphasis border border-secondary-subtle"}return this.statusBadgeClassCache.set(e,t),t}getStatusIcon(e){if(this.statusIconCache.has(e))return this.statusIconCache.get(e);let i={valid:"check-circle",revoked:"x-circle",expired:"clock"}[e]||"question-circle";return this.statusIconCache.set(e,i),i}getStatusLabel(e){if(this.statusLabelCache.has(e))return this.statusLabelCache.get(e);let i={valid:"V\xE1lido",revoked:"Revocado",expired:"Expirado"}[e]||"Estado Desconocido";return this.statusLabelCache.set(e,i),i}getStatusBadgeColorForMultiSelect(e){switch(e){case"valid":return"success";case"revoked":return"danger";case"expired":return"warning";default:return"secondary"}}getTableRowClass(e){switch(e){case"valid":return"";case"revoked":return"table-danger";case"expired":return"table-warning";default:return""}}formatDate(e){try{return new Date(e).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return e}}formatDateTime(e){try{return new Date(e).toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}}canDownload(e){return e.status==="valid"}canRegenerate(e){return e.status==="valid"||e.status==="expired"}canRevoke(e){return e.status==="valid"}exportToCSV(){let e=this.generateCSVData(this.certificates());this.downloadCSV(e,"certificados.csv")}exportSelectedToCSV(){let e=this.certificates().filter(i=>this.selectedCertificates().includes(i.id)),t=this.generateCSVData(e);this.downloadCSV(t,"certificados_seleccionados.csv")}generateCSVData(e){let i=[["ID","Participante","Email","Evento","Fecha Evento","Rol","Estado","C\xF3digo Verificaci\xF3n","Fecha Emisi\xF3n","Descargas","Verificaciones"].join(",")];return e.forEach(a=>{let c=[a.id,`"${a.participantName}"`,a.participantEmail,`"${a.eventTitle}"`,a.eventDate,`"${a.roleName}"`,this.getStatusLabel(a.status),a.verificationCode||"",a.issuedAt,a.downloadCount,a.verificationCount];i.push(c.join(","))}),i.join(`
`)}downloadCSV(e,t){let i=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),c=URL.createObjectURL(i);a.setAttribute("href",c),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}refreshData(){this.refreshCertificates()}confirmDownloadCertificate(e){this.canDownload(e)&&(this.confirmAction.set({title:"Descargar Certificado",message:`\xBFDescargar el certificado de ${e.participantName}?`,confirmText:"S\xED, Descargar",callback:()=>R(this,null,function*(){return yield this.downloadCertificate(e.id)})}),this.confirmModal()?.show())}confirmRegenerateCertificate(e){this.canRegenerate(e)&&(this.confirmAction.set({title:"Regenerar Certificado",message:`\xBFRegenerar el certificado de ${e.participantName}? Esto crear\xE1 una nueva versi\xF3n.`,confirmText:"S\xED, Regenerar",callback:()=>this.regenerateCertificate(e.id)}),this.confirmModal()?.show())}confirmRevokeCertificate(e){this.canRevoke(e)&&(this.confirmAction.set({title:"Revocar Certificado",message:`\xBFRevocar el certificado de ${e.participantName}? Esta acci\xF3n no se puede deshacer.`,confirmText:"S\xED, Revocar",callback:()=>this.revokeCertificate(e.id)}),this.confirmModal()?.show())}downloadCertificate(e){return R(this,null,function*(){try{let t=this.certificates().find(Te=>Te.id===e);if(!t){this.certificateDownloaded.emit({certificateId:e,success:!1});return}this.certificateSelected.emit(t);let i=t.templateUrl||"/template/certificado-1756515494650.json",a=yield fetch(i);if(!a.ok)throw alert(`\u26A0\uFE0F Error: La plantilla con ID "${t.templateId}" y URL "${i}" no existe o no est\xE1 disponible.`),this.certificateDownloaded.emit({certificateId:e,success:!1}),new Error("No se pudo cargar la plantilla del certificado");let c=yield a.json(),y=yield this.CertificateGeneratorService.generarCertificadoPDFPorCodigo(c,t.shortCode,{formato:"A4",orientacion:"landscape",nombreArchivo:`certificado-${t.shortCode}`});y.success?this.certificateDownloaded.emit({certificateId:e,success:!0}):(console.error("Error al generar certificado:",y.message),this.certificateDownloaded.emit({certificateId:e,success:!1}))}catch(t){console.error("Error al descargar certificado:",t),this.certificateDownloaded.emit({certificateId:e,success:!1})}})}regenerateCertificate(e){this.certificateService.regenerateCertificate(e).pipe(P(this.destroyRef)).subscribe({next:t=>{t.success?(this.refreshCertificates(),this.certificateRegenerated.emit({certificateId:e,success:!0})):this.certificateRegenerated.emit({certificateId:e,success:!1})},error:t=>{console.error("Error regenerating certificate:",t),this.certificateRegenerated.emit({certificateId:e,success:!1})}})}revokeCertificate(e){this.certificateService.revokeCertificate(e,"Revocado desde lista de certificados").pipe(P(this.destroyRef)).subscribe({next:t=>{t?(this.refreshCertificates(),this.certificateRevoked.emit({certificateId:e,success:!0})):this.certificateRevoked.emit({certificateId:e,success:!1})},error:t=>{console.error("Error revoking certificate:",t),this.certificateRevoked.emit({certificateId:e,success:!1})}})}onConfirmAccepted(){return R(this,null,function*(){yield this.confirmAction().callback()})}onConfirmCancelled(){}exportCertificates(){this.exportToCSV()}generateBulkCertificates(){this.router.navigate(["/certificates/generate"])}getTemplateName(e){if(!e)return"Sin plantilla";let t=this.certificateTemplatesMap();if(t){for(let[a,c]of Object.entries(t))if(c.templateUrl===e)return c.name}let i=e.split("/").pop()?.replace(".json","")||"Desconocida";return i.charAt(0).toUpperCase()+i.slice(1)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=Q({type:o,selectors:[["app-certificate-list"]],viewQuery:function(t,i){t&1&&W(i.confirmModal,Ve,5),t&2&&X()},inputs:{initialFilters:[1,"initialFilters"],initialPageSize:[1,"initialPageSize"],initialViewMode:[1,"initialViewMode"],showFiltersInitially:[1,"showFiltersInitially"]},outputs:{certificateSelected:"certificateSelected",filtersChanged:"filtersChanged",certificateDownloaded:"certificateDownloaded",certificateRegenerated:"certificateRegenerated",certificateRevoked:"certificateRevoked"},decls:78,vars:24,consts:[["confirmModal",""],["searchInput",""],[1,"container-fluid","py-3"],[3,"accepted","cancelled","title","message","confirmText"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb","mb-0","small"],[1,"breadcrumb-item"],["routerLink","/",1,"text-decoration-none","link-primary"],[1,"bi","bi-house-door","me-1"],[1,"d-none","d-sm-inline"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","justify-content-between","gap-3","mb-4"],[1,"order-1","order-md-0"],[1,"h6","mb-1","fw-normal","d-flex","align-items-center"],[1,"bi","bi-award","me-2","text-primary"],[1,"small"],[1,"badge","text-bg-primary","ms-2","small"],[1,"text-muted","small","mb-0"],[1,"d-flex","flex-wrap","gap-2","order-0","order-md-1"],["type","button","title","Actualizar datos",1,"btn","btn-outline-secondary","btn-sm","d-flex","align-items-center",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"d-none","d-sm-inline","small"],["routerLink","/certificados/generar","title","Generar certificados",1,"btn","btn-primary","btn-sm","d-flex","align-items-center"],[1,"bi","bi-plus-circle","me-1"],["role","group",1,"btn-group"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-light","border-bottom","py-2"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center","gap-2"],[1,"d-flex","align-items-center","gap-1"],[1,"bi","bi-funnel","text-primary"],[1,"mb-0","fw-normal","small"],[1,"badge","text-bg-primary","rounded-pill","small"],["role","group",1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary","border-0","btn-sm",3,"click","title"],[1,"bi"],["type","button","title","Limpiar todos los filtros",1,"btn","btn-outline-danger","border-0","btn-sm"],[1,"card-body","py-3"],[1,"card","border-0","shadow-sm"],[1,"d-flex","align-items-center","gap-2","flex-grow-1","overflow-hidden"],[1,"bi","bi-list-ul","text-primary"],[1,"badge","text-bg-info","small"],[1,"d-flex","align-items-center","gap-1","ms-auto","me-2"],[1,"form-label","mb-0","text-muted","small","d-none","d-md-inline"],["aria-label","Elementos por p\xE1gina",1,"form-select","form-select-sm","small",2,"width","auto","min-width","70px",3,"change","value"],[3,"value"],["role","group","aria-label","Modo de vista",1,"btn-group","btn-group-sm","flex-shrink-0"],["type","radio","name","viewMode","id","cardsView","autocomplete","off",1,"btn-check",3,"change","checked"],["for","cardsView","title","Vista tarjetas",1,"btn","btn-outline-primary","btn-sm","px-2"],[1,"bi","bi-grid-3x3-gap"],[1,"d-none","d-xl-inline","ms-1","small"],["type","radio","name","viewMode","id","tableView","autocomplete","off",1,"btn-check",3,"change","checked"],["for","tableView","title","Vista tabla",1,"btn","btn-outline-primary","btn-sm","px-2"],[1,"bi","bi-table"],[1,"card-body","p-0"],[1,"alert","alert-dismissible","fade","show","border-0","m-3",3,"alert-danger","alert-warning","alert-secondary"],[1,"p-2"],[1,"text-center","py-4"],[1,"card-footer","bg-light","border-top","py-2"],["type","button","data-bs-toggle","dropdown","aria-expanded","false","title","Opciones de exportaci\xF3n",1,"btn","btn-success","btn-sm","dropdown-toggle","d-flex","align-items-center"],[1,"bi","bi-download","me-1"],[1,"dropdown-menu"],["type","button",1,"dropdown-item",3,"click"],[1,"bi","bi-file-earmark-spreadsheet","me-2"],[1,"bi","bi-file-earmark-check","me-2"],["type","button","title","Limpiar todos los filtros",1,"btn","btn-outline-danger","border-0","btn-sm",3,"click"],[1,"bi","bi-x-circle"],[3,"formGroup"],[1,"row","g-2"],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],[1,"form-label","fw-normal","small","mb-1"],[1,"input-group","input-group-sm"],[1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-search","text-muted"],["type","text","placeholder","N\xFAmero, c\xF3digo corto o verificaci\xF3n...","formControlName","searchText",1,"form-control","border-start-0","bg-light","form-control-sm"],["type","button","title","Limpiar b\xFAsqueda",1,"btn","btn-outline-secondary","border-start-0","btn-sm"],[1,"col-12","col-sm-6","col-lg-4","col-xl-3"],["id","event-search-addon",1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-calendar-event","text-muted"],[3,"valueChange","options","displayFn","placeholder","minChars","maxHeight","noResultsMessage","formControl","inputClass","size","autocomplete","ariaDescribedBy","inInputGroup","cacheSize","highlightSearch","loadingMessage"],["id","user-search-addon",1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-person","text-muted"],[3,"valueChange","searchFn","preloadFn","displayFn","placeholder","minChars","searchLimit","debounceMs","maxHeight","noResultsMessage","enablePreload","formControl","inputClass","size","autocomplete","ariaDescribedBy","inInputGroup","cacheSize","highlightSearch","loadingMessage"],["id","role-search-addon",1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-person-badge","text-muted"],["id","template-search-addon",1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-file-earmark-richtext","text-muted"],["formControlName","status",1,"form-select","bg-light","form-select-sm"],["value",""],[1,"col-6","col-sm-3","col-lg-2"],["type","date","formControlName","issuedFrom",1,"form-control","bg-light","form-control-sm"],["type","date","formControlName","issuedTo",1,"form-control","bg-light","form-control-sm"],["type","button","title","Limpiar b\xFAsqueda",1,"btn","btn-outline-secondary","border-start-0","btn-sm",3,"click"],[1,"bi","bi-x"],[1,"alert","alert-dismissible","fade","show","border-0","m-3"],[1,"d-flex","align-items-start"],[1,"me-3"],[1,"bi","bi-wifi-off","text-warning",2,"font-size","1.5rem"],[1,"bi","bi-exclamation-triangle","text-danger",2,"font-size","1.5rem"],[1,"bi","bi-shield-x","text-danger",2,"font-size","1.5rem"],[1,"bi","bi-question-circle","text-secondary",2,"font-size","1.5rem"],[1,"flex-grow-1"],[1,"alert-heading","mb-1"],[1,"mb-2","small"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-2"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-lg-3","row-cols-xl-4","g-2"],[1,"table-responsive"],[1,"text-center","mt-3"],["role","status",1,"spinner-border","text-primary","me-2",2,"width","1rem","height","1rem"],[1,"visually-hidden"],[1,"text-muted","small"],[1,"col"],[1,"card","h-100","border-0","shadow-sm"],[1,"card-header","border-0","py-1"],[1,"placeholder","col-2","bg-secondary","rounded",2,"height","16px"],[1,"d-flex","gap-1"],[1,"placeholder","bg-success","rounded-pill",2,"width","50px","height","16px"],[1,"placeholder","bg-warning","rounded-pill",2,"width","40px","height","16px"],[1,"card-body","py-2"],[1,"d-flex","align-items-start","gap-2","mb-2"],[1,"placeholder","bg-primary","rounded-circle","flex-shrink-0",2,"width","28px","height","28px"],[1,"placeholder-glow"],[1,"placeholder","col-9","mb-1","fw-bold",2,"height","16px"],[1,"placeholder","col-7","small",2,"height","14px"],[1,"d-flex","align-items-center","justify-content-between","small","mt-1"],[1,"placeholder","col-4",2,"height","12px"],[1,"placeholder","bg-info","rounded-pill",2,"width","50px","height","14px"],[1,"d-flex","justify-content-between","text-center","small","mb-2"],[1,"placeholder","col-8","mb-1",2,"height","12px"],[1,"placeholder","col-6",2,"height","10px"],[1,"card-footer","border-0","py-1"],[1,"d-flex","justify-content-end","gap-1"],[1,"placeholder","bg-secondary","rounded",2,"width","24px","height","24px"],[1,"table","table-hover","mb-0","table-sm"],[1,"table-light"],["scope","col",1,"border-0",2,"width","30px"],["scope","col",1,"fw-semibold","border-0"],["scope","col",1,"fw-semibold","border-0","d-none","d-md-table-cell"],["scope","col",1,"fw-semibold","border-0","d-none","d-lg-table-cell"],["scope","col",1,"fw-semibold","border-0","d-none","d-xl-table-cell"],["scope","col",1,"fw-semibold","border-0",2,"width","100px"],[1,"border-0"],[1,"placeholder","bg-secondary","rounded",2,"width","14px","height","14px"],[1,"placeholder","bg-primary","rounded-circle",2,"width","24px","height","24px"],[1,"placeholder","col-10","mb-1","small","fw-bold"],[1,"placeholder","col-8","small"],[1,"border-0","d-none","d-md-table-cell"],[1,"placeholder","col-9","mb-1","small"],[1,"placeholder","col-6","small"],[1,"border-0","d-none","d-lg-table-cell"],[1,"placeholder","bg-info","rounded-pill",2,"width","60px","height","18px"],[1,"placeholder","bg-success","rounded-pill",2,"width","70px","height","20px"],[1,"border-0","d-none","d-xl-table-cell"],[1,"text-muted","mb-3"],[1,"bi","bi-award",2,"font-size","3rem","opacity","0.3"],[1,"text-muted","mb-2"],[1,"text-muted","small","mb-3"],[1,"d-flex","gap-2","justify-content-center","flex-wrap"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bi","bi-funnel","me-1"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],["routerLink","/certificados/generar",1,"btn","btn-primary","btn-sm"],[1,"card-header","border-0","py-1","d-flex","align-items-center","justify-content-between"],[1,"form-check","form-check-sm","mb-0"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"badge","rounded-pill","small"],[1,"d-flex","align-items-center","gap-2","mb-2"],[1,"bg-primary","bg-opacity-10","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","32px","height","32px"],[1,"bi","bi-person-fill","text-primary","small"],[1,"min-w-0","flex-grow-1"],[1,"fw-medium","small","text-truncate"],[1,"text-muted","small","text-truncate"],[1,"mb-2"],[1,"d-flex","align-items-start","gap-1","mb-1"],[1,"bi","bi-calendar-event","text-primary","small","mt-1","flex-shrink-0"],[1,"small","text-truncate",3,"title"],[1,"d-flex","align-items-center","justify-content-between","small","text-muted"],[1,"badge","text-bg-info"],[1,"fw-medium","text-body"],[1,"text-muted",2,"font-size","0.7rem"],[1,"d-flex","gap-1","justify-content-center"],["title","Descargar",1,"btn","btn-outline-info","btn-sm",3,"click","disabled"],[1,"bi","bi-download"],["title","Regenerar",1,"btn","btn-outline-warning","btn-sm"],["title","Revocar",1,"btn","btn-outline-danger","btn-sm",3,"disabled"],["title","Regenerar",1,"btn","btn-outline-warning","btn-sm",3,"click"],[1,"bi","bi-arrow-repeat"],["title","Revocar",1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],[1,"table","table-hover","table-sm","align-middle","mb-0"],["scope","col",1,"border-0",2,"width","40px"],[1,"form-check","form-check-sm"],["type","checkbox","id","selectAll",1,"form-check-input",3,"change","checked","indeterminate"],["scope","col",1,"border-0","fw-medium"],["scope","col",1,"border-0","fw-medium","d-none","d-md-table-cell"],["scope","col",1,"border-0","fw-medium","d-none","d-lg-table-cell"],["scope","col",1,"border-0","fw-medium","d-none","d-xl-table-cell"],["scope","col",1,"border-0","text-center",2,"width","120px"],[3,"table-active","class"],[1,"bg-primary","bg-opacity-10","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","28px","height","28px"],[1,"min-w-0"],[1,"text-muted","small","text-truncate","d-md-none"],[1,"text-muted","small","d-md-none"],[1,"fw-medium","small","text-truncate",3,"title"],[1,"badge","text-bg-secondary","small"],[1,"bi","bi-file-earmark-text","me-1"],[1,"d-none","d-lg-inline","ms-1"],[1,"d-flex","gap-2","small"],[1,"badge","bg-body-secondary","text-body"],[1,"bi","bi-shield-check","me-1"],[1,"fw-medium"],[1,"text-muted"],[1,"border-0","text-center"],[1,"btn-group","btn-group-sm"],["containerClass","justify-content-between align-items-center",1,"mb-0",3,"pageChange","pageSizeChange","totalItems","pageSize","currentPage","showPageSizeSelector","pageSizeOptions","showGoToPage","showRangeInfo","showFirstLastButtons","maxVisiblePages","density"]],template:function(t,i){if(t&1){let a=_();n(0,"div",2)(1,"app-confirm-modal",3,0),f("accepted",function(){return u(a),p(i.onConfirmAccepted())})("cancelled",function(){return u(a),p(i.onConfirmCancelled())}),r(),n(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),d(7,"i",8),n(8,"span",9),l(9,"Inicio"),r()()(),n(10,"li",10),l(11,"Certificados"),r()()(),n(12,"div",11)(13,"div",12)(14,"h1",13),d(15,"i",14),n(16,"span",15),l(17,"Gesti\xF3n de Certificados"),r(),C(18,De,2,1,"span",16),r(),n(19,"p",17),l(20,"Administra los certificados del sistema"),r()(),n(21,"div",18)(22,"button",19),f("click",function(){return u(a),p(i.refreshData())}),C(23,Me,1,0,"span",20)(24,ke,1,0,"i",21),n(25,"span",22),l(26,"Actualizar"),r()(),n(27,"button",23),d(28,"i",24),n(29,"span",15),l(30,"Generar"),r()(),C(31,Pe,12,1,"div",25),r()(),n(32,"div",26)(33,"div",27)(34,"div",28)(35,"div",29)(36,"div",30),d(37,"i",31),n(38,"h6",32),l(39,"Filtros"),r()(),C(40,Ne,2,1,"span",33),r(),n(41,"div",34)(42,"button",35),f("click",function(){return u(a),p(i.toggleFiltersPanel())}),d(43,"i",36),r(),C(44,Ae,2,0,"button",37),r()()(),C(45,Be,56,66,"div",38),r(),n(46,"div",39)(47,"div",27)(48,"div",28)(49,"div",40)(50,"div",30),d(51,"i",41),n(52,"h6",32),l(53,"Certificados"),r()(),C(54,Ue,2,1,"span",42),n(55,"div",43)(56,"label",44),l(57,"Mostrar:"),r(),n(58,"select",45),f("change",function(y){return u(a),p(i.setPageSize(y.target.value))}),I(59,je,2,2,"option",46,z),r()()(),n(61,"div",47)(62,"input",48),f("change",function(){return u(a),p(i.setViewMode("cards"))}),r(),n(63,"label",49),d(64,"i",50),n(65,"span",51),l(66,"Tarjetas"),r()(),n(67,"input",52),f("change",function(){return u(a),p(i.setViewMode("table"))}),r(),n(68,"label",53),d(69,"i",54),n(70,"span",51),l(71,"Tabla"),r()()()()(),n(72,"div",55),C(73,Ye,19,10,"div",56)(74,nt,9,1,"div",57)(75,ot,5,1,"div",58)(76,gt,2,2),r(),C(77,Ct,2,10,"div",59),r()()}t&2&&(s(),g("title",i.confirmAction().title)("message",i.confirmAction().message)("confirmText",i.confirmAction().confirmText),s(17),h(i.totalItems()>0?18:-1),s(4),g("disabled",i.isLoading()),s(),h(i.isLoading()?23:24),s(8),h(i.certificates().length>0?31:-1),s(),D("border-primary",i.hasActiveFilters()),s(8),h(i.hasActiveFilters()?40:-1),s(2),g("title",i.showFilters()?"Ocultar filtros":"Mostrar filtros"),q("aria-expanded",i.showFilters()),s(),D("bi-chevron-up",i.showFilters())("bi-chevron-down",!i.showFilters()),s(),h(i.hasActiveFilters()?44:-1),s(),h(i.showFilters()?45:-1),s(9),h(i.totalItems()>0?54:-1),s(4),g("value",i.pageSize()),s(),F(i.pageSizeOptions),s(3),g("checked",i.viewMode()==="cards"),s(5),g("checked",i.viewMode()==="table"),s(6),h(i.errorState()?73:i.isLoading()?74:i.certificates().length===0?75:76),s(4),h(i.totalPages()>1?77:-1))},dependencies:[ee,ne,ie,he,ce,fe,ge,ae,pe,oe,le,de,me,ue,Ce,xe,ye,_e,Z],encapsulation:2,changeDetection:0})};export{Ie as CertificateListComponent};
