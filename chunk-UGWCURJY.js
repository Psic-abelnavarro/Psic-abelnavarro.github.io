import{b as U}from"./chunk-22IHSIXM.js";import{a as O}from"./chunk-W55XPYIR.js";import{a as B}from"./chunk-MPC7SZEK.js";import{a as v}from"./chunk-TMGCMHHJ.js";import"./chunk-IIPOJGOQ.js";import{f as L,h as F,i as P,l as N}from"./chunk-C3HOFUSH.js";import{Bb as h,Bc as A,Da as r,Fb as y,Gb as n,Hb as m,Ib as _,Jb as T,Na as D,Ob as I,Ra as R,Sb as V,_ as E,bb as g,cb as S,da as b,ea as x,hb as p,ia as w,ib as e,jb as t,kb as s,ma as C,rb as k,sb as f,ub as c,vc as M}from"./chunk-5W5GNUFO.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-FK42CRUA.js";var z=l=>["/eventos",l,"editar"];function H(l,a){if(l&1&&(e(0,"span",21),s(1,"i",59),n(2),t()),l&2){let i=c().ngIf;r(2),_(" ",i.eventType," ")}}function G(l,a){if(l&1&&(e(0,"p",34),n(1),t()),l&2){let i=c().ngIf;r(),m(i.shortDescription)}}function q(l,a){l&1&&(e(0,"p",35),n(1,"Sin descripci\xF3n disponible."),t())}function J(l,a){if(l&1&&(e(0,"span",42),n(1),t()),l&2){let i=c().ngIf;r(),_(" / ",i.maxParticipants," participantes")}}function K(l,a){l&1&&(e(0,"span",42),n(1," participantes"),t())}function Q(l,a){if(l&1&&(e(0,"div",57)(1,"div",60)(2,"div",61)(3,"div",62),n(4),t(),e(5,"div",63),n(6,"Total Inscripciones"),t()()(),e(7,"div",60)(8,"div",61)(9,"div",64),n(10),t(),e(11,"div",63),n(12,"Confirmadas"),t()()(),e(13,"div",60)(14,"div",61)(15,"div",65),n(16),t(),e(17,"div",63),n(18,"Asistieron"),t()()(),e(19,"div",60)(20,"div",61)(21,"div",66),n(22),t(),e(23,"div",63),n(24,"Asistencia"),t()()(),e(25,"div",67)(26,"div",61)(27,"div",68),n(28),t(),e(29,"div",63),n(30,"Certificados Emitidos"),t()()()()),l&2){let i=c(2);r(4),m(i.stats().totalRegistrations),r(6),m(i.stats().confirmedRegistrations),r(6),m(i.stats().attendedCount),r(6),_("",i.stats().attendanceRate,"%"),r(6),m(i.stats().certificatesIssued)}}function W(l,a){l&1&&(e(0,"div",58),s(1,"i",69),e(2,"p",70),n(3,"No hay estad\xEDsticas disponibles a\xFAn."),t()())}function X(l,a){if(l&1){let i=k();e(0,"div",2)(1,"app-confirm-modal",3,0),f("accepted",function(){b(i);let d=c();return x(d.onConfirmAccepted())})("cancelled",function(){b(i);let d=c();return x(d.onConfirmCancelled())}),t(),e(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),s(7,"i",8),e(8,"span",9),n(9,"Inicio"),t()()(),e(10,"li",6)(11,"a",10),n(12,"Eventos"),t()(),e(13,"li",11),n(14),t()()(),e(15,"div",12)(16,"div",13)(17,"h1",14),s(18,"i",15),e(19,"span",16),n(20),t()(),e(21,"div",17)(22,"span"),s(23,"i",18),n(24),t(),e(25,"span",19),s(26,"i",20),n(27),t(),g(28,H,3,1,"span",21),t()(),e(29,"div",22)(30,"a",23),s(31,"i",24),e(32,"span",16),n(33,"Editar"),t()(),e(34,"a",25),s(35,"i",26),e(36,"span",16),n(37,"Volver"),t()()()(),e(38,"div",27)(39,"div",28)(40,"div",29)(41,"div",30)(42,"h6",31),s(43,"i",32),n(44," Descripci\xF3n del Evento "),t()(),e(45,"div",33),g(46,G,2,1,"p",34)(47,q,2,0,"p",35),t()(),e(48,"div",36)(49,"div",30)(50,"h6",31),s(51,"i",37),n(52," Informaci\xF3n Detallada "),t()(),e(53,"div",33)(54,"dl",38)(55,"dt",39),n(56,"Tipo de evento:"),t(),e(57,"dd",40),n(58),t(),e(59,"dt",39),n(60,"Ubicaci\xF3n:"),t(),e(61,"dd",40),n(62),t(),e(63,"dt",39),n(64,"Capacidad:"),t(),e(65,"dd",40)(66,"span",41),n(67),t(),g(68,J,2,1,"span",42)(69,K,2,0,"span",42),t(),e(70,"dt",39),n(71,"Estado registro:"),t(),e(72,"dd",43)(73,"span"),n(74),t()(),e(75,"dt",39),n(76,"Costo:"),t(),e(77,"dd",44),n(78),t()()()()(),e(79,"div",45)(80,"div",29)(81,"div",30)(82,"h6",31),s(83,"i",46),n(84," Acciones del Evento "),t()(),e(85,"div",33)(86,"div",47)(87,"button",48),f("click",function(){b(i);let d=h(2),u=c();return x(u.openConfirm(d,"Publicar evento","\xBFDeseas publicar este evento?","publish"))}),s(88,"i",49),e(89,"span",16),n(90,"Publicar"),t()(),e(91,"button",50),f("click",function(){b(i);let d=h(2),u=c();return x(u.openConfirm(d,"Abrir inscripciones","\xBFAbrir inscripciones ahora?","open"))}),s(92,"i",51),e(93,"span",16),n(94,"Abrir Inscripciones"),t()(),e(95,"button",52),f("click",function(){b(i);let d=h(2),u=c();return x(u.openConfirm(d,"Cerrar inscripciones","\xBFCerrar inscripciones ahora?","close"))}),s(96,"i",53),e(97,"span",16),n(98,"Cerrar Inscripciones"),t()(),e(99,"button",54),f("click",function(){b(i);let d=h(2),u=c();return x(u.openConfirm(d,"Cancelar evento","Esta acci\xF3n no se puede deshacer. \xBFCancelar evento?","cancel"))}),s(100,"i",55),e(101,"span",16),n(102,"Cancelar Evento"),t()()()()(),e(103,"div",36)(104,"div",30)(105,"h6",31),s(106,"i",56),n(107," Estad\xEDsticas del Evento "),t()(),e(108,"div",33),g(109,Q,31,5,"div",57)(110,W,4,0,"div",58),t()()()()()}if(l&2){let i=a.ngIf,o=c();r(),p("title",o.confirmTitle)("message",o.confirmMessage),r(13),m(i.title),r(6),m(i.title),r(2),y(I("text-bg-",i.statusColor," small px-2 py-1 rounded")),r(2),_(" ",i.statusLabel," "),r(3),T(" ",i.startDate," \u2192 ",i.endDate," "),r(),S(i.eventType?28:-1),r(2),p("routerLink",V(27,z,i.id)),r(16),S(i.shortDescription?46:47),r(12),m(i.eventType),r(4),m(i.location),r(5),m(i.currentParticipants),r(),S(i.maxParticipants?68:69),r(5),y(I("text-bg-",i.registrationStatusColor," small px-2 py-1 rounded")),r(),_(" ",i.registrationStatusLabel," "),r(4),m(i.costLabel),r(9),p("disabled",!o.canPublish()),r(4),p("disabled",!o.canOpenReg()),r(4),p("disabled",!o.canCloseReg()),r(4),p("disabled",!o.canCancel()),r(10),S(o.stats()?109:110)}}var j=class l{route=E(L);router=E(F);destroyRef=E(w);eventService=E(U);eventId;eventVmSig=C(null);statsSig=C(null);confirmTitle="";confirmMessage="";pendingAction=null;ngOnInit(){this.route.paramMap.pipe(v(this.destroyRef)).subscribe(a=>{let i=a.get("id");if(!i){this.router.navigate(["/eventos"]);return}this.eventId=Number(i),this.load()})}load(){this.eventService.getEventById(this.eventId).pipe(v(this.destroyRef)).subscribe({next:a=>{let i=B.event.toCard(a);this.eventVmSig.set(i)},error:()=>this.router.navigate(["/eventos"])}),this.eventService.getEventStats(this.eventId).pipe(v(this.destroyRef)).subscribe(a=>this.statsSig.set(a))}event(){return this.eventVmSig()}stats(){return this.statsSig()}canPublish(){let a=this.eventVmSig();return!!a&&(a.status==="draft"||a.status==="published")}canOpenReg(){let a=this.eventVmSig();return!!a&&a.status==="published"}canCloseReg(){let a=this.eventVmSig();return!!a&&a.status==="reg_open"}canCancel(){let a=this.eventVmSig();return!!a&&a.status!=="cancelled"&&a.status!=="completed"}publish(){this.eventService.publishEvent(this.eventId).pipe(v(this.destroyRef)).subscribe(()=>this.load())}openReg(){this.eventService.openRegistrations(this.eventId).pipe(v(this.destroyRef)).subscribe(()=>this.load())}closeReg(){this.eventService.closeRegistrations(this.eventId).pipe(v(this.destroyRef)).subscribe(()=>this.load())}cancel(){this.eventService.changeEventStatus(this.eventId,"cancelled").pipe(v(this.destroyRef)).subscribe(()=>this.load())}openConfirm(a,i,o,d){this.confirmTitle=i,this.confirmMessage=o,this.pendingAction=d,a.show()}onConfirmAccepted(){switch(this.pendingAction){case"publish":this.publish();break;case"open":this.openReg();break;case"close":this.closeReg();break;case"cancel":this.cancel();break}this.pendingAction=null}onConfirmCancelled(){this.pendingAction=null}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=D({type:l,selectors:[["app-event-detail"]],decls:1,vars:1,consts:[["confirmModal",""],["class","container-fluid py-3",4,"ngIf"],[1,"container-fluid","py-3"],[3,"accepted","cancelled","title","message"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb","mb-0","small"],[1,"breadcrumb-item"],["routerLink","/",1,"text-decoration-none","link-primary"],[1,"bi","bi-house-door","me-1"],[1,"d-none","d-sm-inline"],["routerLink","/eventos",1,"text-decoration-none","link-primary"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","justify-content-between","gap-3","mb-4"],[1,"flex-grow-1"],[1,"h6","mb-2","fw-normal","d-flex","align-items-center"],[1,"bi","bi-calendar-event","me-2","text-primary"],[1,"small"],[1,"d-flex","flex-wrap","align-items-center","gap-2"],[1,"bi","bi-circle-fill","me-1",2,"font-size","0.6rem"],[1,"text-bg-light","small","px-2","py-1","rounded","text-dark"],[1,"bi","bi-calendar-date","me-1"],[1,"text-bg-info","small","px-2","py-1","rounded"],[1,"d-flex","flex-wrap","gap-2"],["title","Editar evento",1,"btn","btn-outline-primary","btn-sm",3,"routerLink"],[1,"bi","bi-pencil","me-1"],["routerLink","/eventos","title","Volver a lista",1,"btn","btn-outline-secondary","btn-sm"],[1,"bi","bi-arrow-left","me-1"],[1,"row","g-3"],[1,"col-12","col-lg-8"],[1,"card","border-0","shadow-sm","mb-3"],[1,"card-header","bg-light","border-0","py-2"],[1,"mb-0","fw-normal","small","d-flex","align-items-center"],[1,"bi","bi-file-text","me-1","text-primary"],[1,"card-body","py-3"],[1,"mb-0","fs-7","lh-base"],[1,"mb-0","text-muted","fs-8","fst-italic"],[1,"card","border-0","shadow-sm"],[1,"bi","bi-info-circle","me-1","text-primary"],[1,"row","mb-0","small"],[1,"col-12","col-sm-4","text-muted","fs-8","mb-1"],[1,"col-12","col-sm-8","mb-2","fw-normal"],[1,"text-success","fw-medium"],[1,"text-muted"],[1,"col-12","col-sm-8","mb-2"],[1,"col-12","col-sm-8","mb-0","fw-normal"],[1,"col-12","col-lg-4"],[1,"bi","bi-gear","me-1","text-primary"],[1,"d-grid","gap-2"],[1,"btn","btn-outline-success","btn-sm",3,"click","disabled"],[1,"bi","bi-megaphone","me-1"],[1,"btn","btn-outline-info","btn-sm",3,"click","disabled"],[1,"bi","bi-door-open","me-1"],[1,"btn","btn-outline-warning","btn-sm",3,"click","disabled"],[1,"bi","bi-door-closed","me-1"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],[1,"bi","bi-x-circle","me-1"],[1,"bi","bi-graph-up","me-1","text-primary"],[1,"row","g-2","text-center"],[1,"text-center","py-3"],[1,"bi","bi-tag","me-1"],[1,"col-6"],[1,"border","rounded","p-2","bg-light"],[1,"fw-medium","small","text-primary"],[1,"fs-8","text-muted"],[1,"fw-medium","small","text-success"],[1,"fw-medium","small","text-info"],[1,"fw-medium","small","text-warning"],[1,"col-12"],[1,"fw-medium","small","text-secondary"],[1,"bi","bi-graph-up","text-muted","mb-2",2,"font-size","2rem"],[1,"text-muted","fs-8","mb-0"]],template:function(i,o){i&1&&R(0,X,111,29,"div",1),i&2&&p("ngIf",o.event())},dependencies:[A,M,N,P,O],encapsulation:2})};export{j as EventDetailComponent};
