import{a as Ce}from"./chunk-FK6H3RFT.js";import{d as Se,h as jr}from"./chunk-FK42CRUA.js";var Yp=Se((Ry,Gp)=>{"use strict";Gp.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var ts=Se(Js=>{"use strict";var td,Av=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Js.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};Js.getSymbolTotalCodewords=function(t){return Av[t]};Js.getBCHDigit=function(s){let t=0;for(;s!==0;)t++,s>>>=1;return t};Js.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');td=t};Js.isKanjiModeEnabled=function(){return typeof td<"u"};Js.toSJIS=function(t){return td(t)}});var yl=Se(ln=>{"use strict";ln.L={bit:1};ln.M={bit:0};ln.Q={bit:3};ln.H={bit:2};function Lv(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return ln.L;case"m":case"medium":return ln.M;case"q":case"quartile":return ln.Q;case"h":case"high":return ln.H;default:throw new Error("Unknown EC Level: "+s)}}ln.isValid=function(t){return t&&typeof t.bit<"u"&&t.bit>=0&&t.bit<4};ln.from=function(t,e){if(ln.isValid(t))return t;try{return Lv(t)}catch{return e}}});var Jp=Se((Uy,Kp)=>{"use strict";function Xp(){this.buffer=[],this.length=0}Xp.prototype={get:function(s){let t=Math.floor(s/8);return(this.buffer[t]>>>7-s%8&1)===1},put:function(s,t){for(let e=0;e<t;e++)this.putBit((s>>>t-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(s){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),s&&(this.buffer[t]|=128>>>this.length%8),this.length++}};Kp.exports=Xp});var $p=Se((Wy,Zp)=>{"use strict";function lh(s){if(!s||s<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=s,this.data=new Uint8Array(s*s),this.reservedBit=new Uint8Array(s*s)}lh.prototype.set=function(s,t,e,r){let n=s*this.size+t;this.data[n]=e,r&&(this.reservedBit[n]=!0)};lh.prototype.get=function(s,t){return this.data[s*this.size+t]};lh.prototype.xor=function(s,t,e){this.data[s*this.size+t]^=e};lh.prototype.isReserved=function(s,t){return this.reservedBit[s*this.size+t]};Zp.exports=lh});var Qp=Se(bl=>{"use strict";var Tv=ts().getSymbolSize;bl.getRowColCoords=function(t){if(t===1)return[];let e=Math.floor(t/7)+2,r=Tv(t),n=r===145?26:Math.ceil((r-13)/(2*e-2))*2,i=[r-7];for(let o=1;o<e-1;o++)i[o]=i[o-1]-n;return i.push(6),i.reverse()};bl.getPositions=function(t){let e=[],r=bl.getRowColCoords(t),n=r.length;for(let i=0;i<n;i++)for(let o=0;o<n;o++)i===0&&o===0||i===0&&o===n-1||i===n-1&&o===0||e.push([r[i],r[o]]);return e}});var r1=Se(e1=>{"use strict";var Pv=ts().getSymbolSize,t1=7;e1.getPositions=function(t){let e=Pv(t);return[[0,0],[e-t1,0],[0,e-t1]]}});var n1=Se(Ne=>{"use strict";Ne.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var Zs={N1:3,N2:3,N3:40,N4:10};Ne.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7};Ne.from=function(t){return Ne.isValid(t)?parseInt(t,10):void 0};Ne.getPenaltyN1=function(t){let e=t.size,r=0,n=0,i=0,o=null,a=null;for(let h=0;h<e;h++){n=i=0,o=a=null;for(let l=0;l<e;l++){let f=t.get(h,l);f===o?n++:(n>=5&&(r+=Zs.N1+(n-5)),o=f,n=1),f=t.get(l,h),f===a?i++:(i>=5&&(r+=Zs.N1+(i-5)),a=f,i=1)}n>=5&&(r+=Zs.N1+(n-5)),i>=5&&(r+=Zs.N1+(i-5))}return r};Ne.getPenaltyN2=function(t){let e=t.size,r=0;for(let n=0;n<e-1;n++)for(let i=0;i<e-1;i++){let o=t.get(n,i)+t.get(n,i+1)+t.get(n+1,i)+t.get(n+1,i+1);(o===4||o===0)&&r++}return r*Zs.N2};Ne.getPenaltyN3=function(t){let e=t.size,r=0,n=0,i=0;for(let o=0;o<e;o++){n=i=0;for(let a=0;a<e;a++)n=n<<1&2047|t.get(o,a),a>=10&&(n===1488||n===93)&&r++,i=i<<1&2047|t.get(a,o),a>=10&&(i===1488||i===93)&&r++}return r*Zs.N3};Ne.getPenaltyN4=function(t){let e=0,r=t.data.length;for(let i=0;i<r;i++)e+=t.data[i];return Math.abs(Math.ceil(e*100/r/5)-10)*Zs.N4};function kv(s,t,e){switch(s){case Ne.Patterns.PATTERN000:return(t+e)%2===0;case Ne.Patterns.PATTERN001:return t%2===0;case Ne.Patterns.PATTERN010:return e%3===0;case Ne.Patterns.PATTERN011:return(t+e)%3===0;case Ne.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(e/3))%2===0;case Ne.Patterns.PATTERN101:return t*e%2+t*e%3===0;case Ne.Patterns.PATTERN110:return(t*e%2+t*e%3)%2===0;case Ne.Patterns.PATTERN111:return(t*e%3+(t+e)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}Ne.applyMask=function(t,e){let r=e.size;for(let n=0;n<r;n++)for(let i=0;i<r;i++)e.isReserved(i,n)||e.xor(i,n,kv(t,i,n))};Ne.getBestMask=function(t,e){let r=Object.keys(Ne.Patterns).length,n=0,i=1/0;for(let o=0;o<r;o++){e(o),Ne.applyMask(o,t);let a=Ne.getPenaltyN1(t)+Ne.getPenaltyN2(t)+Ne.getPenaltyN3(t)+Ne.getPenaltyN4(t);Ne.applyMask(o,t),a<i&&(i=a,n=o)}return n}});var rd=Se(ed=>{"use strict";var es=yl(),wl=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xl=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];ed.getBlocksCount=function(t,e){switch(e){case es.L:return wl[(t-1)*4+0];case es.M:return wl[(t-1)*4+1];case es.Q:return wl[(t-1)*4+2];case es.H:return wl[(t-1)*4+3];default:return}};ed.getTotalCodewordsCount=function(t,e){switch(e){case es.L:return xl[(t-1)*4+0];case es.M:return xl[(t-1)*4+1];case es.Q:return xl[(t-1)*4+2];case es.H:return xl[(t-1)*4+3];default:return}}});var i1=Se(Sl=>{"use strict";var uh=new Uint8Array(512),_l=new Uint8Array(256);(function(){let t=1;for(let e=0;e<255;e++)uh[e]=t,_l[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)uh[e]=uh[e-255]})();Sl.log=function(t){if(t<1)throw new Error("log("+t+")");return _l[t]};Sl.exp=function(t){return uh[t]};Sl.mul=function(t,e){return t===0||e===0?0:uh[_l[t]+_l[e]]}});var s1=Se(fh=>{"use strict";var nd=i1();fh.mul=function(t,e){let r=new Uint8Array(t.length+e.length-1);for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++)r[n+i]^=nd.mul(t[n],e[i]);return r};fh.mod=function(t,e){let r=new Uint8Array(t);for(;r.length-e.length>=0;){let n=r[0];for(let o=0;o<e.length;o++)r[o]^=nd.mul(e[o],n);let i=0;for(;i<r.length&&r[i]===0;)i++;r=r.slice(i)}return r};fh.generateECPolynomial=function(t){let e=new Uint8Array([1]);for(let r=0;r<t;r++)e=fh.mul(e,new Uint8Array([1,nd.exp(r)]));return e}});var h1=Se((Jy,a1)=>{"use strict";var o1=s1();function id(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}id.prototype.initialize=function(t){this.degree=t,this.genPoly=o1.generateECPolynomial(this.degree)};id.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");let e=new Uint8Array(t.length+this.degree);e.set(t);let r=o1.mod(e,this.genPoly),n=this.degree-r.length;if(n>0){let i=new Uint8Array(this.degree);return i.set(r,n),i}return r};a1.exports=id});var sd=Se(c1=>{"use strict";c1.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}});var od=Se(_i=>{"use strict";var l1="[0-9]+",Ov="[A-Z $%*+\\-./:]+",dh="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";dh=dh.replace(/u/g,"\\u");var Nv="(?:(?![A-Z0-9 $%*+\\-./:]|"+dh+`)(?:.|[\r
]))+`;_i.KANJI=new RegExp(dh,"g");_i.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");_i.BYTE=new RegExp(Nv,"g");_i.NUMERIC=new RegExp(l1,"g");_i.ALPHANUMERIC=new RegExp(Ov,"g");var Mv=new RegExp("^"+dh+"$"),Dv=new RegExp("^"+l1+"$"),Ev=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");_i.testKanji=function(t){return Mv.test(t)};_i.testNumeric=function(t){return Dv.test(t)};_i.testAlphanumeric=function(t){return Ev.test(t)}});var rs=Se(er=>{"use strict";var Fv=sd(),ad=od();er.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};er.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};er.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};er.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};er.MIXED={bit:-1};er.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!Fv.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]};er.getBestModeForData=function(t){return ad.testNumeric(t)?er.NUMERIC:ad.testAlphanumeric(t)?er.ALPHANUMERIC:ad.testKanji(t)?er.KANJI:er.BYTE};er.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")};er.isValid=function(t){return t&&t.bit&&t.ccBits};function jv(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return er.NUMERIC;case"alphanumeric":return er.ALPHANUMERIC;case"kanji":return er.KANJI;case"byte":return er.BYTE;default:throw new Error("Unknown mode: "+s)}}er.from=function(t,e){if(er.isValid(t))return t;try{return jv(t)}catch{return e}}});var p1=Se($s=>{"use strict";var Cl=ts(),Iv=rd(),u1=yl(),ns=rs(),hd=sd(),d1=7973,f1=Cl.getBCHDigit(d1);function Bv(s,t,e){for(let r=1;r<=40;r++)if(t<=$s.getCapacity(r,e,s))return r}function g1(s,t){return ns.getCharCountIndicator(s,t)+4}function Rv(s,t){let e=0;return s.forEach(function(r){let n=g1(r.mode,t);e+=n+r.getBitsLength()}),e}function qv(s,t){for(let e=1;e<=40;e++)if(Rv(s,e)<=$s.getCapacity(e,t,ns.MIXED))return e}$s.from=function(t,e){return hd.isValid(t)?parseInt(t,10):e};$s.getCapacity=function(t,e,r){if(!hd.isValid(t))throw new Error("Invalid QR Code version");typeof r>"u"&&(r=ns.BYTE);let n=Cl.getSymbolTotalCodewords(t),i=Iv.getTotalCodewordsCount(t,e),o=(n-i)*8;if(r===ns.MIXED)return o;let a=o-g1(r,t);switch(r){case ns.NUMERIC:return Math.floor(a/10*3);case ns.ALPHANUMERIC:return Math.floor(a/11*2);case ns.KANJI:return Math.floor(a/13);case ns.BYTE:default:return Math.floor(a/8)}};$s.getBestVersionForData=function(t,e){let r,n=u1.from(e,u1.M);if(Array.isArray(t)){if(t.length>1)return qv(t,n);if(t.length===0)return 1;r=t[0]}else r=t;return Bv(r.mode,r.getLength(),n)};$s.getEncodedBits=function(t){if(!hd.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;Cl.getBCHDigit(e)-f1>=0;)e^=d1<<Cl.getBCHDigit(e)-f1;return t<<12|e}});var b1=Se(y1=>{"use strict";var cd=ts(),v1=1335,zv=21522,m1=cd.getBCHDigit(v1);y1.getEncodedBits=function(t,e){let r=t.bit<<3|e,n=r<<10;for(;cd.getBCHDigit(n)-m1>=0;)n^=v1<<cd.getBCHDigit(n)-m1;return(r<<10|n)^zv}});var x1=Se((rb,w1)=>{"use strict";var Uv=rs();function sa(s){this.mode=Uv.NUMERIC,this.data=s.toString()}sa.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};sa.prototype.getLength=function(){return this.data.length};sa.prototype.getBitsLength=function(){return sa.getBitsLength(this.data.length)};sa.prototype.write=function(t){let e,r,n;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),n=parseInt(r,10),t.put(n,10);let i=this.data.length-e;i>0&&(r=this.data.substr(e),n=parseInt(r,10),t.put(n,i*3+1))};w1.exports=sa});var S1=Se((nb,_1)=>{"use strict";var Wv=rs(),ld=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function oa(s){this.mode=Wv.ALPHANUMERIC,this.data=s}oa.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};oa.prototype.getLength=function(){return this.data.length};oa.prototype.getBitsLength=function(){return oa.getBitsLength(this.data.length)};oa.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let r=ld.indexOf(this.data[e])*45;r+=ld.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(ld.indexOf(this.data[e]),6)};_1.exports=oa});var A1=Se((ib,C1)=>{"use strict";var Vv=rs();function aa(s){this.mode=Vv.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}aa.getBitsLength=function(t){return t*8};aa.prototype.getLength=function(){return this.data.length};aa.prototype.getBitsLength=function(){return aa.getBitsLength(this.data.length)};aa.prototype.write=function(s){for(let t=0,e=this.data.length;t<e;t++)s.put(this.data[t],8)};C1.exports=aa});var T1=Se((sb,L1)=>{"use strict";var Hv=rs(),Gv=ts();function ha(s){this.mode=Hv.KANJI,this.data=s}ha.getBitsLength=function(t){return t*13};ha.prototype.getLength=function(){return this.data.length};ha.prototype.getBitsLength=function(){return ha.getBitsLength(this.data.length)};ha.prototype.write=function(s){let t;for(t=0;t<this.data.length;t++){let e=Gv.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),s.put(e,13)}};L1.exports=ha});var P1=Se((ob,ud)=>{"use strict";var gh={single_source_shortest_paths:function(s,t,e){var r={},n={};n[t]=0;var i=gh.PriorityQueue.make();i.push(t,0);for(var o,a,h,l,f,p,v,g,b;!i.empty();){o=i.pop(),a=o.value,l=o.cost,f=s[a]||{};for(h in f)f.hasOwnProperty(h)&&(p=f[h],v=l+p,g=n[h],b=typeof n[h]>"u",(b||g>v)&&(n[h]=v,i.push(h,v),r[h]=a))}if(typeof e<"u"&&typeof n[e]>"u"){var w=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(w)}return r},extract_shortest_path_from_predecessor_list:function(s,t){for(var e=[],r=t,n;r;)e.push(r),n=s[r],r=s[r];return e.reverse(),e},find_path:function(s,t,e){var r=gh.single_source_shortest_paths(s,t,e);return gh.extract_shortest_path_from_predecessor_list(r,e)},PriorityQueue:{make:function(s){var t=gh.PriorityQueue,e={},r;s=s||{};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e.queue=[],e.sorter=s.sorter||t.default_sorter,e},default_sorter:function(s,t){return s.cost-t.cost},push:function(s,t){var e={value:s,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof ud<"u"&&(ud.exports=gh)});var j1=Se(ca=>{"use strict";var ye=rs(),N1=x1(),M1=S1(),D1=A1(),E1=T1(),ph=od(),Al=ts(),Yv=P1();function k1(s){return unescape(encodeURIComponent(s)).length}function mh(s,t,e){let r=[],n;for(;(n=s.exec(e))!==null;)r.push({data:n[0],index:n.index,mode:t,length:n[0].length});return r}function F1(s){let t=mh(ph.NUMERIC,ye.NUMERIC,s),e=mh(ph.ALPHANUMERIC,ye.ALPHANUMERIC,s),r,n;return Al.isKanjiModeEnabled()?(r=mh(ph.BYTE,ye.BYTE,s),n=mh(ph.KANJI,ye.KANJI,s)):(r=mh(ph.BYTE_KANJI,ye.BYTE,s),n=[]),t.concat(e,r,n).sort(function(o,a){return o.index-a.index}).map(function(o){return{data:o.data,mode:o.mode,length:o.length}})}function fd(s,t){switch(t){case ye.NUMERIC:return N1.getBitsLength(s);case ye.ALPHANUMERIC:return M1.getBitsLength(s);case ye.KANJI:return E1.getBitsLength(s);case ye.BYTE:return D1.getBitsLength(s)}}function Xv(s){return s.reduce(function(t,e){let r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)},[])}function Kv(s){let t=[];for(let e=0;e<s.length;e++){let r=s[e];switch(r.mode){case ye.NUMERIC:t.push([r,{data:r.data,mode:ye.ALPHANUMERIC,length:r.length},{data:r.data,mode:ye.BYTE,length:r.length}]);break;case ye.ALPHANUMERIC:t.push([r,{data:r.data,mode:ye.BYTE,length:r.length}]);break;case ye.KANJI:t.push([r,{data:r.data,mode:ye.BYTE,length:k1(r.data)}]);break;case ye.BYTE:t.push([{data:r.data,mode:ye.BYTE,length:k1(r.data)}])}}return t}function Jv(s,t){let e={},r={start:{}},n=["start"];for(let i=0;i<s.length;i++){let o=s[i],a=[];for(let h=0;h<o.length;h++){let l=o[h],f=""+i+h;a.push(f),e[f]={node:l,lastCount:0},r[f]={};for(let p=0;p<n.length;p++){let v=n[p];e[v]&&e[v].node.mode===l.mode?(r[v][f]=fd(e[v].lastCount+l.length,l.mode)-fd(e[v].lastCount,l.mode),e[v].lastCount+=l.length):(e[v]&&(e[v].lastCount=l.length),r[v][f]=fd(l.length,l.mode)+4+ye.getCharCountIndicator(l.mode,t))}}n=a}for(let i=0;i<n.length;i++)r[n[i]].end=0;return{map:r,table:e}}function O1(s,t){let e,r=ye.getBestModeForData(s);if(e=ye.from(t,r),e!==ye.BYTE&&e.bit<r.bit)throw new Error('"'+s+'" cannot be encoded with mode '+ye.toString(e)+`.
 Suggested mode is: `+ye.toString(r));switch(e===ye.KANJI&&!Al.isKanjiModeEnabled()&&(e=ye.BYTE),e){case ye.NUMERIC:return new N1(s);case ye.ALPHANUMERIC:return new M1(s);case ye.KANJI:return new E1(s);case ye.BYTE:return new D1(s)}}ca.fromArray=function(t){return t.reduce(function(e,r){return typeof r=="string"?e.push(O1(r,null)):r.data&&e.push(O1(r.data,r.mode)),e},[])};ca.fromString=function(t,e){let r=F1(t,Al.isKanjiModeEnabled()),n=Kv(r),i=Jv(n,e),o=Yv.find_path(i.map,"start","end"),a=[];for(let h=1;h<o.length-1;h++)a.push(i.table[o[h]].node);return ca.fromArray(Xv(a))};ca.rawSplit=function(t){return ca.fromArray(F1(t,Al.isKanjiModeEnabled()))}});var B1=Se(I1=>{"use strict";var Tl=ts(),dd=yl(),Zv=Jp(),$v=$p(),Qv=Qp(),ty=r1(),md=n1(),vd=rd(),ey=h1(),Ll=p1(),ry=b1(),ny=rs(),gd=j1();function iy(s,t){let e=s.size,r=ty.getPositions(t);for(let n=0;n<r.length;n++){let i=r[n][0],o=r[n][1];for(let a=-1;a<=7;a++)if(!(i+a<=-1||e<=i+a))for(let h=-1;h<=7;h++)o+h<=-1||e<=o+h||(a>=0&&a<=6&&(h===0||h===6)||h>=0&&h<=6&&(a===0||a===6)||a>=2&&a<=4&&h>=2&&h<=4?s.set(i+a,o+h,!0,!0):s.set(i+a,o+h,!1,!0))}}function sy(s){let t=s.size;for(let e=8;e<t-8;e++){let r=e%2===0;s.set(e,6,r,!0),s.set(6,e,r,!0)}}function oy(s,t){let e=Qv.getPositions(t);for(let r=0;r<e.length;r++){let n=e[r][0],i=e[r][1];for(let o=-2;o<=2;o++)for(let a=-2;a<=2;a++)o===-2||o===2||a===-2||a===2||o===0&&a===0?s.set(n+o,i+a,!0,!0):s.set(n+o,i+a,!1,!0)}}function ay(s,t){let e=s.size,r=Ll.getEncodedBits(t),n,i,o;for(let a=0;a<18;a++)n=Math.floor(a/3),i=a%3+e-8-3,o=(r>>a&1)===1,s.set(n,i,o,!0),s.set(i,n,o,!0)}function pd(s,t,e){let r=s.size,n=ry.getEncodedBits(t,e),i,o;for(i=0;i<15;i++)o=(n>>i&1)===1,i<6?s.set(i,8,o,!0):i<8?s.set(i+1,8,o,!0):s.set(r-15+i,8,o,!0),i<8?s.set(8,r-i-1,o,!0):i<9?s.set(8,15-i-1+1,o,!0):s.set(8,15-i-1,o,!0);s.set(r-8,8,1,!0)}function hy(s,t){let e=s.size,r=-1,n=e-1,i=7,o=0;for(let a=e-1;a>0;a-=2)for(a===6&&a--;;){for(let h=0;h<2;h++)if(!s.isReserved(n,a-h)){let l=!1;o<t.length&&(l=(t[o]>>>i&1)===1),s.set(n,a-h,l),i--,i===-1&&(o++,i=7)}if(n+=r,n<0||e<=n){n-=r,r=-r;break}}}function cy(s,t,e){let r=new Zv;e.forEach(function(h){r.put(h.mode.bit,4),r.put(h.getLength(),ny.getCharCountIndicator(h.mode,s)),h.write(r)});let n=Tl.getSymbolTotalCodewords(s),i=vd.getTotalCodewordsCount(s,t),o=(n-i)*8;for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);let a=(o-r.getLengthInBits())/8;for(let h=0;h<a;h++)r.put(h%2?17:236,8);return ly(r,s,t)}function ly(s,t,e){let r=Tl.getSymbolTotalCodewords(t),n=vd.getTotalCodewordsCount(t,e),i=r-n,o=vd.getBlocksCount(t,e),a=r%o,h=o-a,l=Math.floor(r/o),f=Math.floor(i/o),p=f+1,v=l-f,g=new ey(v),b=0,w=new Array(o),C=new Array(o),x=0,k=new Uint8Array(s.buffer);for(let J=0;J<o;J++){let F=J<h?f:p;w[J]=k.slice(b,b+F),C[J]=g.encode(w[J]),b+=F,x=Math.max(x,F)}let I=new Uint8Array(r),G=0,U,nt;for(U=0;U<x;U++)for(nt=0;nt<o;nt++)U<w[nt].length&&(I[G++]=w[nt][U]);for(U=0;U<v;U++)for(nt=0;nt<o;nt++)I[G++]=C[nt][U];return I}function uy(s,t,e,r){let n;if(Array.isArray(s))n=gd.fromArray(s);else if(typeof s=="string"){let l=t;if(!l){let f=gd.rawSplit(s);l=Ll.getBestVersionForData(f,e)}n=gd.fromString(s,l||40)}else throw new Error("Invalid data");let i=Ll.getBestVersionForData(n,e);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);let o=cy(t,e,n),a=Tl.getSymbolSize(t),h=new $v(a);return iy(h,t),sy(h),oy(h,t),pd(h,e,0),t>=7&&ay(h,t),hy(h,o),isNaN(r)&&(r=md.getBestMask(h,pd.bind(null,h,e))),md.applyMask(r,h),pd(h,e,r),{modules:h,version:t,errorCorrectionLevel:e,maskPattern:r,segments:n}}I1.create=function(t,e){if(typeof t>"u"||t==="")throw new Error("No input text");let r=dd.M,n,i;return typeof e<"u"&&(r=dd.from(e.errorCorrectionLevel,dd.M),n=Ll.from(e.version),i=md.from(e.maskPattern),e.toSJISFunc&&Tl.setToSJISFunction(e.toSJISFunc)),uy(t,n,r,i)}});var yd=Se(Qs=>{"use strict";function R1(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let t=s.slice().replace("#","").split("");if(t.length<3||t.length===5||t.length>8)throw new Error("Invalid hex color: "+s);(t.length===3||t.length===4)&&(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),t.length===6&&t.push("F","F");let e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:e&255,hex:"#"+t.slice(0,6).join("")}}Qs.getOptions=function(t){t||(t={}),t.color||(t.color={});let e=typeof t.margin>"u"||t.margin===null||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,n=t.scale||4;return{width:r,scale:r?4:n,margin:e,color:{dark:R1(t.color.dark||"#000000ff"),light:R1(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}};Qs.getScale=function(t,e){return e.width&&e.width>=t+e.margin*2?e.width/(t+e.margin*2):e.scale};Qs.getImageWidth=function(t,e){let r=Qs.getScale(t,e);return Math.floor((t+e.margin*2)*r)};Qs.qrToImageData=function(t,e,r){let n=e.modules.size,i=e.modules.data,o=Qs.getScale(n,r),a=Math.floor((n+r.margin*2)*o),h=r.margin*o,l=[r.color.light,r.color.dark];for(let f=0;f<a;f++)for(let p=0;p<a;p++){let v=(f*a+p)*4,g=r.color.light;if(f>=h&&p>=h&&f<a-h&&p<a-h){let b=Math.floor((f-h)/o),w=Math.floor((p-h)/o);g=l[i[b*n+w]?1:0]}t[v++]=g.r,t[v++]=g.g,t[v++]=g.b,t[v]=g.a}}});var q1=Se(Pl=>{"use strict";var bd=yd();function fy(s,t,e){s.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=e,t.width=e,t.style.height=e+"px",t.style.width=e+"px"}function dy(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}Pl.render=function(t,e,r){let n=r,i=e;typeof n>"u"&&(!e||!e.getContext)&&(n=e,e=void 0),e||(i=dy()),n=bd.getOptions(n);let o=bd.getImageWidth(t.modules.size,n),a=i.getContext("2d"),h=a.createImageData(o,o);return bd.qrToImageData(h.data,t,n),fy(a,i,o),a.putImageData(h,0,0),i};Pl.renderToDataURL=function(t,e,r){let n=r;typeof n>"u"&&(!e||!e.getContext)&&(n=e,e=void 0),n||(n={});let i=Pl.render(t,e,n),o=n.type||"image/png",a=n.rendererOpts||{};return i.toDataURL(o,a.quality)}});var W1=Se(U1=>{"use strict";var gy=yd();function z1(s,t){let e=s.a/255,r=t+'="'+s.hex+'"';return e<1?r+" "+t+'-opacity="'+e.toFixed(2).slice(1)+'"':r}function wd(s,t,e){let r=s+t;return typeof e<"u"&&(r+=" "+e),r}function py(s,t,e){let r="",n=0,i=!1,o=0;for(let a=0;a<s.length;a++){let h=Math.floor(a%t),l=Math.floor(a/t);!h&&!i&&(i=!0),s[a]?(o++,a>0&&h>0&&s[a-1]||(r+=i?wd("M",h+e,.5+l+e):wd("m",n,0),n=0,i=!1),h+1<t&&s[a+1]||(r+=wd("h",o),o=0)):n++}return r}U1.render=function(t,e,r){let n=gy.getOptions(e),i=t.modules.size,o=t.modules.data,a=i+n.margin*2,h=n.color.light.a?"<path "+z1(n.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",l="<path "+z1(n.color.dark,"stroke")+' d="'+py(o,i,n.margin)+'"/>',f='viewBox="0 0 '+a+" "+a+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+f+' shape-rendering="crispEdges">'+h+l+`</svg>
`;return typeof r=="function"&&r(null,v),v}});var yy=Se(vh=>{"use strict";var my=Yp(),xd=B1(),V1=q1(),vy=W1();function _d(s,t,e,r,n){let i=[].slice.call(arguments,1),o=i.length,a=typeof i[o-1]=="function";if(!a&&!my())throw new Error("Callback required as last argument");if(a){if(o<2)throw new Error("Too few arguments provided");o===2?(n=e,e=t,t=r=void 0):o===3&&(t.getContext&&typeof n>"u"?(n=r,r=void 0):(n=r,r=e,e=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(e=t,t=r=void 0):o===2&&!t.getContext&&(r=e,e=t,t=void 0),new Promise(function(h,l){try{let f=xd.create(e,r);h(s(f,t,r))}catch(f){l(f)}})}try{let h=xd.create(e,r);n(null,s(h,t,r))}catch(h){n(h)}}vh.create=xd.create;vh.toCanvas=_d.bind(null,V1.render);vh.toDataURL=_d.bind(null,V1.renderToDataURL);vh.toString=_d.bind(null,function(s,t,e){return vy.render(s,e)})});function W(s,t,e){return(t=function(r){var n=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var h=a.call(i,o||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(r,"string");return typeof n=="symbol"?n:n+""}(t))in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}function Zd(s,t){var e=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),e.push.apply(e,r)}return e}function X(s){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Zd(Object(e),!0).forEach(function(r){W(s,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(e)):Zd(Object(e)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(e,r))})}return s}function De(s,t){if(s==null)return{};var e,r,n=function(o,a){if(o==null)return{};var h={};for(var l in o)if({}.hasOwnProperty.call(o,l)){if(a.indexOf(l)>=0)continue;h[l]=o[l]}return h}(s,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(r=0;r<i.length;r++)e=i[r],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(s,e)&&(n[e]=s[e])}return n}function Jn(s,t){return t||(t=s.slice(0)),Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(t)}}))}var vc=class{constructor(){W(this,"browserShadowBlurConstant",1),W(this,"DPI",96),W(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),W(this,"perfLimitSizeTotal",2097152),W(this,"maxCacheSideLimit",4096),W(this,"minCacheSideLimit",256),W(this,"disableStyleCopyPaste",!1),W(this,"enableGLFiltering",!0),W(this,"textureSize",4096),W(this,"forceGLPutImageData",!1),W(this,"cachesBoundsOfCurve",!1),W(this,"fontPaths",{}),W(this,"NUM_FRACTION_DIGITS",4)}},ue=new class extends vc{constructor(s){super(),this.configure(s)}configure(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,s)}addFonts(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=X(X({},this.fontPaths),s)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(s=>{delete this.fontPaths[s]})}clearFonts(){this.fontPaths={}}restoreDefaults(s){let t=new vc,e=s?.reduce((r,n)=>(r[n]=t[n],r),{})||t;this.configure(e)}},Hi=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return console[s]("fabric",...e)},cn=class extends Error{constructor(t,e){super("fabric: ".concat(t),e)}},yc=class extends cn{constructor(t){super("".concat(t," 'options.signal' is in 'aborted' state"))}},ku=class{},Ou=class extends ku{testPrecision(t,e){let r="precision ".concat(e,` float;
void main(){}`),n=t.createShader(t.FRAGMENT_SHADER);return!!n&&(t.shaderSource(n,r),t.compileShader(n),!!t.getShaderParameter(n,t.COMPILE_STATUS))}queryWebGL(t){let e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(e,r)),e.getExtension("WEBGL_lose_context").loseContext(),Hi("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}},P2={},$d;var Yn=()=>$d||($d={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Ou,dispose(){},copyPasteData:P2}),Go=()=>Yn().document,rh=()=>Yn().window,Dg=()=>{var s;return Math.max((s=ue.devicePixelRatio)!==null&&s!==void 0?s:rh().devicePixelRatio,1)},Va=new class{constructor(){W(this,"charWidthsCache",{}),W(this,"boundsOfCurveCache",{})}getFontCache(s){let{fontFamily:t,fontStyle:e,fontWeight:r}=s;t=t.toLowerCase(),this.charWidthsCache[t]||(this.charWidthsCache[t]={});let n=this.charWidthsCache[t],i="".concat(e.toLowerCase(),"_").concat((r+"").toLowerCase());return n[i]||(n[i]={}),n[i]}clearFontCache(s){(s=(s||"").toLowerCase())?this.charWidthsCache[s]&&delete this.charWidthsCache[s]:this.charWidthsCache={}}limitDimsByArea(s){let{perfLimitSizeTotal:t}=ue,e=Math.sqrt(t*s);return[Math.floor(e),Math.floor(t/e)]}},Nu="6.7.1";function js(){}var Gi=Math.PI/2,vi=2*Math.PI,hf=Math.PI/180,Pr=Object.freeze([1,0,0,1,0,0]),cf=16,Ii=.4477152502,ie="center",ve="left",Ir="top",Mu="bottom",Ge="right",Br="none",lf=/\r?\n/,Eg="moving",Gc="scaling",Fg="rotating",uf="rotate",jg="skewing",Ja="resizing",Ig="modifyPoly",k2="modifyPath",bc="changed",Yc="scale",kr="scaleX",Xr="scaleY",Yo="skewX",Xo="skewY",ir="fill",Rr="stroke",wc="modified",Oo="json",vu="svg",Bt=new class{constructor(){this[Oo]=new Map,this[vu]=new Map}has(s){return this[Oo].has(s)}getClass(s){let t=this[Oo].get(s);if(!t)throw new cn("No class registered for ".concat(s));return t}setClass(s,t){t?this[Oo].set(t,s):(this[Oo].set(s.type,s),this[Oo].set(s.type.toLowerCase(),s))}getSVGClass(s){return this[vu].get(s)}setSVGClass(s,t){this[vu].set(t??s.type.toLowerCase(),s)}},xc=new class extends Array{remove(s){let t=this.indexOf(s);t>-1&&this.splice(t,1)}cancelAll(){let s=this.splice(0);return s.forEach(t=>t.abort()),s}cancelByCanvas(s){if(!s)return[];let t=this.filter(e=>{var r;return e.target===s||typeof e.target=="object"&&((r=e.target)===null||r===void 0?void 0:r.canvas)===s});return t.forEach(e=>e.abort()),t}cancelByTarget(s){if(!s)return[];let t=this.filter(e=>e.target===s);return t.forEach(e=>e.abort()),t}},Du=class{constructor(){W(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach(r=>{let[n,i]=r;this.on(n,i)}),()=>this.off(t);if(e){let r=t;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(e),()=>this.off(r,e)}return()=>!1}once(t,e){if(typeof t=="object"){let r=[];return Object.entries(t).forEach(n=>{let[i,o]=n;r.push(this.once(i,o))}),()=>r.forEach(n=>n())}if(e){let r=this.on(t,function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];e.call(this,...i),r()});return r}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){let r=this.__eventListeners[t],n=r.indexOf(e);n>-1&&r.splice(n,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(let r in this.__eventListeners)this._removeEventListener(r);else typeof t=="object"?Object.entries(t).forEach(r=>{let[n,i]=r;this._removeEventListener(n,i)}):this._removeEventListener(t,e)}fire(t,e){var r;if(!this.__eventListeners)return;let n=(r=this.__eventListeners[t])===null||r===void 0?void 0:r.concat();if(n)for(let i=0;i<n.length;i++)n[i].call(this,e||{})}},vs=(s,t)=>{let e=s.indexOf(t);return e!==-1&&s.splice(e,1),s},Ln=s=>{if(s===0)return 1;switch(Math.abs(s)/Gi){case 1:case 3:return 0;case 2:return-1}return Math.cos(s)},Tn=s=>{if(s===0)return 0;let t=s/Gi,e=Math.sign(s);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(s)},ft=class s{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new s(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new s(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new s(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new s(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new s(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new s(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new s(this.x/t.x,this.y/t.y)}scalarDivide(t){return new s(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new s(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){let e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}midPointFrom(t){return this.lerp(t)}min(t){return new s(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new s(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){let e=this.x,r=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=r}clone(){return new s(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ff,r=Tn(t),n=Ln(t),i=this.subtract(e);return new s(i.x*n-i.y*r,i.x*r+i.y*n).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new s(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}},ff=new ft(0,0),pc=s=>!!s&&Array.isArray(s._objects);function Bg(s){class t extends s{constructor(){super(...arguments),W(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];let o=this._objects.push(...n);return n.forEach(a=>this._onObjectAdded(a)),o}insertAt(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return this._objects.splice(r,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){let r=this._objects,n=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(h=>{let l=r.indexOf(h);l!==-1&&(r.splice(l,1),n.push(h),this._onObjectRemoved(h))}),n}forEachObject(r){this.getObjects().forEach((n,i,o)=>r(n,i,o))}getObjects(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...n))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,n){return!!this._objects.includes(r)||!!n&&this._objects.some(i=>i instanceof t&&i.contains(r,!0))}complexity(){return this._objects.reduce((r,n)=>r+=n.complexity?n.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(vs(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(vs(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,n){if(!r)return!1;let i=this._objects.indexOf(r);if(i!==0){let o=this.findNewLowerIndex(r,i,n);return vs(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,n){if(!r)return!1;let i=this._objects.indexOf(r);if(i!==this._objects.length-1){let o=this.findNewUpperIndex(r,i,n);return vs(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,n){return r!==this._objects[n]&&(vs(this._objects,r),this._objects.splice(n,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,n,i){let o;if(i){o=n;for(let a=n-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=n-1;return o}findNewUpperIndex(r,n,i){let o;if(i){o=n;for(let a=n+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=n+1;return o}collectObjects(r){let{left:n,top:i,width:o,height:a}=r,{includeIntersecting:h=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[],f=new ft(n,i),p=f.add(new ft(o,a));for(let v=this._objects.length-1;v>=0;v--){let g=this._objects[v];g.selectable&&g.visible&&(h&&g.intersectsWithRect(f,p)||g.isContainedWithinRect(f,p)||h&&g.containsPoint(f)||h&&g.containsPoint(p))&&l.push(g)}return l}}return t}var _c=class extends Du{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let e in t)this.set(e,t[e])}_setObject(t){for(let e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){let e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}};function Ha(s){return rh().requestAnimationFrame(s)}function Rg(s){return rh().cancelAnimationFrame(s)}var O2=0,Yi=()=>O2++,Xn=()=>{let s=Go().createElement("canvas");if(!s||s.getContext===void 0)throw new cn("Failed to create `canvas` element");return s},qg=()=>Go().createElement("img"),Kr=s=>{let t=Xn();return t.width=s.width,t.height=s.height,t},df=(s,t,e)=>s.toDataURL("image/".concat(t),e),gf=(s,t,e)=>new Promise((r,n)=>{s.toBlob(r,"image/".concat(t),e)}),Re=s=>s*hf,Kn=s=>s/hf,zg=s=>s.every((t,e)=>t===Pr[e]),mr=(s,t,e)=>new ft(s).transform(t,e),Yr=s=>{let t=1/(s[0]*s[3]-s[1]*s[2]),e=[t*s[3],-t*s[1],-t*s[2],t*s[0],0,0],{x:r,y:n}=new ft(s[4],s[5]).transform(e,!0);return e[4]=-r,e[5]=-n,e},qe=(s,t,e)=>[s[0]*t[0]+s[2]*t[1],s[1]*t[0]+s[3]*t[1],s[0]*t[2]+s[2]*t[3],s[1]*t[2]+s[3]*t[3],e?0:s[0]*t[4]+s[2]*t[5]+s[4],e?0:s[1]*t[4]+s[3]*t[5]+s[5]],Xc=(s,t)=>s.reduceRight((e,r)=>r&&e?qe(r,e,t):r||e,void 0)||Pr.concat(),Ug=s=>{let[t,e]=s;return Math.atan2(e,t)},zo=s=>{let t=Ug(s),e=Math.pow(s[0],2)+Math.pow(s[1],2),r=Math.sqrt(e),n=(s[0]*s[3]-s[2]*s[1])/r,i=Math.atan2(s[0]*s[2]+s[1]*s[3],e);return{angle:Kn(t),scaleX:r,scaleY:n,skewX:Kn(i),skewY:0,translateX:s[4]||0,translateY:s[5]||0}},Ko=function(s){return[1,0,0,1,s,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Us(){let{angle:s=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Re(s),n=Ln(r),i=Tn(r);return[n,i,-i,n,t?t-(n*t-i*e):0,e?e-(i*t+n*e):0]}var Kc=function(s){return[s,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,0,0]},Wg=s=>Math.tan(Re(s)),pf=s=>[1,0,Wg(s),1,0,0],mf=s=>[1,Wg(s),0,1,0,0],nh=s=>{let{scaleX:t=1,scaleY:e=1,flipX:r=!1,flipY:n=!1,skewX:i=0,skewY:o=0}=s,a=Kc(r?-t:t,n?-e:e);return i&&(a=qe(a,pf(i),!0)),o&&(a=qe(a,mf(o),!0)),a},Vg=s=>{let{translateX:t=0,translateY:e=0,angle:r=0}=s,n=Ko(t,e);r&&(n=qe(n,Us({angle:r})));let i=nh(s);return zg(i)||(n=qe(n,i)),n},Ga=function(s){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,n){if(t&&t.aborted)return n(new yc("loadImage"));let i=qg(),o;t&&(o=function(h){i.src="",n(h)},t.addEventListener("abort",o,{once:!0}));let a=function(){i.onload=i.onerror=null,o&&t?.removeEventListener("abort",o),r(i)};s?(i.onload=a,i.onerror=function(){o&&t?.removeEventListener("abort",o),n(new cn("Error loading ".concat(i.src)))},e&&(i.crossOrigin=e),i.src=s):a()})},Uo=function(s){let{signal:t,reviver:e=js}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,n)=>{let i=[];t&&t.addEventListener("abort",n,{once:!0}),Promise.all(s.map(o=>Bt.getClass(o.type).fromObject(o,{signal:t}).then(a=>(e(o,a),i.push(a),a)))).then(r).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),n(o)}).finally(()=>{t&&t.removeEventListener("abort",n)})})},ih=function(s){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((e,r)=>{let n=[];t&&t.addEventListener("abort",r,{once:!0});let i=Object.values(s).map(a=>a&&a.type&&Bt.has(a.type)?Uo([a],{signal:t}).then(h=>{let[l]=h;return n.push(l),l}):a),o=Object.keys(s);Promise.all(i).then(a=>a.reduce((h,l,f)=>(h[o[f]]=l,h),{})).then(e).catch(a=>{n.forEach(h=>{h.dispose&&h.dispose()}),r(a)}).finally(()=>{t&&t.removeEventListener("abort",r)})})},Ws=function(s){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((t,e)=>(e in s&&(t[e]=s[e]),t),{})},vf=(s,t)=>Object.keys(s).reduce((e,r)=>(t(s[r],r,s)&&(e[r]=s[r]),e),{}),Te=(s,t)=>parseFloat(Number(s).toFixed(t)),Wo=s=>"matrix("+s.map(t=>Te(t,ue.NUM_FRACTION_DIGITS)).join(" ")+")",hn=s=>!!s&&s.toLive!==void 0,Qd=s=>!!s&&typeof s.toObject=="function",tg=s=>!!s&&s.offsetX!==void 0&&"source"in s,ys=s=>!!s&&"multiSelectionStacking"in s;function Hg(s){let t=s&&Sn(s),e=0,r=0;if(!s||!t)return{left:e,top:r};let n=s,i=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;n&&(n.parentNode||n.host)&&(n=n.parentNode||n.host,n===t?(e=o.scrollLeft||i.scrollLeft||0,r=o.scrollTop||i.scrollTop||0):(e+=n.scrollLeft||0,r+=n.scrollTop||0),n.nodeType!==1||n.style.position!=="fixed"););return{left:e,top:r}}var Sn=s=>s.ownerDocument||null,Gg=s=>{var t;return((t=s.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},Yg=function(s,t,e){let{width:r,height:n}=e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;s.width=r,s.height=n,i>1&&(s.setAttribute("width",(r*i).toString()),s.setAttribute("height",(n*i).toString()),t.scale(i,i))},Eu=(s,t)=>{let{width:e,height:r}=t;e&&(s.style.width=typeof e=="number"?"".concat(e,"px"):e),r&&(s.style.height=typeof r=="number"?"".concat(r,"px"):r)};function eg(s){return s.onselectstart!==void 0&&(s.onselectstart=()=>!1),s.style.userSelect=Br,s}var Sc=class{constructor(t){W(this,"_originalCanvasStyle",void 0),W(this,"lower",void 0);let e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){let e=(r=t)&&r.getContext!==void 0?t:t&&Go().getElementById(t)||Xn();var r;if(e.hasAttribute("data-fabric"))throw new cn("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:r}=t,{el:n}=this.lower;n.classList.remove("lower-canvas"),n.removeAttribute("data-fabric"),n.setAttribute("width","".concat(e)),n.setAttribute("height","".concat(r)),n.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){let{el:r,ctx:n}=this.lower;Yg(r,n,t,e)}setCSSDimensions(t){Eu(this.lower.el,t)}calcOffset(){return function(t){var e;let r=t&&Sn(t),n={left:0,top:0};if(!r)return n;let i=((e=Gg(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};n.left+=parseInt(i.borderLeftWidth,10)||0,n.top+=parseInt(i.borderTopWidth,10)||0,n.left+=parseInt(i.paddingLeft,10)||0,n.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0},a=r.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());let h=Hg(t);return{left:o.left+h.left-(a.clientLeft||0)+n.left,top:o.top+h.top-(a.clientTop||0)+n.top}}(this.lower.el)}dispose(){Yn().dispose(this.lower.el),delete this.lower}},N2={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Pr]},Za=class s extends Bg(_c){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return s.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new Sc(t)}add(){let t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];let i=super.insertAt(t,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){let t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(Hi("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Dg():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(t,e){return this.setDimensions({width:t},e)}setHeight(t,e){return this.setDimensions({height:t},e)}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){let n=X({width:this.width,height:this.height},t);this.elements.setDimensions(n,this.getRetinaScaling()),this.hasLostContext=!0,this.width=n.width,this.height=n.height}r||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){let r=t,n=[...this.viewportTransform],i=mr(t,Yr(n));n[0]=e,n[3]=e;let o=mr(i,n);n[4]+=r.x-o.x,n[5]+=r.y-o.y,this.setViewportTransform(n)}setZoom(t){this.zoomToPoint(new ft(0,0),t)}absolutePan(t){let e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new ft(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Ha(()=>this.renderAndReset()))}calcViewportBoundaries(){let t=this.width,e=this.height,r=Yr(this.viewportTransform),n=mr({x:0,y:0},r),i=mr({x:t,y:e},r),o=n.min(i),a=n.max(i);return this.vptCoords={tl:o,tr:new ft(a.x,o.y),bl:new ft(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(Rg(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;let r=this.viewportTransform,n=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality="best",this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),n&&(n._set("canvas",this),n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,n)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){let r=this.viewportTransform;t.save(),t.transform(...r),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let r=0,n=e.length;r<n;++r)e[r]&&e[r].render(t)}_renderBackgroundOrOverlay(t,e){let r=this["".concat(e,"Color")],n=this["".concat(e,"Image")],i=this.viewportTransform,o=this["".concat(e,"Vpt")];if(!r&&!n)return;let a=hn(r);if(r){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=a?r.toLive(t):r,o&&t.transform(...i),a){t.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);let h=r.gradientTransform||r.patternTransform;h&&t.transform(...h)}t.fill(),t.restore()}if(n){t.save();let{skipOffscreen:h}=this;this.skipOffscreen=o,o&&t.transform(...i),n.render(t),this.skipOffscreen=h,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new ft(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new ft(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new ft(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new ft(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new ft(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return mr(this.getCenterPoint(),Yr(this.viewportTransform))}_centerObject(t,e){t.setXY(e,ie,ie),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){let r=this.clipPath,n=r&&!r.excludeFromExport?this._toObject(r,t,e):null;return X(X(X({version:Nu},Ws(this,e)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,t,e))},this.__serializeBgOverlay(t,e)),n?{clipPath:n}:null)}_toObject(t,e,r){let n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);let i=t[e](r);return this.includeDefaultValues||(t.includeDefaultValues=!!n),i}__serializeBgOverlay(t,e){let r={},n=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return hn(o)?o.excludeFromExport||(r.background=o.toObject(e)):o&&(r.background=o),hn(a)?a.excludeFromExport||(r.overlay=a.toObject(e)):a&&(r.overlay=a),n&&!n.excludeFromExport&&(r.backgroundImage=this._toObject(n,t,e)),i&&!i.excludeFromExport&&(r.overlayImage=this._toObject(i,t,e)),r}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;let r=[];return this._setSVGPreamble(r,t),this._setSVGHeader(r,t),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",e),this._setSVGObjects(r,e),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",e),r.push("</svg>"),r.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){let r=e.width||"".concat(this.width),n=e.height||"".concat(this.height),i=ue.NUM_FRACTION_DIGITS,o=e.viewBox,a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){let h=this.viewportTransform;a='viewBox="'.concat(Te(-h[4]/h[0],i)," ").concat(Te(-h[5]/h[3],i)," ").concat(Te(this.width/h[0],i)," ").concat(Te(this.height/h[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',n,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Nu,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){let e=this.clipPath;return e?(e.clipPathId="CLIPPATH_".concat(Yi()),'<clipPath id="'.concat(e.clipPathId,`" >
`).concat(e.toClipPathSVG(t.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(t=>{let e=this["".concat(t,"Color")];if(hn(e)){let r=this["".concat(t,"Vpt")],n=this.viewportTransform,i={isType:()=>!1,width:this.width/(r?n[0]:1),height:this.height/(r?n[3]:1)};return e.toSVG(i,{additionalTransform:r?Wo(n):""})}}).join("")}createSVGFontFacesMarkup(){let t=[],e={},r=ue.fontPaths;this._objects.forEach(function i(o){t.push(o),pc(o)&&o._objects.forEach(i)}),t.forEach(i=>{if(!(o=i)||typeof o._renderText!="function")return;var o;let{styles:a,fontFamily:h}=i;!e[h]&&r[h]&&(e[h]=!0,a&&Object.values(a).forEach(l=>{Object.values(l).forEach(f=>{let{fontFamily:p=""}=f;!e[p]&&r[p]&&(e[p]=!0)})}))});let n=Object.keys(e).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(r[i],`');
		}
`)).join("");return n?`	<style type="text/css"><![CDATA[
`.concat(n,`]]></style>
`):""}_setSVGObjects(t,e){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(t,r,e)})}_setSVGObject(t,e,r){t.push(e.toSVG(r))}_setSVGBgOverlayImage(t,e,r){let n=this[e];n&&!n.excludeFromExport&&n.toSVG&&t.push(n.toSVG(r))}_setSVGBgOverlayColor(t,e){let r=this["".concat(e,"Color")];if(r)if(hn(r)){let n=r.repeat||"",i=this.width,o=this.height,a=this["".concat(e,"Vpt")]?Wo(Yr(this.viewportTransform)):"";t.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(r.offsetX-i/2,'" y="').concat(r.offsetY-o/2,'" width="').concat(n!=="repeat-y"&&n!=="no-repeat"||!tg(r)?i:r.source.width,'" height="').concat(n!=="repeat-x"&&n!=="no-repeat"||!tg(r)?o:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new cn("`json` is undefined"));let n=typeof t=="string"?JSON.parse(t):t,{objects:i=[],backgroundImage:o,background:a,overlayImage:h,overlay:l,clipPath:f}=n,p=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Uo(i,{reviver:e,signal:r}),ih({backgroundImage:o,backgroundColor:a,overlayImage:h,overlayColor:l,clipPath:f},{signal:r})]).then(v=>{let[g,b]=v;return this.clear(),this.add(...g),this.set(n),this.set(b),this.renderOnAddRemove=p,this})}clone(t){let e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){let t=Kr(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:e="png",quality:r=1,multiplier:n=1,enableRetinaScaling:i=!1}=t,o=n*(i?this.getRetinaScaling():1);return df(this.toCanvasElement(o,t),e,r)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:e="png",quality:r=1,multiplier:n=1,enableRetinaScaling:i=!1}=t,o=n*(i?this.getRetinaScaling():1);return gf(this.toCanvasElement(o,t),e,r)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:r,left:n,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(e||this.width)*t,h=(r||this.height)*t,l=this.getZoom(),f=this.width,p=this.height,v=this.skipControlsDrawing,g=l*t,b=this.viewportTransform,w=[g,0,0,g,(b[4]-(n||0))*t,(b[5]-(i||0))*t],C=this.enableRetinaScaling,x=Kr({width:a,height:h}),k=o?this._objects.filter(I=>o(I)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=w,this.width=a,this.height=h,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),k),this.viewportTransform=b,this.width=f,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=C,this.skipControlsDrawing=v,x}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),xc.cancelByCanvas(this),this.disposed=!0,new Promise((t,e)=>{let r=()=>{this.destroy(),t(!0)};r.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(t=>t.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};W(Za,"ownDefaults",N2);var M2=["touchstart","touchmove","touchend"],Xg=s=>{let t=Hg(s.target),e=function(r){let n=r.changedTouches;return n&&n[0]?n[0]:r}(s);return new ft(e.clientX+t.left,e.clientY+t.top)},Cc=s=>M2.includes(s.type)||s.pointerType==="touch",rg=s=>{s.preventDefault(),s.stopPropagation()},Gn=s=>{let t=0,e=0,r=0,n=0;for(let i=0,o=s.length;i<o;i++){let{x:a,y:h}=s[i];(a>r||!i)&&(r=a),(a<t||!i)&&(t=a),(h>n||!i)&&(n=h),(h<e||!i)&&(e=h)}return{left:t,top:e,width:r-t,height:n-e}},D2=["translateX","translateY","scaleX","scaleY"],Kg=(s,t)=>Vo(s,qe(t,s.calcOwnMatrix())),Vo=(s,t)=>{let e=zo(t),{translateX:r,translateY:n,scaleX:i,scaleY:o}=e,a=De(e,D2),h=new ft(r,n);s.flipX=!1,s.flipY=!1,Object.assign(s,a),s.set({scaleX:i,scaleY:o}),s.setPositionByOrigin(h,ie,ie)},Jg=s=>{s.scaleX=1,s.scaleY=1,s.skewX=0,s.skewY=0,s.flipX=!1,s.flipY=!1,s.rotate(0)},yf=s=>({scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,angle:s.angle,left:s.left,flipX:s.flipX,flipY:s.flipY,top:s.top}),Jc=(s,t,e)=>{let r=s/2,n=t/2,i=[new ft(-r,-n),new ft(r,-n),new ft(-r,n),new ft(r,n)].map(a=>a.transform(e)),o=Gn(i);return new ft(o.width,o.height)},sh=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pr;return qe(Yr(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pr),s)},mi=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pr;return s.transform(sh(t,e))},Zg=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pr;return s.transform(sh(t,e),!0)},Fu=(s,t,e)=>{let r=sh(t,e);return Vo(s,qe(r,s.calcOwnMatrix())),r},bf=(s,t)=>{var e;let{transform:{target:r}}=t;(e=r.canvas)===null||e===void 0||e.fire("object:".concat(s),X(X({},t),{},{target:r})),r.fire(s,t)},E2={left:-.5,top:-.5,center:0,bottom:.5,right:.5},tr=s=>typeof s=="string"?E2[s]:s-.5,Ac="not-allowed";function $g(s){return tr(s.originX)===tr(ie)&&tr(s.originY)===tr(ie)}function ng(s){return .5-tr(s)}var An=(s,t)=>s[t],wf=(s,t,e,r)=>({e:s,transform:t,pointer:new ft(e,r)});function Qg(s,t){let e=s.getTotalAngle()+Kn(Math.atan2(t.y,t.x))+360;return Math.round(e%360/45)}function Zc(s,t,e,r,n){var i;let{target:o,corner:a}=s,h=o.controls[a],l=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,f=o.padding/l,p=function(v,g,b,w){let C=v.getRelativeCenterPoint(),x=b!==void 0&&w!==void 0?v.translateToGivenOrigin(C,ie,ie,b,w):new ft(v.left,v.top);return(v.angle?g.rotate(-Re(v.angle),C):g).subtract(x)}(o,new ft(r,n),t,e);return p.x>=f&&(p.x-=f),p.x<=-f&&(p.x+=f),p.y>=f&&(p.y-=f),p.y<=f&&(p.y+=f),p.x-=h.offsetX,p.y-=h.offsetY,p}var t0=(s,t,e,r)=>{let{target:n,offsetX:i,offsetY:o}=t,a=e-i,h=r-o,l=!An(n,"lockMovementX")&&n.left!==a,f=!An(n,"lockMovementY")&&n.top!==h;return l&&n.set(ve,a),f&&n.set(Ir,h),(l||f)&&bf(Eg,wf(s,t,e,r)),l||f},ig={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},yu=(s,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+6*(t-s)*e:e<.5?t:e<2/3?s+(t-s)*(2/3-e)*6:s),sg=(s,t,e,r)=>{s/=255,t/=255,e/=255;let n=Math.max(s,t,e),i=Math.min(s,t,e),o,a,h=(n+i)/2;if(n===i)o=a=0;else{let l=n-i;switch(a=h>.5?l/(2-n-i):l/(n+i),n){case s:o=(t-e)/l+(t<e?6:0);break;case t:o=(e-s)/l+2;break;case e:o=(s-t)/l+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*h),r]},og=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(s)/(s.endsWith("%")?100:1)},hc=s=>Math.min(Math.round(s),255).toString(16).toUpperCase().padStart(2,"0"),ag=s=>{let[t,e,r,n=1]=s,i=Math.round(.3*t+.59*e+.11*r);return[i,i,i,n]},vr=class s{constructor(t){if(W(this,"isUnrecognised",!1),t)if(t instanceof s)this.setSource([...t._source]);else if(Array.isArray(t)){let[e,r,n,i=1]=t;this.setSource([e,r,n,i])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in ig&&(t=ig[t]),t==="transparent"?[255,255,255,0]:s.sourceFromHex(t)||s.sourceFromRgb(t)||s.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){let[t,e,r]=this.getSource();return"rgb(".concat(t,",").concat(e,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[t,e,r]=sg(...this.getSource());return"hsl(".concat(t,",").concat(e,"%,").concat(r,"%)")}toHsla(){let[t,e,r,n]=sg(...this.getSource());return"hsla(".concat(t,",").concat(e,"%,").concat(r,"%,").concat(n,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[t,e,r,n]=this.getSource();return"".concat(hc(t)).concat(hc(e)).concat(hc(r)).concat(hc(Math.round(255*n)))}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(ag(this.getSource())),this}toBlackWhite(t){let[e,,,r]=ag(this.getSource()),n=e<(t||127)?0:255;return this.setSource([n,n,n,r]),this}overlayWith(t){t instanceof s||(t=new s(t));let e=this.getSource(),r=t.getSource(),[n,i,o]=e.map((a,h)=>Math.round(.5*a+.5*r[h]));return this.setSource([n,i,o,e[3]]),this}static fromRgb(t){return s.fromRgba(t)}static fromRgba(t){return new s(s.sourceFromRgb(t))}static sourceFromRgb(t){let e=t.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(e){let[r,n,i]=e.slice(1,4).map(o=>{let a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[r,n,i,og(e[4])]}}static fromHsl(t){return s.fromHsla(t)}static fromHsla(t){return new s(s.sourceFromHsl(t))}static sourceFromHsl(t){let e=t.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!e)return;let r=(s.parseAngletoDegrees(e[1])%360+360)%360/360,n=parseFloat(e[2])/100,i=parseFloat(e[3])/100,o,a,h;if(n===0)o=a=h=i;else{let l=i<=.5?i*(n+1):i+n-i*n,f=2*i-l;o=yu(f,l,r+1/3),a=yu(f,l,r),h=yu(f,l,r-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*h),og(e[4])]}static fromHex(t){return new s(s.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let e=t.slice(t.indexOf("#")+1),r;r=e.length<=4?e.split("").map(h=>h+h):e.match(/.{2}/g);let[n,i,o,a=255]=r.map(h=>parseInt(h,16));return[n,i,o,a/255]}}static parseAngletoDegrees(t){let e=t.toLowerCase(),r=parseFloat(e);return e.includes("rad")?Kn(r):e.includes("turn")?360*r:r}},Is=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cf,e=/\D{0,2}$/.exec(s),r=parseFloat(s),n=ue.DPI;switch(e?.[0]){case"mm":return r*n/25.4;case"cm":return r*n/2.54;case"in":return r*n;case"pt":return r*n/72;case"pc":return r*n/72*12;case"em":return r*t;default:return r}},e0=s=>{let[t,e]=s.trim().split(" "),[r,n]=(i=t)&&i!==Br?[i.slice(1,4),i.slice(5,8)]:i===Br?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:e||"meet",alignX:r,alignY:n}},$a=function(s,t){let e,r,n=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e="url(#SVGID_".concat(t.id,")");else{let i=new vr(t),o=i.getAlpha();e=i.toRgb(),o!==1&&(r=o.toString())}else e="none";return n?"".concat(s,": ").concat(e,"; ").concat(r?"".concat(s,"-opacity: ").concat(r,"; "):""):"".concat(s,'="').concat(e,'" ').concat(r?"".concat(s,'-opacity="').concat(r,'" '):"")},Lc=class{getSvgStyles(t){let e=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):Br,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",h=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=this.opacity!==void 0?this.opacity:"1",f=this.visible?"":" visibility: hidden;",p=t?"":this.getSvgFilter(),v=$a(ir,this.fill);return[$a(Rr,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",h,"; ",v,"fill-rule: ",e,"; ","opacity: ",l,";",p,f].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=t?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'.concat(Wo(r));return"".concat(n).concat(e,'" ')}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),i=t.indexOf("COMMON_PARTS");return t[i]=n,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:r,withShadow:n,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=e?"":'style="'.concat(this.getSvgStyles(),'" '),a=n?'style="'.concat(this.getSvgFilter(),'" '):"",h=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",f=h&&h.absolutePositioned,p=this.stroke,v=this.fill,g=this.shadow,b=[],w=t.indexOf("COMMON_PARTS"),C;h&&(h.clipPathId="CLIPPATH_".concat(Yi()),C='<clipPath id="'.concat(h.clipPathId,`" >
`).concat(h.toClipPathSVG(r),`</clipPath>
`)),f&&b.push("<g ",a,this.getSvgCommons(),` >
`),b.push("<g ",this.getSvgTransform(!1),f?"":a+this.getSvgCommons(),` >
`);let x=[o,l,e?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return t[w]=x,hn(v)&&b.push(v.toSVG(this)),hn(p)&&b.push(p.toSVG(this)),g&&b.push(g.toSVG(this)),h&&b.push(C),b.push(t.join("")),b.push(`</g>
`),f&&b.push(`</g>
`),r?r(b.join("")):b.join("")}addPaintOrder(){return this.paintFirst!==ir?' paint-order="'.concat(this.paintFirst,'" '):""}};function $c(s){return new RegExp("^("+s.join("|")+")\\b","i")}var Rs="textDecorationThickness",r0=["fontSize","fontWeight","fontFamily","fontStyle"],n0=["underline","overline","linethrough"],i0=[...r0,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],s0=[...i0,...n0,"textBackgroundColor","direction",Rs],F2=[...r0,...n0,Rr,"strokeWidth",ir,"deltaY","textBackgroundColor",Rs],j2={_reNewline:lf,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:ve,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:ve,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Rs]:66.667},Hn="justify",Tc="justify-left",Ya="justify-right",Xa="justify-center",hg,cg,lg,Cn=String.raw(hg||(hg=Jn(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),bu=String.raw(cg||(cg=Jn(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"])));var I2=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Cn+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Cn+"))?\\s+(.*)"),B2={cx:ve,x:ve,r:"radius",cy:Ir,y:Ir,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Rs},wu="font-size",xu="clip-path",by=$c(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),wy=$c(["symbol","image","marker","pattern","view","svg"]),ug=$c(["symbol","g","a","svg","clipPath","defs"]),xy=new RegExp(String.raw(lg||(lg=Jn(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),Cn,bu,Cn,bu,Cn,bu,Cn)),R2=new ft(1,0),o0=new ft,xf=(s,t)=>s.rotate(t),Pc=(s,t)=>new ft(t).subtract(s),kc=s=>s.distanceFrom(o0),Oc=(s,t)=>Math.atan2(Ro(s,t),h0(s,t)),a0=s=>Oc(R2,s),Qc=s=>s.eq(o0)?s:s.scalarDivide(kc(s)),_f=function(s){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return Qc(new ft(-s.y,s.x).scalarMultiply(t?1:-1))},Ro=(s,t)=>s.x*t.y-s.y*t.x,h0=(s,t)=>s.x*t.x+s.y*t.y,ju=(s,t,e)=>{if(s.eq(t)||s.eq(e))return!0;let r=Ro(t,e),n=Ro(t,s),i=Ro(e,s);return r>=0?n>=0&&i<=0:!(n<=0&&i>=0)},fg="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",dg=new RegExp("(?:\\s|^)"+fg+fg+"("+Cn+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),Wi=class s{constructor(t){let e=typeof t=="string"?s.parseShadow(t):t;Object.assign(this,s.ownDefaults,e),this.id=Yi()}static parseShadow(t){let e=t.trim(),[,r=0,n=0,i=0]=(dg.exec(e)||[]).map(o=>parseFloat(o)||0);return{color:(e.replace(dg,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:n,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){let e=xf(new ft(this.offsetX,this.offsetY),Re(-t.angle)),r=new vr(this.color),n=40,i=40;return t.width&&t.height&&(n=100*Te((Math.abs(e.x)+this.blur)/t.width,ue.NUM_FRACTION_DIGITS)+20,i=100*Te((Math.abs(e.y)+this.blur)/t.height,ue.NUM_FRACTION_DIGITS)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(n,'%" width="').concat(100+2*n,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Te(this.blur?this.blur/2:0,ue.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Te(e.x,ue.NUM_FRACTION_DIGITS),'" dy="').concat(Te(e.y,ue.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){let t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=s.ownDefaults;return this.includeDefaultValues?t:vf(t,(r,n)=>r!==e[n])}static fromObject(t){return jr(this,null,function*(){return new this(t)})}};W(Wi,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),W(Wi,"type","shadow"),Bt.setClass(Wi,"shadow");var qs=(s,t,e)=>Math.max(s,Math.min(t,e)),q2=[Ir,ve,kr,Xr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Yo,Xo],yi=[ir,Rr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],z2={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:ve,originY:Ir,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:ir,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},_u=(s,t,e,r)=>(s<Math.abs(t)?(s=t,r=e/4):r=t===0&&s===0?e/vi*Math.asin(1):e/vi*Math.asin(t/s),{a:s,c:t,p:e,s:r}),gg=(s,t,e,r,n)=>s*Math.pow(2,10*(r-=1))*Math.sin((r*n-t)*vi/e),c0=(s,t,e,r)=>-e*Math.cos(s/r*Gi)+e+t,Iu=(s,t,e,r)=>(s/=r)<1/2.75?e*(7.5625*s*s)+t:s<2/2.75?e*(7.5625*(s-=1.5/2.75)*s+.75)+t:s<2.5/2.75?e*(7.5625*(s-=2.25/2.75)*s+.9375)+t:e*(7.5625*(s-=2.625/2.75)*s+.984375)+t,pg=(s,t,e,r)=>e-Iu(r-s,0,e,r)+t,U2=Object.freeze({__proto__:null,defaultEasing:c0,easeInBack:function(s,t,e,r){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*(s/=r)*s*((n+1)*s-n)+t},easeInBounce:pg,easeInCirc:(s,t,e,r)=>-e*(Math.sqrt(1-(s/=r)*s)-1)+t,easeInCubic:(s,t,e,r)=>e*(s/r)**3+t,easeInElastic:(s,t,e,r)=>{let n=e,i=0;if(s===0)return t;if((s/=r)===1)return t+e;i||(i=.3*r);let{a:o,s:a,p:h}=_u(n,e,i,1.70158);return-gg(o,a,h,s,r)+t},easeInExpo:(s,t,e,r)=>s===0?t:e*2**(10*(s/r-1))+t,easeInOutBack:function(s,t,e,r){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(s/=r/2)<1?e/2*(s*s*((1+(n*=1.525))*s-n))+t:e/2*((s-=2)*s*((1+(n*=1.525))*s+n)+2)+t},easeInOutBounce:(s,t,e,r)=>s<r/2?.5*pg(2*s,0,e,r)+t:.5*Iu(2*s-r,0,e,r)+.5*e+t,easeInOutCirc:(s,t,e,r)=>(s/=r/2)<1?-e/2*(Math.sqrt(1-s**2)-1)+t:e/2*(Math.sqrt(1-(s-=2)*s)+1)+t,easeInOutCubic:(s,t,e,r)=>(s/=r/2)<1?e/2*s**3+t:e/2*((s-2)**3+2)+t,easeInOutElastic:(s,t,e,r)=>{let n=e,i=0;if(s===0)return t;if((s/=r/2)===2)return t+e;i||(i=r*(.3*1.5));let{a:o,s:a,p:h,c:l}=_u(n,e,i,1.70158);return s<1?-.5*gg(o,a,h,s,r)+t:o*Math.pow(2,-10*(s-=1))*Math.sin((s*r-a)*vi/h)*.5+l+t},easeInOutExpo:(s,t,e,r)=>s===0?t:s===r?t+e:(s/=r/2)<1?e/2*2**(10*(s-1))+t:e/2*-(2**(-10*--s)+2)+t,easeInOutQuad:(s,t,e,r)=>(s/=r/2)<1?e/2*s**2+t:-e/2*(--s*(s-2)-1)+t,easeInOutQuart:(s,t,e,r)=>(s/=r/2)<1?e/2*s**4+t:-e/2*((s-=2)*s**3-2)+t,easeInOutQuint:(s,t,e,r)=>(s/=r/2)<1?e/2*s**5+t:e/2*((s-2)**5+2)+t,easeInOutSine:(s,t,e,r)=>-e/2*(Math.cos(Math.PI*s/r)-1)+t,easeInQuad:(s,t,e,r)=>e*(s/=r)*s+t,easeInQuart:(s,t,e,r)=>e*(s/=r)*s**3+t,easeInQuint:(s,t,e,r)=>e*(s/r)**5+t,easeInSine:(s,t,e,r)=>-e*Math.cos(s/r*Gi)+e+t,easeOutBack:function(s,t,e,r){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return e*((s=s/r-1)*s*((n+1)*s+n)+1)+t},easeOutBounce:Iu,easeOutCirc:(s,t,e,r)=>e*Math.sqrt(1-(s=s/r-1)*s)+t,easeOutCubic:(s,t,e,r)=>e*((s/r-1)**3+1)+t,easeOutElastic:(s,t,e,r)=>{let n=e,i=0;if(s===0)return t;if((s/=r)===1)return t+e;i||(i=.3*r);let{a:o,s:a,p:h,c:l}=_u(n,e,i,1.70158);return o*2**(-10*s)*Math.sin((s*r-a)*vi/h)+l+t},easeOutExpo:(s,t,e,r)=>s===r?t+e:e*-(2**(-10*s/r)+1)+t,easeOutQuad:(s,t,e,r)=>-e*(s/=r)*(s-2)+t,easeOutQuart:(s,t,e,r)=>-e*((s=s/r-1)*s**3-1)+t,easeOutQuint:(s,t,e,r)=>e*((s/r-1)**5+1)+t,easeOutSine:(s,t,e,r)=>e*Math.sin(s/r*Gi)+t}),W2=()=>!1,Qa=class{constructor(t){let{startValue:e,byValue:r,duration:n=500,delay:i=0,easing:o=c0,onStart:a=js,onChange:h=js,onComplete:l=js,abort:f=W2,target:p}=t;W(this,"_state","pending"),W(this,"durationProgress",0),W(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=n,this.delay=i,this.easing=o,this._onStart=a,this._onChange=h,this._onComplete=l,this._abort=f,this.target=p,this.startValue=e,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Ha(t),this.delay):Ha(t)}tick(t){let e=(t||+new Date)-this.startTime,r=Math.min(e,this.duration);this.durationProgress=r/this.duration;let{value:n,valueProgress:i}=this.calculate(r);this.value=Object.freeze(n),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Ha(this.tick)))}register(){xc.push(this)}unregister(){xc.remove(this)}abort(){this._state="aborted",this.unregister()}},V2=["startValue","endValue"],Bu=class extends Qa{constructor(t){let{startValue:e=0,endValue:r=100}=t;super(X(X({},De(t,V2)),{},{startValue:e,byValue:r-e}))}calculate(t){let e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}},H2=["startValue","endValue"],Ru=class extends Qa{constructor(t){let{startValue:e=[0],endValue:r=[100]}=t;super(X(X({},De(t,H2)),{},{startValue:e,byValue:r.map((n,i)=>n-e[i])}))}calculate(t){let e=this.startValue.map((r,n)=>this.easing(t,r,this.byValue[n],this.duration,n));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}},G2=["startValue","endValue","easing","onChange","onComplete","abort"],Y2=(s,t,e,r)=>t+e*(1-Math.cos(s/r*Gi)),Su=s=>s&&((t,e,r)=>s(new vr(t).toRgba(),e,r)),qu=class extends Qa{constructor(t){let{startValue:e,endValue:r,easing:n=Y2,onChange:i,onComplete:o,abort:a}=t,h=De(t,G2),l=new vr(e).getSource(),f=new vr(r).getSource();super(X(X({},h),{},{startValue:l,byValue:f.map((p,v)=>p-l[v]),easing:n,onChange:Su(i),onComplete:Su(o),abort:Su(a)}))}calculate(t){let[e,r,n,i]=this.startValue.map((a,h)=>this.easing(t,a,this.byValue[h],this.duration,h)),o=[...[e,r,n].map(Math.round),qs(0,i,1)];return{value:o,valueProgress:o.map((a,h)=>this.byValue[h]!==0?Math.abs((a-this.startValue[h])/this.byValue[h]):0).find(a=>a!==0)||0}}};function Sf(s){let t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(s)?new Ru(s):new Bu(s);return t.start(),t}function l0(s){let t=new qu(s);return t.start(),t}var Bs=class s{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some(e=>e.eq(t))}append(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.points=this.points.concat(e.filter(n=>!this.includes(n))),this}static isPointContained(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(r))return t.eq(e);if(e.x===r.x)return t.x===e.x&&(n||t.y>=Math.min(e.y,r.y)&&t.y<=Math.max(e.y,r.y));if(e.y===r.y)return t.y===e.y&&(n||t.x>=Math.min(e.x,r.x)&&t.x<=Math.max(e.x,r.x));{let i=Pc(e,r),o=Pc(e,t).divide(i);return n?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){let r=new ft(t).setX(Math.min(t.x-1,...e.map(i=>i.x))),n=0;for(let i=0;i<e.length;i++){let o=this.intersectSegmentSegment(e[i],e[(i+1)%e.length],t,r);if(o.includes(t))return!0;n+=+(o.status==="Intersection")}return n%2==1}static intersectLineLine(t,e,r,n){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],a=e.x-t.x,h=e.y-t.y,l=n.x-r.x,f=n.y-r.y,p=t.x-r.x,v=t.y-r.y,g=l*v-f*p,b=a*v-h*p,w=f*a-l*h;if(w!==0){let C=g/w,x=b/w;return(i||0<=C&&C<=1)&&(o||0<=x&&x<=1)?new s("Intersection").append(new ft(t.x+C*a,t.y+C*h)):new s}if(g===0||b===0){let C=i||o||s.isPointContained(t,r,n)||s.isPointContained(e,r,n)||s.isPointContained(r,t,e)||s.isPointContained(n,t,e);return new s(C?"Coincident":void 0)}return new s("Parallel")}static intersectSegmentLine(t,e,r,n){return s.intersectLineLine(t,e,r,n,!1,!0)}static intersectSegmentSegment(t,e,r,n){return s.intersectLineLine(t,e,r,n,!1,!1)}static intersectLinePolygon(t,e,r){let n=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],i=new s,o=r.length;for(let a,h,l,f=0;f<o;f++){if(a=r[f],h=r[(f+1)%o],l=s.intersectLineLine(t,e,a,h,n,!1),l.status==="Coincident")return l;i.append(...l.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(t,e,r){return s.intersectLinePolygon(t,e,r,!1)}static intersectPolygonPolygon(t,e){let r=new s,n=t.length,i=[];for(let o=0;o<n;o++){let a=t[o],h=t[(o+1)%n],l=s.intersectSegmentPolygon(a,h,e);l.status==="Coincident"?(i.push(l),r.append(a,h)):r.append(...l.points)}return i.length>0&&i.length===t.length?new s("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(t,e,r){let n=e.min(r),i=e.max(r),o=new ft(i.x,n.y),a=new ft(n.x,i.y);return s.intersectPolygonPolygon(t,[n,o,i,a])}},zu=class extends _c{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){let t=this.getRelativeXY();return this.group?mr(t,this.group.calcTransformMatrix()):t}setXY(t,e,r){this.group&&(t=mr(t,Yr(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,r)}getRelativeXY(){return new ft(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:t,tr:e,br:r,bl:n}=this.aCoords||(this.aCoords=this.calcACoords()),i=[t,e,r,n];if(this.group){let o=this.group.calcTransformMatrix();return i.map(a=>mr(a,o))}return i}intersectsWithRect(t,e){return Bs.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){let e=Bs.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every(e=>t.containsPoint(e))}isContainedWithinRect(t,e){let{left:r,top:n,width:i,height:o}=this.getBoundingRect();return r>=t.x&&r+i<=e.x&&n>=t.y&&n+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return Bs.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=e.x&&r.x>=t.x&&r.y<=e.y&&r.y>=t.y)||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every(r=>(r.x>=e.x||r.x<=t.x)&&(r.y>=e.y||r.y<=t.y))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Gn(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(kr,t),this._set(Xr,t),this.setCoords()}scaleToWidth(t){let e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){let e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?Kn(Ug(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||Pr.concat()}calcACoords(){let t=Us({angle:this.angle}),{x:e,y:r}=this.getRelativeCenterPoint(),n=Ko(e,r),i=qe(n,t),o=this._getTransformedDimensions(),a=o.x/2,h=o.y/2;return{tl:mr({x:-a,y:-h},i),tr:mr({x:a,y:-h},i),bl:mr({x:-a,y:h},i),br:mr({x:a,y:h},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,tr(this.originX),tr(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;let r=this.transformMatrixKey(t),n=this.matrixCache;return n&&n.key.every((i,o)=>i===r[o])?n.value:(this.group&&(e=qe(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:r,value:e},e)}calcOwnMatrix(){let t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key===t)return e.value;let r=this.getRelativeCenterPoint(),n={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=Vg(n);return this.ownMatrixCache={key:t,value:i},i}_getNonTransformedDimensions(){return new ft(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=X({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},t),r=e.strokeWidth,n=r,i=0;this.strokeUniform&&(n=0,i=r);let o=e.width+n,a=e.height+n,h;return h=e.skewX===0&&e.skewY===0?new ft(o*e.scaleX,a*e.scaleY):Jc(o,a,nh(e)),h.scalarAdd(i)}translateToGivenOrigin(t,e,r,n,i){let o=t.x,a=t.y,h=tr(n)-tr(e),l=tr(i)-tr(r);if(h||l){let f=this._getTransformedDimensions();o+=h*f.x,a+=l*f.y}return new ft(o,a)}translateToCenterPoint(t,e,r){if(e===ie&&r===ie)return t;let n=this.translateToGivenOrigin(t,e,r,ie,ie);return this.angle?n.rotate(Re(this.angle),t):n}translateToOriginPoint(t,e,r){let n=this.translateToGivenOrigin(t,ie,ie,e,r);return this.angle?n.rotate(Re(this.angle),t):n}getCenterPoint(){let t=this.getRelativeCenterPoint();return this.group?mr(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new ft(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,r){let n=this.translateToCenterPoint(t,e,r),i=this.translateToOriginPoint(n,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),ve,Ir)}},X2=["type"],K2=["extraParam"],fi=class mc extends zu{static getDefaults(){return mc.ownDefaults}get type(){let t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){Hi("warn","Setting type has no effect",t)}constructor(t){super(),W(this,"_cacheContext",null),Object.assign(this,mc.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=Xn(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){let e=t.width,r=t.height,n=ue.maxCacheSideLimit,i=ue.minCacheSideLimit;if(e<=n&&r<=n&&e*r<=ue.perfLimitSizeTotal)return e<i&&(t.width=i),r<i&&(t.height=i),t;let o=e/r,[a,h]=Va.limitDimsByArea(o),l=qs(i,a,n),f=qs(i,h,n);return e>l&&(t.zoomX/=e/l,t.width=l,t.capped=!0),r>f&&(t.zoomY/=r/f,t.height=f,t.capped=!0),t}_getCacheCanvasDimensions(){let t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),r=e.x*t.x/this.scaleX,n=e.y*t.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(n+2),zoomX:t.x,zoomY:t.y,x:r,y:n}}_updateCacheCanvas(){let t=this._cacheCanvas,e=this._cacheContext,{width:r,height:n,zoomX:i,zoomY:o,x:a,y:h}=this._limitCacheSize(this._getCacheCanvasDimensions()),l=r!==t.width||n!==t.height,f=this.zoomX!==i||this.zoomY!==o;if(!t||!e)return!1;if(l||f){r!==t.width||n!==t.height?(t.width=r,t.height=n):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));let p=a/2,v=h/2;return this.cacheTranslationX=Math.round(t.width/2-p)+p,this.cacheTranslationY=Math.round(t.height/2-v)+v,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(i,o),this.zoomX=i,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){let e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,r=this.calcTransformMatrix(!e);t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new ft(Math.abs(this.scaleX),Math.abs(this.scaleY));let t=zo(this.calcTransformMatrix());return new ft(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){let t=this.getObjectScaling();if(this.canvas){let e=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return t.scalarMultiply(e*r)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==kr&&t!==Xr||(e=this._constrainScale(e)),t===kr&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof Wi||(e=new Wi(e));let r=this[t]!==e;return this[t]=e,r&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){let{zoomX:e,zoomY:r,cacheTranslationX:n,cacheTranslationY:i}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:r,cacheTranslationX:n,cacheTranslationY:i,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Rr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,r){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),t.restore()}drawObject(t,e,r){let n=this.fill,i=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath,r),this.fill=n,this.stroke=i}createClipPathLayer(t,e){let r=Kr(e),n=r.getContext("2d");if(n.translate(e.cacheTranslationX,e.cacheTranslationY),n.scale(e.zoomX,e.zoomY),t._cacheCanvas=r,e.parentClipPaths.forEach(i=>{i.transform(n)}),e.parentClipPaths.push(t),t.absolutePositioned){let i=Yr(this.calcTransformMatrix());n.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return t.transform(n),t.drawObject(n,!0,e),r}_drawClipPath(t,e,r){if(!e)return;e._transformDone=!0;let n=this.createClipPathLayer(e,r);this.drawClipPathOnCache(t,e,n)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;let e=this._cacheCanvas,r=this._cacheContext;return!(!e||!r||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&r&&!t&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,e.width,e.height),r.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;let e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){let r=e.stroke;r&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,hn(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(t,r):(t.strokeStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:r}=e;r&&(hn(r)?(t.fillStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.fillStyle=r)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;let e=this.shadow,r=this.canvas,n=this.getCanvasRetinaScaling(),[i,,,o]=r?.viewportTransform||Pr,a=i*n,h=o*n,l=e.nonScaling?new ft(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*ue.browserShadowBlurConstant*(a+h)*(l.x+l.y)/4,t.shadowOffsetX=e.offsetX*a*l.x,t.shadowOffsetY=e.offsetY*h*l.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!hn(e))return{offsetX:0,offsetY:0};let r=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,i=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,n,i):t.transform(1,0,0,1,n,i),r&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:n,offsetY:i}}_renderPaintInOrder(t){this.paintFirst===Rr?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){let e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var r;let n=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),o=n.x/this.scaleX/i,a=n.y/this.scaleY/i,h=Kr({width:Math.ceil(o),height:Math.ceil(a)}),l=h.getContext("2d");l&&(l.beginPath(),l.moveTo(0,0),l.lineTo(o,0),l.lineTo(o,a),l.lineTo(0,a),l.closePath(),l.translate(o/2,a/2),l.scale(n.zoomX/this.scaleX/i,n.zoomY/this.scaleY/i),this._applyPatternGradientTransform(l,e),l.fillStyle=e.toLive(t),l.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(i*this.scaleX/n.zoomX,i*this.scaleY/n.zoomY),t.strokeStyle=(r=l.createPattern(h,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new ft(this.left+this.width/2,this.top+this.height/2)}clone(t){let e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){let e=this.toCanvasElement(t);return new(Bt.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=yf(this),r=this.group,n=this.shadow,i=Math.abs,o=t.enableRetinaScaling?Dg():1,a=(t.multiplier||1)*o,h=t.canvasProvider||(k=>new Za(k,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&Jg(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&Fu(this,this.getViewportTransform()),this.setCoords();let l=Xn(),f=this.getBoundingRect(),p=this.shadow,v=new ft;if(p){let k=p.blur,I=p.nonScaling?new ft(1,1):this.getObjectScaling();v.x=2*Math.round(i(p.offsetX)+k)*i(I.x),v.y=2*Math.round(i(p.offsetY)+k)*i(I.y)}let g=f.width+v.x,b=f.height+v.y;l.width=Math.ceil(g),l.height=Math.ceil(b);let w=h(l);t.format==="jpeg"&&(w.backgroundColor="#fff"),this.setPositionByOrigin(new ft(w.width/2,w.height/2),ie,ie);let C=this.canvas;w._objects=[this],this.set("canvas",w),this.setCoords();let x=w.toCanvasElement(a||1,t);return this.set("canvas",C),this.shadow=n,r&&(this.group=r),this.set(e),this.setCoords(),w._objects=[],w.destroy(),x}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return df(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return gf(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){let{centeredRotation:e,originX:r,originY:n}=this;if(e){let{x:i,y:o}=this.getRelativeCenterPoint();this.originX=ie,this.originY=ie,this.left=i,this.top=o}if(this.set("angle",t),e){let{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,n);this.left=i,this.top=o,this.originX=r,this.originY=n}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){xc.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Yn().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce((r,n)=>{let[i,o]=n;return r[i]=this._animate(i,o,e),r},{})}_animate(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.split("."),i=this.constructor.colorProperties.includes(n[n.length-1]),{abort:o,startValue:a,onChange:h,onComplete:l}=r,f=X(X({},r),{},{target:this,startValue:a??n.reduce((p,v)=>p[v],this),endValue:e,abort:o?.bind(this),onChange:(p,v,g)=>{n.reduce((b,w,C)=>(C===n.length-1&&(b[w]=p),b[w]),this),h&&h(p,v,g)},onComplete:(p,v,g)=>{this.setCoords(),l&&l(p,v,g)}});return i?l0(f):Sf(f)}isDescendantOf(t){let{parent:e,group:r}=this;return e===t||r===t||!!e&&e.isDescendantOf(t)||!!r&&r!==e&&r.isDescendantOf(t)}getAncestors(){let t=[],e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};let e=this.getAncestors(),r=t.getAncestors();if(e.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[t,...r.slice(0,r.length-1)],common:[this]};for(let n,i=0;i<e.length;i++){if(n=e[i],n===t)return{fork:[this,...e.slice(0,i)],otherFork:[],common:e.slice(i)};for(let o=0;o<r.length;o++){if(this===r[o])return{fork:[],otherFork:[t,...r.slice(0,o)],common:[this,...e]};if(n===r[o])return{fork:[this,...e.slice(0,i)],otherFork:[t,...r.slice(0,o)],common:e.slice(i)}}}return{fork:[this,...e],otherFork:[t,...r],common:[]}}hasCommonAncestors(t){let e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;let e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;let r=e.common[0]||this.canvas;if(!r)return;let n=e.fork.pop(),i=e.otherFork.pop(),o=r._objects.indexOf(n),a=r._objects.indexOf(i);return o>-1&&o>a}toObject(){let t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(mc.customProperties,this.constructor.customProperties||[]),e,r=ue.NUM_FRACTION_DIGITS,{clipPath:n,fill:i,stroke:o,shadow:a,strokeDashArray:h,left:l,top:f,originX:p,originY:v,width:g,height:b,strokeWidth:w,strokeLineCap:C,strokeDashOffset:x,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:G,scaleX:U,scaleY:nt,angle:J,flipX:F,flipY:et,opacity:dt,visible:N,backgroundColor:M,fillRule:z,paintFirst:R,globalCompositeOperation:ht,skewX:it,skewY:ut}=this;n&&!n.excludeFromExport&&(e=n.toObject(t.concat("inverted","absolutePositioned")));let Q=pt=>Te(pt,r),gt=X(X({},Ws(this,t)),{},{type:this.constructor.type,version:Nu,originX:p,originY:v,left:Q(l),top:Q(f),width:Q(g),height:Q(b),fill:Qd(i)?i.toObject():i,stroke:Qd(o)?o.toObject():o,strokeWidth:Q(w),strokeDashArray:h&&h.concat(),strokeLineCap:C,strokeDashOffset:x,strokeLineJoin:k,strokeUniform:I,strokeMiterLimit:Q(G),scaleX:Q(U),scaleY:Q(nt),angle:Q(J),flipX:F,flipY:et,opacity:Q(dt),shadow:a&&a.toObject(),visible:N,backgroundColor:M,fillRule:z,paintFirst:R,globalCompositeOperation:ht,skewX:Q(it),skewY:Q(ut)},e?{clipPath:e}:null);return this.includeDefaultValues?gt:this._removeDefaultValues(gt)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){let e=this.constructor.getDefaults(),r=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return vf(t,(n,i)=>{if(i===ve||i===Ir||i==="type")return!0;let o=r[i];return n!==o&&!(Array.isArray(n)&&Array.isArray(o)&&n.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(t){let e=De(t,X2),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:n}=r,i=De(r,K2);return ih(e,i).then(o=>n?(delete o[n],new this(e[n],o)):new this(o))}static fromObject(t,e){return this._fromObject(t,e)}};W(fi,"stateProperties",q2),W(fi,"cacheProperties",yi),W(fi,"ownDefaults",z2),W(fi,"type","FabricObject"),W(fi,"colorProperties",[ir,Rr,"backgroundColor"]),W(fi,"customProperties",[]),Bt.setClass(fi),Bt.setClass(fi,"object");var Xi=(s,t,e)=>(r,n,i,o)=>{let a=t(r,n,i,o);return a&&bf(s,X(X({},wf(r,n,i,o)),e)),a};function Vs(s){return(t,e,r,n)=>{let{target:i,originX:o,originY:a}=e,h=i.getRelativeCenterPoint(),l=i.translateToOriginPoint(h,o,a),f=s(t,e,r,n);return i.setPositionByOrigin(l,e.originX,e.originY),f}}var Uu=Xi(Ja,Vs((s,t,e,r)=>{let n=Zc(t,t.originX,t.originY,e,r);if(tr(t.originX)===tr(ie)||tr(t.originX)===tr(Ge)&&n.x<0||tr(t.originX)===tr(ve)&&n.x>0){let{target:i}=t,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=$g(t)?2:1,h=i.width,l=Math.abs(n.x*a/i.scaleX)-o;return i.set("width",Math.max(l,1)),h!==i.width}return!1}));function u0(s,t,e,r,n){r=r||{};let i=this.sizeX||r.cornerSize||n.cornerSize,o=this.sizeY||r.cornerSize||n.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:n.transparentCorners,h=a?Rr:ir,l=!a&&(r.cornerStrokeColor||n.cornerStrokeColor),f,p=t,v=e;s.save(),s.fillStyle=r.cornerColor||n.cornerColor||"",s.strokeStyle=r.cornerStrokeColor||n.cornerStrokeColor||"",i>o?(f=i,s.scale(1,o/i),v=e*i/o):o>i?(f=o,s.scale(i/o,1),p=t*o/i):f=i,s.beginPath(),s.arc(p,v,f/2,0,vi,!1),s[h](),l&&s.stroke(),s.restore()}function f0(s,t,e,r,n){r=r||{};let i=this.sizeX||r.cornerSize||n.cornerSize,o=this.sizeY||r.cornerSize||n.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:n.transparentCorners,h=a?Rr:ir,l=!a&&(r.cornerStrokeColor||n.cornerStrokeColor),f=i/2,p=o/2;s.save(),s.fillStyle=r.cornerColor||n.cornerColor||"",s.strokeStyle=r.cornerStrokeColor||n.cornerStrokeColor||"",s.translate(t,e);let v=n.getTotalAngle();s.rotate(Re(v)),s["".concat(h,"Rect")](-f,-p,i,o),l&&s.strokeRect(-f,-p,i,o),s.restore()}var Lr=class{constructor(t){W(this,"visible",!0),W(this,"actionName",Yc),W(this,"angle",0),W(this,"x",0),W(this,"y",0),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"sizeX",0),W(this,"sizeY",0),W(this,"touchSizeX",0),W(this,"touchSizeY",0),W(this,"cursorStyle","crosshair"),W(this,"withConnection",!1),Object.assign(this,t)}shouldActivate(t,e,r,n){var i;let{tl:o,tr:a,br:h,bl:l}=n;return((i=e.canvas)===null||i===void 0?void 0:i.getActiveObject())===e&&e.isControlVisible(t)&&Bs.isPointInPolygon(r,[o,a,h,l])}getActionHandler(t,e,r){return this.actionHandler}getMouseDownHandler(t,e,r){return this.mouseDownHandler}getMouseUpHandler(t,e,r){return this.mouseUpHandler}cursorStyleHandler(t,e,r){return e.cursorStyle}getActionName(t,e,r){return e.actionName}getVisibility(t,e){var r,n;return(r=(n=t._controlsVisibility)===null||n===void 0?void 0:n[e])!==null&&r!==void 0?r:this.visible}setVisibility(t,e,r){this.visible=t}positionHandler(t,e,r,n){return new ft(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,r,n,i,o){let a=Xc([Ko(r,n),Us({angle:t}),Kc((i?this.touchSizeX:this.sizeX)||e,(i?this.touchSizeY:this.sizeY)||e)]);return{tl:new ft(-.5,-.5).transform(a),tr:new ft(.5,-.5).transform(a),br:new ft(.5,.5).transform(a),bl:new ft(-.5,.5).transform(a)}}render(t,e,r,n,i){((n=n||{}).cornerStyle||i.cornerStyle)==="circle"?u0.call(this,t,e,r,n,i):f0.call(this,t,e,r,n,i)}},d0=(s,t,e)=>e.lockRotation?Ac:t.cursorStyle,g0=Xi(Fg,Vs((s,t,e,r)=>{let{target:n,ex:i,ey:o,theta:a,originX:h,originY:l}=t,f=n.translateToOriginPoint(n.getRelativeCenterPoint(),h,l);if(An(n,"lockRotation"))return!1;let p=Math.atan2(o-f.y,i-f.x),v=Math.atan2(r-f.y,e-f.x),g=Kn(v-p+a);if(n.snapAngle&&n.snapAngle>0){let w=n.snapAngle,C=n.snapThreshold||w,x=Math.ceil(g/w)*w,k=Math.floor(g/w)*w;Math.abs(g-k)<C?g=k:Math.abs(g-x)<C&&(g=x)}g<0&&(g=360+g),g%=360;let b=n.angle!==g;return n.angle=g,b}));function p0(s,t){let e=t.canvas,r=s[e.uniScaleKey];return e.uniformScaling&&!r||!e.uniformScaling&&r}function m0(s,t,e){let r=An(s,"lockScalingX"),n=An(s,"lockScalingY");if(r&&n||!t&&(r||n)&&e||r&&t==="x"||n&&t==="y")return!0;let{width:i,height:o,strokeWidth:a}=s;return i===0&&a===0&&t!=="y"||o===0&&a===0&&t!=="x"}var J2=["e","se","s","sw","w","nw","n","ne","e"],Mo=(s,t,e)=>{let r=p0(s,e);if(m0(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",r))return Ac;let n=Qg(e,t);return"".concat(J2[n],"-resize")};function Cf(s,t,e,r){let n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},i=t.target,o=n.by,a=p0(s,i),h,l,f,p,v,g;if(m0(i,o,a))return!1;if(t.gestureScale)l=t.scaleX*t.gestureScale,f=t.scaleY*t.gestureScale;else{if(h=Zc(t,t.originX,t.originY,e,r),v=o!=="y"?Math.sign(h.x||t.signX||1):1,g=o!=="x"?Math.sign(h.y||t.signY||1):1,t.signX||(t.signX=v),t.signY||(t.signY=g),An(i,"lockScalingFlip")&&(t.signX!==v||t.signY!==g))return!1;if(p=i._getTransformedDimensions(),a&&!o){let C=Math.abs(h.x)+Math.abs(h.y),{original:x}=t,k=C/(Math.abs(p.x*x.scaleX/i.scaleX)+Math.abs(p.y*x.scaleY/i.scaleY));l=x.scaleX*k,f=x.scaleY*k}else l=Math.abs(h.x*i.scaleX/p.x),f=Math.abs(h.y*i.scaleY/p.y);$g(t)&&(l*=2,f*=2),t.signX!==v&&o!=="y"&&(t.originX=ng(t.originX),l*=-1,t.signX=v),t.signY!==g&&o!=="x"&&(t.originY=ng(t.originY),f*=-1,t.signY=g)}let b=i.scaleX,w=i.scaleY;return o?(o==="x"&&i.set(kr,l),o==="y"&&i.set(Xr,f)):(!An(i,"lockScalingX")&&i.set(kr,l),!An(i,"lockScalingY")&&i.set(Xr,f)),b!==i.scaleX||w!==i.scaleY}var Ua=Xi(Gc,Vs((s,t,e,r)=>Cf(s,t,e,r))),v0=Xi(Gc,Vs((s,t,e,r)=>Cf(s,t,e,r,{by:"x"}))),y0=Xi(Gc,Vs((s,t,e,r)=>Cf(s,t,e,r,{by:"y"}))),Z2=["target","ex","ey","skewingSide"],Cu={x:{counterAxis:"y",scale:kr,skew:Yo,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Xr,skew:Xo,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},$2=["ns","nesw","ew","nwse"],b0=(s,t,e)=>{if(t.x!==0&&An(e,"lockSkewingY")||t.y!==0&&An(e,"lockSkewingX"))return Ac;let r=Qg(e,t)%4;return"".concat($2[r],"-resize")};function w0(s,t,e,r,n){let{target:i}=e,{counterAxis:o,origin:a,lockSkewing:h,skew:l,flip:f}=Cu[s];if(An(i,h))return!1;let{origin:p,flip:v}=Cu[o],g=tr(e[p])*(i[v]?-1:1),b=-Math.sign(g)*(i[f]?-1:1),w=.5*-((i[l]===0&&Zc(e,ie,ie,r,n)[s]>0||i[l]>0?1:-1)*b)+.5;return Xi(jg,Vs((x,k,I,G)=>function(U,nt,J){let{target:F,ex:et,ey:dt,skewingSide:N}=nt,M=De(nt,Z2),{skew:z}=Cu[U],R=J.subtract(new ft(et,dt)).divide(new ft(F.scaleX,F.scaleY))[U],ht=F[z],it=M[z],ut=Math.tan(Re(it)),Q=U==="y"?F._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:F._getTransformedDimensions({scaleX:1,scaleY:1}).y,gt=2*R*N/Math.max(Q,1)+ut,pt=Kn(Math.atan(gt));F.set(z,pt);let kt=ht!==F[z];if(kt&&U==="y"){let{skewX:T,scaleX:E}=F,B=F._getTransformedDimensions({skewY:ht}),V=F._getTransformedDimensions(),$=T!==0?B.x/V.x:1;$!==1&&F.set(kr,$*E)}return kt}(s,k,new ft(I,G))))(t,X(X({},e),{},{[a]:w,skewingSide:b}),r,n)}var x0=(s,t,e,r)=>w0("x",s,t,e,r),_0=(s,t,e,r)=>w0("y",s,t,e,r);function tl(s,t){return s[t.canvas.altActionKey]}var Wa=(s,t,e)=>{let r=tl(s,e);return t.x===0?r?Yo:Xr:t.y===0?r?Xo:kr:""},ws=(s,t,e)=>tl(s,e)?b0(0,t,e):Mo(s,t,e),Wu=(s,t,e,r)=>tl(s,t.target)?_0(s,t,e,r):v0(s,t,e,r),Vu=(s,t,e,r)=>tl(s,t.target)?x0(s,t,e,r):y0(s,t,e,r),Af=()=>({ml:new Lr({x:-.5,y:0,cursorStyleHandler:ws,actionHandler:Wu,getActionName:Wa}),mr:new Lr({x:.5,y:0,cursorStyleHandler:ws,actionHandler:Wu,getActionName:Wa}),mb:new Lr({x:0,y:.5,cursorStyleHandler:ws,actionHandler:Vu,getActionName:Wa}),mt:new Lr({x:0,y:-.5,cursorStyleHandler:ws,actionHandler:Vu,getActionName:Wa}),tl:new Lr({x:-.5,y:-.5,cursorStyleHandler:Mo,actionHandler:Ua}),tr:new Lr({x:.5,y:-.5,cursorStyleHandler:Mo,actionHandler:Ua}),bl:new Lr({x:-.5,y:.5,cursorStyleHandler:Mo,actionHandler:Ua}),br:new Lr({x:.5,y:.5,cursorStyleHandler:Mo,actionHandler:Ua}),mtr:new Lr({x:0,y:-.5,actionHandler:g0,cursorStyleHandler:d0,offsetY:-40,withConnection:!0,actionName:uf})}),S0=()=>({mr:new Lr({x:.5,y:0,actionHandler:Uu,cursorStyleHandler:ws,actionName:Ja}),ml:new Lr({x:-.5,y:0,actionHandler:Uu,cursorStyleHandler:ws,actionName:Ja})}),C0=()=>X(X({},Af()),S0()),Nc=class s extends fi{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t){super(),Object.assign(this,this.constructor.createControls(),s.ownDefaults),this.setOptions(t)}static createControls(){return{controls:Af()}}_updateCacheCanvas(){let t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){let e=t._currentTransform,r=e.target,n=e.action;if(this===r&&n&&n.startsWith(Yc))return!1}return super._updateCacheCanvas()}getActiveControl(){let t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let r=Object.entries(this.oCoords);for(let n=r.length-1;n>=0;n--){let[i,o]=r[n],a=this.controls[i];if(a.shouldActivate(i,this,t,e?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){let t=this.getViewportTransform(),e=this.getCenterPoint(),r=Ko(e.x,e.y),n=Us({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=qe(r,n),o=qe(t,i),a=qe(o,[1/t[0],0,0,1/t[3],0,0]),h=this.group?zo(this.calcTransformMatrix()):void 0;h&&(h.scaleX=Math.abs(h.scaleX),h.scaleY=Math.abs(h.scaleY));let l=this._calculateCurrentDimensions(h),f={};return this.forEachControl((p,v)=>{let g=p.positionHandler(l,a,this,p);f[v]=Object.assign(g,this._calcCornerCoords(p,g))}),f}_calcCornerCoords(t,e){let r=this.getTotalAngle();return{corner:t.calcCornerCoords(r,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(r,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(let e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();let e=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),n=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/n[0],1/n[3]),t.rotate(Re(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-r.x/2,-r.y/2,r.x,r.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=X({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);t.save(),t.strokeStyle=n.borderColor,this._setLineDash(t,n.borderDashArray),this.strokeBorders(t,e),n.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:r,hasControls:n}=this,i=X({hasBorders:r,hasControls:n},e),o=this.getViewportTransform(),a=i.hasBorders,h=i.hasControls,l=qe(o,this.calcTransformMatrix()),f=zo(l);t.save(),t.translate(f.translateX,f.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(f.angle-=180),t.rotate(Re(this.group?f.angle:this.angle)),a&&this.drawBorders(t,f,e),h&&this.drawControls(t,e),t.restore()}drawBorders(t,e,r){let n;if(r&&r.forActiveSelection||this.group){let i=Jc(this.width,this.height,nh(e)),o=this.isStrokeAccountedForInDimensions()?ff:(this.strokeUniform?new ft().scalarAdd(this.canvas?this.canvas.getZoom():1):new ft(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);n=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else n=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,n,r)}drawControlsConnectingLines(t,e){let r=!1;t.beginPath(),this.forEachControl((n,i)=>{n.withConnection&&n.getVisibility(this,i)&&(r=!0,t.moveTo(n.x*e.x,n.y*e.y),t.lineTo(n.x*e.x+n.offsetX,n.y*e.y+n.offsetY))}),r&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();let r=this.getCanvasRetinaScaling(),{cornerStrokeColor:n,cornerDashArray:i,cornerColor:o}=this,a=X({cornerStrokeColor:n,cornerDashArray:i,cornerColor:o},e);t.setTransform(r,0,0,r,0,0),t.strokeStyle=t.fillStyle=a.cornerColor,this.transparentCorners||(t.strokeStyle=a.cornerStrokeColor),this._setLineDash(t,a.cornerDashArray),this.forEachControl((h,l)=>{if(h.getVisibility(this,l)){let f=this.oCoords[l];h.render(t,f.x,f.y,a,this)}}),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach(e=>{let[r,n]=e;return this.setControlVisible(r,n)})}clearContextTop(t){if(!this.canvas)return;let e=this.canvas.contextTop;if(!e)return;let r=this.canvas.viewportTransform;e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(e);let n=this.width+4,i=this.height+4;return e.clearRect(-n/2,-i/2,n,i),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}};function A0(s,t){return t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(s.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r)||Object.create(null))})}),s}W(Nc,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var hr=class extends Nc{};A0(hr,[Lc]),Bt.setClass(hr),Bt.setClass(hr,"object");var L0=(s,t,e,r)=>{let n=2*(r=Math.round(r))+1,{data:i}=s.getImageData(t-r,e-r,n,n);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0},Mc=class{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new ft(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new ft(1/this.options.scaleX,1/this.options.scaleY):new ft(1,1)}createSideVector(t,e){let r=Pc(t,e);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(t,e,r){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){let e=new ft(t);return e.y+=e.x*Math.tan(Re(this.options.skewY)),e.x+=e.y*Math.tan(Re(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}},Q2=new ft,Dc=class s extends Mc{static getOrthogonalRotationFactor(t,e){let r=e?Oc(t,e):a0(t);return Math.abs(r)<Gi?-1:1}constructor(t,e,r,n){super(n),W(this,"AB",void 0),W(this,"AC",void 0),W(this,"alpha",void 0),W(this,"bisector",void 0),this.A=new ft(t),this.B=new ft(e),this.C=new ft(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Oc(this.AB,this.AC),this.bisector=Qc(xf(this.AB.eq(Q2)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,n=this.createSideVector(t,e),i=_f(n),o=s.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,r*o)}projectBevel(){let t=[];return(this.alpha%vi==0?[this.B]:[this.B,this.C]).forEach(e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))}),t}projectMiter(){let t=[],e=Math.abs(this.alpha),r=1/Math.sin(e/2),n=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),i=this.options.strokeUniform?kc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return kc(n)/this.strokeProjectionMagnitude<=i&&t.push(this.applySkew(this.A.add(n))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){let r=[],n=new ft(s.getOrthogonalRotationFactor(this.bisector),s.getOrthogonalRotationFactor(new ft(this.bisector.y,this.bisector.x)));return[new ft(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n),new ft(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(n)].forEach(i=>{ju(i,t,e)&&r.push(this.A.add(i))}),r}projectRoundWithSkew(t,e){let r=[],{skewX:n,skewY:i,scaleX:o,scaleY:a,strokeUniform:h}=this.options,l=new ft(Math.tan(Re(n)),Math.tan(Re(i))),f=this.strokeProjectionMagnitude,p=h?f/a/Math.sqrt(1/a**2+1/o**2*l.y**2):f/Math.sqrt(1+l.y**2),v=new ft(Math.sqrt(Math.max(f**2-p**2,0)),p),g=h?f/Math.sqrt(1+l.x**2*(1/a)**2/(1/o+1/o*l.x*l.y)**2):f/Math.sqrt(1+l.x**2/(1+l.x*l.y)**2),b=new ft(g,Math.sqrt(Math.max(f**2-g**2,0)));return[b,b.scalarMultiply(-1),v,v.scalarMultiply(-1)].map(w=>this.applySkew(h?w.multiply(this.strokeUniformScalar):w)).forEach(w=>{ju(w,t,e)&&r.push(this.applySkew(this.A).add(w))}),r}projectRound(){let t=[];t.push(...this.projectBevel());let e=this.alpha%vi==0,r=this.applySkew(this.A),n=t[e?0:2].subtract(r),i=t[e?1:0].subtract(r),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Ro(n,o)>0,h=a?n:i,l=a?i:n;return this.isSkewed()?t.push(...this.projectRoundWithSkew(h,l)):t.push(...this.projectRoundNoSkew(h,l)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector}))}},Ec=class extends Mc{constructor(t,e,r){super(r),this.A=new ft(t),this.T=new ft(e)}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,n=this.createSideVector(t,e);return this.scaleUnitVector(_f(n),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let t=[];if(!this.isSkewed()&&this.A.eq(this.T)){let e=new ft(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new Dc(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){let t=[];if(this.A.eq(this.T)){let e=new ft(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{let e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(Qc(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),n=this.A.add(r);t.push(n.add(e),n.subtract(e))}return t.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t}))}},T0=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=[];if(s.length===0)return r;let n=s.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new ft(o)),i),[new ft(s[0])]);if(n.length===1)e=!0;else if(!e){let i=n[0],o=((a,h)=>{for(let l=a.length-1;l>=0;l--)if(h(a[l],l,a))return l;return-1})(n,a=>!a.eq(i));n.splice(o+1)}return n.forEach((i,o,a)=>{let h,l;o===0?(l=a[1],h=e?i:a[a.length-1]):o===a.length-1?(h=a[o-1],l=e?i:a[0]):(h=a[o-1],l=a[o+1]),e&&a.length===1?r.push(...new Ec(i,i,t).project()):!e||o!==0&&o!==a.length-1?r.push(...new Dc(i,h,l,t).project()):r.push(...new Ec(i,o===0?l:h,t).project())}),r},Lf=s=>{let t={};return Object.keys(s).forEach(e=>{t[e]={},Object.keys(s[e]).forEach(r=>{t[e][r]=X({},s[e][r])})}),t},P0=s=>s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),qa,el=s=>{if(qa||qa||(qa="Intl"in rh()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),qa){let t=qa.segment(s);return Array.from(t).map(e=>{let{segment:r}=e;return r})}return t5(s)},t5=s=>{let t=[];for(let e,r=0;r<s.length;r++)(e=e5(s,r))!==!1&&t.push(e);return t},e5=(s,t)=>{let e=s.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return s.charAt(t);if(55296<=e&&e<=56319){if(s.length<=t+1)throw"High surrogate without following low surrogate";let n=s.charCodeAt(t+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return s.charAt(t)+s.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";let r=s.charCodeAt(t-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},r5=Object.freeze({__proto__:null,capitalize:function(s){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(s.charAt(0).toUpperCase()).concat(t?s.slice(1):s.slice(1).toLowerCase())},escapeXml:P0,graphemeSplit:el}),rl=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return s.fill!==t.fill||s.stroke!==t.stroke||s.strokeWidth!==t.strokeWidth||s.fontSize!==t.fontSize||s.fontFamily!==t.fontFamily||s.fontWeight!==t.fontWeight||s.fontStyle!==t.fontStyle||s.textDecorationThickness!==t.textDecorationThickness||s.textBackgroundColor!==t.textBackgroundColor||s.deltaY!==t.deltaY||e&&(s.overline!==t.overline||s.underline!==t.underline||s.linethrough!==t.linethrough)},k0=(s,t)=>{let e=t.split(`
`),r=[],n=-1,i={};s=Lf(s);for(let o=0;o<e.length;o++){let a=el(e[o]);if(s[o])for(let h=0;h<a.length;h++){n++;let l=s[o][h];l&&Object.keys(l).length>0&&(rl(i,l,!0)?r.push({start:n,end:n+1,style:l}):r[r.length-1].end++),i=l||{}}else n+=a.length,i={}}return r},O0=(s,t)=>{if(!Array.isArray(s))return Lf(s);let e=t.split(lf),r={},n=-1,i=0;for(let o=0;o<e.length;o++){let a=el(e[o]);for(let h=0;h<a.length;h++)n++,s[i]&&s[i].start<=n&&n<s[i].end&&(r[o]=r[o]||{},r[o][h]=X({},s[i].style),n===s[i].end-1&&i++)}return r},Ki=["display","transform",ir,"fill-opacity","fill-rule","opacity",Rr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function mg(s,t){let e=s.nodeName,r=s.getAttribute("class"),n=s.getAttribute("id"),i="(?![a-zA-Z\\-]+)",o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),n&&t.length&&(o=new RegExp("#"+n+i,"i"),t=t.replace(o,"")),r&&t.length){let a=r.split(" ");for(let h=a.length;h--;)o=new RegExp("\\."+a[h]+i,"i"),t=t.replace(o,"")}return t.length===0}function n5(s,t){let e=!0,r=mg(s,t.pop());return r&&t.length&&(e=function(n,i){let o,a=!0;for(;n.parentElement&&n.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=mg(n=n.parentElement,o);return i.length===0}(s,t)),r&&e&&t.length===0}var i5=s=>{var t;return(t=B2[s])!==null&&t!==void 0?t:s},s5=new RegExp("(".concat(Cn,")"),"gi"),o5=s=>s.replace(s5," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),vg,yg,bg,wg,xg,_g,Sg,Tr="(".concat(Cn,")"),a5=String.raw(vg||(vg=Jn(["(skewX)(",")"],["(skewX)\\(","\\)"])),Tr),h5=String.raw(yg||(yg=Jn(["(skewY)(",")"],["(skewY)\\(","\\)"])),Tr),c5=String.raw(bg||(bg=Jn(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Tr,Tr,Tr),l5=String.raw(wg||(wg=Jn(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Tr,Tr),u5=String.raw(xg||(xg=Jn(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Tr,Tr),f5=String.raw(_g||(_g=Jn(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Tr,Tr,Tr,Tr,Tr,Tr),Tf="(?:".concat(f5,"|").concat(u5,"|").concat(c5,"|").concat(l5,"|").concat(a5,"|").concat(h5,")"),d5="(?:".concat(Tf,"*)"),g5=String.raw(Sg||(Sg=Jn(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),d5),p5=new RegExp(g5),m5=new RegExp(Tf),v5=new RegExp(Tf,"g");function Hu(s){let t=[];if(!(s=o5(s).replace(/\s*([()])\s*/gi,"$1"))||s&&!p5.test(s))return[...Pr];for(let e of s.matchAll(v5)){let r=m5.exec(e[0]);if(!r)continue;let n=Pr,i=r.filter(b=>!!b),[,o,...a]=i,[h,l,f,p,v,g]=a.map(b=>parseFloat(b));switch(o){case"translate":n=Ko(h,l);break;case uf:n=Us({angle:h},{x:l,y:f});break;case Yc:n=Kc(h,l);break;case Yo:n=pf(h);break;case Xo:n=mf(h);break;case"matrix":n=[h,l,f,p,v,g]}t.push(n)}return Xc(t)}function y5(s,t,e,r){let n=Array.isArray(t),i,o=t;if(s!==ir&&s!==Rr||t!==Br){if(s==="strokeUniform")return t==="non-scaling-stroke";if(s==="strokeDashArray")o=t===Br?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(s==="transformMatrix")o=e&&e.transformMatrix?qe(e.transformMatrix,Hu(t)):Hu(t);else if(s==="visible")o=t!==Br&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(s==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(s==="textAnchor")o=t==="start"?ve:t==="end"?Ge:ie;else if(s==="charSpacing"||s===Rs)i=Is(t,r)/r*1e3;else if(s==="paintFirst"){let a=t.indexOf(ir),h=t.indexOf(Rr);o=ir,(a>-1&&h>-1&&h<a||a===-1&&h>-1)&&(o=Rr)}else{if(s==="href"||s==="xlink:href"||s==="font"||s==="id")return t;if(s==="imageSmoothing")return t==="optimizeQuality";i=n?t.map(Is):Is(t,r)}}else o="";return!n&&isNaN(i)?o:i}function b5(s,t){let e=s.match(I2);if(!e)return;let r=e[1],n=e[3],i=e[4],o=e[5],a=e[6];r&&(t.fontStyle=r),n&&(t.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),i&&(t.fontSize=Is(i)),a&&(t.fontFamily=a),o&&(t.lineHeight=o==="normal"?1:o)}function w5(s,t){s.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;let[r,n]=e.split(":");t[r.trim().toLowerCase()]=n.trim()})}function x5(s){let t={},e=s.getAttribute("style");return e&&(typeof e=="string"?w5(e,t):function(r,n){Object.entries(r).forEach(i=>{let[o,a]=i;a!==void 0&&(n[o.toLowerCase()]=a)})}(e,t)),t}var _5={stroke:"strokeOpacity",fill:"fillOpacity"};function bi(s,t,e){if(!s)return{};let r,n={},i=cf;s.parentNode&&ug.test(s.parentNode.nodeName)&&(n=bi(s.parentElement,t,e),n.fontSize&&(r=i=Is(n.fontSize)));let o=X(X(X({},t.reduce((l,f)=>{let p=s.getAttribute(f);return p&&(l[f]=p),l},{})),function(l){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p={};for(let v in f)n5(l,v.split(" "))&&(p=X(X({},p),f[v]));return p}(s,e)),x5(s));o[xu]&&s.setAttribute(xu,o[xu]),o[wu]&&(r=Is(o[wu],i),o[wu]="".concat(r));let a={};for(let l in o){let f=i5(l),p=y5(f,o[l],n,r);a[f]=p}a&&a.font&&b5(a.font,a);let h=X(X({},n),a);return ug.test(s.nodeName)?h:function(l){let f=hr.getDefaults();return Object.entries(_5).forEach(p=>{let[v,g]=p;if(l[g]===void 0||l[v]==="")return;if(l[v]===void 0){if(!f[v])return;l[v]=f[v]}if(l[v].indexOf("url(")===0)return;let b=new vr(l[v]);l[v]=b.setAlpha(Te(b.getAlpha()*l[g],2)).toRgba()}),l}(h)}var S5=["left","top","width","height","visible"],N0=["rx","ry"],di=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t){super(),Object.assign(this,s.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){let{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){let{width:e,height:r}=this,n=-e/2,i=-r/2,o=this.rx?Math.min(this.rx,e/2):0,a=this.ry?Math.min(this.ry,r/2):0,h=o!==0||a!==0;t.beginPath(),t.moveTo(n+o,i),t.lineTo(n+e-o,i),h&&t.bezierCurveTo(n+e-Ii*o,i,n+e,i+Ii*a,n+e,i+a),t.lineTo(n+e,i+r-a),h&&t.bezierCurveTo(n+e,i+r-Ii*a,n+e-Ii*o,i+r,n+e-o,i+r),t.lineTo(n+o,i+r),h&&t.bezierCurveTo(n+Ii*o,i+r,n,i+r-Ii*a,n,i+r-a),t.lineTo(n,i+a),h&&t.bezierCurveTo(n,i+Ii*a,n+Ii*o,i,n+o,i),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...N0,...t])}_toSVG(){let{width:t,height:e,rx:r,ry:n}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-t/2,'" y="').concat(-e/2,'" rx="').concat(r,'" ry="').concat(n,'" width="').concat(t,'" height="').concat(e,`" />
`)]}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,width:a=0,height:h=0,visible:l=!0}=n,f=De(n,S5);return new this(X(X(X({},e),f),{},{left:i,top:o,width:a,height:h,visible:!!(l&&a&&h)}))})}};W(di,"type","Rect"),W(di,"cacheProperties",[...yi,...N0]),W(di,"ownDefaults",{rx:0,ry:0}),W(di,"ATTRIBUTE_NAMES",[...Ki,"x","y","rx","ry","width","height"]),Bt.setClass(di),Bt.setSVGClass(di);var gi="initialization",Fc="added",Pf="removed",jc="imperative",M0=(s,t)=>{let{strokeUniform:e,strokeWidth:r,width:n,height:i,group:o}=t,a=o&&o!==s?sh(o.calcTransformMatrix(),s.calcTransformMatrix()):null,h=a?t.getRelativeCenterPoint().transform(a):t.getRelativeCenterPoint(),l=!t.isStrokeAccountedForInDimensions(),f=e&&l?Zg(new ft(r,r),void 0,s.calcTransformMatrix()):ff,p=!e&&l?r:0,v=Jc(n+p,i+p,Xc([a,t.calcOwnMatrix()],!0)).add(f).scalarDivide(2);return[h.subtract(v),h.add(v)]},Ho=class{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:r,strategy:n}=t;return e===gi||e===jc||!!r&&n!==r}shouldLayoutClipPath(t){let{type:e,target:{clipPath:r}}=t;return e!==gi&&r&&!r.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){let{type:r,target:n}=e;if(r===jc&&e.overrides)return e.overrides;if(t.length===0)return;let{left:i,top:o,width:a,height:h}=Gn(t.map(p=>M0(n,p)).reduce((p,v)=>p.concat(v),[])),l=new ft(a,h),f=new ft(i,o).add(l.scalarDivide(2));if(r===gi){let p=this.getInitialSize(e,{size:l,center:f});return{center:f,relativeCorrection:new ft(0,0),size:p}}return{center:f.transform(n.calcOwnMatrix()),size:l}}};W(Ho,"type","strategy");var th=class extends Ho{shouldPerformLayout(t){return!0}};W(th,"type","fit-content"),Bt.setClass(th);var C5=["strategy"],A5=["target","strategy","bubbles","prevStrategy"],D0="layoutManager",zs=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new th;W(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){let e=X(X({bubbles:!0,strategy:this.strategy},t),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(e);let r=this.getLayoutResult(e);r&&this.commitLayout(e,r),this.onAfterLayout(e,r),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){let{target:r}=e;return[wc,Eg,Ja,Fg,Gc,jg,bc,Ig,k2].map(n=>t.on(n,i=>this.performLayout(n===wc?{type:"object_modified",trigger:n,e:i,target:r}:{type:"object_modifying",trigger:n,e:i,target:r})))}subscribe(t,e){this.unsubscribe(t,e);let r=this.attachHandlers(t,e);this._subscriptions.set(t,r)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach(r=>r()),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach(e=>this.unsubscribe(e,t))}subscribeTargets(t){t.targets.forEach(e=>this.subscribe(e,t))}onBeforeLayout(t){let{target:e,type:r}=t,{canvas:n}=e;if(r===gi||r===Fc?this.subscribeTargets(t):r===Pf&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),n&&n.fire("object:layout:before",{target:e,context:t}),r===jc&&t.deep){let i=De(t,C5);e.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(X(X({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(t){let{target:e,strategy:r,type:n}=t,i=r.calcLayoutResult(t,e.getObjects());if(!i)return;let o=n===gi?new ft:e.getRelativeCenterPoint(),{center:a,correction:h=new ft,relativeCorrection:l=new ft}=i,f=o.subtract(a).add(h).transform(n===gi?Pr:Yr(e.calcOwnMatrix()),!0).add(l);return{result:i,prevCenter:o,nextCenter:a,offset:f}}commitLayout(t,e){let{target:r}=t,{result:{size:n},nextCenter:i}=e;var o,a;r.set({width:n.x,height:n.y}),this.layoutObjects(t,e),t.type===gi?r.set({left:(o=t.x)!==null&&o!==void 0?o:i.x+n.x*tr(r.originX),top:(a=t.y)!==null&&a!==void 0?a:i.y+n.y*tr(r.originY)}):(r.setPositionByOrigin(i,ie,ie),r.setCoords(),r.set("dirty",!0))}layoutObjects(t,e){let{target:r}=t;r.forEachObject(n=>{n.group===r&&this.layoutObject(t,e,n)}),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,r.clipPath)}layoutObject(t,e,r){let{offset:n}=e;r.set({left:r.left+n.x,top:r.top+n.y})}onAfterLayout(t,e){let{target:r,strategy:n,bubbles:i,prevStrategy:o}=t,a=De(t,A5),{canvas:h}=r;r.fire("layout:after",{context:t,result:e}),h&&h.fire("object:layout:after",{context:t,result:e,target:r});let l=r.parent;i&&l!=null&&l.layoutManager&&((a.path||(a.path=[])).push(r),l.layoutManager.performLayout(X(X({},a),{},{target:l}))),r.set("dirty",!0)}dispose(){let{_subscriptions:t}=this;t.forEach(e=>e.forEach(r=>r())),t.clear()}toObject(){return{type:D0,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};Bt.setClass(zs,D0);var L5=["type","objects","layoutManager"],Gu=class extends zs{performLayout(){}},Vi=class s extends Bg(hr){static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"_activeObjects",[]),W(this,"__objectSelectionTracker",void 0),W(this,"__objectSelectionDisposer",void 0),Object.assign(this,s.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var r;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(n=>{this.enterGroup(n,!1)}),this.layoutManager=(r=e.layoutManager)!==null&&r!==void 0?r:new zs,this.layoutManager.performLayout({type:gi,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(Hi("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(Hi("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter((e,r,n)=>this.canEnterGroup(e)&&n.indexOf(e)===r)}add(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];let n=this._filterObjectsBeforeEnteringGroup(e),i=super.add(...n);return this._onAfterObjectsChange(Fc,n),i}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];let i=this._filterObjectsBeforeEnteringGroup(r),o=super.insertAt(t,...i);return this._onAfterObjectsChange(Fc,i),o}remove(){let t=super.remove(...arguments);return this._onAfterObjectsChange(Pf,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){let r=this[t];return super._set(t,e),t==="canvas"&&r!==e&&(this._objects||[]).forEach(n=>{n._set(t,e)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:r}=e,n=this._activeObjects;if(t)n.push(r),this._set("dirty",!0);else if(n.length>0){let i=n.indexOf(r);i>-1&&(n.splice(i,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&Vo(t,qe(Yr(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);let r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===t||t.isDescendantOf(r))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(Vo(t,qe(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);let r=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){let t=hr.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,r){this._renderBackground(t);for(let i=0;i<this._objects.length;i++){var n;let o=this._objects[i];(n=this.canvas)!==null&&n!==void 0&&n.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...Yr(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(t=>t.setCoords())}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(X({target:this,type:jc},t))}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){let r=this.includeDefaultValues;return this._objects.filter(function(n){return!n.excludeFromExport}).map(function(n){let i=n.includeDefaultValues;n.includeDefaultValues=r;let o=n[t||"toObject"](e);return n.includeDefaultValues=i,o})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=this.layoutManager.toObject();return X(X(X({},super.toObject(["subTargetCheck","interactive",...t])),e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{}),{},{objects:this.__serializeObjects("toObject",t)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(t=>{this._watchObject(!1,t),t.dispose()}),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";let e=di.prototype._toSVG.call(this),r=e.indexOf("COMMON_PARTS");e[r]='for="group" ';let n=e.join("");return t?t(n):n}_toSVG(t){let e=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(t);r&&e.push("		",r);for(let n=0;n<this._objects.length;n++)e.push("		",this._objects[n].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){let t=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){let e=[],r=this._createSVGBgRect(t);r&&e.push("	",r);for(let n=0;n<this._objects.length;n++)e.push("	",this._objects[n].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:r,objects:n=[],layoutManager:i}=t,o=De(t,L5);return Promise.all([Uo(n,e),ih(o,e)]).then(a=>{let[h,l]=a,f=new this(h,X(X(X({},o),l),{},{layoutManager:new Gu}));if(i){let p=Bt.getClass(i.type),v=Bt.getClass(i.strategy);f.layoutManager=new p(new v)}else f.layoutManager=new zs;return f.layoutManager.subscribeTargets({type:gi,target:f,targets:f.getObjects()}),f.setCoords(),f})}};W(Vi,"type","Group"),W(Vi,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Bt.setClass(Vi);var E0=(s,t)=>Math.min(t.width/s.width,t.height/s.height),F0=(s,t)=>Math.max(t.width/s.width,t.height/s.height),Yu="\\s*,?\\s*",za="".concat(Yu,"(").concat(Cn,")"),T5="".concat(za).concat(za).concat(za).concat(Yu,"([01])").concat(Yu,"([01])").concat(za).concat(za),P5={m:"l",M:"L"},k5=(s,t,e,r,n,i,o,a,h,l,f)=>{let p=Ln(s),v=Tn(s),g=Ln(t),b=Tn(t),w=e*n*g-r*i*b+o,C=r*n*g+e*i*b+a;return["C",l+h*(-e*n*v-r*i*p),f+h*(-r*n*v+e*i*p),w+h*(e*n*b+r*i*g),C+h*(r*n*b-e*i*g),w,C]},Cg=(s,t,e,r)=>{let n=Math.atan2(t,s),i=Math.atan2(r,e);return i>=n?i-n:2*Math.PI-(n-i)};function Xu(s,t,e,r,n,i,o,a){let h;if(ue.cachesBoundsOfCurve&&(h=[...arguments].join(),Va.boundsOfCurveCache[h]))return Va.boundsOfCurveCache[h];let l=Math.sqrt,f=Math.abs,p=[],v=[[0,0],[0,0]],g=6*s-12*e+6*n,b=-3*s+9*e-9*n+3*o,w=3*e-3*s;for(let G=0;G<2;++G){if(G>0&&(g=6*t-12*r+6*i,b=-3*t+9*r-9*i+3*a,w=3*r-3*t),f(b)<1e-12){if(f(g)<1e-12)continue;let et=-w/g;0<et&&et<1&&p.push(et);continue}let U=g*g-4*w*b;if(U<0)continue;let nt=l(U),J=(-g+nt)/(2*b);0<J&&J<1&&p.push(J);let F=(-g-nt)/(2*b);0<F&&F<1&&p.push(F)}let C=p.length,x=C,k=I0(s,t,e,r,n,i,o,a);for(;C--;){let{x:G,y:U}=k(p[C]);v[0][C]=G,v[1][C]=U}v[0][x]=s,v[1][x]=t,v[0][x+1]=o,v[1][x+1]=a;let I=[new ft(Math.min(...v[0]),Math.min(...v[1])),new ft(Math.max(...v[0]),Math.max(...v[1]))];return ue.cachesBoundsOfCurve&&(Va.boundsOfCurveCache[h]=I),I}var O5=(s,t,e)=>{let[r,n,i,o,a,h,l,f]=e,p=((v,g,b,w,C,x,k)=>{if(b===0||w===0)return[];let I=0,G=0,U=0,nt=Math.PI,J=k*hf,F=Tn(J),et=Ln(J),dt=.5*(-et*v-F*g),N=.5*(-et*g+F*v),M=b**2,z=w**2,R=N**2,ht=dt**2,it=M*z-M*R-z*ht,ut=Math.abs(b),Q=Math.abs(w);if(it<0){let Ct=Math.sqrt(1-it/(M*z));ut*=Ct,Q*=Ct}else U=(C===x?-1:1)*Math.sqrt(it/(M*R+z*ht));let gt=U*ut*N/Q,pt=-U*Q*dt/ut,kt=et*gt-F*pt+.5*v,T=F*gt+et*pt+.5*g,E=Cg(1,0,(dt-gt)/ut,(N-pt)/Q),B=Cg((dt-gt)/ut,(N-pt)/Q,(-dt-gt)/ut,(-N-pt)/Q);x===0&&B>0?B-=2*nt:x===1&&B<0&&(B+=2*nt);let V=Math.ceil(Math.abs(B/nt*2)),$=[],at=B/V,lt=8/3*Math.sin(at/4)*Math.sin(at/4)/Math.sin(at/2),ct=E+at;for(let Ct=0;Ct<V;Ct++)$[Ct]=k5(E,ct,et,F,ut,Q,kt,T,lt,I,G),I=$[Ct][5],G=$[Ct][6],E=ct,ct+=at;return $})(l-s,f-t,n,i,a,h,o);for(let v=0,g=p.length;v<g;v++)p[v][1]+=s,p[v][2]+=t,p[v][3]+=s,p[v][4]+=t,p[v][5]+=s,p[v][6]+=t;return p},j0=s=>{let t=0,e=0,r=0,n=0,i=[],o,a=0,h=0;for(let l of s){let f=[...l],p;switch(f[0]){case"l":f[1]+=t,f[2]+=e;case"L":t=f[1],e=f[2],p=["L",t,e];break;case"h":f[1]+=t;case"H":t=f[1],p=["L",t,e];break;case"v":f[1]+=e;case"V":e=f[1],p=["L",t,e];break;case"m":f[1]+=t,f[2]+=e;case"M":t=f[1],e=f[2],r=f[1],n=f[2],p=["M",t,e];break;case"c":f[1]+=t,f[2]+=e,f[3]+=t,f[4]+=e,f[5]+=t,f[6]+=e;case"C":a=f[3],h=f[4],t=f[5],e=f[6],p=["C",f[1],f[2],a,h,t,e];break;case"s":f[1]+=t,f[2]+=e,f[3]+=t,f[4]+=e;case"S":o==="C"?(a=2*t-a,h=2*e-h):(a=t,h=e),t=f[3],e=f[4],p=["C",a,h,f[1],f[2],t,e],a=p[3],h=p[4];break;case"q":f[1]+=t,f[2]+=e,f[3]+=t,f[4]+=e;case"Q":a=f[1],h=f[2],t=f[3],e=f[4],p=["Q",a,h,t,e];break;case"t":f[1]+=t,f[2]+=e;case"T":o==="Q"?(a=2*t-a,h=2*e-h):(a=t,h=e),t=f[1],e=f[2],p=["Q",a,h,t,e];break;case"a":f[6]+=t,f[7]+=e;case"A":O5(t,e,f).forEach(v=>i.push(v)),t=f[6],e=f[7];break;case"z":case"Z":t=r,e=n,p=["Z"]}p?(i.push(p),o=p[0]):o=""}return i},Ic=(s,t,e,r)=>Math.sqrt((e-s)**2+(r-t)**2),I0=(s,t,e,r,n,i,o,a)=>h=>{let l=h**3,f=(g=>3*g**2*(1-g))(h),p=(g=>3*g*(1-g)**2)(h),v=(g=>(1-g)**3)(h);return new ft(o*l+n*f+e*p+s*v,a*l+i*f+r*p+t*v)},B0=s=>s**2,R0=s=>2*s*(1-s),q0=s=>(1-s)**2,N5=(s,t,e,r,n,i,o,a)=>h=>{let l=B0(h),f=R0(h),p=q0(h),v=3*(p*(e-s)+f*(n-e)+l*(o-n)),g=3*(p*(r-t)+f*(i-r)+l*(a-i));return Math.atan2(g,v)},M5=(s,t,e,r,n,i)=>o=>{let a=B0(o),h=R0(o),l=q0(o);return new ft(n*a+e*h+s*l,i*a+r*h+t*l)},D5=(s,t,e,r,n,i)=>o=>{let a=1-o,h=2*(a*(e-s)+o*(n-e)),l=2*(a*(r-t)+o*(i-r));return Math.atan2(l,h)},Ag=(s,t,e)=>{let r=new ft(t,e),n=0;for(let i=1;i<=100;i+=1){let o=s(i/100);n+=Ic(r.x,r.y,o.x,o.y),r=o}return n},E5=(s,t)=>{let e,r=0,n=0,i={x:s.x,y:s.y},o=X({},i),a=.01,h=0,l=s.iterator,f=s.angleFinder;for(;n<t&&a>1e-4;)o=l(r),h=r,e=Ic(i.x,i.y,o.x,o.y),e+n>t?(r-=a,a/=2):(i=o,r+=a,n+=e);return X(X({},o),{},{angle:f(h)})},kf=s=>{let t,e,r=0,n=0,i=0,o=0,a=0,h=[];for(let l of s){let f={x:n,y:i,command:l[0],length:0};switch(l[0]){case"M":e=f,e.x=o=n=l[1],e.y=a=i=l[2];break;case"L":e=f,e.length=Ic(n,i,l[1],l[2]),n=l[1],i=l[2];break;case"C":t=I0(n,i,l[1],l[2],l[3],l[4],l[5],l[6]),e=f,e.iterator=t,e.angleFinder=N5(n,i,l[1],l[2],l[3],l[4],l[5],l[6]),e.length=Ag(t,n,i),n=l[5],i=l[6];break;case"Q":t=M5(n,i,l[1],l[2],l[3],l[4]),e=f,e.iterator=t,e.angleFinder=D5(n,i,l[1],l[2],l[3],l[4]),e.length=Ag(t,n,i),n=l[3],i=l[4];break;case"Z":e=f,e.destX=o,e.destY=a,e.length=Ic(n,i,o,a),n=o,i=a}r+=e.length,h.push(e)}return h.push({length:r,x:n,y:i}),h},z0=function(s,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kf(s),r=0;for(;t-e[r].length>0&&r<e.length-2;)t-=e[r].length,r++;let n=e[r],i=t/n.length,o=s[r];switch(n.command){case"M":return{x:n.x,y:n.y,angle:0};case"Z":return X(X({},new ft(n.x,n.y).lerp(new ft(n.destX,n.destY),i)),{},{angle:Math.atan2(n.destY-n.y,n.destX-n.x)});case"L":return X(X({},new ft(n.x,n.y).lerp(new ft(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-n.y,o[1]-n.x)});case"C":case"Q":return E5(n,t)}},F5=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Lg=new RegExp(T5,"g"),j5=new RegExp(Cn,"gi"),I5={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},U0=s=>{var t;let e=[],r=(t=s.match(F5))!==null&&t!==void 0?t:[];for(let n of r){let i=n[0];if(i==="z"||i==="Z"){e.push([i]);continue}let o=I5[i.toLowerCase()],a=[];if(i==="a"||i==="A"){Lg.lastIndex=0;for(let h=null;h=Lg.exec(n);)a.push(...h.slice(1))}else a=n.match(j5)||[];for(let h=0;h<a.length;h+=o){let l=new Array(o),f=P5[i];l[0]=h>0&&f?f:i;for(let p=0;p<o;p++)l[p+1]=parseFloat(a[h+p]);e.push(l)}}return e},W0=function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new ft(s[0]),r=new ft(s[1]),n=1,i=0,o=[],a=s.length,h=a>2,l;for(h&&(n=s[2].x<r.x?-1:s[2].x===r.x?0:1,i=s[2].y<r.y?-1:s[2].y===r.y?0:1),o.push(["M",e.x-n*t,e.y-i*t]),l=1;l<a;l++){if(!e.eq(r)){let f=e.midPointFrom(r);o.push(["Q",e.x,e.y,f.x,f.y])}e=s[l],l+1<s.length&&(r=s[l+1])}return h&&(n=e.x>s[l-2].x?1:e.x===s[l-2].x?0:-1,i=e.y>s[l-2].y?1:e.y===s[l-2].y?0:-1),o.push(["L",e.x+n*t,e.y+i*t]),o},Of=(s,t)=>s.map(e=>e.map((r,n)=>n===0||t===void 0?r:Te(r,t)).join(" ")).join(" ");function Bc(s,t){let e=s.style;e&&t&&(typeof t=="string"?e.cssText+=";"+t:Object.entries(t).forEach(r=>{let[n,i]=r;return e.setProperty(n,i)}))}var B5=(s,t)=>Math.floor(Math.random()*(t-s+1))+s;function R5(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=t.onComplete||js,r=new(rh()).XMLHttpRequest,n=t.signal,i=function(){r.abort()},o=function(){n&&n.removeEventListener("abort",i),r.onerror=r.ontimeout=js};if(n&&n.aborted)throw new yc("request");return n&&n.addEventListener("abort",i,{once:!0}),r.onreadystatechange=function(){r.readyState===4&&(o(),e(r),r.onreadystatechange=js)},r.onerror=r.ontimeout=o,r.open("get",s,!0),r.send(),r}var q5=(s,t)=>{let e=s._findCenterFromElement();s.transformMatrix&&((r=>{if(r.transformMatrix){let{scaleX:n,scaleY:i,angle:o,skewX:a}=zo(r.transformMatrix);r.flipX=!1,r.flipY=!1,r.set(kr,n),r.set(Xr,i),r.angle=o,r.skewX=a,r.skewY=0}})(s),e=e.transform(s.transformMatrix)),delete s.transformMatrix,t&&(s.scaleX*=t.scaleX,s.scaleY*=t.scaleY,s.cropX=t.cropX,s.cropY=t.cropY,e.x+=t.offsetLeft,e.y+=t.offsetTop,s.width=t.width,s.height=t.height),s.setPositionByOrigin(e,ie,ie)},_y=Object.freeze({__proto__:null,addTransformToObject:Kg,animate:Sf,animateColor:l0,applyTransformToObject:Vo,calcAngleBetweenVectors:Oc,calcDimensionsMatrix:nh,calcPlaneChangeMatrix:sh,calcVectorRotation:a0,cancelAnimFrame:Rg,capValue:qs,composeMatrix:Vg,copyCanvasElement:s=>{var t;let e=Kr(s);return(t=e.getContext("2d"))===null||t===void 0||t.drawImage(s,0,0),e},cos:Ln,createCanvasElement:Xn,createImage:qg,createRotateMatrix:Us,createScaleMatrix:Kc,createSkewXMatrix:pf,createSkewYMatrix:mf,createTranslateMatrix:Ko,createVector:Pc,crossProduct:Ro,degreesToRadians:Re,dotProduct:h0,ease:U2,enlivenObjectEnlivables:ih,enlivenObjects:Uo,findScaleToCover:F0,findScaleToFit:E0,getBoundsOfCurve:Xu,getOrthonormalVector:_f,getPathSegmentsInfo:kf,getPointOnPath:z0,getPointer:Xg,getRandomInt:B5,getRegularPolygonPath:(s,t)=>{let e=2*Math.PI/s,r=-Gi;s%2==0&&(r+=e/2);let n=new Array(s+1);for(let i=0;i<s;i++){let o=i*e+r,{x:a,y:h}=new ft(Ln(o),Tn(o)).scalarMultiply(t);n[i]=[i===0?"M":"L",a,h]}return n[s]=["Z"],n},getSmoothPathFromPoints:W0,getSvgAttributes:s=>{let t=["instantiated_by_use","style","id","class"];switch(s){case"linearGradient":return t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return t.concat(["offset","stop-color","stop-opacity"])}return t},getUnitVector:Qc,groupSVGElements:(s,t)=>s&&s.length===1?s[0]:new Vi(s,t),hasStyleChanged:rl,invertTransform:Yr,isBetweenVectors:ju,isIdentityMatrix:zg,isTouchEvent:Cc,isTransparent:L0,joinPath:Of,loadImage:Ga,magnitude:kc,makeBoundingBoxFromPoints:Gn,makePathSimpler:j0,matrixToSVG:Wo,mergeClipPaths:(s,t)=>{var e;let r=s,n=t;r.inverted&&!n.inverted&&(r=t,n=s),Fu(n,(e=n.group)===null||e===void 0?void 0:e.calcTransformMatrix(),r.calcTransformMatrix());let i=r.inverted&&n.inverted;return i&&(r.inverted=n.inverted=!1),new Vi([r],{clipPath:n,inverted:i})},multiplyTransformMatrices:qe,multiplyTransformMatrixArray:Xc,parsePath:U0,parsePreserveAspectRatioAttribute:e0,parseUnit:Is,pick:Ws,projectStrokeOnPoints:T0,qrDecompose:zo,radiansToDegrees:Kn,removeFromArray:vs,removeTransformFromObject:(s,t)=>{let e=Yr(t),r=qe(e,s.calcOwnMatrix());Vo(s,r)},removeTransformMatrixForSvgParsing:q5,request:R5,requestAnimFrame:Ha,resetObjectTransform:Jg,rotatePoint:(s,t,e)=>s.rotate(e,t),rotateVector:xf,saveObjectTransform:yf,sendObjectToPlane:Fu,sendPointToPlane:mi,sendVectorToPlane:Zg,setStyle:Bc,sin:Tn,sizeAfterTransform:Jc,string:r5,stylesFromArray:O0,stylesToArray:k0,toBlob:gf,toDataURL:df,toFixed:Te,transformPath:(s,t,e)=>(e&&(t=qe(t,[1,0,0,1,-e.x,-e.y])),s.map(r=>{let n=[...r];for(let i=1;i<r.length-1;i+=2){let{x:o,y:a}=mr({x:r[i],y:r[i+1]},t);n[i]=o,n[i+1]=a}return n})),transformPoint:mr}),Ku=class extends Sc{constructor(t){let{allowTouchScrolling:e=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),W(this,"upper",void 0),W(this,"container",void 0);let{el:n}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(n,{allowTouchScrolling:e}),this.applyCanvasStyle(i,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});let o=this.createContainerElement();o.classList.add(r),n.parentNode&&n.parentNode.replaceChild(o,n),o.append(n,i),this.container=o}createUpperCanvas(){let{el:t}=this.lower,e=Xn();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){let t=Go().createElement("div");return t.setAttribute("data-fabric","wrapper"),Bc(t,{position:"relative"}),eg(t),t}applyCanvasStyle(t,e){let{styles:r,allowTouchScrolling:n}=e;Bc(t,X(X({},r),{},{"touch-action":n?"manipulation":Br})),eg(t)}setDimensions(t,e){super.setDimensions(t,e);let{el:r,ctx:n}=this.upper;Yg(r,n,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),Eu(this.upper.el,t),Eu(this.container,t)}cleanupDOM(t){let e=this.container,{el:r}=this.lower,{el:n}=this.upper;super.cleanupDOM(t),e.removeChild(n),e.removeChild(r),e.parentNode&&e.parentNode.replaceChild(r,e)}dispose(){super.dispose(),Yn().dispose(this.upper.el),delete this.upper,delete this.container}},Rc=class s extends Za{constructor(){super(...arguments),W(this,"targets",[]),W(this,"_hoveredTargets",[]),W(this,"_objectsToRender",void 0),W(this,"_currentTransform",null),W(this,"_groupSelector",null),W(this,"contextTopDirty",!1)}static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new Ku(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter(e=>!e.group&&e!==t).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){let t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;let e=this.getRetinaScaling(),r=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,r){let n=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-e+n,-r+n),i.transform(...this.viewportTransform);let o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(i),t.selectionBackgroundColor=o,i.restore();let a=Math.round(n*this.getRetinaScaling());return L0(i,a,a,a)}_isSelectionKeyPressed(t){let e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find(r=>!!r&&t[r]===!0):t[e])}_shouldClearSelection(t,e){let r=this.getActiveObjects(),n=this._activeObject;return!!(!e||e&&n&&r.length>1&&r.indexOf(e)===-1&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e)}_shouldCenterTransform(t,e,r){if(!t)return;let n;return e===Yc||e===kr||e===Xr||e===Ja?n=this.centeredScaling||t.centeredScaling:e===uf&&(n=this.centeredRotation||t.centeredRotation),n?!r:r}_getOriginFromCorner(t,e){let r={x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?r.x=Ge:["mr","tr","br"].includes(e)&&(r.x=ve),["tl","mt","tr"].includes(e)?r.y=Mu:["bl","mb","br"].includes(e)&&(r.y=Ir)),r}_setupCurrentTransform(t,e,r){var n;let i=e.group?mi(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:a}=e.getActiveControl()||{},h=r&&a?(n=a.getActionHandler(t,e,a))===null||n===void 0?void 0:n.bind(a):t0,l=((g,b,w,C)=>{if(!b||!g)return"drag";let x=C.controls[b];return x.getActionName(w,x,C)})(r,o,t,e),f=t[this.centeredKey],p=this._shouldCenterTransform(e,l,f)?{x:ie,y:ie}:this._getOriginFromCorner(e,o),v={target:e,action:l,actionHandler:h,actionPerformed:!1,corner:o,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,offsetX:i.x-e.left,offsetY:i.y-e.top,originX:p.x,originY:p.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:Re(e.angle),width:e.width,height:e.height,shiftKey:t.shiftKey,altKey:f,original:X(X({},yf(e)),{},{originX:p.x,originY:p.y})};this._currentTransform=v,this.fire("before:transform",{e:t,transform:v})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){let{x:e,y:r,deltaX:n,deltaY:i}=this._groupSelector,o=new ft(e,r).transform(this.viewportTransform),a=new ft(e+n,r+i).transform(this.viewportTransform),h=this.selectionLineWidth/2,l=Math.min(o.x,a.x),f=Math.min(o.y,a.y),p=Math.max(o.x,a.x),v=Math.max(o.y,a.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(l,f,p-l,v-f)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,l+=h,f+=h,p-=h,v-=h,hr.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(l,f,p-l,v-f))}findTarget(t){if(this.skipTargetFind)return;let e=this.getViewportPoint(t),r=this._activeObject,n=this.getActiveObjects();if(this.targets=[],r&&n.length>=1){if(r.findControl(e,Cc(t))||n.length>1&&this.searchPossibleTargets([r],e))return r;if(r===this.searchPossibleTargets([r],e)){if(this.preserveObjectStacking){let i=this.targets;this.targets=[];let o=this.searchPossibleTargets(this._objects,e);return t[this.altSelectionKey]&&o&&o!==r?(this.targets=i,r):o}return r}}return this.searchPossibleTargets(this._objects,e)}_pointIsInObjectSelectionArea(t,e){let r=t.getCoords(),n=this.getZoom(),i=t.padding/n;if(i){let[o,a,h,l]=r,f=Math.atan2(a.y-o.y,a.x-o.x),p=Ln(f)*i,v=Tn(f)*i,g=p+v,b=p-v;r=[new ft(o.x-b,o.y-g),new ft(a.x+g,a.y-b),new ft(h.x+b,h.y+g),new ft(l.x-g,l.y+b)]}return Bs.isPointInPolygon(e,r)}_checkTarget(t,e){return!!(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,mi(e,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing||!this.isTargetTransparent(t,e.x,e.y)))}_searchPossibleTargets(t,e){let r=t.length;for(;r--;){let n=t[r];if(this._checkTarget(n,e)){if(pc(n)&&n.subTargetCheck){let i=this._searchPossibleTargets(n._objects,e);i&&this.targets.push(i)}return n}}}searchPossibleTargets(t,e){let r=this._searchPossibleTargets(t,e);if(r&&pc(r)&&r.interactive&&this.targets[0]){let n=this.targets;for(let i=n.length-1;i>0;i--){let o=n[i];if(!pc(o)||!o.interactive)return o}return n[0]}return r}getViewportPoint(t){return this._pointer?this._pointer:this.getPointer(t,!0)}getScenePoint(t){return this._absolutePointer?this._absolutePointer:this.getPointer(t)}getPointer(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.upperCanvasEl,n=r.getBoundingClientRect(),i=Xg(t),o=n.width||0,a=n.height||0;o&&a||(Ir in n&&Mu in n&&(a=Math.abs(n.top-n.bottom)),Ge in n&&ve in n&&(o=Math.abs(n.right-n.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,e||(i=mi(i,void 0,this.viewportTransform));let h=this.getRetinaScaling();h!==1&&(i.x/=h,i.y/=h);let l=o===0||a===0?new ft(1,1):new ft(r.width/o,r.height/a);return i.multiply(l)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Xn(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let t=this._activeObject;return ys(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let r=!1,n=!1,i=this.getActiveObjects(),o=[],a=[];t.forEach(h=>{i.includes(h)||(r=!0,h.fire("deselected",{e,target:h}),a.push(h))}),i.forEach(h=>{t.includes(h)||(r=!0,h.fire("selected",{e,target:h}),o.push(h))}),t.length>0&&i.length>0?(n=!0,r&&this.fire("selection:updated",{e,selected:o,deselected:a})):i.length>0?(n=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(n=!0,this.fire("selection:cleared",{e,deselected:a})),n&&(this._objectsToRender=void 0)}setActiveObject(t,e){let r=this.getActiveObjects(),n=this._setActiveObject(t,e);return this._fireSelectionEvents(r,e),n}_setActiveObject(t,e){let r=this._activeObject;return r!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,ys(t)&&r!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){let r=this._activeObject;return!!r&&!r.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(t),ys(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){let e=this.getActiveObjects(),r=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[r]});let n=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),n}endCurrentTransform(t){let e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){let e=this._currentTransform,r=e.target,n={e:t,target:r,transform:e,action:e.action};r._scaling&&(r._scaling=!1),r.setCoords(),e.actionPerformed&&(this.fire("object:modified",n),r.fire(wc,n))}setViewportTransform(t){super.setViewportTransform(t);let e=this._activeObject;e&&e.setCoords()}destroy(){let t=this._activeObject;ys(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){let e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,r){let n=this._realizeGroupTransformOnObject(t),i=super._toObject(t,e,r);return t.set(n),i}_realizeGroupTransformOnObject(t){let{group:e}=t;if(e&&ys(e)&&this._activeObject===e){let r=Ws(t,["angle","flipX","flipY",ve,kr,Xr,Yo,Xo,Ir]);return Kg(t,e.calcOwnMatrix()),r}return{}}_setSVGObject(t,e,r){let n=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,r),e.set(n)}};W(Rc,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});var Ju=class{constructor(t){W(this,"targets",[]),W(this,"__disposer",void 0);let e=()=>{let{hiddenTextarea:n}=t.getActiveObject()||{};n&&n.focus()},r=t.upperCanvasEl;r.addEventListener("click",e),this.__disposer=()=>r.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach(t=>{t.isEditing&&t.exitEditing()})}add(t){this.targets.push(t)}remove(t){this.unregister(t),vs(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},z5=["target","oldTarget","fireCanvas","e"],Gr={passive:!1},No=(s,t)=>{let e=s.getViewportPoint(t),r=s.getScenePoint(t);return{viewportPoint:e,scenePoint:r,pointer:e,absolutePointer:r}},Bi=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return s.addEventListener(...e)},on=function(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return s.removeEventListener(...e)},U5={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},qc=class extends Rc{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),W(this,"_isClick",void 0),W(this,"textEditingManager",new Ju(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(Bi,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t,e){let r=this.upperCanvasEl,n=this._getEventPrefix();t(Gg(r),"resize",this._onResize),t(r,n+"down",this._onMouseDown),t(r,"".concat(n,"move"),this._onMouseMove,Gr),t(r,"".concat(n,"out"),this._onMouseOut),t(r,"".concat(n,"enter"),this._onMouseEnter),t(r,"wheel",this._onMouseWheel),t(r,"contextmenu",this._onContextMenu),t(r,"click",this._onClick),t(r,"dblclick",this._onClick),t(r,"dragstart",this._onDragStart),t(r,"dragend",this._onDragEnd),t(r,"dragover",this._onDragOver),t(r,"dragenter",this._onDragEnter),t(r,"dragleave",this._onDragLeave),t(r,"drop",this._onDrop),this.enablePointerEvents||t(r,"touchstart",this._onTouchStart,Gr)}removeListeners(){this.addOrRemove(on,"remove");let t=this._getEventPrefix(),e=Sn(this.upperCanvasEl);on(e,"".concat(t,"up"),this._onMouseUp),on(e,"touchend",this._onTouchEnd,Gr),on(e,"".concat(t,"move"),this._onMouseMove,Gr),on(e,"touchmove",this._onMouseMove,Gr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this.__onMouseWheel(t)}_onMouseOut(t){let e=this._hoveredTarget,r=X({e:t},No(this,t));this.fire("mouse:out",X(X({},r),{},{target:e})),this._hoveredTarget=void 0,e&&e.fire("mouseout",X({},r)),this._hoveredTargets.forEach(n=>{this.fire("mouse:out",X(X({},r),{},{target:n})),n&&n.fire("mouseout",X({},r))}),this._hoveredTargets=[]}_onMouseEnter(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",X({e:t},No(this,t))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;let e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;let r={e:t,target:e};return this.fire("dragstart",r),e.fire("dragstart",r),void Bi(this.upperCanvasEl,"drag",this._onDragProgress)}rg(t)}_renderDragEffects(t,e,r){let n=!1,i=this._dropTarget;i&&i!==e&&i!==r&&(i.clearContextTop(),n=!0),e?.clearContextTop(),r!==e&&r?.clearContextTop();let o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),n=!0),r&&(o.save(),r.transform(o),r.renderDropTargetEffect(t),o.restore(),n=!0),o.restore(),n&&(this.contextTopDirty=!0)}_onDragEnd(t){let e=!!t.dataTransfer&&t.dataTransfer.dropEffect!==Br,r=e?this._activeObject:void 0,n={e:t,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:e,dropTarget:r};on(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",n),this._dragSource&&this._dragSource.fire("dragend",n),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){let e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}findDragTargets(t){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(t)),targets:[...this.targets]}}_onDragOver(t){let e="dragover",{target:r,targets:n}=this.findDragTargets(t),i=this._dragSource,o={e:t,target:r,subTargets:n,dragSource:i,canDrop:!1,dropTarget:void 0},a;this.fire(e,o),this._fireEnterLeaveEvents(r,o),r&&(r.canDrop(t)&&(a=r),r.fire(e,o));for(let h=0;h<n.length;h++){let l=n[h];l.canDrop(t)&&(a=l),l.fire(e,o)}this._renderDragEffects(t,i,a),this._dropTarget=a}_onDragEnter(t){let{target:e,targets:r}=this.findDragTargets(t),n={e:t,target:e,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",n),this._fireEnterLeaveEvents(e,n)}_onDragLeave(t){let e={e:t,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",e),this._fireEnterLeaveEvents(void 0,e),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(t){let{target:e,targets:r}=this.findDragTargets(t),n=this._basicEventHandler("drop:before",X({e:t,target:e,subTargets:r,dragSource:this._dragSource},No(this,t)));n.didDrop=!1,n.dropTarget=void 0,this._basicEventHandler("drop",n),this.fire("drop:after",n)}_onContextMenu(t){let e=this.findTarget(t),r=this.targets||[],n=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:r});return this.stopContextMenu&&rg(t),this._basicEventHandler("contextmenu",n),!1}_onClick(t){let e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}getPointerId(t){let e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){let e=!this.allowTouchScrolling,r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),(this.isDrawingMode||r&&this._target===r)&&(e=!0),e&&t.preventDefault(),this._resetTransformEventData();let n=this.upperCanvasEl,i=this._getEventPrefix(),o=Sn(n);Bi(o,"touchend",this._onTouchEnd,Gr),e&&Bi(o,"touchmove",this._onMouseMove,Gr),on(n,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(t){this.__onMouseDown(t),this._resetTransformEventData();let e=this.upperCanvasEl,r=this._getEventPrefix();on(e,"".concat(r,"move"),this._onMouseMove,Gr);let n=Sn(e);Bi(n,"".concat(r,"up"),this._onMouseUp),Bi(n,"".concat(r,"move"),this._onMouseMove,Gr)}_onTouchEnd(t){if(t.touches.length>0)return;this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;let e=this._getEventPrefix(),r=Sn(this.upperCanvasEl);on(r,"touchend",this._onTouchEnd,Gr),on(r,"touchmove",this._onMouseMove,Gr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Bi(this.upperCanvasEl,"".concat(e,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(t){this.__onMouseUp(t),this._resetTransformEventData();let e=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(t)){let n=Sn(this.upperCanvasEl);on(n,"".concat(r,"up"),this._onMouseUp),on(n,"".concat(r,"move"),this._onMouseMove,Gr),Bi(e,"".concat(r,"move"),this._onMouseMove,Gr)}}_onMouseMove(t){let e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){let e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._cacheTransformEventData(t),this._handleEvent(t,"up:before");let r=this._currentTransform,n=this._isClick,i=this._target,{button:o}=t;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let a,h,l=!1;if(r&&(this._finalizeCurrentTransform(t),l=r.actionPerformed),!n){let f=i===this._activeObject;this.handleSelection(t),l||(l=this._shouldRender(i)||!f&&i===this._activeObject)}if(i){let f=i.findControl(this.getViewportPoint(t),Cc(t)),{key:p,control:v}=f||{};if(h=p,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,t),l=!0;else if(v){let g=v.getMouseUpHandler(t,i,v);g&&(a=this.getScenePoint(t),g.call(v,t,r,a.x,a.y))}i.isMoving=!1}if(r&&(r.target!==i||r.corner!==h)){let f=r.target&&r.target.controls[r.corner],p=f&&f.getMouseUpHandler(t,r.target,f);a=a||this.getScenePoint(t),p&&p.call(f,t,r,a.x,a.y)}this._setCursorFromEvent(t,i),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),l?this.requestRenderAll():n||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){let{target:r,subTargets:n=[]}=e;this.fire(t,e),r&&r.fire(t,e);for(let i=0;i<n.length;i++)n[i]!==r&&n[i].fire(t,e);return e}_handleEvent(t,e,r){let n=this._target,i=this.targets||[],o=X(X(X({e:t,target:n,subTargets:i},No(this,t)),{},{transform:this._currentTransform},e==="up:before"||e==="up"?{isClick:this._isClick,currentTarget:this.findTarget(t),currentSubTargets:this.targets}:{}),e==="down:before"||e==="down"?r:{});this.fire("mouse:".concat(e),o),n&&n.fire("mouse".concat(e),o);for(let a=0;a<i.length;a++)i[a]!==n&&i[a].fire("mouse".concat(e),o)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());let e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){let e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){let e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._cacheTransformEventData(t),this._handleEvent(t,"down:before");let e=this._target,r=!!e&&e===this._activeObject,{button:n}=t;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(t,"down",{alreadySelected:r}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let i=this._shouldRender(e),o=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,o=!0,i=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){let a=this.getScenePoint(t);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(r=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);let a=e.findControl(this.getViewportPoint(t),Cc(t));if(e===this._activeObject&&(a||!o)){this._setupCurrentTransform(t,e,r);let h=a?a.control:void 0,l=this.getScenePoint(t),f=h&&h.getMouseDownHandler(t,e,h);f&&f.call(h,t,this._currentTransform,l.x,l.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:r}),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._pointer=this.getViewportPoint(t),this._absolutePointer=mi(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)}__onMouseMove(t){if(this._isClick=!1,this._cacheTransformEventData(t),this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;let e=this._groupSelector;if(e){let r=this.getScenePoint(t);e.deltaX=r.x-e.x,e.deltaY=r.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{let r=this.findTarget(t);this._setCursorFromEvent(t,r),this._fireOverOutEvents(t,r)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move"),this._resetTransformEventData()}_fireOverOutEvents(t,e){let r=this._hoveredTarget,n=this._hoveredTargets,i=this.targets,o=Math.max(n.length,i.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:r,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e:t,target:i[a],oldTarget:n[a]});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(t,e){let r=this._draggedoverTarget,n=this._hoveredTargets,i=this.targets,o=Math.max(n.length,i.length);this.fireSyntheticInOutEvents("drag",X(X({},e),{},{target:t,oldTarget:r,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",X(X({},e),{},{target:i[a],oldTarget:n[a]}));this._draggedoverTarget=t}fireSyntheticInOutEvents(t,e){let{target:r,oldTarget:n,fireCanvas:i,e:o}=e,a=De(e,z5),{targetIn:h,targetOut:l,canvasIn:f,canvasOut:p}=U5[t],v=n!==r;if(n&&v){let g=X(X({},a),{},{e:o,target:n,nextTarget:r},No(this,o));i&&this.fire(p,g),n.fire(l,g)}if(r&&v){let g=X(X({},a),{},{e:o,target:r,previousTarget:n},No(this,o));i&&this.fire(f,g),r.fire(h,g)}}__onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_transformObject(t){let e=this.getScenePoint(t),r=this._currentTransform,n=r.target,i=n.group?mi(e,void 0,n.group.calcTransformMatrix()):e;r.shiftKey=t.shiftKey,r.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,r,i),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,r){let{action:n,actionHandler:i,target:o}=e,a=!!i&&i(t,e,r.x,r.y);a&&o.setCoords(),n==="drag"&&a&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||a}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let r=e.hoverCursor||this.hoverCursor,n=ys(this._activeObject)?this._activeObject:null,i=(!n||e.group!==n)&&e.findControl(this.getViewportPoint(t));if(i){let o=i.control;this.setCursor(o.cursorStyleHandler(t,o,e))}else e.subTargetCheck&&this.targets.concat().reverse().map(o=>{r=o.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(t,e){let r=this._activeObject,n=ys(r);if(r&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(r!==e||n)&&(n||!e.isDescendantOf(r)&&!r.isDescendantOf(e))&&!e.onSelect({e:t})&&!r.getActiveControl()){if(n){let i=r.getObjects();if(e===r){let o=this.getViewportPoint(t);if(!(e=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!e.selectable)return!1}e.group===r?(r.remove(e),this._hoveredTarget=e,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),t)):(r.multiSelectAdd(e),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,t)}else{r.isEditing&&r.exitEditing();let i=new(Bt.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(r,e),this._hoveredTarget=i,this._setActiveObject(i,t),this._fireSelectionEvents([r],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;let{x:e,y:r,deltaX:n,deltaY:i}=this._groupSelector,o=new ft(e,r),a=o.add(new ft(n,i)),h=o.min(a),l=o.max(a).subtract(h),f=this.collectObjects({left:h.x,top:h.y,width:l.x,height:l.y},{includeIntersecting:!this.selectionFullyContained}),p=o.eq(a)?f[0]?[f[0]]:[]:f.length>1?f.filter(v=>!v.onSelect({e:t})).reverse():f;if(p.length===1)this.setActiveObject(p[0],t);else if(p.length>1){let v=Bt.getClass("ActiveSelection");this.setActiveObject(new v(p,{canvas:this}),t)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},V0={x1:0,y1:0,x2:0,y2:0},W5=X(X({},V0),{},{r1:0,r2:0}),Do=(s,t)=>isNaN(s)&&typeof t=="number"?t:s,V5=/^(\d+\.\d+)%|(\d+)%$/;function H0(s){return s&&V5.test(s)}function G0(s,t){let e=typeof s=="number"?s:typeof s=="string"?parseFloat(s)/(H0(s)?100:1):NaN;return qs(0,Do(e,t),1)}var H5=/\s*;\s*/,G5=/\s*:\s*/;function Y5(s,t){let e,r,n=s.getAttribute("style");if(n){let o=n.split(H5);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){let[h,l]=o[a].split(G5).map(f=>f.trim());h==="stop-color"?e=l:h==="stop-opacity"&&(r=l)}}let i=new vr(e||s.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:G0(s.getAttribute("offset"),0),color:i.toRgb(),opacity:Do(parseFloat(r||s.getAttribute("stop-opacity")||""),1)*i.getAlpha()*t}}function X5(s,t){let e=[],r=s.getElementsByTagName("stop"),n=G0(t,1);for(let i=r.length;i--;)e.push(Y5(r[i],n));return e}function Y0(s){return s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?"linear":"radial"}function X0(s){return s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function _n(s,t){return s.getAttribute(t)}function K5(s,t){return function(e,r){let n,{width:i,height:o,gradientUnits:a}=r;return Object.keys(e).reduce((h,l)=>{let f=e[l];return f==="Infinity"?n=1:f==="-Infinity"?n=0:(n=typeof f=="string"?parseFloat(f):f,typeof f=="string"&&H0(f)&&(n*=.01,a==="pixels"&&(l!=="x1"&&l!=="x2"&&l!=="r2"||(n*=i),l!=="y1"&&l!=="y2"||(n*=o)))),h[l]=n,h},{})}(Y0(s)==="linear"?function(e){return{x1:_n(e,"x1")||0,y1:_n(e,"y1")||0,x2:_n(e,"x2")||"100%",y2:_n(e,"y2")||0}}(s):function(e){return{x1:_n(e,"fx")||_n(e,"cx")||"50%",y1:_n(e,"fy")||_n(e,"cy")||"50%",r1:0,x2:_n(e,"cx")||"50%",y2:_n(e,"cy")||"50%",r2:_n(e,"r")||"50%"}}(s),X(X({},t),{},{gradientUnits:X0(s)}))}var Eo=class{constructor(t){let{type:e="linear",gradientUnits:r="pixels",coords:n={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:h,id:l}=t||{};Object.assign(this,{type:e,gradientUnits:r,coords:X(X({},e==="radial"?W5:V0),n),colorStops:i,offsetX:o,offsetY:a,gradientTransform:h,id:l?"".concat(l,"_").concat(Yi()):Yi()})}addColorStop(t){for(let e in t){let r=new vr(t[e]);this.colorStops.push({offset:parseFloat(e),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(t){return X(X({},Ws(this,t)),{},{type:this.type,coords:X({},this.coords),colorStops:this.colorStops.map(e=>X({},e)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[],n=this.gradientTransform?this.gradientTransform.concat():Pr.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(p=>X({},p)).sort((p,v)=>p.offset-v.offset),a=-this.offsetX,h=-this.offsetY;var l;i==="objectBoundingBox"?(a/=t.width,h/=t.height):(a+=t.width/2,h+=t.height/2),(l=t)&&typeof l._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=t.pathOffset.x,h-=t.pathOffset.y),n[4]-=a,n[5]-=h;let f=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(e?e+" ":"").concat(Wo(n),'"'),""].join(" ");if(this.type==="linear"){let{x1:p,y1:v,x2:g,y2:b}=this.coords;r.push("<linearGradient ",f,' x1="',p,'" y1="',v,'" x2="',g,'" y2="',b,`">
`)}else if(this.type==="radial"){let{x1:p,y1:v,x2:g,y2:b,r1:w,r2:C}=this.coords,x=w>C;r.push("<radialGradient ",f,' cx="',x?p:g,'" cy="',x?v:b,'" r="',x?w:C,'" fx="',x?g:p,'" fy="',x?b:v,`">
`),x&&(o.reverse(),o.forEach(I=>{I.offset=1-I.offset}));let k=Math.min(w,C);if(k>0){let I=k/Math.max(w,C);o.forEach(G=>{G.offset+=I*(1-G.offset)})}}return o.forEach(p=>{let{color:v,offset:g,opacity:b}=p;r.push("<stop ",'offset="',100*g+"%",'" style="stop-color:',v,b!==void 0?";stop-opacity: "+b:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(t){let{x1:e,y1:r,x2:n,y2:i,r1:o,r2:a}=this.coords,h=this.type==="linear"?t.createLinearGradient(e,r,n,i):t.createRadialGradient(e,r,o,n,i,a);return this.colorStops.forEach(l=>{let{color:f,opacity:p,offset:v}=l;h.addColorStop(v,p!==void 0?new vr(f).setAlpha(p).toRgba():f)}),h}static fromObject(t){return jr(this,null,function*(){let{colorStops:e,gradientTransform:r}=t;return new this(X(X({},t),{},{colorStops:e?e.map(n=>X({},n)):void 0,gradientTransform:r?[...r]:void 0}))})}static fromElement(t,e,r){let n=X0(t),i=e._findCenterFromElement();return new this(X({id:t.getAttribute("id")||void 0,type:Y0(t),coords:K5(t,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:X5(t,r.opacity),gradientUnits:n,gradientTransform:Hu(t.getAttribute("gradientTransform")||"")},n==="pixels"?{offsetX:e.width/2-i.x,offsetY:e.height/2-i.y}:{offsetX:0,offsetY:0}))}};W(Eo,"type","Gradient"),Bt.setClass(Eo,"gradient"),Bt.setClass(Eo,"linear"),Bt.setClass(Eo,"radial");var J5=["type","source","patternTransform"],Ka=class{get type(){return"pattern"}set type(t){Hi("warn","Setting type has no effect",t)}constructor(t){W(this,"repeat","repeat"),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"crossOrigin",""),this.id=Yi(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:e,crossOrigin:r}=this;return X(X({},Ws(this,t)),{},{type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:r,offsetX:Te(this.offsetX,ue.NUM_FRACTION_DIGITS),offsetY:Te(this.offsetY,ue.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(t){let{width:e,height:r}=t,{source:n,repeat:i,id:o}=this,a=Do(this.offsetX/e,0),h=Do(this.offsetY/r,0),l=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):Do(n.width/e,0),f=i==="repeat-x"||i==="no-repeat"?1+Math.abs(h||0):Do(n.height/r,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(h,'" width="').concat(l,'" height="').concat(f,'">'),'<image x="0" y="0" width="'.concat(n.width,'" height="').concat(n.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static fromObject(t,e){return jr(this,null,function*(){let{type:r,source:n,patternTransform:i}=t,o=De(t,J5),a=yield Ga(n,X(X({},e),{},{crossOrigin:o.crossOrigin}));return new this(X(X({},o),{},{patternTransform:i&&i.slice(0),source:a}))})}};W(Ka,"type","Pattern"),Bt.setClass(Ka),Bt.setClass(Ka,"pattern");var Zu=class{constructor(t){W(this,"color","rgb(0, 0, 0)"),W(this,"width",1),W(this,"shadow",null),W(this,"strokeLineCap","round"),W(this,"strokeLineJoin","round"),W(this,"strokeMiterLimit",10),W(this,"strokeDashArray",null),W(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){let e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new vr(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;let t=this.canvas,e=this.shadow,r=t.contextTop,n=t.getZoom()*t.getRetinaScaling();r.shadowColor=e.color,r.shadowBlur=e.blur*n,r.shadowOffsetX=e.offsetX*n,r.shadowOffsetY=e.offsetY*n}_resetShadow(){let t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}},Z5=["path","left","top"],$5=["d"],zi=class s extends hr{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:n,top:i}=e,o=De(e,Z5);super(),Object.assign(this,s.ownDefaults),this.setOptions(o),this._setPath(t||[],!0),typeof n=="number"&&this.set(ve,n),typeof i=="number"&&this.set(Ir,i)}_setPath(t,e){this.path=j0(Array.isArray(t)?t:U0(t)),this.setBoundingBox(e)}_findCenterFromElement(){let t=this._calcBoundsFromPath();return new ft(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){let e=-this.pathOffset.x,r=-this.pathOffset.y;t.beginPath();for(let n of this.path)switch(n[0]){case"L":t.lineTo(n[1]+e,n[2]+r);break;case"M":t.moveTo(n[1]+e,n[2]+r);break;case"C":t.bezierCurveTo(n[1]+e,n[2]+r,n[3]+e,n[4]+r,n[5]+e,n[6]+r);break;case"Q":t.quadraticCurveTo(n[1]+e,n[2]+r,n[3]+e,n[4]+r);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X(X({},super.toObject(t)),{},{path:this.path.map(e=>e.slice())})}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){let t=Of(this.path,ue.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(t,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){let t=ue.NUM_FRACTION_DIGITS;return" translate(".concat(Te(-this.pathOffset.x,t),", ").concat(Te(-this.pathOffset.y,t),")")}toClipPathSVG(t){let e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){let e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){let{width:e,height:r,pathOffset:n}=this._calcDimensions();this.set({width:e,height:r,pathOffset:n}),t&&this.setPositionByOrigin(n,ie,ie)}_calcBoundsFromPath(){let t=[],e=0,r=0,n=0,i=0;for(let o of this.path)switch(o[0]){case"L":n=o[1],i=o[2],t.push({x:e,y:r},{x:n,y:i});break;case"M":n=o[1],i=o[2],e=n,r=i;break;case"C":t.push(...Xu(n,i,o[1],o[2],o[3],o[4],o[5],o[6])),n=o[5],i=o[6];break;case"Q":t.push(...Xu(n,i,o[1],o[2],o[1],o[2],o[3],o[4])),n=o[3],i=o[4];break;case"Z":n=e,i=r}return Gn(t)}_calcDimensions(){let t=this._calcBoundsFromPath();return X(X({},t),{},{pathOffset:new ft(t.left+t.width/2,t.top+t.height/2)})}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,this.ATTRIBUTE_NAMES,r),{d:i}=n;return new this(i,X(X(X({},De(n,$5)),e),{},{left:void 0,top:void 0}))})}};W(zi,"type","Path"),W(zi,"cacheProperties",[...yi,"path","fillRule"]),W(zi,"ATTRIBUTE_NAMES",[...Ki,"d"]),Bt.setClass(zi),Bt.setSVGClass(zi);var Tg=class s extends Zu{constructor(t){super(t),W(this,"decimate",.4),W(this,"drawStraightLine",!1),W(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,r){let n=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,n.x,n.y),n}onMouseDown(t,e){let{e:r}=e;this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:r}=e;if(this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{let n=this._points,i=n.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=s.drawSegment(o,n[i-2],n[i-1]),o.stroke(),o.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],r=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===r.x&&e.y===r.y){let n=this.width/1e3;e.x-=n,r.x+=n}t.moveTo(e.x,e.y);for(let n=1;n<this._points.length;n++)s.drawSegment(t,e,r),e=this._points[n],r=this._points[n+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){let e=this.width/1e3;return W0(t,e)}createPath(t){let e=new zi(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new Wi(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let r,n=t[0],i=this.canvas.getZoom(),o=Math.pow(e/i,2),a=t.length-1,h=[n];for(let l=1;l<a-1;l++)r=Math.pow(n.x-t[l].x,2)+Math.pow(n.y-t[l].y,2),r>=o&&(n=t[l],h.push(n));return h.push(t[a]),h}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));let t=this.convertPointsToSVGPath(this._points);if(function(r){return Of(r)==="M 0 0 Q 0 0 0 0 L 0 0"}(t))return void this.canvas.requestRenderAll();let e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}},Q5=["left","top","radius"],K0=["radius","startAngle","endAngle","counterClockwise"],Ri=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t){super(),Object.assign(this,s.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,Re(this.startAngle),Re(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(kr)}getRadiusY(){return this.get("radius")*this.get(Xr)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...K0,...t])}_toSVG(){let t=(this.endAngle-this.startAngle)%360;if(t===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{let{radius:e}=this,r=Re(this.startAngle),n=Re(this.endAngle),i=Ln(r)*e,o=Tn(r)*e,a=Ln(n)*e,h=Tn(n)*e,l=t>180?1:0,f=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(e," ").concat(e," 0 ").concat(l," ").concat(f," ").concat(a," ").concat(h,'" '),"COMMON_PARTS",` />
`]}}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,radius:a=0}=n;return new this(X(X({},De(n,Q5)),{},{radius:a,left:i-a,top:o-a}))})}static fromObject(t){return super._fromObject(t)}};W(Ri,"type","Circle"),W(Ri,"cacheProperties",[...yi,...K0]),W(Ri,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),W(Ri,"ATTRIBUTE_NAMES",["cx","cy","r",...Ki]),Bt.setClass(Ri),Bt.setSVGClass(Ri);var tm=["x1","y1","x2","y2"],em=["x1","y1","x2","y2"],$u=["x1","x2","y1","y2"],bs=class s extends hr{constructor(){let[t,e,r,n]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,s.ownDefaults),this.setOptions(i),this.x1=t,this.x2=r,this.y1=e,this.y2=n,this._setWidthHeight();let{left:o,top:a}=i;typeof o=="number"&&this.set(ve,o),typeof a=="number"&&this.set(Ir,a)}_setWidthHeight(){let{x1:t,y1:e,x2:r,y2:n}=this;this.width=Math.abs(r-t),this.height=Math.abs(n-e);let{left:i,top:o,width:a,height:h}=Gn([{x:t,y:e},{x:r,y:n}]),l=new ft(i+a/2,o+h/2);this.setPositionByOrigin(l,ie,ie)}_set(t,e){return super._set(t,e),$u.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();let e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;let r=t.strokeStyle;var n;hn(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(n=this.stroke)!==null&&n!==void 0?n:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=r}_findCenterFromElement(){return new ft((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X(X({},super.toObject(t)),this.calcLinePoints())}_getNonTransformedDimensions(){let t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){let{x1:t,x2:e,y1:r,y2:n,width:i,height:o}=this,a=t<=e?-1:1,h=r<=n?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:h*o/2,y2:h*-o/2}}_toSVG(){let{x1:t,x2:e,y1:r,y2:n}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(t,'" y1="').concat(r,'" x2="').concat(e,'" y2="').concat(n,`" />
`)]}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,this.ATTRIBUTE_NAMES,r),{x1:i=0,y1:o=0,x2:a=0,y2:h=0}=n;return new this([i,o,a,h],De(n,tm))})}static fromObject(t){let{x1:e,y1:r,x2:n,y2:i}=t,o=De(t,em);return this._fromObject(X(X({},o),{},{points:[e,r,n,i]}),{extraParam:"points"})}};W(bs,"type","Line"),W(bs,"cacheProperties",[...yi,...$u]),W(bs,"ATTRIBUTE_NAMES",Ki.concat($u)),Bt.setClass(bs),Bt.setSVGClass(bs);var Fo=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t){super(),Object.assign(this,s.ownDefaults),this.setOptions(t)}_render(t){let e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,r),t.lineTo(0,-r),t.lineTo(e,r),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){let t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-t," ").concat(e,",0 ").concat(-e,",").concat(t," ").concat(e),'" />']}};W(Fo,"type","Triangle"),W(Fo,"ownDefaults",{width:100,height:100}),Bt.setClass(Fo),Bt.setSVGClass(Fo);var J0=["rx","ry"],qi=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t){super(),Object.assign(this,s.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(kr)}getRy(){return this.get("ry")*this.get(Xr)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...J0,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,vi,!1),t.restore(),this._renderPaintInOrder(t)}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,this.ATTRIBUTE_NAMES,r);return n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,new this(n)})}};function rm(s){if(!s)return[];let t=s.replace(/,/g," ").trim().split(/\s+/),e=[];for(let r=0;r<t.length;r+=2)e.push({x:parseFloat(t[r]),y:parseFloat(t[r+1])});return e}W(qi,"type","Ellipse"),W(qi,"cacheProperties",[...yi,...J0]),W(qi,"ownDefaults",{rx:0,ry:0}),W(qi,"ATTRIBUTE_NAMES",[...Ki,"cx","cy","rx","ry"]),Bt.setClass(qi),Bt.setSVGClass(qi);var nm=["left","top"],Z0={exactBoundingBox:!1},Wn=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"strokeDiff",void 0),Object.assign(this,s.ownDefaults),this.setOptions(e),this.points=t;let{left:r,top:n}=e;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(ve,r),typeof n=="number"&&this.set(Ir,n)}isOpen(){return!0}_projectStrokeOnPoints(t){return T0(this.points,t,this.isOpen())}_calcDimensions(t){t=X({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},t||{});let e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map(l=>l.projectedPoint):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new ft,strokeOffset:new ft,strokeDiff:new ft};let r=Gn(e),n=nh(X(X({},t),{},{scaleX:1,scaleY:1})),i=Gn(this.points.map(l=>mr(l,n,!0))),o=new ft(this.scaleX,this.scaleY),a=r.left+r.width/2,h=r.top+r.height/2;return this.exactBoundingBox&&(a-=h*Math.tan(Re(this.skewX)),h-=a*Math.tan(Re(this.skewY))),X(X({},r),{},{pathOffset:new ft(a,h),strokeOffset:new ft(i.left,i.top).subtract(new ft(r.left,r.top)).multiply(o),strokeDiff:new ft(r.width,r.height).subtract(new ft(i.width,i.height)).multiply(o)})}_findCenterFromElement(){let t=Gn(this.points);return new ft(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){let{left:e,top:r,width:n,height:i,pathOffset:o,strokeOffset:a,strokeDiff:h}=this._calcDimensions();this.set({width:n,height:i,pathOffset:o,strokeOffset:a,strokeDiff:h}),t&&this.setPositionByOrigin(new ft(e+n/2,r+i/2),ie,ie)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new ft(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var e,r;let{width:a,height:h}=this._calcDimensions(t);o=new ft((e=t.width)!==null&&e!==void 0?e:a,(r=t.height)!==null&&r!==void 0?r:h)}else{var n,i;o=new ft((n=t.width)!==null&&n!==void 0?n:this.width,(i=t.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new ft(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){let r=this.initialized&&this[t]!==e,n=super._set(t,e);return this.exactBoundingBox&&r&&((t===kr||t===Xr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),n}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X(X({},super.toObject(t)),{},{points:this.points.map(e=>{let{x:r,y:n}=e;return{x:r,y:n}})})}_toSVG(){let t=[],e=this.pathOffset.x,r=this.pathOffset.y,n=ue.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)t.push(Te(this.points[i].x-e,n),",",Te(this.points[i].y-r,n)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(t.join(""),`" />
`)]}_render(t){let e=this.points.length,r=this.pathOffset.x,n=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-n);for(let i=0;i<e;i++){let o=this.points[i];t.lineTo(o.x-r,o.y-n)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static fromElement(t,e,r){return jr(this,null,function*(){return new this(rm(t.getAttribute("points")),X(X({},De(bi(t,this.ATTRIBUTE_NAMES,r),nm)),e))})}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}};W(Wn,"ownDefaults",Z0),W(Wn,"type","Polyline"),W(Wn,"layoutProperties",[Yo,Xo,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),W(Wn,"cacheProperties",[...yi,"points"]),W(Wn,"ATTRIBUTE_NAMES",[...Ki]),Bt.setClass(Wn),Bt.setSVGClass(Wn);var jo=class extends Wn{isOpen(){return!1}};W(jo,"ownDefaults",Z0),W(jo,"type","Polygon"),Bt.setClass(jo),Bt.setSVGClass(jo);var zc=class extends hr{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;let e=t===void 0?this.styles:{line:this.styles[t]};for(let r in e)for(let n in e[r])for(let i in e[r][n])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;let r=e===void 0?this.styles:{0:this.styles[e]};for(let n in r)for(let i in r[n])if(r[n][i][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;let e=this.styles,r,n,i=0,o=!0,a=0;for(let h in e){r=0;for(let l in e[h]){let f=e[h][l]||{};i++,f[t]!==void 0?(n?f[t]!==n&&(o=!1):n=f[t],f[t]===this[t]&&delete f[t]):o=!1,Object.keys(f).length!==0?r++:delete e[h][l]}r===0&&delete e[h]}for(let h=0;h<this._textLines.length;h++)a+=this._textLines[h].length;o&&i===a&&(this[t]=n,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;let e=this.styles,r,n,i;for(n in e){for(i in r=e[n],r)delete r[i][t],Object.keys(r[i]).length===0&&delete r[i];Object.keys(r).length===0&&delete e[n]}}_extendStyles(t,e){let{lineIndex:r,charIndex:n}=this.get2DCursorLocation(t);this._getLineStyle(r)||this._setLineStyle(r);let i=vf(X(X({},this._getStyleDeclaration(r,n)),e),o=>o!==void 0);this._setStyleDeclaration(r,n,i)}getSelectionStyles(t,e,r){let n=[];for(let i=t;i<(e||t);i++)n.push(this.getStyleAtPosition(i,r));return n}getStyleAtPosition(t,e){let{lineIndex:r,charIndex:n}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(r,n):this._getStyleDeclaration(r,n)}setSelectionStyles(t,e,r){for(let n=e;n<(r||e);n++)this._extendStyles(n,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var r;let n=this.styles&&this.styles[t];return n&&(r=n[e])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(t,e){return X(X({},Ws(this,this.constructor._styleProperties)),this._getStyleDeclaration(t,e))}_setStyleDeclaration(t,e,r){this.styles[t][e]=r}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}};W(zc,"_styleProperties",F2);var im=/  +/g,sm=/"/g;function Au(s,t,e,r,n){return"		".concat(function(i,o){let{left:a,top:h,width:l,height:f}=o,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ue.NUM_FRACTION_DIGITS,v=$a(ir,i,!1),[g,b,w,C]=[a,h,l,f].map(x=>Te(x,p));return"<rect ".concat(v,' x="').concat(g,'" y="').concat(b,'" width="').concat(w,'" height="').concat(C,'"></rect>')}(s,{left:t,top:e,width:r,height:n}),`
`)}var om=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"],Lu,an=class s extends zc{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t,e){super(),W(this,"__charBounds",[]),Object.assign(this,s.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let t=this.path;t&&(t.segmentsInfo=kf(t.path))}_splitText(){let t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Hn)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,r,n,i,o,a;for(let h=0,l=this._textLines.length;h<l;h++)if((this.textAlign===Hn||h!==l-1&&!this.isEndOfWrapping(h))&&(n=0,i=this._textLines[h],e=this.getLineWidth(h),e<this.width&&(a=this.textLines[h].match(this._reSpacesAndTabs)))){r=a.length,t=(this.width-e)/r;for(let f=0;f<=i.length;f++)o=this.__charBounds[h][f],this._reSpaceAndTab.test(i[f])?(o.width+=t,o.kernedWidth+=t,o.left+=n,n+=t):o.left+=n}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){let r=e?this._unwrappedTextLines:this._textLines,n;for(n=0;n<r.length;n++){if(t<=r[n].length)return{lineIndex:n,charIndex:t};t-=r[n].length+this.missingNewlineOffset(n,e)}return{lineIndex:n-1,charIndex:r[n-1].length<t?r[n-1].length:t}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){let e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===Rr?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,r){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case ie:t.textBaseline="middle";break;case"ascender":t.textBaseline=Ir;break;case"descender":t.textBaseline=Mu}t.font=this._getFontDeclaration(e,r)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,r=this._textLines.length;e<r;e++){let n=this.getLineWidth(e);n>t&&(t=n)}return t}_renderTextLine(t,e,r,n,i,o){this._renderChars(t,e,r,n,i,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let e=t.fillStyle,r=this._getLeftOffset(),n=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){let a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){n+=a;continue}let h=this._textLines[i].length,l=this._getLineLeftOffset(i),f,p,v=0,g=0,b=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let w=0;w<h;w++){let C=this.__charBounds[i][w];p=this.getValueOfPropertyAt(i,w,"textBackgroundColor"),this.path?(t.save(),t.translate(C.renderLeft,C.renderTop),t.rotate(C.angle),t.fillStyle=p,p&&t.fillRect(-C.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),C.width,a/this.lineHeight),t.restore()):p!==b?(f=r+l+g,this.direction==="rtl"&&(f=this.width-f-v),t.fillStyle=b,b&&t.fillRect(f,n,v,a/this.lineHeight),g=C.left,v=C.width,b=p):v+=C.kernedWidth}p&&!this.path&&(f=r+l+g,this.direction==="rtl"&&(f=this.width-f-v),t.fillStyle=p,t.fillRect(f,n,v,a/this.lineHeight)),n+=a}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,r,n){let i=Va.getFontCache(e),o=this._getFontDeclaration(e),a=r+t,h=r&&o===this._getFontDeclaration(n),l=e.fontSize/this.CACHE_FONT_SIZE,f,p,v,g;if(r&&i[r]!==void 0&&(v=i[r]),i[t]!==void 0&&(g=f=i[t]),h&&i[a]!==void 0&&(p=i[a],g=p-v),f===void 0||v===void 0||p===void 0){let b=function(){return Lu||(Lu=Kr({width:0,height:0}).getContext("2d")),Lu}();this._setTextStyles(b,e,!0),f===void 0&&(g=f=b.measureText(t).width,i[t]=f),v===void 0&&h&&r&&(v=b.measureText(r).width,i[r]=v),h&&p===void 0&&(p=b.measureText(a).width,i[a]=p,g=p-v)}return{width:f*l,kernedWidth:g*l}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){let e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,r,n=0,i=this.pathSide===Ge,o=this.path,a=this._textLines[t],h=a.length,l=new Array(h);this.__charBounds[t]=l;for(let f=0;f<h;f++){let p=a[f];r=this._getGraphemeBox(p,t,f,e),l[f]=r,n+=r.kernedWidth,e=p}if(l[h]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let f=0,p=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case ve:f=i?p-n:0;break;case ie:f=(p-n)/2;break;case Ge:f=i?0:p-n}f+=this.pathStartOffset*(i?-1:1);for(let v=i?h-1:0;i?v>=0:v<h;i?v--:v++)r=l[v],f>p?f%=p:f<0&&(f+=p),this._setGraphemeOnPath(f,r),f+=r.kernedWidth}return{width:n,numOfSpaces:0}}_setGraphemeOnPath(t,e){let r=t+e.kernedWidth/2,n=this.path,i=z0(n.path,r,n.segmentsInfo);e.renderLeft=i.x-n.pathOffset.x,e.renderTop=i.y-n.pathOffset.y,e.angle=i.angle+(this.pathSide===Ge?Math.PI:0)}_getGraphemeBox(t,e,r,n,i){let o=this.getCompleteStyleDeclaration(e,r),a=n?this.getCompleteStyleDeclaration(e,r-1):{},h=this._measureChar(t,o,n,a),l,f=h.kernedWidth,p=h.width;this.charSpacing!==0&&(l=this._getWidthOfCharSpacing(),p+=l,f+=l);let v={width:p,left:0,height:o.fontSize,kernedWidth:f,deltaY:o.deltaY};if(r>0&&!i){let g=this.__charBounds[e][r-1];v.left=g.left+g.width+h.kernedWidth-h.width}return v}getHeightOfLine(t){if(this.__lineHeights[t])return this.__lineHeights[t];let e=this.getHeightOfChar(t,0);for(let r=1,n=this._textLines[t].length;r<n;r++)e=Math.max(this.getHeightOfChar(t,r),e);return this.__lineHeights[t]=e*this.lineHeight*this._fontSizeMult}calcTextHeight(){let t,e=0;for(let r=0,n=this._textLines.length;r<n;r++)t=this.getHeightOfLine(r),e+=r===n-1?t/this.lineHeight:t;return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let r=0,n=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){let h=this.getHeightOfLine(o),l=h/this.lineHeight,f=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],n+f,i+r+l,o),r+=h}t.restore()}_renderTextFill(t){(this.fill||this.styleHas(ir))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,r,n,i,o){let a=this.getHeightOfLine(o),h=this.textAlign.includes(Hn),l=this.path,f=!h&&this.charSpacing===0&&this.isEmptyStyles(o)&&!l,p=this.direction==="ltr",v=this.direction==="ltr"?1:-1,g=e.direction,b,w,C,x,k,I="",G=0;if(e.save(),g!==this.direction&&(e.canvas.setAttribute("dir",p?"ltr":"rtl"),e.direction=p?"ltr":"rtl",e.textAlign=p?ve:Ge),i-=a*this._fontSizeFraction/this.lineHeight,f)return this._renderChar(t,e,o,0,r.join(""),n,i),void e.restore();for(let U=0,nt=r.length-1;U<=nt;U++)x=U===nt||this.charSpacing||l,I+=r[U],C=this.__charBounds[o][U],G===0?(n+=v*(C.kernedWidth-C.width),G+=C.width):G+=C.kernedWidth,h&&!x&&this._reSpaceAndTab.test(r[U])&&(x=!0),x||(b=b||this.getCompleteStyleDeclaration(o,U),w=this.getCompleteStyleDeclaration(o,U+1),x=rl(b,w,!1)),x&&(l?(e.save(),e.translate(C.renderLeft,C.renderTop),e.rotate(C.angle),this._renderChar(t,e,o,U,I,-G/2,0),e.restore()):(k=n,this._renderChar(t,e,o,U,I,k,i)),I="",b=w,n+=v*G,G=0);e.restore()}_applyPatternGradientTransformText(t){let e=this.width+this.strokeWidth,r=this.height+this.strokeWidth,n=Kr({width:e,height:r}),i=n.getContext("2d");return n.width=e,n.height=r,i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(e,r),i.lineTo(0,r),i.closePath(),i.translate(e/2,r/2),i.fillStyle=t.toLive(i),this._applyPatternGradientTransform(i,t),i.fill(),i.createPattern(n,"no-repeat")}handleFiller(t,e,r){let n,i;return hn(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(n=-this.width/2,i=-this.height/2,t.translate(n,i),t[e]=this._applyPatternGradientTransformText(r),{offsetX:n,offsetY:i}):(t[e]=r.toLive(t),this._applyPatternGradientTransform(t,r)):(t[e]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:r,strokeWidth:n}=e;return t.lineWidth=n,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",r)}_setFillStyles(t,e){let{fill:r}=e;return this.handleFiller(t,"fillStyle",r)}_renderChar(t,e,r,n,i,o,a){let h=this._getStyleDeclaration(r,n),l=this.getCompleteStyleDeclaration(r,n),f=t==="fillText"&&l.fill,p=t==="strokeText"&&l.stroke&&l.strokeWidth;if(p||f){if(e.save(),e.font=this._getFontDeclaration(l),h.textBackgroundColor&&this._removeShadow(e),h.deltaY&&(a+=h.deltaY),f){let v=this._setFillStyles(e,l);e.fillText(i,o-v.offsetX,a-v.offsetY)}if(p){let v=this._setStrokeStyles(e,l);e.strokeText(i,o-v.offsetX,a-v.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,r){let n=this.get2DCursorLocation(t,!0),i=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),o=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),a={fontSize:i*r.size,deltaY:o+i*r.baseline};this.setSelectionStyles(a,t,e)}_getLineLeftOffset(t){let e=this.getLineWidth(t),r=this.width-e,n=this.textAlign,i=this.direction,o=this.isEndOfWrapping(t),a=0;return n===Hn||n===Xa&&!o||n===Ya&&!o||n===Tc&&!o?0:(n===ie&&(a=r/2),n===Ge&&(a=r),n===Xa&&(a=r/2),n===Ya&&(a=r),i==="rtl"&&(n===Ge||n===Hn||n===Ya?a=0:n===ve||n===Tc?a=-r:n!==ie&&n!==Xa||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];let{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,r){var n;return(n=this._getStyleDeclaration(t,e)[r])!==null&&n!==void 0?n:this[r]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let r=this._getTopOffset(),n=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=e==="linethrough"?.5:e==="overline"?1:0,h=this.offsets[e];for(let l=0,f=this._textLines.length;l<f;l++){let p=this.getHeightOfLine(l);if(!this[e]&&!this.styleHas(e,l)){r+=p;continue}let v=this._textLines[l],g=p/this.lineHeight,b=this._getLineLeftOffset(l),w=0,C=0,x=this.getValueOfPropertyAt(l,0,e),k=this.getValueOfPropertyAt(l,0,ir),I=this.getValueOfPropertyAt(l,0,Rs),G=x,U=k,nt=I,J=r+g*(1-this._fontSizeFraction),F=this.getHeightOfChar(l,0),et=this.getValueOfPropertyAt(l,0,"deltaY");for(let M=0,z=v.length;M<z;M++){let R=this.__charBounds[l][M];G=this.getValueOfPropertyAt(l,M,e),U=this.getValueOfPropertyAt(l,M,ir),nt=this.getValueOfPropertyAt(l,M,Rs);let ht=this.getHeightOfChar(l,M),it=this.getValueOfPropertyAt(l,M,"deltaY");if(i&&G&&U){let ut=this.fontSize*nt/1e3;t.save(),t.fillStyle=k,t.translate(R.renderLeft,R.renderTop),t.rotate(R.angle),t.fillRect(-R.kernedWidth/2,h*ht+it-a*ut,R.kernedWidth,ut),t.restore()}else if((G!==x||U!==k||ht!==F||nt!==I||it!==et)&&C>0){let ut=this.fontSize*I/1e3,Q=n+b+w;this.direction==="rtl"&&(Q=this.width-Q-C),x&&k&&I&&(t.fillStyle=k,t.fillRect(Q,J+h*F+et-a*ut,C,ut)),w=R.left,C=R.width,x=G,I=nt,k=U,F=ht,et=it}else C+=R.kernedWidth}let dt=n+b+w;this.direction==="rtl"&&(dt=this.width-dt-C),t.fillStyle=U;let N=this.fontSize*nt/1e3;G&&U&&nt&&t.fillRect(dt,J+h*F+et-a*N,C-o,N),r+=p}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:n=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,o=t.includes("'")||t.includes('"')||t.includes(",")||s.genericFonts.includes(t.toLowerCase())?t:'"'.concat(t,'"');return[e,r,"".concat(i?this.CACHE_FONT_SIZE:n,"px"),o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return el(t)}_splitTextIntoLines(t){let e=t.split(this._reNewline),r=new Array(e.length),n=[`
`],i=[];for(let o=0;o<e.length;o++)r[o]=this.graphemeSplit(e[o]),i=i.concat(r[o],n);return i.pop(),{_unwrappedLines:r,lines:e,graphemeText:i,graphemeLines:r}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return X(X({},super.toObject([...s0,...t])),{},{styles:k0(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(t,e){let{textLayoutProperties:r}=this.constructor;super.set(t,e);let n=!1,i=!1;if(typeof t=="object")for(let o in t)o==="path"&&this.setPathInfo(),n=n||r.includes(o),i=i||o==="path";else n=r.includes(t),i=t==="path";return i&&this.setPathInfo(),n&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static fromElement(t,e,r){return jr(this,null,function*(){let n=bi(t,s.ATTRIBUTE_NAMES,r),i=X(X({},e),n),{textAnchor:o=ve,textDecoration:a="",dx:h=0,dy:l=0,top:f=0,left:p=0,fontSize:v=cf,strokeWidth:g=1}=i,b=De(i,om),w=new this((t.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),X({left:p+h,top:f+l,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:v},b)),C=w.getScaledHeight()/w.height,x=((w.height+w.strokeWidth)*w.lineHeight-w.height)*C,k=w.getScaledHeight()+x,I=0;return o===ie&&(I=w.getScaledWidth()/2),o===Ge&&(I=w.getScaledWidth()),w.set({left:w.left-I,top:w.top-(k-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:g}),w})}static fromObject(t){return this._fromObject(X(X({},t),{},{styles:O0(t.styles||{},t.text)}),{extraParam:"text"})}};W(an,"textLayoutProperties",i0),W(an,"cacheProperties",[...yi,...s0]),W(an,"ownDefaults",j2),W(an,"type","Text"),W(an,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),W(an,"ATTRIBUTE_NAMES",Ki.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),A0(an,[class extends Lc{_toSVG(){let s=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(s.textTop,s.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(s){let t=this._createBaseSVGMarkup(this._toSVG(),{reviver:s,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:s,withShadow:!0,additionalTransform:Wo(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(s){let{textBgRects:t,textSpans:e}=s,r=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(sm,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(s,t){let e=[],r=[],n,i=s;this.backgroundColor&&r.push(...Au(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)n=this._getLineLeftOffset(o),this.direction==="rtl"&&(n+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(r,o,t+n,i),this._setSVGTextLineText(e,o,t+n,i),i+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:r}}_createTextCharSpan(s,t,e,r,n){let i=ue.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,s!==s.trim()||!!s.match(im)),a=o?'style="'.concat(o,'"'):"",h=t.deltaY,l=h?' dy="'.concat(Te(h,i),'" '):"",{angle:f,renderLeft:p,renderTop:v,width:g}=n,b="";if(p!==void 0){let w=g/2;f&&(b=' rotate="'.concat(Te(Kn(f),i),'"'));let C=Us({angle:Kn(f)});C[4]=p,C[5]=v;let x=new ft(-w,0).transform(C);e=x.x,r=x.y}return'<tspan x="'.concat(Te(e,i),'" y="').concat(Te(r,i),'" ').concat(l).concat(b).concat(a,">").concat(P0(s),"</tspan>")}_setSVGTextLineText(s,t,e,r){let n=this.getHeightOfLine(t),i=this.textAlign.includes(Hn),o=this._textLines[t],a,h,l,f,p,v="",g=0;r+=n*(1-this._fontSizeFraction)/this.lineHeight;for(let b=0,w=o.length-1;b<=w;b++)p=b===w||this.charSpacing||this.path,v+=o[b],l=this.__charBounds[t][b],g===0?(e+=l.kernedWidth-l.width,g+=l.width):g+=l.kernedWidth,i&&!p&&this._reSpaceAndTab.test(o[b])&&(p=!0),p||(a=a||this.getCompleteStyleDeclaration(t,b),h=this.getCompleteStyleDeclaration(t,b+1),p=rl(a,h,!0)),p&&(f=this._getStyleDeclaration(t,b),s.push(this._createTextCharSpan(v,f,e,r,l)),v="",a=h,this.direction==="rtl"?e-=g:e+=g,g=0)}_setSVGTextLineBg(s,t,e,r){let n=this._textLines[t],i=this.getHeightOfLine(t)/this.lineHeight,o,a=0,h=0,l=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let f=0;f<n.length;f++){let{left:p,width:v,kernedWidth:g}=this.__charBounds[t][f];o=this.getValueOfPropertyAt(t,f,"textBackgroundColor"),o!==l?(l&&s.push(...Au(l,e+h,r,a,i)),h=p,a=v,l=o):a+=g}o&&s.push(...Au(l,e+h,r,a,i))}_getSVGLineTopOffset(s){let t,e=0;for(t=0;t<s;t++)e+=this.getHeightOfLine(t);let r=this.getHeightOfLine(t);return{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(s){return"".concat(super.getSvgStyles(s)," text-decoration-thickness: ").concat(Te(this.textDecorationThickness*this.getObjectScaling().y/10,ue.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(s,t){let{fontFamily:e,strokeWidth:r,stroke:n,fill:i,fontSize:o,fontStyle:a,fontWeight:h,deltaY:l,textDecorationThickness:f,linethrough:p,overline:v,underline:g}=s,b=this.getSvgTextDecoration({underline:g??this.underline,overline:v??this.overline,linethrough:p??this.linethrough}),w=f||this.textDecorationThickness;return[n?$a(Rr,n):"",r?"stroke-width: ".concat(r,"; "):"",e?"font-family: ".concat(e.includes("'")||e.includes('"')?e:"'".concat(e,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",h?"font-weight: ".concat(h,"; "):"",b?"text-decoration: ".concat(b,"; text-decoration-thickness: ").concat(Te(w*this.getObjectScaling().y/10,ue.NUM_FRACTION_DIGITS),"%; "):"",i?$a(ir,i):"",l?"baseline-shift: ".concat(-l,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(s){return["overline","underline","line-through"].filter(t=>s[t.replace("-","")]).join(" ")}}]),Bt.setClass(an),Bt.setSVGClass(an);var Qu=class{constructor(t){W(this,"target",void 0),W(this,"__mouseDownInPlace",!1),W(this,"__dragStartFired",!1),W(this,"__isDraggingOver",!1),W(this,"__dragStartSelection",void 0),W(this,"__dragImageDisposer",void 0),W(this,"_dispose",void 0),this.target=t;let e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(t){let e=this.target,r=e.getSelectionStartFromPointer(t);return e.isEditing&&r>=e.selectionStart&&r<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){let e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var r;let{selectionStart:n,selectionEnd:i}=e,o=this.target,a=o.canvas,h=new ft(o.flipX?-1:1,o.flipY?-1:1),l=o._getCursorBoundaries(n),f=new ft(l.left+l.leftOffset,l.top+l.topOffset).multiply(h).transform(o.calcTransformMatrix()),p=a.getScenePoint(t).subtract(f),v=o.getCanvasRetinaScaling(),g=o.getBoundingRect(),b=f.subtract(new ft(g.left,g.top)),w=a.viewportTransform,C=b.add(p).transform(w,!0),x=o.backgroundColor,k=Lf(o.styles);o.backgroundColor="";let I={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(I,0,n),o.setSelectionStyles(I,i,o.text.length),o.dirty=!0;let G=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=x,o.styles=k,o.dirty=!0,Bc(G,{position:"fixed",left:"".concat(-G.width,"px"),border:Br,width:"".concat(G.width/v,"px"),height:"".concat(G.height/v,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{G.remove()},Sn(t.target||this.target.hiddenTextarea).body.appendChild(G),(r=t.dataTransfer)===null||r===void 0||r.setDragImage(G,C.x,C.y)}onDragStart(t){this.__dragStartFired=!0;let e=this.target,r=this.isActive();if(r&&t.dataTransfer){let n=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},i=e._text.slice(n.selectionStart,n.selectionEnd).join(""),o=X({text:e.text,value:i},n);t.dataTransfer.setData("text/plain",i),t.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:e.getSelectionStyles(n.selectionStart,n.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),r}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let e=this.target.getSelectionStartFromPointer(t),r=this.__dragStartSelection;return e<r.selectionStart||e>r.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t,r=this.targetCanDrop(e);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(t){let{e}=t,r=this.targetCanDrop(e);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;let{e:r}=t,n=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let i=(e=r.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(i&&!n){let o=this.target,a=o.canvas,h=o.getSelectionStartFromPointer(r),{styles:l}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},f=i[Math.max(0,i.length-1)],p=0;if(this.__dragStartSelection){let v=this.__dragStartSelection.selectionStart,g=this.__dragStartSelection.selectionEnd;h>v&&h<=g?h=v:h>g&&(h-=g-v),o.removeChars(v,g),delete this.__dragStartSelection}o._reNewline.test(f)&&(o._reNewline.test(o._text[h])||h===o._text.length)&&(i=i.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(i,l,h),a.setActiveObject(o),o.enterEditing(r),o.selectionStart=Math.min(h+p,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(bc,{index:h+p,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;let n=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,h=((r=e.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Br;h===Br?(n.selectionStart=o,n.selectionEnd=a,n._updateTextarea(),n.hiddenTextarea.focus()):(n.clearContextTop(),h==="move"&&(n.removeChars(o,a),n.selectionStart=n.selectionEnd=o,n.hiddenTextarea&&(n.hiddenTextarea.value=n.text),n._updateTextarea(),n.fire(bc,{index:o,action:"dragend"}),i.fire("text:changed",{target:n}),i.requestRenderAll()),n.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},Pg=/[ \n\.,;!\?\-]/,tf=class extends an{constructor(){super(...arguments),W(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:r,delay:n,onComplete:i}=t;return Sf({startValue:this._currentCursorOpacity,endValue:e,duration:r,delay:n,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach(e=>{e&&!e.isDone()&&(t=!0,e.abort())}),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(t=>!t||t.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,r=t-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r--;for(;/\S/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findWordBoundaryRight(t){let e=0,r=t;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}findLineBoundaryLeft(t){let e=0,r=t-1;for(;!/\n/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findLineBoundaryRight(t){let e=0,r=t;for(;!/\n/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}searchWordBoundary(t,e){let r=this._text,n=t>0&&this._reSpace.test(r[t])&&(e===-1||!lf.test(r[t-1]))?t-1:t,i=r[n];for(;n>0&&n<r.length&&!Pg.test(i);)n+=e,i=r[n];return e===-1&&Pg.test(i)&&n++,n}selectWord(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;let r=this.searchWordBoundary(t,-1),n=Math.max(r,this.searchWordBoundary(t,1));this.selectionStart=r,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){var e;t=(e=t)!==null&&e!==void 0?e:this.selectionStart;let r=this.findLineBoundaryLeft(t),n=this.findLineBoundaryRight(t);this.selectionStart=r,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;let e=this.hiddenTextarea;Sn(e).activeElement!==e&&e.focus();let r=this.getSelectionStartFromPointer(t),n=this.selectionStart,i=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&n!==i||n!==r&&i!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,r){let n=r.slice(0,t),i=this.graphemeSplit(n).length;if(t===e)return{selectionStart:i,selectionEnd:i};let o=r.slice(t,e);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,r){let n=r.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+r.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let t=this.hiddenTextarea;this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let e=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),r=this.get2DCursorLocation(t),n=r.lineIndex,i=r.charIndex,o=this.getValueOfPropertyAt(n,i,"fontSize")*this.lineHeight,a=e.leftOffset,h=this.getCanvasRetinaScaling(),l=this.canvas.upperCanvasEl,f=l.width/h,p=l.height/h,v=f-o,g=p-o,b=new ft(e.left+a,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new ft(l.clientWidth/f,l.clientHeight/p));return b.x<0&&(b.x=0),b.x>v&&(b.x=v),b.y<0&&(b.y=0),b.y>g&&(b.y=g),b.x+=this.canvas._offset.left,b.y+=this.canvas._offset.top,{left:"".concat(b.x,"px"),top:"".concat(b.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){let t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(wc),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){let{lineIndex:r,charIndex:n}=this.get2DCursorLocation(t,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(e,!0);if(r!==i){if(this.styles[r])for(let a=n;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){let h=this.styles[i][a];h&&(this.styles[r]||(this.styles[r]={}),this.styles[r][n+a-o]=h)}for(let a=r+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,r-i)}else if(this.styles[r]){let a=this.styles[r],h=o-n;for(let l=n;l<o;l++)delete a[l];for(let l in this.styles[r]){let f=parseInt(l,10);f>=o&&(a[f-h]=a[l],delete a[l])}}}shiftLineStyles(t,e){let r=Object.assign({},this.styles);for(let n in this.styles){let i=parseInt(n,10);i>t&&(this.styles[i+e]=r[i],r[i-e]||delete this.styles[i])}}insertNewlineStyleObject(t,e,r,n){let i={},o=this._unwrappedTextLines[t].length,a=o===e,h=!1;r||(r=1),this.shiftLineStyles(t,r);let l=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(let p in this.styles[t]){let v=parseInt(p,10);v>=e&&(h=!0,i[v-e]=this.styles[t][p],a&&e===0||delete this.styles[t][p])}let f=!1;for(h&&!a&&(this.styles[t+r]=i,f=!0),(f||o>e)&&r--;r>0;)n&&n[r-1]?this.styles[t+r]={0:X({},n[r-1])}:l?this.styles[t+r]={0:X({},l)}:delete this.styles[t+r],r--;this._forceClearCache=!0}insertCharStyleObject(t,e,r,n){this.styles||(this.styles={});let i=this.styles[t],o=i?X({},i):{};r||(r=1);for(let h in o){let l=parseInt(h,10);l>=e&&(i[l+r]=o[l],o[l-r]||delete i[l])}if(this._forceClearCache=!0,n){for(;r--;)Object.keys(n[r]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+r]=X({},n[r]));return}if(!i)return;let a=i[e?e-1:1];for(;a&&r--;)this.styles[t][e+r]=X({},a)}insertNewStyleBlock(t,e,r){let n=this.get2DCursorLocation(e,!0),i=[0],o,a=0;for(let h=0;h<t.length;h++)t[h]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,i[0],r),r=r&&r.slice(i[0]+1)),a&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(n.lineIndex+o,0,i[o],r):r&&this.styles[n.lineIndex+o]&&r[0]&&(this.styles[n.lineIndex+o][0]=r[0]),r=r&&r.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(n.lineIndex+o,0,i[o],r)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;n>r&&this.removeStyleFromTo(r,n);let i=this.graphemeSplit(t);this.insertNewStyleBlock(i,r,e),this._text=[...this._text.slice(0,r),...i,...this._text.slice(n)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,r){r<=t?(e===t?this._selectionDirection=ve:this._selectionDirection===Ge&&(this._selectionDirection=ve,this.selectionEnd=t),this.selectionStart=r):r>t&&r<e?this._selectionDirection===Ge?this.selectionEnd=r:this.selectionStart=r:(e===t?this._selectionDirection=Ge:this._selectionDirection===ve&&(this._selectionDirection=Ge,this.selectionStart=e),this.selectionEnd=r)}},ef=class extends tf{initHiddenTextarea(){let t=this.canvas&&Sn(this.canvas.getElement())||Go(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,h]=o;return e.setAttribute(a,h)});let{top:r,left:n,fontSize:i}=this._calcTextareaPosition();e.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(n,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,h]=o;return e.addEventListener(a,this[h].bind(this))}),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;let e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){let e=this.fromPaste,{value:r,selectionStart:n,selectionEnd:i}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;let o=()=>{this.updateFromTextArea(),this.fire(bc),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();let a=this._splitTextIntoLines(r).graphemeText,h=this._text.length,l=a.length,f=this.selectionStart,p=this.selectionEnd,v=f!==p,g,b,w,C,x=l-h,k=this.fromStringToGraphemeSelection(n,i,r),I=f>k.selectionStart;v?(b=this._text.slice(f,p),x+=p-f):l<h&&(b=I?this._text.slice(p+x,p):this._text.slice(f,f-x));let G=a.slice(k.selectionEnd-x,k.selectionEnd);if(b&&b.length&&(G.length&&(g=this.getSelectionStyles(f,f+1,!1),g=G.map(()=>g[0])),v?(w=f,C=p):I?(w=p-b.length,C=p):(w=p,C=p+b.length),this.removeStyleFromTo(w,C)),G.length){let{copyPasteData:U}=Yn();e&&G.join("")===U.copiedText&&!ue.disableStyleCopyPaste&&(g=U.copiedTextStyle),this.insertNewStyleBlock(G,f,g)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t,{selectionStart:r,selectionEnd:n}=e;this.compositionStart=r,this.compositionEnd=n,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:t}=Yn();t.copiedText=this.getSelectedText(),ue.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let r,n=this._getLineLeftOffset(t);return e>0&&(r=this.__charBounds[t][e-1],n+=r.left+r.width),n}getDownCursorOffset(t,e){let r=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(r),i=n.lineIndex;if(i===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-r;let o=n.charIndex,a=this._getWidthBeforeCursor(i,o),h=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+h+1+this.missingNewlineOffset(i)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){let r=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(r),i=n.lineIndex;if(i===0||t.metaKey||t.keyCode===33)return-r;let o=n.charIndex,a=this._getWidthBeforeCursor(i,o),h=this._getIndexOnLine(i-1,a),l=this._textLines[i].slice(0,o),f=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+h-l.length+(1-f)}_getIndexOnLine(t,e){let r=this._textLines[t],n,i,o=this._getLineLeftOffset(t),a=0;for(let h=0,l=r.length;h<l;h++)if(n=this.__charBounds[t][h].width,o+=n,o>e){i=!0;let f=o-n,p=o,v=Math.abs(f-e);a=Math.abs(p-e)<v?h:h-1;break}return i||(a=r.length-1),a}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){let r=this["get".concat(t,"CursorOffset")](e,this._selectionDirection===Ge);if(e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){let n=this.text.length;this.selectionStart=qs(0,this.selectionStart,n),this.selectionEnd=qs(0,this.selectionEnd,n),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){let e=this._selectionDirection===ve?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,r){let n;if(t.altKey)n=this["findWordBoundary".concat(r)](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=r==="Left"?-1:1,!0;n=this["findLineBoundary".concat(r)](this[e])}return n!==void 0&&this[e]!==n&&(this[e]=n,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=ve,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===Ge&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=ve,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){let r="moveCursor".concat(t).concat(e.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===ve&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Ge,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=Ge,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}},kg=s=>!!s.button,rf=class extends ef{constructor(){super(...arguments),W(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Qu(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:r}=t;this.canvas&&this.editable&&!kg(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),r&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=r||this.isEditing)))}mouseUpHandler(t){let{e,transform:r}=t,n=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);let i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||kg(e)||n||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){let e=this.getSelectionStartFromPointer(t),r=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){let e=this.canvas.getScenePoint(t).transform(Yr(this.calcTransformMatrix())).add(new ft(-this._getLeftOffset(),-this._getTopOffset())),r=0,n=0,i=0;for(let l=0;l<this._textLines.length&&r<=e.y;l++)r+=this.getHeightOfLine(l),i=l,l>0&&(n+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));let o=Math.abs(this._getLineLeftOffset(i)),a=this._textLines[i].length,h=this.__charBounds[i];for(let l=0;l<a;l++){let f=o+h[l].kernedWidth;if(e.x<=f){Math.abs(e.x-f)<=Math.abs(e.x-o)&&n++;break}o=f,n++}return Math.min(this.flipX?a-n:n,this._text.length)}},cc="moveCursorUp",lc="moveCursorDown",uc="moveCursorLeft",fc="moveCursorRight",dc="exitEditing",Og=(s,t)=>{let e=t.getRetinaScaling();s.setTransform(e,0,0,e,0,0);let r=t.viewportTransform;s.transform(r[0],r[1],r[2],r[3],r[4],r[5])},am=X({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:dc,27:dc,33:cc,34:lc,35:fc,36:uc,37:uc,38:cc,39:fc,40:lc},keysMapRtl:{9:dc,27:dc,33:cc,34:lc,35:uc,36:fc,37:fc,38:cc,39:uc,40:lc},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1}),Ui=class s extends rf{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}get type(){let t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,X(X({},s.ownDefaults),e)),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof qc&&this.canvas.textEditingManager.remove(this),e instanceof qc&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,r)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,r)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){let e=this.isEditing;this.isEditing=!1;let r=super.toCanvasElement(t);return this.isEditing=e,r}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;let t=this.clearContextTop(!0);if(!t)return;let e=this._getCursorBoundaries(),r=this.findAncestorsWithClipPath(),n=r.length>0,i,o=t;if(n){i=Kr(t.canvas),o=i.getContext("2d"),Og(o,this.canvas);let a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,e):this.renderCursor(o,e),n)for(let a of r){let h=a.clipPath,l=Kr(t.canvas),f=l.getContext("2d");if(Og(f,this.canvas),!h.absolutePositioned){let p=a.calcTransformMatrix();f.transform(p[0],p[1],p[2],p[3],p[4],p[5])}h.transform(f),h.drawObject(f,!0,{}),this.drawClipPathOnCache(o,h,l)}n&&(t.setTransform(1,0,0,1,0,0),t.drawImage(i,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){let t=[],e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0,r=this._getLeftOffset(),n=this._getTopOffset(),i=this._getCursorBoundariesOffsets(t,e);return{left:r,top:n,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,r=0,{charIndex:n,lineIndex:i}=this.get2DCursorLocation(t);for(let l=0;l<i;l++)e+=this.getHeightOfLine(l);let o=this._getLineLeftOffset(i),a=this.__charBounds[i][n];a&&(r=a.left),this.charSpacing!==0&&n===this._textLines[i].length&&(r-=this._getWidthOfCharSpacing());let h={top:e,left:o+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===Ge||this.textAlign===Hn||this.textAlign===Ya?h.left*=-1:this.textAlign===ve||this.textAlign===Tc?h.left=o-(r>0?r:0):this.textAlign!==ie&&this.textAlign!==Xa||(h.left=o-(r>0?r:0))),h}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t),r=this.get2DCursorLocation(t),n=r.lineIndex,i=r.charIndex>0?r.charIndex-1:0,o=this.getValueOfPropertyAt(n,i,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),h=this.cursorWidth/a,l=this.getValueOfPropertyAt(n,i,"deltaY"),f=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(n,i,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-h/2,top:f+e.top+l,width:h,height:o}}_renderCursor(t,e,r){let{color:n,opacity:i,left:o,top:a,width:h,height:l}=this.getCursorRenderingData(r,e);t.fillStyle=n,t.globalAlpha=i,t.fillRect(o,a,h,l)}renderSelection(t,e){let r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,r,e)}renderDragSourceEffect(){let t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){let e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,r){let n=e.selectionStart,i=e.selectionEnd,o=this.textAlign.includes(Hn),a=this.get2DCursorLocation(n),h=this.get2DCursorLocation(i),l=a.lineIndex,f=h.lineIndex,p=a.charIndex<0?0:a.charIndex,v=h.charIndex<0?0:h.charIndex;for(let g=l;g<=f;g++){let b=this._getLineLeftOffset(g)||0,w=this.getHeightOfLine(g),C=0,x=0,k=0;if(g===l&&(x=this.__charBounds[l][p].left),g>=l&&g<f)k=o&&!this.isEndOfWrapping(g)?this.width:this.getLineWidth(g)||5;else if(g===f)if(v===0)k=this.__charBounds[f][v].left;else{let J=this._getWidthOfCharSpacing();k=this.__charBounds[f][v-1].left+this.__charBounds[f][v-1].width-J}C=w,(this.lineHeight<1||g===f&&this.lineHeight>1)&&(w/=this.lineHeight);let I=r.left+b+x,G=w,U=0,nt=k-x;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",G=1,U=w):t.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Ge||this.textAlign===Hn||this.textAlign===Ya?I=this.width-I-nt:this.textAlign===ve||this.textAlign===Tc?I=r.left+b-k:this.textAlign!==ie&&this.textAlign!==Xa||(I=r.left+b-k)),t.fillRect(I,r.top+r.topOffset+U,nt,G),r.topOffset+=C}}getCurrentCharFontSize(){let t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){let t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,ir)}_getCurrentCharIndex(){let t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}};W(Ui,"ownDefaults",am),W(Ui,"type","IText"),Bt.setClass(Ui),Bt.setClass(Ui,"i-text");var Io=class s extends Ui{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t,e){super(t,X(X({},s.ownDefaults),e))}static createControls(){return{controls:C0()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Hn)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,r=0,n=0,i={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[n]===`
`&&o>0?(r=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&o>0&&(r++,n++),i[o]={line:e,offset:r},n+=t.graphemeLines[o].length,r+=t.graphemeLines[o].length;return i}styleHas(t,e){if(this._styleMap&&!this.isWrapping){let r=this._styleMap[e];r&&(e=r.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,r=0,n=t+1,i=!1,o=this._styleMap[t],a=this._styleMap[t+1];o&&(t=o.line,r=o.offset),a&&(n=a.line,i=n===t,e=a.offset);let h=t===void 0?this.styles:{line:this.styles[t]};for(let l in h)for(let f in h[l]){let p=parseInt(f,10);if(p>=r&&(!i||p<e))for(let v in h[l][f])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){let r=this._styleMap[t];if(!r)return{};t=r.line,e=r.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,r){let n=this._styleMap[t];super._setStyleDeclaration(n.line,n.offset+e,r)}_deleteStyleDeclaration(t,e){let r=this._styleMap[t];super._deleteStyleDeclaration(r.line,r.offset+e)}_getLineStyle(t){let e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){let e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;let r=this.getGraphemeDataForRender(t),n=[];for(let i=0;i<r.wordsData.length;i++)n.push(...this._wrapLine(i,e,r));return this.isWrapping=!1,n}getGraphemeDataForRender(t){let e=this.splitByGrapheme,r=e?"":" ",n=0;return{wordsData:t.map((i,o)=>{let a=0,h=e?this.graphemeSplit(i):this.wordSplit(i);return h.length===0?[{word:[],width:0}]:h.map(l=>{let f=e?[l]:this.graphemeSplit(l),p=this._measureWord(f,o,a);return n=Math.max(p,n),a+=f.length+r.length,{word:f,width:p}})}),largestWordWidth:n}}_measureWord(t,e){let r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=t.length;o<a;o++)i+=this._getGraphemeBox(t[o],e,o+n,r,!0).kernedWidth,r=t[o];return i}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,r){let{largestWordWidth:n,wordsData:i}=r,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=this._getWidthOfCharSpacing(),h=this.splitByGrapheme,l=[],f=h?"":" ",p=0,v=[],g=0,b=0,w=!0;e-=o;let C=Math.max(e,n,this.dynamicMinWidth),x=i[t],k;for(g=0,k=0;k<x.length;k++){let{word:I,width:G}=x[k];g+=I.length,p+=b+G-a,p>C&&!w?(l.push(v),v=[],p=G,w=!0):p+=a,w||h||v.push(f),v=v.concat(I),b=h?0:this._measureWord([f],t,g),g++,w=!1}return k&&l.push(v),n+o>this.dynamicMinWidth&&(this.dynamicMinWidth=n-a+o),l}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){let e=super._splitTextIntoLines(t),r=this._wrapText(e.lines,this.width),n=new Array(r.length);for(let i=0;i<r.length;i++)n[i]=r[i].join("");return e.lines=n,e.graphemeLines=r,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let t=new Map;for(let e in this._styleMap){let r=parseInt(e,10);if(this._textLines[r]){let n=this._styleMap[e].line;t.set("".concat(n),!0)}}for(let e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}};W(Io,"type","Textbox"),W(Io,"textLayoutProperties",[...Ui.textLayoutProperties,"width"]),W(Io,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Bt.setClass(Io);var Uc=class extends Ho{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){let{target:r}=t,{clipPath:n,group:i}=r;if(!n||!this.shouldPerformLayout(t))return;let{width:o,height:a}=Gn(M0(r,n)),h=new ft(o,a);if(n.absolutePositioned)return{center:mi(n.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:h};{let l=n.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){let{center:f=new ft,correction:p=new ft}=this.calcBoundingBox(e,t)||{};return{center:f.add(l),correction:p.subtract(l),size:h}}return{center:r.getRelativeCenterPoint().add(l),size:h}}}};W(Uc,"type","clip-path"),Bt.setClass(Uc);var Wc=class extends Ho{getInitialSize(t,e){let{target:r}=t,{size:n}=e;return new ft(r.width||n.x,r.height||n.y)}};W(Wc,"type","fixed"),Bt.setClass(Wc);var nf=class extends zs{subscribeTargets(t){let e=t.target;t.targets.reduce((r,n)=>(n.parent&&r.add(n.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[e]})})}unsubscribeTargets(t){let e=t.target,r=e.getObjects();t.targets.reduce((n,i)=>(i.parent&&n.add(i.parent),n),new Set).forEach(n=>{!r.some(i=>i.parent===n)&&n.layoutManager.unsubscribeTargets({target:n,targets:[e]})})}},Bo=class s extends Vi{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,s.ownDefaults),this.setOptions(e);let{left:r,top:n,layoutManager:i}=e;this.groupInit(t,{left:r,top:n,layoutManager:i??new nf})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach(n=>{let i=this._objects.findIndex(a=>a.isInFrontOf(n)),o=i===-1?this.size():i;this.insertAt(o,n)})}canEnterGroup(t){return this.getObjects().some(e=>e.isDescendantOf(t)||t.isDescendantOf(e))?(Hi("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);let r=new Set;e.forEach(n=>{let{parent:i}=n;i&&r.add(i)}),t===Pf?r.forEach(n=>{n._onAfterObjectsChange(Fc,e)}):r.forEach(n=>{n._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,r){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;let n=X(X({hasControls:!1},r),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(t,n);super._renderControls(t,e),t.restore()}};W(Bo,"type","ActiveSelection"),W(Bo,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Bt.setClass(Bo),Bt.setClass(Bo,"activeSelection");var sf=class{constructor(){W(this,"resources",{})}applyFilters(t,e,r,n,i){let o=i.getContext("2d");if(!o)return;o.drawImage(e,0,0,r,n);let a={sourceWidth:r,sourceHeight:n,imageData:o.getImageData(0,0,r,n),originalEl:e,originalImageData:o.getImageData(0,0,r,n),canvasEl:i,ctx:o,filterBackend:this};t.forEach(l=>{l.applyTo(a)});let{imageData:h}=a;return h.width===r&&h.height===n||(i.width=h.width,i.height=h.height),o.putImageData(h,0,0),a}},Vc=class{constructor(){let{tileSize:t=ue.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),W(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){let r=Kr({width:t,height:e}),n=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});n&&(n.clearColor(0,0,0,0),this.canvas=r,this.gl=n)}applyFilters(t,e,r,n,i,o){let a=this.gl,h=i.getContext("2d");if(!a||!h)return;let l;o&&(l=this.getCachedTexture(o,e));let f={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:r,sourceHeight:n,destinationWidth:r,destinationHeight:n,context:a,sourceTexture:this.createTexture(a,r,n,l?void 0:e),targetTexture:this.createTexture(a,r,n),originalTexture:l||this.createTexture(a,r,n,l?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},p=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,p),t.forEach(v=>{v&&v.applyTo(f)}),function(v){let g=v.targetCanvas,b=g.width,w=g.height,C=v.destinationWidth,x=v.destinationHeight;b===C&&w===x||(g.width=C,g.height=x)}(f),this.copyGLTo2D(a,f),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(f.sourceTexture),a.deleteTexture(f.targetTexture),a.deleteFramebuffer(p),h.setTransform(1,0,0,1,0,0),f}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,r,n,i){let{NEAREST:o,TEXTURE_2D:a,RGBA:h,UNSIGNED_BYTE:l,CLAMP_TO_EDGE:f,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:v,TEXTURE_WRAP_S:g,TEXTURE_WRAP_T:b}=t,w=t.createTexture();return t.bindTexture(a,w),t.texParameteri(a,p,i||o),t.texParameteri(a,v,i||o),t.texParameteri(a,g,f),t.texParameteri(a,b,f),n?t.texImage2D(a,0,h,h,l,n):t.texImage2D(a,0,h,e,r,0,h,l,null),w}getCachedTexture(t,e,r){let{textureCache:n}=this;if(n[t])return n[t];{let i=this.createTexture(this.gl,e.width,e.height,e,r);return i&&(n[t]=i),i}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){let r=t.canvas,n=e.targetCanvas,i=n.getContext("2d");if(!i)return;i.translate(0,n.height),i.scale(1,-1);let o=r.height-n.height;i.drawImage(r,0,o,n.width,n.height,0,0,n.width,n.height)}copyGLTo2DPutImageData(t,e){let r=e.targetCanvas.getContext("2d"),n=e.destinationWidth,i=e.destinationHeight,o=n*i*4;if(!r)return;let a=new Uint8Array(this.imageBuffer,0,o),h=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,n,i,t.RGBA,t.UNSIGNED_BYTE,a);let l=new ImageData(h,n,i);r.putImageData(l,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let t=this.gl,e={renderer:"",vendor:""};if(!t)return e;let r=t.getExtension("WEBGL_debug_renderer_info");if(r){let n=t.getParameter(r.UNMASKED_RENDERER_WEBGL),i=t.getParameter(r.UNMASKED_VENDOR_WEBGL);n&&(e.renderer=n.toLowerCase()),i&&(e.vendor=i.toLowerCase())}return this.gpuInfo=e,e}},Tu;function hm(){let{WebGLProbe:s}=Yn();return s.queryWebGL(Xn()),ue.enableGLFiltering&&s.isSupported(ue.textureSize)?new Vc({tileSize:ue.textureSize}):new sf}function Pu(){return!Tu&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Tu=hm()),Tu}var cm=["filters","resizeFilter","src","crossOrigin","type"],$0=["cropX","cropY"],Vn=class s extends hr{static getDefaults(){return X(X({},super.getDefaults()),s.ownDefaults)}constructor(t,e){super(),W(this,"_lastScaleX",1),W(this,"_lastScaleY",1),W(this,"_filterScalingX",1),W(this,"_filterScalingY",1),this.filters=[],Object.assign(this,s.ownDefaults),this.setOptions(e),this.cacheKey="texture".concat(Yi()),this.setElement(typeof t=="string"?(this.canvas&&Sn(this.canvas.getElement())||Go()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){var e;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=t,this._originalElement=t,this._setWidthHeight(r),(e=t.classList)===null||e===void 0||e.add(s.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){let e=Pu(!1);e instanceof Vc&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(t=>{let e=this[t];e&&Yn().dispose(e),this[t]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;let e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,-r),t.lineTo(e,-r),t.lineTo(e,r),t.lineTo(-e,r),t.lineTo(-e,-r),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=[];return this.filters.forEach(r=>{r&&e.push(r.toObject())}),X(X({},super.toObject([...$0,...t])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let t=[],e=this._element,r=-this.width/2,n=-this.height/2,i=[],o=[],a="",h="";if(!e)return[];if(this.hasCrop()){let l=Yi();i.push('<clipPath id="imageCrop_'+l+`">
`,'	<rect x="'+r+'" y="'+n+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(h=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(n-this.cropY,'" width="').concat(e.width||e.naturalWidth,'" height="').concat(e.height||e.naturalHeight,'"').concat(h).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){let l=this.fill;this.fill=null,o=['	<rect x="'.concat(r,'" y="').concat(n,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=l}return i=this.paintFirst!==ir?i.concat(o,t):i.concat(t,o),i}getSrc(t){let e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ga(t,{crossOrigin:e,signal:r}).then(n=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(n)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let t=this.resizeFilter,e=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),n=r.x,i=r.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||n>e&&i>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=i);let a=Kr(o),{width:h,height:l}=o;this._element=a,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=i,Pu().applyFilters([t],o,h,l,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let e=this._originalElement,r=e.naturalWidth||e.width,n=e.naturalHeight||e.height;if(this._element===this._originalElement){let i=Kr({width:r,height:n});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,n),this._lastScaleX=1,this._lastScaleY=1);Pu().applyFilters(t,this._originalElement,r,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){let e=this._element;if(!e)return;let r=this._filterScalingX,n=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),h=Math.max(this.cropY,0),l=e.naturalWidth||e.width,f=e.naturalHeight||e.height,p=a*r,v=h*n,g=Math.min(i*r,l-p),b=Math.min(o*n,f-v),w=-i/2,C=-o/2,x=Math.min(i,l/r-a),k=Math.min(o,f/n-h);e&&t.drawImage(e,p,v,g,b,w,C,x,k)}_needsResize(){let t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=this.getOriginalSize();this.width=t||r.width,this.height=e||r.height}parsePreserveAspectRatioAttribute(){let t=e0(this.preserveAspectRatio||""),e=this.width,r=this.height,n={width:e,height:r},i,o=this._element.width,a=this._element.height,h=1,l=1,f=0,p=0,v=0,g=0;return!t||t.alignX===Br&&t.alignY===Br?(h=e/o,l=r/a):(t.meetOrSlice==="meet"&&(h=l=E0(this._element,n),i=(e-o*h)/2,t.alignX==="Min"&&(f=-i),t.alignX==="Max"&&(f=i),i=(r-a*l)/2,t.alignY==="Min"&&(p=-i),t.alignY==="Max"&&(p=i)),t.meetOrSlice==="slice"&&(h=l=F0(this._element,n),i=o-e/h,t.alignX==="Mid"&&(v=i/2),t.alignX==="Max"&&(v=i),i=a-r/l,t.alignY==="Mid"&&(g=i/2),t.alignY==="Max"&&(g=i),o=e/h,a=r/l)),{width:o,height:a,scaleX:h,scaleY:l,offsetLeft:f,offsetTop:p,cropX:v,cropY:g}}static fromObject(t,e){let{filters:r,resizeFilter:n,src:i,crossOrigin:o,type:a}=t,h=De(t,cm);return Promise.all([Ga(i,X(X({},e),{},{crossOrigin:o})),r&&Uo(r,e),n&&Uo([n],e),ih(h,e)]).then(l=>{let[f,p=[],[v]=[],g={}]=l;return new this(f,X(X({},h),{},{src:i,filters:p,resizeFilter:v},g))})}static fromURL(t){let{crossOrigin:e=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Ga(t,{crossOrigin:e,signal:r}).then(i=>new this(i,n))}static fromElement(e){return jr(this,arguments,function*(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=bi(t,this.ATTRIBUTE_NAMES,n);return this.fromURL(i["xlink:href"]||i.href,r,i).catch(o=>(Hi("log","Unable to parse Image",o),null))})}};W(Vn,"type","Image"),W(Vn,"cacheProperties",[...yi,...$0]),W(Vn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),W(Vn,"CSS_CANVAS","canvas-img"),W(Vn,"ATTRIBUTE_NAMES",[...Ki,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Bt.setClass(Vn),Bt.setSVGClass(Vn);var Sy=$c(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var Q0=Ig,Ng=s=>function(t,e,r){let{points:n,pathOffset:i}=r;return new ft(n[s]).subtract(i).transform(qe(r.getViewportTransform(),r.calcTransformMatrix()))},tp=(s,t,e,r)=>{let{target:n,pointIndex:i}=t,o=n,a=mi(new ft(e,r),void 0,o.calcOwnMatrix());return o.points[i]=a.add(o.pathOffset),o.setDimensions(),o.set("dirty",!0),!0},ep=(s,t)=>function(e,r,n,i){let o=r.target,a=new ft(o.points[(s>0?s:o.points.length)-1]),h=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()),l=t(e,X(X({},r),{},{pointIndex:s}),n,i),f=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()).subtract(h);return o.left-=f.x,o.top-=f.y,l},Mg=s=>Xi(Q0,ep(s,tp)),of=(s,t,e)=>{let{path:r,pathOffset:n}=s,i=r[t];return new ft(i[e]-n.x,i[e+1]-n.y).transform(qe(s.getViewportTransform(),s.calcTransformMatrix()))};function lm(s,t,e){let{commandIndex:r,pointIndex:n}=this;return of(e,r,n)}function um(s,t,e,r){let{target:n}=t,{commandIndex:i,pointIndex:o}=this,a=((h,l,f,p,v)=>{let{path:g,pathOffset:b}=h,w=g[(p>0?p:g.length)-1],C=new ft(w[v],w[v+1]),x=C.subtract(b).transform(h.calcOwnMatrix()),k=mi(new ft(l,f),void 0,h.calcOwnMatrix());g[p][v]=k.x+b.x,g[p][v+1]=k.y+b.y,h.setDimensions();let I=C.subtract(h.pathOffset).transform(h.calcOwnMatrix()).subtract(x);return h.left-=I.x,h.top-=I.y,h.set("dirty",!0),!0})(n,e,r,i,o);return bf(this.actionName,X(X({},wf(s,t,e,r)),{},{commandIndex:i,pointIndex:o})),a}var Hc=class extends Lr{constructor(t){super(t)}render(t,e,r,n,i){let o=X(X({},n),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(t,e,r,o,i)}},af=class extends Hc{constructor(t){super(t)}render(t,e,r,n,i){let{path:o}=i,{commandIndex:a,pointIndex:h,connectToCommandIndex:l,connectToPointIndex:f}=this;t.save(),t.strokeStyle=this.controlStroke,this.connectionDashArray&&t.setLineDash(this.connectionDashArray);let[p]=o[a],v=of(i,l,f);if(p==="Q"){let g=of(i,a,h+2);t.moveTo(g.x,g.y),t.lineTo(e,r)}else t.moveTo(e,r);t.lineTo(v.x,v.y),t.stroke(),t.restore(),super.render(t,e,r,n,i)}},gc=(s,t,e,r,n,i)=>new(e?af:Hc)(X(X({commandIndex:s,pointIndex:t,actionName:"modifyPath",positionHandler:lm,actionHandler:um,connectToCommandIndex:n,connectToPointIndex:i},r),e?r.controlPointStyle:r.pointStyle)),Cy=Object.freeze({__proto__:null,changeWidth:Uu,createObjectDefaultControls:Af,createPathControls:function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={},r="M";return s.path.forEach((n,i)=>{let o=n[0];switch(o!=="Z"&&(e["c_".concat(i,"_").concat(o)]=gc(i,n.length-2,!1,t)),o){case"C":e["c_".concat(i,"_C_CP_1")]=gc(i,1,!0,t,i-1,(a=>a==="C"?5:a==="Q"?3:1)(r)),e["c_".concat(i,"_C_CP_2")]=gc(i,3,!0,t,i,5);break;case"Q":e["c_".concat(i,"_Q_CP_1")]=gc(i,1,!0,t,i,3)}r=o}),e},createPolyActionHandler:Mg,createPolyControls:function(s){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={};for(let r=0;r<(typeof s=="number"?s:s.points.length);r++)e["p".concat(r)]=new Lr(X({actionName:Q0,positionHandler:Ng(r),actionHandler:Mg(r)},t));return e},createPolyPositionHandler:Ng,createResizeControls:S0,createTextboxDefaultControls:C0,dragHandler:t0,factoryPolyActionHandler:ep,getLocalPoint:Zc,polyActionHandler:tp,renderCircleControl:u0,renderSquareControl:f0,rotationStyleHandler:d0,rotationWithSnapping:g0,scaleCursorStyleHandler:Mo,scaleOrSkewActionName:Wa,scaleSkewCursorStyleHandler:ws,scalingEqually:Ua,scalingX:v0,scalingXOrSkewingY:Wu,scalingY:y0,scalingYOrSkewingX:Vu,skewCursorStyleHandler:b0,skewHandlerX:x0,skewHandlerY:_0,wrapWithFireEvent:Xi,wrapWithFixedAnchor:Vs}),nl=s=>s.webgl!==void 0;var Nf="precision highp float",fm=`
    `.concat(Nf,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),dm=["type"],gm=["type"],pm=new RegExp(Nf,"g"),ze=class{get type(){return this.constructor.type}constructor(){let t=De(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},dm);Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return fm}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource(),{WebGLProbe:{GLPrecision:n="highp"}}=Yn();n!=="highp"&&(e=e.replace(pm,Nf.replace("highp",n)));let i=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),a=t.createProgram();if(!i||!o||!a)throw new cn("Vertex, fragment shader or program creation error");if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new cn("Vertex shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(i)));if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new cn("Fragment shader compile error for ".concat(this.type,": ").concat(t.getShaderInfoLog(o)));if(t.attachShader(a,i),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new cn('Shader link error for "'.concat(this.type,'" ').concat(t.getProgramInfoLog(a)));let h=this.getUniformLocations(t,a)||{};return h.uStepW=t.getUniformLocation(a,"uStepW"),h.uStepH=t.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(t,a),uniformLocations:h}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){let r=this.constructor.uniformLocations,n={};for(let i=0;i<r.length;i++)n[r[i]]=t.getUniformLocation(e,r[i]);return n}sendAttributeData(t,e,r){let n=e.aPosition,i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)}_setupFrameBuffer(t){let e=t.context;if(t.passes>1){let r=t.destinationWidth,n=t.destinationHeight;t.sourceWidth===r&&t.sourceHeight===n||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,r,n)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;let e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){nl(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){let e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){let e=t.context,r=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){let{sourceWidth:e,sourceHeight:r}=t,n=Kr({width:e,height:r});t.helpLayer=n}}toObject(){let t=Object.keys(this.constructor.defaults||{});return X({type:this.type},t.reduce((e,r)=>(e[r]=this[r],e),{}))}toJSON(){return this.toObject()}static fromObject(t,e){return jr(this,null,function*(){return new this(De(t,gm))})}};W(ze,"type","BaseFilter"),W(ze,"uniformLocations",[]);var mm={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},xs=class extends ze{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(mm[this.mode],`
        }
      }
      `)}applyTo2d(t){let{imageData:{data:e}}=t,r=new vr(this.color).getSource(),n=this.alpha,i=r[0]*n,o=r[1]*n,a=r[2]*n,h=1-n;for(let l=0;l<e.length;l+=4){let f=e[l],p=e[l+1],v=e[l+2],g,b,w;switch(this.mode){case"multiply":g=f*i/255,b=p*o/255,w=v*a/255;break;case"screen":g=255-(255-f)*(255-i)/255,b=255-(255-p)*(255-o)/255,w=255-(255-v)*(255-a)/255;break;case"add":g=f+i,b=p+o,w=v+a;break;case"difference":g=Math.abs(f-i),b=Math.abs(p-o),w=Math.abs(v-a);break;case"subtract":g=f-i,b=p-o,w=v-a;break;case"darken":g=Math.min(f,i),b=Math.min(p,o),w=Math.min(v,a);break;case"lighten":g=Math.max(f,i),b=Math.max(p,o),w=Math.max(v,a);break;case"overlay":g=i<128?2*f*i/255:255-2*(255-f)*(255-i)/255,b=o<128?2*p*o/255:255-2*(255-p)*(255-o)/255,w=a<128?2*v*a/255:255-2*(255-v)*(255-a)/255;break;case"exclusion":g=i+f-2*i*f/255,b=o+p-2*o*p/255,w=a+v-2*a*v/255;break;case"tint":g=i+f*h,b=o+p*h,w=a+v*h}e[l]=g,e[l+1]=b,e[l+2]=w}}sendUniformData(t,e){let r=new vr(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(e.uColor,r)}};W(xs,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),W(xs,"type","BlendColor"),W(xs,"uniformLocations",["uColor"]),Bt.setClass(xs);var vm={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},ym=["type","image"],_s=class extends ze{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return vm[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){let e=t.context,r=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,r,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){let t=this.image,{width:e,height:r}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/r,1]}applyTo2d(t){let{imageData:{data:e,width:r,height:n},filterBackend:{resources:i}}=t,o=this.image;i.blendImage||(i.blendImage=Xn());let a=i.blendImage,h=a.getContext("2d");a.width!==r||a.height!==n?(a.width=r,a.height=n):h.clearRect(0,0,r,n),h.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),h.drawImage(o.getElement(),0,0,r,n);let l=h.getImageData(0,0,r,n).data;for(let f=0;f<e.length;f+=4){let p=e[f],v=e[f+1],g=e[f+2],b=e[f+3],w=l[f],C=l[f+1],x=l[f+2],k=l[f+3];switch(this.mode){case"multiply":e[f]=p*w/255,e[f+1]=v*C/255,e[f+2]=g*x/255,e[f+3]=b*k/255;break;case"mask":e[f+3]=k}}}sendUniformData(t,e){let r=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,r)}toObject(){return X(X({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static fromObject(t,e){return jr(this,null,function*(){let{type:r,image:n}=t,i=De(t,ym);return Vn.fromObject(n,e).then(o=>new this(X(X({},i),{},{image:o})))})}};W(_s,"type","BlendImage"),W(_s,"defaults",{mode:"multiply",alpha:1}),W(_s,"uniformLocations",["uTransformMatrix","uImage"]),Bt.setClass(_s);var Ss=class extends ze{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){nl(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:r,height:n}}=t;this.aspectRatio=r/n,this.horizontal=!0;let i=this.getBlurValue()*r,o=new Uint8ClampedArray(e),a=15,h=4*r;for(let l=0;l<e.length;l+=4){let f=0,p=0,v=0,g=0,b=0,w=l-l%h,C=w+h;for(let x=-14;x<a;x++){let k=x/a,I=4*Math.floor(i*k),G=1-Math.abs(k),U=l+I;U<w?U=w:U>C&&(U=C);let nt=e[U+3]*G;f+=e[U]*nt,p+=e[U+1]*nt,v+=e[U+2]*nt,g+=nt,b+=G}o[l]=f/g,o[l+1]=p/g,o[l+2]=v/g,o[l+3]=g/b}this.horizontal=!1,i=this.getBlurValue()*n;for(let l=0;l<o.length;l+=4){let f=0,p=0,v=0,g=0,b=0,w=l%h,C=o.length-h+w;for(let x=-14;x<a;x++){let k=x/a,I=Math.floor(i*k)*h,G=1-Math.abs(k),U=l+I;U<w?U=w:U>C&&(U=C);let nt=o[U+3]*G;f+=o[U]*nt,p+=o[U+1]*nt,v+=o[U+2]*nt,g+=nt,b+=G}e[l]=f/g,e[l+1]=p/g,e[l+2]=v/g,e[l+3]=g/b}}sendUniformData(t,e){let r=this.chooseRightDelta();t.uniform2fv(e.uDelta,r)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1,{horizontal:e,aspectRatio:r}=this;return e?r>1&&(t=1/r):r<1&&(t=r),t*this.blur*.12}chooseRightDelta(){let t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}};W(Ss,"type","Blur"),W(Ss,"defaults",{blur:0}),W(Ss,"uniformLocations",["uDelta"]),Bt.setClass(Ss);var Cs=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t,r=Math.round(255*this.brightness);for(let n=0;n<e.length;n+=4)e[n]+=r,e[n+1]+=r,e[n+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}};W(Cs,"type","Brightness"),W(Cs,"defaults",{brightness:0}),W(Cs,"uniformLocations",["uBrightness"]),Bt.setClass(Cs);var rp={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0},pi=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){let e=t.imageData.data,r=this.matrix,n=this.colorsOnly;for(let i=0;i<e.length;i+=4){let o=e[i],a=e[i+1],h=e[i+2];if(e[i]=o*r[0]+a*r[1]+h*r[2]+255*r[4],e[i+1]=o*r[5]+a*r[6]+h*r[7]+255*r[9],e[i+2]=o*r[10]+a*r[11]+h*r[12]+255*r[14],!n){let l=e[i+3];e[i]+=l*r[3],e[i+1]+=l*r[8],e[i+2]+=l*r[13],e[i+3]=o*r[15]+a*r[16]+h*r[17]+l*r[18]+255*r[19]}}}sendUniformData(t,e){let r=this.matrix,n=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],i=[r[4],r[9],r[14],r[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,i)}toObject(){return X(X({},super.toObject()),{},{matrix:[...this.matrix]})}};function Hs(s,t){var e;let r=(W(e=class extends pi{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",s),W(e,"defaults",{colorsOnly:!1,matrix:t}),e);return Bt.setClass(r,s),r}W(pi,"type","ColorMatrix"),W(pi,"defaults",rp),W(pi,"uniformLocations",["uColorMatrix","uConstants"]),Bt.setClass(pi);var bm=Hs("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),wm=Hs("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),xm=Hs("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),_m=Hs("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),Sm=Hs("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Cm=Hs("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Am=Hs("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),eh=class extends ze{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){nl(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach(e=>{e.applyTo(t)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(t=>t.toObject())}}isNeutralState(){return!this.subFilters.some(t=>!t.isNeutralState())}static fromObject(t,e){return Promise.all((t.subFilters||[]).map(r=>Bt.getClass(r.type).fromObject(r,e))).then(r=>new this({subFilters:r}))}};W(eh,"type","Composed"),Bt.setClass(eh);var As=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t,r=Math.floor(255*this.contrast),n=259*(r+255)/(255*(259-r));for(let i=0;i<e.length;i+=4)e[i]=n*(e[i]-128)+128,e[i+1]=n*(e[i+1]-128)+128,e[i+2]=n*(e[i+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}};W(As,"type","Contrast"),W(As,"defaults",{contrast:0}),W(As,"uniformLocations",["uContrast"]),Bt.setClass(As);var Lm={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},Ls=class extends ze{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return Lm[this.getCacheKey()]}applyTo2d(t){let e=t.imageData,r=e.data,n=this.matrix,i=Math.round(Math.sqrt(n.length)),o=Math.floor(i/2),a=e.width,h=e.height,l=t.ctx.createImageData(a,h),f=l.data,p=this.opaque?1:0,v,g,b,w,C,x,k,I,G,U,nt,J,F;for(nt=0;nt<h;nt++)for(U=0;U<a;U++){for(C=4*(nt*a+U),v=0,g=0,b=0,w=0,F=0;F<i;F++)for(J=0;J<i;J++)k=nt+F-o,x=U+J-o,k<0||k>=h||x<0||x>=a||(I=4*(k*a+x),G=n[F*i+J],v+=r[I]*G,g+=r[I+1]*G,b+=r[I+2]*G,p||(w+=r[I+3]*G));f[C]=v,f[C+1]=g,f[C+2]=b,f[C+3]=p?r[C+3]:w}t.imageData=l}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return X(X({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};W(Ls,"type","Convolute"),W(Ls,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),W(Ls,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Bt.setClass(Ls);var np="Gamma",Ts=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t,r=this.gamma,n=1/r[0],i=1/r[1],o=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let a=this.rgbValues;for(let h=0;h<256;h++)a.r[h]=255*Math.pow(h/255,n),a.g[h]=255*Math.pow(h/255,i),a.b[h]=255*Math.pow(h/255,o);for(let h=0;h<e.length;h+=4)e[h]=a.r[e[h]],e[h+1]=a.g[e[h+1]],e[h+2]=a.b[e[h+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){let{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:np,gamma:this.gamma.concat()}}};W(Ts,"type",np),W(Ts,"defaults",{gamma:[1,1,1]}),W(Ts,"uniformLocations",["uGamma"]),Bt.setClass(Ts);var Tm={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},Ps=class extends ze{applyTo2d(t){let{imageData:{data:e}}=t;for(let r,n=0;n<e.length;n+=4){let i=e[n],o=e[n+1],a=e[n+2];switch(this.mode){case"average":r=(i+o+a)/3;break;case"lightness":r=(Math.min(i,o,a)+Math.max(i,o,a))/2;break;case"luminosity":r=.21*i+.72*o+.07*a}e[n+2]=e[n+1]=e[n]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Tm[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}};W(Ps,"type","Grayscale"),W(Ps,"defaults",{mode:"average"}),W(Ps,"uniformLocations",["uMode"]),Bt.setClass(Ps);var Pm=X(X({},rp),{},{rotation:0}),qo=class extends pi{calculateMatrix(){let t=this.rotation*Math.PI,e=Ln(t),r=Tn(t),n=1/3,i=Math.sqrt(n)*r,o=1-e;this.matrix=[e+o/3,n*o-i,n*o+i,0,0,n*o+i,e+n*o,n*o-i,0,0,n*o-i,n*o+i,e+n*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}};W(qo,"type","HueRotation"),W(qo,"defaults",Pm),Bt.setClass(qo);var ks=class extends ze{applyTo2d(t){let{imageData:{data:e}}=t;for(let r=0;r<e.length;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2],this.alpha&&(e[r+3]=255-e[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}};W(ks,"type","Invert"),W(ks,"defaults",{alpha:!1,invert:!0}),W(ks,"uniformLocations",["uInvert","uAlpha"]),Bt.setClass(ks);var Os=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t,r=this.noise;for(let n=0;n<e.length;n+=4){let i=(.5-Math.random())*r;e[n]+=i,e[n+1]+=i,e[n+2]+=i}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}};W(Os,"type","Noise"),W(Os,"defaults",{noise:0}),W(Os,"uniformLocations",["uNoise","uSeed"]),Bt.setClass(Os);var Ns=class extends ze{applyTo2d(t){let{imageData:{data:e,width:r,height:n}}=t;for(let i=0;i<n;i+=this.blocksize)for(let o=0;o<r;o+=this.blocksize){let a=4*i*r+4*o,h=e[a],l=e[a+1],f=e[a+2],p=e[a+3];for(let v=i;v<Math.min(i+this.blocksize,n);v++)for(let g=o;g<Math.min(o+this.blocksize,r);g++){let b=4*v*r+4*g;e[b]=h,e[b+1]=l,e[b+2]=f,e[b+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}};W(Ns,"type","Pixelate"),W(Ns,"defaults",{blocksize:4}),W(Ns,"uniformLocations",["uBlocksize"]),Bt.setClass(Ns);var Ms=class extends ze{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t,r=255*this.distance,n=new vr(this.color).getSource(),i=[n[0]-r,n[1]-r,n[2]-r],o=[n[0]+r,n[1]+r,n[2]+r];for(let a=0;a<e.length;a+=4){let h=e[a],l=e[a+1],f=e[a+2];h>i[0]&&l>i[1]&&f>i[2]&&h<o[0]&&l<o[1]&&f<o[2]&&(e[a+3]=0)}}sendUniformData(t,e){let r=new vr(this.color).getSource(),n=this.distance,i=[0+r[0]/255-n,0+r[1]/255-n,0+r[2]/255-n,1],o=[r[0]/255+n,r[1]/255+n,r[2]/255+n,1];t.uniform4fv(e.uLow,i),t.uniform4fv(e.uHigh,o)}};W(Ms,"type","RemoveColor"),W(Ms,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),W(Ms,"uniformLocations",["uLow","uHigh"]),Bt.setClass(Ms);var Ds=class extends ze{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){let t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){let t=this.getFilterWindow();return"".concat(this.type,"_").concat(t)}getFragmentSource(){let t=this.getFilterWindow();return this.generateShader(t)}getTaps(){let t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,r=this.getFilterWindow(),n=new Array(r);for(let i=1;i<=r;i++)n[i-1]=t(i*e);return n}generateShader(t){let e=new Array(t);for(let r=1;r<=t;r++)e[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(t,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(e.map((r,n)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(n,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(n,`];
              sum += 2.0 * uTaps[`).concat(n,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){nl(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;let r=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(r)/r}}applyTo2d(t){let e=t.imageData,r=this.scaleX,n=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/n;let i=e.width,o=e.height,a=Math.round(i*r),h=Math.round(o*n),l;l=this.resizeType==="sliceHack"?this.sliceByTwo(t,i,o,a,h):this.resizeType==="hermite"?this.hermiteFastResize(t,i,o,a,h):this.resizeType==="bilinear"?this.bilinearFiltering(t,i,o,a,h):this.resizeType==="lanczos"?this.lanczosResize(t,i,o,a,h):new ImageData(a,h),t.imageData=l}sliceByTwo(t,e,r,n,i){let o=t.imageData,a=.5,h=!1,l=!1,f=e*a,p=r*a,v=t.filterBackend.resources,g=0,b=0,w=e,C=0;v.sliceByTwo||(v.sliceByTwo=Xn());let x=v.sliceByTwo;(x.width<1.5*e||x.height<r)&&(x.width=1.5*e,x.height=r);let k=x.getContext("2d");for(k.clearRect(0,0,1.5*e,r),k.putImageData(o,0,0),n=Math.floor(n),i=Math.floor(i);!h||!l;)e=f,r=p,n<Math.floor(f*a)?f=Math.floor(f*a):(f=n,h=!0),i<Math.floor(p*a)?p=Math.floor(p*a):(p=i,l=!0),k.drawImage(x,g,b,e,r,w,C,f,p),g=w,b=C,C+=p;return k.getImageData(g,b,n,i)}lanczosResize(t,e,r,n,i){let o=t.imageData.data,a=t.ctx.createImageData(n,i),h=a.data,l=this.lanczosCreate(this.lanczosLobes),f=this.rcpScaleX,p=this.rcpScaleY,v=2/this.rcpScaleX,g=2/this.rcpScaleY,b=Math.ceil(f*this.lanczosLobes/2),w=Math.ceil(p*this.lanczosLobes/2),C={},x={x:0,y:0},k={x:0,y:0};return function I(G){let U,nt,J,F,et,dt,N,M,z,R,ht;for(x.x=(G+.5)*f,k.x=Math.floor(x.x),U=0;U<i;U++){for(x.y=(U+.5)*p,k.y=Math.floor(x.y),et=0,dt=0,N=0,M=0,z=0,nt=k.x-b;nt<=k.x+b;nt++)if(!(nt<0||nt>=e)){R=Math.floor(1e3*Math.abs(nt-x.x)),C[R]||(C[R]={});for(let it=k.y-w;it<=k.y+w;it++)it<0||it>=r||(ht=Math.floor(1e3*Math.abs(it-x.y)),C[R][ht]||(C[R][ht]=l(Math.sqrt(Math.pow(R*v,2)+Math.pow(ht*g,2))/1e3)),J=C[R][ht],J>0&&(F=4*(it*e+nt),et+=J,dt+=J*o[F],N+=J*o[F+1],M+=J*o[F+2],z+=J*o[F+3]))}F=4*(U*n+G),h[F]=dt/et,h[F+1]=N/et,h[F+2]=M/et,h[F+3]=z/et}return++G<n?I(G):a}(0)}bilinearFiltering(t,e,r,n,i){let o,a,h,l,f,p,v,g,b,w,C,x,k,I=0,G=this.rcpScaleX,U=this.rcpScaleY,nt=4*(e-1),J=t.imageData.data,F=t.ctx.createImageData(n,i),et=F.data;for(v=0;v<i;v++)for(g=0;g<n;g++)for(f=Math.floor(G*g),p=Math.floor(U*v),b=G*g-f,w=U*v-p,k=4*(p*e+f),C=0;C<4;C++)o=J[k+C],a=J[k+4+C],h=J[k+nt+C],l=J[k+nt+4+C],x=o*(1-b)*(1-w)+a*b*(1-w)+h*w*(1-b)+l*b*w,et[I++]=x;return F}hermiteFastResize(t,e,r,n,i){let o=this.rcpScaleX,a=this.rcpScaleY,h=Math.ceil(o/2),l=Math.ceil(a/2),f=t.imageData.data,p=t.ctx.createImageData(n,i),v=p.data;for(let g=0;g<i;g++)for(let b=0;b<n;b++){let w=4*(b+g*n),C=0,x=0,k=0,I=0,G=0,U=0,nt=0,J=(g+.5)*a;for(let F=Math.floor(g*a);F<(g+1)*a;F++){let et=Math.abs(J-(F+.5))/l,dt=(b+.5)*o,N=et*et;for(let M=Math.floor(b*o);M<(b+1)*o;M++){let z=Math.abs(dt-(M+.5))/h,R=Math.sqrt(N+z*z);R>1&&R<-1||(C=2*R*R*R-3*R*R+1,C>0&&(z=4*(M+F*e),nt+=C*f[z+3],k+=C,f[z+3]<255&&(C=C*f[z+3]/250),I+=C*f[z],G+=C*f[z+1],U+=C*f[z+2],x+=C))}}v[w]=I/x,v[w+1]=G/x,v[w+2]=U/x,v[w+3]=nt/k}return p}};W(Ds,"type","Resize"),W(Ds,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),W(Ds,"uniformLocations",["uDelta","uTaps"]),Bt.setClass(Ds);var Es=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t,r=-this.saturation;for(let n=0;n<e.length;n+=4){let i=e[n],o=e[n+1],a=e[n+2],h=Math.max(i,o,a);e[n]+=h!==i?(h-i)*r:0,e[n+1]+=h!==o?(h-o)*r:0,e[n+2]+=h!==a?(h-a)*r:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}};W(Es,"type","Saturation"),W(Es,"defaults",{saturation:0}),W(Es,"uniformLocations",["uSaturation"]),Bt.setClass(Es);var Fs=class extends ze{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t,r=-this.vibrance;for(let n=0;n<e.length;n+=4){let i=e[n],o=e[n+1],a=e[n+2],h=Math.max(i,o,a),l=(i+o+a)/3,f=2*Math.abs(h-l)/255*r;e[n]+=h!==i?(h-i)*f:0,e[n+1]+=h!==o?(h-o)*f:0,e[n+2]+=h!==a?(h-a)*f:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}};W(Fs,"type","Vibrance"),W(Fs,"defaults",{vibrance:0}),W(Fs,"uniformLocations",["uVibrance"]),Bt.setClass(Fs);var Ay=Object.freeze({__proto__:null,BaseFilter:ze,BlackWhite:Am,BlendColor:xs,BlendImage:_s,Blur:Ss,Brightness:Cs,Brownie:bm,ColorMatrix:pi,Composed:eh,Contrast:As,Convolute:Ls,Gamma:Ts,Grayscale:Ps,HueRotation:qo,Invert:ks,Kodachrome:xm,Noise:Os,Pixelate:Ns,Polaroid:Sm,RemoveColor:Ms,Resize:Ds,Saturation:Es,Sepia:Cm,Technicolor:_m,Vibrance:Fs,Vintage:wm});var yr=Uint8Array,Jr=Uint16Array,Rf=Int32Array,il=new yr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),sl=new yr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ff=new yr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ap=function(s,t){for(var e=new Jr(31),r=0;r<31;++r)e[r]=t+=1<<s[r-1];for(var n=new Rf(e[30]),r=1;r<30;++r)for(var i=e[r];i<e[r+1];++i)n[i]=i-e[r]<<5|r;return{b:e,r:n}},hp=ap(il,2),cp=hp.b,jf=hp.r;cp[28]=258,jf[258]=28;var lp=ap(sl,0),km=lp.b,ip=lp.r,If=new Jr(32768);for(ge=0;ge<32768;++ge)wi=(ge&43690)>>1|(ge&21845)<<1,wi=(wi&52428)>>2|(wi&13107)<<2,wi=(wi&61680)>>4|(wi&3855)<<4,If[ge]=((wi&65280)>>8|(wi&255)<<8)>>1;var wi,ge,Zn=function(s,t,e){for(var r=s.length,n=0,i=new Jr(t);n<r;++n)s[n]&&++i[s[n]-1];var o=new Jr(t);for(n=1;n<t;++n)o[n]=o[n-1]+i[n-1]<<1;var a;if(e){a=new Jr(1<<t);var h=15-t;for(n=0;n<r;++n)if(s[n])for(var l=n<<4|s[n],f=t-s[n],p=o[s[n]-1]++<<f,v=p|(1<<f)-1;p<=v;++p)a[If[p]>>h]=l}else for(a=new Jr(r),n=0;n<r;++n)s[n]&&(a[n]=If[o[s[n]-1]++]>>15-s[n]);return a},Ji=new yr(288);for(ge=0;ge<144;++ge)Ji[ge]=8;var ge;for(ge=144;ge<256;++ge)Ji[ge]=9;var ge;for(ge=256;ge<280;++ge)Ji[ge]=7;var ge;for(ge=280;ge<288;++ge)Ji[ge]=8;var ge,hh=new yr(32);for(ge=0;ge<32;++ge)hh[ge]=5;var ge,Om=Zn(Ji,9,0),Nm=Zn(Ji,9,1),Mm=Zn(hh,5,0),Dm=Zn(hh,5,1),Mf=function(s){for(var t=s[0],e=1;e<s.length;++e)s[e]>t&&(t=s[e]);return t},Pn=function(s,t,e){var r=t/8|0;return(s[r]|s[r+1]<<8)>>(t&7)&e},Df=function(s,t){var e=t/8|0;return(s[e]|s[e+1]<<8|s[e+2]<<16)>>(t&7)},qf=function(s){return(s+7)/8|0},up=function(s,t,e){return(t==null||t<0)&&(t=0),(e==null||e>s.length)&&(e=s.length),new yr(s.subarray(t,e))};var Em=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],kn=function(s,t,e){var r=new Error(t||Em[s]);if(r.code=s,Error.captureStackTrace&&Error.captureStackTrace(r,kn),!e)throw r;return r},Fm=function(s,t,e,r){var n=s.length,i=r?r.length:0;if(!n||t.f&&!t.l)return e||new yr(0);var o=!e,a=o||t.i!=2,h=t.i;o&&(e=new yr(n*3));var l=function(Lt){var Dt=e.length;if(Lt>Dt){var Ot=new yr(Math.max(Dt*2,Lt));Ot.set(e),e=Ot}},f=t.f||0,p=t.p||0,v=t.b||0,g=t.l,b=t.d,w=t.m,C=t.n,x=n*8;do{if(!g){f=Pn(s,p,1);var k=Pn(s,p+1,3);if(p+=3,k)if(k==1)g=Nm,b=Dm,w=9,C=5;else if(k==2){var nt=Pn(s,p,31)+257,J=Pn(s,p+10,15)+4,F=nt+Pn(s,p+5,31)+1;p+=14;for(var et=new yr(F),dt=new yr(19),N=0;N<J;++N)dt[Ff[N]]=Pn(s,p+N*3,7);p+=J*3;for(var M=Mf(dt),z=(1<<M)-1,R=Zn(dt,M,1),N=0;N<F;){var ht=R[Pn(s,p,z)];p+=ht&15;var I=ht>>4;if(I<16)et[N++]=I;else{var it=0,ut=0;for(I==16?(ut=3+Pn(s,p,3),p+=2,it=et[N-1]):I==17?(ut=3+Pn(s,p,7),p+=3):I==18&&(ut=11+Pn(s,p,127),p+=7);ut--;)et[N++]=it}}var Q=et.subarray(0,nt),gt=et.subarray(nt);w=Mf(Q),C=Mf(gt),g=Zn(Q,w,1),b=Zn(gt,C,1)}else kn(1);else{var I=qf(p)+4,G=s[I-4]|s[I-3]<<8,U=I+G;if(U>n){h&&kn(0);break}a&&l(v+G),e.set(s.subarray(I,U),v),t.b=v+=G,t.p=p=U*8,t.f=f;continue}if(p>x){h&&kn(0);break}}a&&l(v+131072);for(var pt=(1<<w)-1,kt=(1<<C)-1,T=p;;T=p){var it=g[Df(s,p)&pt],E=it>>4;if(p+=it&15,p>x){h&&kn(0);break}if(it||kn(2),E<256)e[v++]=E;else if(E==256){T=p,g=null;break}else{var B=E-254;if(E>264){var N=E-257,V=il[N];B=Pn(s,p,(1<<V)-1)+cp[N],p+=V}var $=b[Df(s,p)&kt],at=$>>4;$||kn(3),p+=$&15;var gt=km[at];if(at>3){var V=sl[at];gt+=Df(s,p)&(1<<V)-1,p+=V}if(p>x){h&&kn(0);break}a&&l(v+131072);var lt=v+B;if(v<gt){var ct=i-gt,Ct=Math.min(gt,lt);for(ct+v<0&&kn(3);v<Ct;++v)e[v]=r[ct+v]}for(;v<lt;++v)e[v]=e[v-gt]}}t.l=g,t.p=T,t.b=v,t.f=f,g&&(f=1,t.m=w,t.d=b,t.n=C)}while(!f);return v!=e.length&&o?up(e,0,v):e.subarray(0,v)},xi=function(s,t,e){e<<=t&7;var r=t/8|0;s[r]|=e,s[r+1]|=e>>8},oh=function(s,t,e){e<<=t&7;var r=t/8|0;s[r]|=e,s[r+1]|=e>>8,s[r+2]|=e>>16},Ef=function(s,t){for(var e=[],r=0;r<s.length;++r)s[r]&&e.push({s:r,f:s[r]});var n=e.length,i=e.slice();if(!n)return{t:dp,l:0};if(n==1){var o=new yr(e[0].s+1);return o[e[0].s]=1,{t:o,l:1}}e.sort(function(U,nt){return U.f-nt.f}),e.push({s:-1,f:25001});var a=e[0],h=e[1],l=0,f=1,p=2;for(e[0]={s:-1,f:a.f+h.f,l:a,r:h};f!=n-1;)a=e[e[l].f<e[p].f?l++:p++],h=e[l!=f&&e[l].f<e[p].f?l++:p++],e[f++]={s:-1,f:a.f+h.f,l:a,r:h};for(var v=i[0].s,r=1;r<n;++r)i[r].s>v&&(v=i[r].s);var g=new Jr(v+1),b=Bf(e[f-1],g,0);if(b>t){var r=0,w=0,C=b-t,x=1<<C;for(i.sort(function(nt,J){return g[J.s]-g[nt.s]||nt.f-J.f});r<n;++r){var k=i[r].s;if(g[k]>t)w+=x-(1<<b-g[k]),g[k]=t;else break}for(w>>=C;w>0;){var I=i[r].s;g[I]<t?w-=1<<t-g[I]++-1:++r}for(;r>=0&&w;--r){var G=i[r].s;g[G]==t&&(--g[G],++w)}b=t}return{t:new yr(g),l:b}},Bf=function(s,t,e){return s.s==-1?Math.max(Bf(s.l,t,e+1),Bf(s.r,t,e+1)):t[s.s]=e},sp=function(s){for(var t=s.length;t&&!s[--t];);for(var e=new Jr(++t),r=0,n=s[0],i=1,o=function(h){e[r++]=h},a=1;a<=t;++a)if(s[a]==n&&a!=t)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=s[a]}return{c:e.subarray(0,r),n:t}},ah=function(s,t){for(var e=0,r=0;r<t.length;++r)e+=s[r]*t[r];return e},fp=function(s,t,e){var r=e.length,n=qf(t+2);s[n]=r&255,s[n+1]=r>>8,s[n+2]=s[n]^255,s[n+3]=s[n+1]^255;for(var i=0;i<r;++i)s[n+i+4]=e[i];return(n+4+r)*8},op=function(s,t,e,r,n,i,o,a,h,l,f){xi(t,f++,e),++n[256];for(var p=Ef(n,15),v=p.t,g=p.l,b=Ef(i,15),w=b.t,C=b.l,x=sp(v),k=x.c,I=x.n,G=sp(w),U=G.c,nt=G.n,J=new Jr(19),F=0;F<k.length;++F)++J[k[F]&31];for(var F=0;F<U.length;++F)++J[U[F]&31];for(var et=Ef(J,7),dt=et.t,N=et.l,M=19;M>4&&!dt[Ff[M-1]];--M);var z=l+5<<3,R=ah(n,Ji)+ah(i,hh)+o,ht=ah(n,v)+ah(i,w)+o+14+3*M+ah(J,dt)+2*J[16]+3*J[17]+7*J[18];if(h>=0&&z<=R&&z<=ht)return fp(t,f,s.subarray(h,h+l));var it,ut,Q,gt;if(xi(t,f,1+(ht<R)),f+=2,ht<R){it=Zn(v,g,0),ut=v,Q=Zn(w,C,0),gt=w;var pt=Zn(dt,N,0);xi(t,f,I-257),xi(t,f+5,nt-1),xi(t,f+10,M-4),f+=14;for(var F=0;F<M;++F)xi(t,f+3*F,dt[Ff[F]]);f+=3*M;for(var kt=[k,U],T=0;T<2;++T)for(var E=kt[T],F=0;F<E.length;++F){var B=E[F]&31;xi(t,f,pt[B]),f+=dt[B],B>15&&(xi(t,f,E[F]>>5&127),f+=E[F]>>12)}}else it=Om,ut=Ji,Q=Mm,gt=hh;for(var F=0;F<a;++F){var V=r[F];if(V>255){var B=V>>18&31;oh(t,f,it[B+257]),f+=ut[B+257],B>7&&(xi(t,f,V>>23&31),f+=il[B]);var $=V&31;oh(t,f,Q[$]),f+=gt[$],$>3&&(oh(t,f,V>>5&8191),f+=sl[$])}else oh(t,f,it[V]),f+=ut[V]}return oh(t,f,it[256]),f+ut[256]},jm=new Rf([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),dp=new yr(0),Im=function(s,t,e,r,n,i){var o=i.z||s.length,a=new yr(r+o+5*(1+Math.ceil(o/7e3))+n),h=a.subarray(r,a.length-n),l=i.l,f=(i.r||0)&7;if(t){f&&(h[0]=i.r>>3);for(var p=jm[t-1],v=p>>13,g=p&8191,b=(1<<e)-1,w=i.p||new Jr(32768),C=i.h||new Jr(b+1),x=Math.ceil(e/3),k=2*x,I=function(Ht){return(s[Ht]^s[Ht+1]<<x^s[Ht+2]<<k)&b},G=new Rf(25e3),U=new Jr(288),nt=new Jr(32),J=0,F=0,et=i.i||0,dt=0,N=i.w||0,M=0;et+2<o;++et){var z=I(et),R=et&32767,ht=C[z];if(w[R]=ht,C[z]=R,N<=et){var it=o-et;if((J>7e3||dt>24576)&&(it>423||!l)){f=op(s,h,0,G,U,nt,F,dt,M,et-M,f),dt=J=F=0,M=et;for(var ut=0;ut<286;++ut)U[ut]=0;for(var ut=0;ut<30;++ut)nt[ut]=0}var Q=2,gt=0,pt=g,kt=R-ht&32767;if(it>2&&z==I(et-kt))for(var T=Math.min(v,it)-1,E=Math.min(32767,et),B=Math.min(258,it);kt<=E&&--pt&&R!=ht;){if(s[et+Q]==s[et+Q-kt]){for(var V=0;V<B&&s[et+V]==s[et+V-kt];++V);if(V>Q){if(Q=V,gt=kt,V>T)break;for(var $=Math.min(kt,V-2),at=0,ut=0;ut<$;++ut){var lt=et-kt+ut&32767,ct=w[lt],Ct=lt-ct&32767;Ct>at&&(at=Ct,ht=lt)}}}R=ht,ht=w[R],kt+=R-ht&32767}if(gt){G[dt++]=268435456|jf[Q]<<18|ip[gt];var Lt=jf[Q]&31,Dt=ip[gt]&31;F+=il[Lt]+sl[Dt],++U[257+Lt],++nt[Dt],N=et+Q,++J}else G[dt++]=s[et],++U[s[et]]}}for(et=Math.max(et,N);et<o;++et)G[dt++]=s[et],++U[s[et]];f=op(s,h,l,G,U,nt,F,dt,M,et-M,f),l||(i.r=f&7|h[f/8|0]<<3,f-=7,i.h=C,i.p=w,i.i=et,i.w=N)}else{for(var et=i.w||0;et<o+l;et+=65535){var Ot=et+65535;Ot>=o&&(h[f/8|0]=l,Ot=o),f=fp(h,f+1,s.subarray(et,Ot))}i.i=o}return up(a,0,r+qf(f)+n)};var gp=function(){var s=1,t=0;return{p:function(e){for(var r=s,n=t,i=e.length|0,o=0;o!=i;){for(var a=Math.min(o+2655,i);o<a;++o)n+=r+=e[o];r=(r&65535)+15*(r>>16),n=(n&65535)+15*(n>>16)}s=r,t=n},d:function(){return s%=65521,t%=65521,(s&255)<<24|(s&65280)<<8|(t&255)<<8|t>>8}}},Bm=function(s,t,e,r,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new yr(i.length+s.length);o.set(i),o.set(s,i.length),s=o,n.w=i.length}return Im(s,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+t.mem,e,r,n)};var pp=function(s,t,e){for(;e;++t)s[t]=e,e>>>=8};var Rm=function(s,t){var e=t.level,r=e==0?0:e<6?1:e==9?3:2;if(s[0]=120,s[1]=r<<6|(t.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,t.dictionary){var n=gp();n.p(t.dictionary),pp(s,2,n.d())}},qm=function(s,t){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&kn(6,"invalid zlib data"),(s[1]>>5&1)==+!t&&kn(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function ol(s,t){t||(t={});var e=gp();e.p(s);var r=Bm(s,t,t.dictionary?6:2,4);return Rm(r,t),pp(r,r.length-4,e.d()),r}function mp(s,t){return Fm(s.subarray(qm(s,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var zm=typeof TextDecoder<"u"&&new TextDecoder,Um=0;try{zm.decode(dp,{stream:!0}),Um=1}catch{}var Yt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function zf(){Yt.console&&typeof Yt.console.log=="function"&&Yt.console.log.apply(Yt.console,arguments)}var Pe={log:zf,warn:function(s){Yt.console&&(typeof Yt.console.warn=="function"?Yt.console.warn.apply(Yt.console,arguments):zf.call(null,arguments))},error:function(s){Yt.console&&(typeof Yt.console.error=="function"?Yt.console.error.apply(Yt.console,arguments):zf(s))}};function Uf(s,t,e){var r=new XMLHttpRequest;r.open("GET",s),r.responseType="blob",r.onload=function(){Gs(r.response,t,e)},r.onerror=function(){Pe.error("could not download file")},r.send()}function vp(s){var t=new XMLHttpRequest;t.open("HEAD",s,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function al(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(t)}}var ch,Yf,Gs=Yt.saveAs||((typeof window>"u"?"undefined":Ce(window))!=="object"||window!==Yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(s,t,e){var r=Yt.URL||Yt.webkitURL,n=document.createElement("a");t=t||s.name||"download",n.download=t,n.rel="noopener",typeof s=="string"?(n.href=s,n.origin!==location.origin?vp(n.href)?Uf(s,t,e):al(n,n.target="_blank"):al(n)):(n.href=r.createObjectURL(s),setTimeout(function(){r.revokeObjectURL(n.href)},4e4),setTimeout(function(){al(n)},0))}:"msSaveOrOpenBlob"in navigator?function(s,t,e){if(t=t||s.name||"download",typeof s=="string")if(vp(s))Uf(s,t,e);else{var r=document.createElement("a");r.href=s,r.target="_blank",setTimeout(function(){al(r)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:Ce(i)!=="object"&&(Pe.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(s,e),t)}:function(s,t,e,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof s=="string")return Uf(s,t,e);var n=s.type==="application/octet-stream",i=/constructor/i.test(Yt.HTMLElement)||Yt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":Ce(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var f=a.result;f=o?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},a.readAsDataURL(s)}else{var h=Yt.URL||Yt.webkitURL,l=h.createObjectURL(s);r?r.location=l:location.href=l,r=null,setTimeout(function(){h.revokeObjectURL(l)},4e4)}});function Ep(s){var t;s=s||"",this.ok=!1,s.charAt(0)=="#"&&(s=s.substr(1,6)),s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[s=(s=s.replace(/ /g,"")).toLowerCase()]||s;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<e.length;r++){var n=e[r].re,i=e[r].process,o=n.exec(s);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),h=this.g.toString(16),l=this.b.toString(16);return a.length==1&&(a="0"+a),h.length==1&&(h="0"+h),l.length==1&&(l="0"+l),"#"+a+h+l}}function Wf(s,t){var e=s[0],r=s[1],n=s[2],i=s[3];e=br(e,r,n,i,t[0],7,-680876936),i=br(i,e,r,n,t[1],12,-389564586),n=br(n,i,e,r,t[2],17,606105819),r=br(r,n,i,e,t[3],22,-1044525330),e=br(e,r,n,i,t[4],7,-176418897),i=br(i,e,r,n,t[5],12,1200080426),n=br(n,i,e,r,t[6],17,-1473231341),r=br(r,n,i,e,t[7],22,-45705983),e=br(e,r,n,i,t[8],7,1770035416),i=br(i,e,r,n,t[9],12,-1958414417),n=br(n,i,e,r,t[10],17,-42063),r=br(r,n,i,e,t[11],22,-1990404162),e=br(e,r,n,i,t[12],7,1804603682),i=br(i,e,r,n,t[13],12,-40341101),n=br(n,i,e,r,t[14],17,-1502002290),e=wr(e,r=br(r,n,i,e,t[15],22,1236535329),n,i,t[1],5,-165796510),i=wr(i,e,r,n,t[6],9,-1069501632),n=wr(n,i,e,r,t[11],14,643717713),r=wr(r,n,i,e,t[0],20,-373897302),e=wr(e,r,n,i,t[5],5,-701558691),i=wr(i,e,r,n,t[10],9,38016083),n=wr(n,i,e,r,t[15],14,-660478335),r=wr(r,n,i,e,t[4],20,-405537848),e=wr(e,r,n,i,t[9],5,568446438),i=wr(i,e,r,n,t[14],9,-1019803690),n=wr(n,i,e,r,t[3],14,-187363961),r=wr(r,n,i,e,t[8],20,1163531501),e=wr(e,r,n,i,t[13],5,-1444681467),i=wr(i,e,r,n,t[2],9,-51403784),n=wr(n,i,e,r,t[7],14,1735328473),e=xr(e,r=wr(r,n,i,e,t[12],20,-1926607734),n,i,t[5],4,-378558),i=xr(i,e,r,n,t[8],11,-2022574463),n=xr(n,i,e,r,t[11],16,1839030562),r=xr(r,n,i,e,t[14],23,-35309556),e=xr(e,r,n,i,t[1],4,-1530992060),i=xr(i,e,r,n,t[4],11,1272893353),n=xr(n,i,e,r,t[7],16,-155497632),r=xr(r,n,i,e,t[10],23,-1094730640),e=xr(e,r,n,i,t[13],4,681279174),i=xr(i,e,r,n,t[0],11,-358537222),n=xr(n,i,e,r,t[3],16,-722521979),r=xr(r,n,i,e,t[6],23,76029189),e=xr(e,r,n,i,t[9],4,-640364487),i=xr(i,e,r,n,t[12],11,-421815835),n=xr(n,i,e,r,t[15],16,530742520),e=_r(e,r=xr(r,n,i,e,t[2],23,-995338651),n,i,t[0],6,-198630844),i=_r(i,e,r,n,t[7],10,1126891415),n=_r(n,i,e,r,t[14],15,-1416354905),r=_r(r,n,i,e,t[5],21,-57434055),e=_r(e,r,n,i,t[12],6,1700485571),i=_r(i,e,r,n,t[3],10,-1894986606),n=_r(n,i,e,r,t[10],15,-1051523),r=_r(r,n,i,e,t[1],21,-2054922799),e=_r(e,r,n,i,t[8],6,1873313359),i=_r(i,e,r,n,t[15],10,-30611744),n=_r(n,i,e,r,t[6],15,-1560198380),r=_r(r,n,i,e,t[13],21,1309151649),e=_r(e,r,n,i,t[4],6,-145523070),i=_r(i,e,r,n,t[11],10,-1120210379),n=_r(n,i,e,r,t[2],15,718787259),r=_r(r,n,i,e,t[9],21,-343485551),s[0]=$i(e,s[0]),s[1]=$i(r,s[1]),s[2]=$i(n,s[2]),s[3]=$i(i,s[3])}function vl(s,t,e,r,n,i){return t=$i($i(t,s),$i(r,i)),$i(t<<n|t>>>32-n,e)}function br(s,t,e,r,n,i,o){return vl(t&e|~t&r,s,t,n,i,o)}function wr(s,t,e,r,n,i,o){return vl(t&r|e&~r,s,t,n,i,o)}function xr(s,t,e,r,n,i,o){return vl(t^e^r,s,t,n,i,o)}function _r(s,t,e,r,n,i,o){return vl(e^(t|~r),s,t,n,i,o)}function Fp(s){var t,e=s.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=s.length;t+=64)Wf(r,Wm(s.substring(t-64,t)));s=s.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<s.length;t++)n[t>>2]|=s.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Wf(r,n),t=0;t<16;t++)n[t]=0;return n[14]=8*e,Wf(r,n),r}function Wm(s){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=s.charCodeAt(t)+(s.charCodeAt(t+1)<<8)+(s.charCodeAt(t+2)<<16)+(s.charCodeAt(t+3)<<24);return e}ch=Yt.atob.bind(Yt),Yf=Yt.btoa.bind(Yt);var yp="0123456789abcdef".split("");function Vm(s){for(var t="",e=0;e<4;e++)t+=yp[s>>8*e+4&15]+yp[s>>8*e&15];return t}function Hm(s){return String.fromCharCode((255&s)>>0,(65280&s)>>8,(16711680&s)>>16,(4278190080&s)>>24)}function Xf(s){return Fp(s).map(Hm).join("")}var Gm=function(s){for(var t=0;t<s.length;t++)s[t]=Vm(s[t]);return s.join("")}(Fp("hello"))!="5d41402abc4b2a76b9719d911017c592";function $i(s,t){if(Gm){var e=(65535&s)+(65535&t);return(s>>16)+(t>>16)+(e>>16)<<16|65535&e}return s+t&4294967295}function Kf(s,t){var e,r,n,i;if(s!==e){for(var o=(n=s,i=1+(256/s.length>>0),new Array(i+1).join(n)),a=[],h=0;h<256;h++)a[h]=h;var l=0;for(h=0;h<256;h++){var f=a[h];l=(l+f+o.charCodeAt(h))%256,a[h]=a[l],a[l]=f}e=s,r=a}else a=r;var p=t.length,v=0,g=0,b="";for(h=0;h<p;h++)g=(g+(f=a[v=(v+1)%256]))%256,a[v]=a[g],a[g]=f,o=a[(a[v]+a[g])%256],b+=String.fromCharCode(t.charCodeAt(h)^o);return b}var bp={print:4,modify:8,copy:16,"annot-forms":32};function $o(s,t,e,r){this.v=1,this.r=2;var n=192;s.forEach(function(a){if(bp.perm!==void 0)throw new Error("Invalid permission: "+a);n+=bp[a]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var i=(t+this.padding).substr(0,32),o=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=Xf(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Kf(this.encryptionKey,this.padding)}function Qo(s){if(/[^\u0000-\u00ff]/.test(s))throw new Error("Invalid PDF Name Object: "+s+", Only accept ASCII characters.");for(var t="",e=s.length,r=0;r<e;r++){var n=s.charCodeAt(r);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?t+="#"+("0"+n.toString(16)).slice(-2):t+=s[r]}return t}function wp(s){if(Ce(s)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,r,n){if(n=n||!1,typeof e!="string"||typeof r!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var i=Math.random().toString(35);return t[e][i]=[r,!!n],i},this.unsubscribe=function(e){for(var r in t)if(t[r][e])return delete t[r][e],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var r=Array.prototype.slice.call(arguments,1),n=[];for(var i in t[e]){var o=t[e][i];try{o[0].apply(s,r)}catch(a){Yt.console&&Pe.error("jsPDF PubSub Error",a.message,a)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function pl(s){if(!(this instanceof pl))return new pl(s);var t="opacity,stroke-opacity".split(",");for(var e in s)s.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=s[e]);this.id="",this.objectNumber=-1}function jp(s,t){this.gState=s,this.matrix=t,this.id="",this.objectNumber=-1}function Ys(s,t,e,r,n){if(!(this instanceof Ys))return new Ys(s,t,e,r,n);this.type=s==="axial"?2:3,this.coords=t,this.colors=e,jp.call(this,r,n)}function ta(s,t,e,r,n){if(!(this instanceof ta))return new ta(s,t,e,r,n);this.boundingBox=s,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,jp.call(this,r,n)}function Gt(s){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],n=arguments[2],i=arguments[3],o=[],a=1,h=16,l="S",f=null;Ce(s=s||{})==="object"&&(e=s.orientation,r=s.unit||r,n=s.format||n,i=s.compress||s.compressPdf||i,(f=s.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),a=typeof s.userUnit=="number"?Math.abs(s.userUnit):1,s.precision!==void 0&&(t=s.precision),s.floatPrecision!==void 0&&(h=s.floatPrecision),l=s.defaultPathOperation||"S"),o=s.filters||(i===!0?["FlateEncode"]:o),r=r||"mm",e=(""+(e||"P")).toLowerCase();var p=s.putOnlyUsedFonts||!1,v={},g={internal:{},__private__:{}};g.__private__.PubSub=wp;var b="1.3",w=g.__private__.getPdfVersion=function(){return b};g.__private__.setPdfVersion=function(d){b=d};var C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return C};var x=g.__private__.getPageFormat=function(d){return C[d]};n=n||"a4";var k={COMPAT:"compat",ADVANCED:"advanced"},I=k.COMPAT;function G(){this.saveGraphicsState(),q(new Vt(Ft,0,0,-Ft,0,Ai()*Ft).toString()+" cm"),this.setFontSize(this.getFontSize()/Ft),l="n",I=k.ADVANCED}function U(){this.restoreGraphicsState(),l="S",I=k.COMPAT}var nt=g.__private__.combineFontStyleAndFontWeight=function(d,S){if(d=="bold"&&S=="normal"||d=="bold"&&S==400||d=="normal"&&S=="italic"||d=="bold"&&S=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return S&&(d=S==400||S==="normal"?d==="italic"?"italic":"normal":S!=700&&S!=="bold"||d!=="normal"?(S==700?"bold":S)+""+d:"bold"),d};g.advancedAPI=function(d){var S=I===k.COMPAT;return S&&G.call(this),typeof d!="function"||(d(this),S&&U.call(this)),this},g.compatAPI=function(d){var S=I===k.ADVANCED;return S&&U.call(this),typeof d!="function"||(d(this),S&&G.call(this)),this},g.isAdvancedAPI=function(){return I===k.ADVANCED};var J,F=function(d){if(I!==k.ADVANCED)throw new Error(d+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},et=g.roundToPrecision=g.__private__.roundToPrecision=function(d,S){var j=t||S;if(isNaN(d)||isNaN(j))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return d.toFixed(j).replace(/0+$/,"")};J=g.hpf=g.__private__.hpf=typeof h=="number"?function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.hpf");return et(d,h)}:h==="smart"?function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.hpf");return et(d,d>-1&&d<1?16:5)}:function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.hpf");return et(d,16)};var dt=g.f2=g.__private__.f2=function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.f2");return et(d,2)},N=g.__private__.f3=function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.f3");return et(d,3)},M=g.scale=g.__private__.scale=function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.scale");return I===k.COMPAT?d*Ft:I===k.ADVANCED?d:void 0},z=function(d){return I===k.COMPAT?Ai()-d:I===k.ADVANCED?d:void 0},R=function(d){return M(z(d))};g.__private__.setPrecision=g.setPrecision=function(d){typeof parseInt(d,10)=="number"&&(t=parseInt(d,10))};var ht,it="00000000000000000000000000000000",ut=g.__private__.getFileId=function(){return it},Q=g.__private__.setFileId=function(d){return it=d!==void 0&&/^[a-fA-F0-9]{32}$/.test(d)?d.toUpperCase():it.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(gr=new $o(f.userPermissions,f.userPassword,f.ownerPassword,it)),it};g.setFileId=function(d){return Q(d),this},g.getFileId=function(){return ut()};var gt=g.__private__.convertDateToPDFDate=function(d){var S=d.getTimezoneOffset(),j=S<0?"+":"-",H=Math.floor(Math.abs(S/60)),rt=Math.abs(S%60),vt=[j,B(H),"'",B(rt),"'"].join("");return["D:",d.getFullYear(),B(d.getMonth()+1),B(d.getDate()),B(d.getHours()),B(d.getMinutes()),B(d.getSeconds()),vt].join("")},pt=g.__private__.convertPDFDateToDate=function(d){var S=parseInt(d.substr(2,4),10),j=parseInt(d.substr(6,2),10)-1,H=parseInt(d.substr(8,2),10),rt=parseInt(d.substr(10,2),10),vt=parseInt(d.substr(12,2),10),St=parseInt(d.substr(14,2),10);return new Date(S,j,H,rt,vt,St,0)},kt=g.__private__.setCreationDate=function(d){var S;if(d===void 0&&(d=new Date),d instanceof Date)S=gt(d);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(d))throw new Error("Invalid argument passed to jsPDF.setCreationDate");S=d}return ht=S},T=g.__private__.getCreationDate=function(d){var S=ht;return d==="jsDate"&&(S=pt(ht)),S};g.setCreationDate=function(d){return kt(d),this},g.getCreationDate=function(d){return T(d)};var E,B=g.__private__.padd2=function(d){return("0"+parseInt(d)).slice(-2)},V=g.__private__.padd2Hex=function(d){return("00"+(d=d.toString())).substr(d.length)},$=0,at=[],lt=[],ct=0,Ct=[],Lt=[],Dt=!1,Ot=lt,Ht=function(){$=0,ct=0,lt=[],at=[],Ct=[],ri=Je(),gn=Je()};g.__private__.setCustomOutputDestination=function(d){Dt=!0,Ot=d};var yt=function(d){Dt||(Ot=d)};g.__private__.resetCustomOutputDestination=function(){Dt=!1,Ot=lt};var q=g.__private__.out=function(d){return d=d.toString(),ct+=d.length+1,Ot.push(d),Ot},te=g.__private__.write=function(d){return q(arguments.length===1?d.toString():Array.prototype.join.call(arguments," "))},qt=g.__private__.getArrayBuffer=function(d){for(var S=d.length,j=new ArrayBuffer(S),H=new Uint8Array(j);S--;)H[S]=d.charCodeAt(S);return j},At=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return At};var Tt=s.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(d){return Tt=I===k.ADVANCED?d/Ft:d,this};var Et,Mt=g.__private__.getFontSize=g.getFontSize=function(){return I===k.COMPAT?Tt:Tt*Ft},zt=s.R2L||!1;g.__private__.setR2L=g.setR2L=function(d){return zt=d,this},g.__private__.getR2L=g.getR2L=function(){return zt};var Jt,ne=g.__private__.setZoomMode=function(d){var S=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(d))Et=d;else if(isNaN(d)){if(S.indexOf(d)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+d+'" is not recognized.');Et=d}else Et=parseInt(d,10)};g.__private__.getZoomMode=function(){return Et};var se,ce=g.__private__.setPageMode=function(d){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(d)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+d+'" is not recognized.');Jt=d};g.__private__.getPageMode=function(){return Jt};var xe=g.__private__.setLayoutMode=function(d){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(d)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+d+'" is not recognized.');se=d};g.__private__.getLayoutMode=function(){return se},g.__private__.setDisplayMode=g.setDisplayMode=function(d,S,j){return ne(d),xe(S),ce(j),this};var Xt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(d){if(Object.keys(Xt).indexOf(d)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Xt[d]},g.__private__.getDocumentProperties=function(){return Xt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(d){for(var S in Xt)Xt.hasOwnProperty(S)&&d[S]&&(Xt[S]=d[S]);return this},g.__private__.setDocumentProperty=function(d,S){if(Object.keys(Xt).indexOf(d)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Xt[d]=S};var oe,Ft,dr,fe,un,Ae={},Me={},Dn=[],pe={},is={},Fe={},fn={},ei=null,je=0,Zt=[],me=new wp(g),ss=s.hotfixes||[],lr={},En={},Fn=[],Vt=function d(S,j,H,rt,vt,St){if(!(this instanceof d))return new d(S,j,H,rt,vt,St);isNaN(S)&&(S=1),isNaN(j)&&(j=0),isNaN(H)&&(H=0),isNaN(rt)&&(rt=1),isNaN(vt)&&(vt=0),isNaN(St)&&(St=0),this._matrix=[S,j,H,rt,vt,St]};Object.defineProperty(Vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(d){this._matrix[0]=d}}),Object.defineProperty(Vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(d){this._matrix[1]=d}}),Object.defineProperty(Vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(d){this._matrix[2]=d}}),Object.defineProperty(Vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(d){this._matrix[3]=d}}),Object.defineProperty(Vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(d){this._matrix[4]=d}}),Object.defineProperty(Vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(d){this._matrix[5]=d}}),Object.defineProperty(Vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(d){this._matrix[0]=d}}),Object.defineProperty(Vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(d){this._matrix[1]=d}}),Object.defineProperty(Vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(d){this._matrix[2]=d}}),Object.defineProperty(Vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(d){this._matrix[3]=d}}),Object.defineProperty(Vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(d){this._matrix[4]=d}}),Object.defineProperty(Vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(d){this._matrix[5]=d}}),Object.defineProperty(Vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Vt.prototype.join=function(d){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(J).join(d)},Vt.prototype.multiply=function(d){var S=d.sx*this.sx+d.shy*this.shx,j=d.sx*this.shy+d.shy*this.sy,H=d.shx*this.sx+d.sy*this.shx,rt=d.shx*this.shy+d.sy*this.sy,vt=d.tx*this.sx+d.ty*this.shx+this.tx,St=d.tx*this.shy+d.ty*this.sy+this.ty;return new Vt(S,j,H,rt,vt,St)},Vt.prototype.decompose=function(){var d=this.sx,S=this.shy,j=this.shx,H=this.sy,rt=this.tx,vt=this.ty,St=Math.sqrt(d*d+S*S),jt=(d/=St)*j+(S/=St)*H;j-=d*jt,H-=S*jt;var Ut=Math.sqrt(j*j+H*H);return jt/=Ut,d*(H/=Ut)<S*(j/=Ut)&&(d=-d,S=-S,jt=-jt,St=-St),{scale:new Vt(St,0,0,Ut,0,0),translate:new Vt(1,0,0,1,rt,vt),rotate:new Vt(d,S,-S,d,0,0),skew:new Vt(1,0,jt,1,0,0)}},Vt.prototype.toString=function(d){return this.join(" ")},Vt.prototype.inversed=function(){var d=this.sx,S=this.shy,j=this.shx,H=this.sy,rt=this.tx,vt=this.ty,St=1/(d*H-S*j),jt=H*St,Ut=-S*St,ee=-j*St,$t=d*St;return new Vt(jt,Ut,ee,$t,-jt*rt-ee*vt,-Ut*rt-$t*vt)},Vt.prototype.applyToPoint=function(d){var S=d.x*this.sx+d.y*this.shx+this.tx,j=d.x*this.shy+d.y*this.sy+this.ty;return new go(S,j)},Vt.prototype.applyToRectangle=function(d){var S=this.applyToPoint(d),j=this.applyToPoint(new go(d.x+d.w,d.y+d.h));return new wa(S.x,S.y,j.x-S.x,j.y-S.y)},Vt.prototype.clone=function(){var d=this.sx,S=this.shy,j=this.shx,H=this.sy,rt=this.tx,vt=this.ty;return new Vt(d,S,j,H,rt,vt)},g.Matrix=Vt;var dn=g.matrixMult=function(d,S){return S.multiply(d)},jn=new Vt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=jn;var Or=function(d,S){if(!is[d]){var j=(S instanceof Ys?"Sh":"P")+(Object.keys(pe).length+1).toString(10);S.id=j,is[d]=j,pe[j]=S,me.publish("addPattern",S)}};g.ShadingPattern=Ys,g.TilingPattern=ta,g.addShadingPattern=function(d,S){return F("addShadingPattern()"),Or(d,S),this},g.beginTilingPattern=function(d){F("beginTilingPattern()"),jh(d.boundingBox[0],d.boundingBox[1],d.boundingBox[2]-d.boundingBox[0],d.boundingBox[3]-d.boundingBox[1],d.matrix)},g.endTilingPattern=function(d,S){F("endTilingPattern()"),S.stream=Lt[E].join(`
`),Or(d,S),me.publish("endTilingPattern",S),Fn.pop().restore()};var rr=g.__private__.newObject=function(){var d=Je();return zr(d,!0),d},Je=g.__private__.newObjectDeferred=function(){return $++,at[$]=function(){return ct},$},zr=function(d,S){return S=typeof S=="boolean"&&S,at[d]=ct,S&&q(d+" 0 obj"),d},to=g.__private__.newAdditionalObject=function(){var d={objId:Je(),content:""};return Ct.push(d),d},ri=Je(),gn=Je(),pn=g.__private__.decodeColorString=function(d){var S=d.split(" ");if(S.length!==2||S[1]!=="g"&&S[1]!=="G")S.length===5&&(S[4]==="k"||S[4]==="K")&&(S=[(1-S[0])*(1-S[3]),(1-S[1])*(1-S[3]),(1-S[2])*(1-S[3]),"r"]);else{var j=parseFloat(S[0]);S=[j,j,j,"r"]}for(var H="#",rt=0;rt<3;rt++)H+=("0"+Math.floor(255*parseFloat(S[rt])).toString(16)).slice(-2);return H},mn=g.__private__.encodeColorString=function(d){var S;typeof d=="string"&&(d={ch1:d});var j=d.ch1,H=d.ch2,rt=d.ch3,vt=d.ch4,St=d.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof j=="string"&&j.charAt(0)!=="#"){var jt=new Ep(j);if(jt.ok)j=jt.toHex();else if(!/^\d*\.?\d*$/.test(j))throw new Error('Invalid color "'+j+'" passed to jsPDF.encodeColorString.')}if(typeof j=="string"&&/^#[0-9A-Fa-f]{3}$/.test(j)&&(j="#"+j[1]+j[1]+j[2]+j[2]+j[3]+j[3]),typeof j=="string"&&/^#[0-9A-Fa-f]{6}$/.test(j)){var Ut=parseInt(j.substr(1),16);j=Ut>>16&255,H=Ut>>8&255,rt=255&Ut}if(H===void 0||vt===void 0&&j===H&&H===rt)if(typeof j=="string")S=j+" "+St[0];else switch(d.precision){case 2:S=dt(j/255)+" "+St[0];break;case 3:default:S=N(j/255)+" "+St[0]}else if(vt===void 0||Ce(vt)==="object"){if(vt&&!isNaN(vt.a)&&vt.a===0)return S=["1.","1.","1.",St[1]].join(" ");if(typeof j=="string")S=[j,H,rt,St[1]].join(" ");else switch(d.precision){case 2:S=[dt(j/255),dt(H/255),dt(rt/255),St[1]].join(" ");break;default:case 3:S=[N(j/255),N(H/255),N(rt/255),St[1]].join(" ")}}else if(typeof j=="string")S=[j,H,rt,vt,St[2]].join(" ");else switch(d.precision){case 2:S=[dt(j),dt(H),dt(rt),dt(vt),St[2]].join(" ");break;case 3:default:S=[N(j),N(H),N(rt),N(vt),St[2]].join(" ")}return S},In=g.__private__.getFilters=function(){return o},Zr=g.__private__.putStream=function(d){var S=(d=d||{}).data||"",j=d.filters||In(),H=d.alreadyAppliedFilters||[],rt=d.addLength1||!1,vt=S.length,St=d.objectId,jt=function(pr){return pr};if(f!==null&&St===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(jt=gr.encryptor(St,0));var Ut={};j===!0&&(j=["FlateEncode"]);var ee=d.additionalKeyValues||[],$t=(Ut=Gt.API.processDataByFilters!==void 0?Gt.API.processDataByFilters(S,j):{data:S,reverseChain:[]}).reverseChain+(Array.isArray(H)?H.join(" "):H.toString());if(Ut.data.length!==0&&(ee.push({key:"Length",value:Ut.data.length}),rt===!0&&ee.push({key:"Length1",value:vt})),$t.length!=0)if($t.split("/").length-1==1)ee.push({key:"Filter",value:$t});else{ee.push({key:"Filter",value:"["+$t+"]"});for(var he=0;he<ee.length;he+=1)if(ee[he].key==="DecodeParms"){for(var Ee=[],Ie=0;Ie<Ut.reverseChain.split("/").length-1;Ie+=1)Ee.push("null");Ee.push(ee[he].value),ee[he].value="["+Ee.join(" ")+"]"}}q("<<");for(var Ze=0;Ze<ee.length;Ze++)q("/"+ee[Ze].key+" "+ee[Ze].value);q(">>"),Ut.data.length!==0&&(q("stream"),q(jt(Ut.data)),q("endstream"))},Bn=g.__private__.putPage=function(d){var S=d.number,j=d.data,H=d.objId,rt=d.contentsObjId;zr(H,!0),q("<</Type /Page"),q("/Parent "+d.rootDictionaryObjId+" 0 R"),q("/Resources "+d.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(J(d.mediaBox.bottomLeftX))+" "+parseFloat(J(d.mediaBox.bottomLeftY))+" "+J(d.mediaBox.topRightX)+" "+J(d.mediaBox.topRightY)+"]"),d.cropBox!==null&&q("/CropBox ["+J(d.cropBox.bottomLeftX)+" "+J(d.cropBox.bottomLeftY)+" "+J(d.cropBox.topRightX)+" "+J(d.cropBox.topRightY)+"]"),d.bleedBox!==null&&q("/BleedBox ["+J(d.bleedBox.bottomLeftX)+" "+J(d.bleedBox.bottomLeftY)+" "+J(d.bleedBox.topRightX)+" "+J(d.bleedBox.topRightY)+"]"),d.trimBox!==null&&q("/TrimBox ["+J(d.trimBox.bottomLeftX)+" "+J(d.trimBox.bottomLeftY)+" "+J(d.trimBox.topRightX)+" "+J(d.trimBox.topRightY)+"]"),d.artBox!==null&&q("/ArtBox ["+J(d.artBox.bottomLeftX)+" "+J(d.artBox.bottomLeftY)+" "+J(d.artBox.topRightX)+" "+J(d.artBox.topRightY)+"]"),typeof d.userUnit=="number"&&d.userUnit!==1&&q("/UserUnit "+d.userUnit),me.publish("putPage",{objId:H,pageContext:Zt[S],pageNumber:S,page:j}),q("/Contents "+rt+" 0 R"),q(">>"),q("endobj");var vt=j.join(`
`);return I===k.ADVANCED&&(vt+=`
Q`),zr(rt,!0),Zr({data:vt,filters:In(),objectId:rt}),q("endobj"),H},os=g.__private__.putPages=function(){var d,S,j=[];for(d=1;d<=je;d++)Zt[d].objId=Je(),Zt[d].contentsObjId=Je();for(d=1;d<=je;d++)j.push(Bn({number:d,data:Lt[d],objId:Zt[d].objId,contentsObjId:Zt[d].contentsObjId,mediaBox:Zt[d].mediaBox,cropBox:Zt[d].cropBox,bleedBox:Zt[d].bleedBox,trimBox:Zt[d].trimBox,artBox:Zt[d].artBox,userUnit:Zt[d].userUnit,rootDictionaryObjId:ri,resourceDictionaryObjId:gn}));zr(ri,!0),q("<</Type /Pages");var H="/Kids [";for(S=0;S<je;S++)H+=j[S]+" 0 R ";q(H+"]"),q("/Count "+je),q(">>"),q("endobj"),me.publish("postPutPages")},eo=function(d){me.publish("putFont",{font:d,out:q,newObject:rr,putStream:Zr}),d.isAlreadyPutted!==!0&&(d.objectNumber=rr(),q("<<"),q("/Type /Font"),q("/BaseFont /"+Qo(d.postScriptName)),q("/Subtype /Type1"),typeof d.encoding=="string"&&q("/Encoding /"+d.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},ro=function(){for(var d in Ae)Ae.hasOwnProperty(d)&&(p===!1||p===!0&&v.hasOwnProperty(d))&&eo(Ae[d])},no=function(d){d.objectNumber=rr();var S=[];S.push({key:"Type",value:"/XObject"}),S.push({key:"Subtype",value:"/Form"}),S.push({key:"BBox",value:"["+[J(d.x),J(d.y),J(d.x+d.width),J(d.y+d.height)].join(" ")+"]"}),S.push({key:"Matrix",value:"["+d.matrix.toString()+"]"});var j=d.pages[1].join(`
`);Zr({data:j,additionalKeyValues:S,objectId:d.objectNumber}),q("endobj")},io=function(){for(var d in lr)lr.hasOwnProperty(d)&&no(lr[d])},yh=function(d,S){var j,H=[],rt=1/(S-1);for(j=0;j<1;j+=rt)H.push(j);if(H.push(1),d[0].offset!=0){var vt={offset:0,color:d[0].color};d.unshift(vt)}if(d[d.length-1].offset!=1){var St={offset:1,color:d[d.length-1].color};d.push(St)}for(var jt="",Ut=0,ee=0;ee<H.length;ee++){for(j=H[ee];j>d[Ut+1].offset;)Ut++;var $t=d[Ut].offset,he=(j-$t)/(d[Ut+1].offset-$t),Ee=d[Ut].color,Ie=d[Ut+1].color;jt+=V(Math.round((1-he)*Ee[0]+he*Ie[0]).toString(16))+V(Math.round((1-he)*Ee[1]+he*Ie[1]).toString(16))+V(Math.round((1-he)*Ee[2]+he*Ie[2]).toString(16))}return jt.trim()},kl=function(d,S){S||(S=21);var j=rr(),H=yh(d.colors,S),rt=[];rt.push({key:"FunctionType",value:"0"}),rt.push({key:"Domain",value:"[0.0 1.0]"}),rt.push({key:"Size",value:"["+S+"]"}),rt.push({key:"BitsPerSample",value:"8"}),rt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zr({data:H,additionalKeyValues:rt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:j}),q("endobj"),d.objectNumber=rr(),q("<< /ShadingType "+d.type),q("/ColorSpace /DeviceRGB");var vt="/Coords ["+J(parseFloat(d.coords[0]))+" "+J(parseFloat(d.coords[1]))+" ";d.type===2?vt+=J(parseFloat(d.coords[2]))+" "+J(parseFloat(d.coords[3])):vt+=J(parseFloat(d.coords[2]))+" "+J(parseFloat(d.coords[3]))+" "+J(parseFloat(d.coords[4]))+" "+J(parseFloat(d.coords[5])),q(vt+="]"),d.matrix&&q("/Matrix ["+d.matrix.toString()+"]"),q("/Function "+j+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},Ol=function(d,S){var j=Je(),H=rr();S.push({resourcesOid:j,objectOid:H}),d.objectNumber=H;var rt=[];rt.push({key:"Type",value:"/Pattern"}),rt.push({key:"PatternType",value:"1"}),rt.push({key:"PaintType",value:"1"}),rt.push({key:"TilingType",value:"1"}),rt.push({key:"BBox",value:"["+d.boundingBox.map(J).join(" ")+"]"}),rt.push({key:"XStep",value:J(d.xStep)}),rt.push({key:"YStep",value:J(d.yStep)}),rt.push({key:"Resources",value:j+" 0 R"}),d.matrix&&rt.push({key:"Matrix",value:"["+d.matrix.toString()+"]"}),Zr({data:d.stream,additionalKeyValues:rt,objectId:d.objectNumber}),q("endobj")},so=function(d){var S;for(S in pe)pe.hasOwnProperty(S)&&(pe[S]instanceof Ys?kl(pe[S]):pe[S]instanceof ta&&Ol(pe[S],d))},bh=function(d){for(var S in d.objectNumber=rr(),q("<<"),d)switch(S){case"opacity":q("/ca "+dt(d[S]));break;case"stroke-opacity":q("/CA "+dt(d[S]))}q(">>"),q("endobj")},Nl=function(){var d;for(d in Fe)Fe.hasOwnProperty(d)&&bh(Fe[d])},la=function(){for(var d in q("/XObject <<"),lr)lr.hasOwnProperty(d)&&lr[d].objectNumber>=0&&q("/"+d+" "+lr[d].objectNumber+" 0 R");me.publish("putXobjectDict"),q(">>")},Ml=function(){gr.oid=rr(),q("<<"),q("/Filter /Standard"),q("/V "+gr.v),q("/R "+gr.r),q("/U <"+gr.toHexString(gr.U)+">"),q("/O <"+gr.toHexString(gr.O)+">"),q("/P "+gr.P),q(">>"),q("endobj")},wh=function(){for(var d in q("/Font <<"),Ae)Ae.hasOwnProperty(d)&&(p===!1||p===!0&&v.hasOwnProperty(d))&&q("/"+d+" "+Ae[d].objectNumber+" 0 R");q(">>")},Dl=function(){if(Object.keys(pe).length>0){for(var d in q("/Shading <<"),pe)pe.hasOwnProperty(d)&&pe[d]instanceof Ys&&pe[d].objectNumber>=0&&q("/"+d+" "+pe[d].objectNumber+" 0 R");me.publish("putShadingPatternDict"),q(">>")}},oo=function(d){if(Object.keys(pe).length>0){for(var S in q("/Pattern <<"),pe)pe.hasOwnProperty(S)&&pe[S]instanceof g.TilingPattern&&pe[S].objectNumber>=0&&pe[S].objectNumber<d&&q("/"+S+" "+pe[S].objectNumber+" 0 R");me.publish("putTilingPatternDict"),q(">>")}},El=function(){if(Object.keys(Fe).length>0){var d;for(d in q("/ExtGState <<"),Fe)Fe.hasOwnProperty(d)&&Fe[d].objectNumber>=0&&q("/"+d+" "+Fe[d].objectNumber+" 0 R");me.publish("putGStateDict"),q(">>")}},We=function(d){zr(d.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),wh(),Dl(),oo(d.objectOid),El(),la(),q(">>"),q("endobj")},xh=function(){var d=[];ro(),Nl(),io(),so(d),me.publish("putResources"),d.forEach(We),We({resourcesOid:gn,objectOid:Number.MAX_SAFE_INTEGER}),me.publish("postPutResources")},_h=function(){me.publish("putAdditionalObjects");for(var d=0;d<Ct.length;d++){var S=Ct[d];zr(S.objId,!0),q(S.content),q("endobj")}me.publish("postPutAdditionalObjects")},Sh=function(d){Me[d.fontName]=Me[d.fontName]||{},Me[d.fontName][d.fontStyle]=d.id},ua=function(d,S,j,H,rt){var vt={id:"F"+(Object.keys(Ae).length+1).toString(10),postScriptName:d,fontName:S,fontStyle:j,encoding:H,isStandardFont:rt||!1,metadata:{}};return me.publish("addFont",{font:vt,instance:this}),Ae[vt.id]=vt,Sh(vt),vt.id},Fl=function(d){for(var S=0,j=At.length;S<j;S++){var H=ua.call(this,d[S][0],d[S][1],d[S][2],At[S][3],!0);p===!1&&(v[H]=!0);var rt=d[S][0].split("-");Sh({id:H,fontName:rt[0],fontStyle:rt[1]||""})}me.publish("addFonts",{fonts:Ae,dictionary:Me})},vn=function(d){return d.foo=function(){try{return d.apply(this,arguments)}catch(H){var S=H.stack||"";~S.indexOf(" at ")&&(S=S.split(" at ")[1]);var j="Error in function "+S.split(`
`)[0].split("<")[0]+": "+H.message;if(!Yt.console)throw new Error(j);Yt.console.error(j,H),Yt.alert&&alert(j)}},d.foo.bar=d,d.foo},ao=function(d,S){var j,H,rt,vt,St,jt,Ut,ee,$t;if(rt=(S=S||{}).sourceEncoding||"Unicode",St=S.outputEncoding,(S.autoencode||St)&&Ae[oe].metadata&&Ae[oe].metadata[rt]&&Ae[oe].metadata[rt].encoding&&(vt=Ae[oe].metadata[rt].encoding,!St&&Ae[oe].encoding&&(St=Ae[oe].encoding),!St&&vt.codePages&&(St=vt.codePages[0]),typeof St=="string"&&(St=vt[St]),St)){for(Ut=!1,jt=[],j=0,H=d.length;j<H;j++)(ee=St[d.charCodeAt(j)])?jt.push(String.fromCharCode(ee)):jt.push(d[j]),jt[j].charCodeAt(0)>>8&&(Ut=!0);d=jt.join("")}for(j=d.length;Ut===void 0&&j!==0;)d.charCodeAt(j-1)>>8&&(Ut=!0),j--;if(!Ut)return d;for(jt=S.noBOM?[]:[254,255],j=0,H=d.length;j<H;j++){if(($t=(ee=d.charCodeAt(j))>>8)>>8)throw new Error("Character at position "+j+" of string '"+d+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jt.push($t),jt.push(ee-($t<<8))}return String.fromCharCode.apply(void 0,jt)},Nr=g.__private__.pdfEscape=g.pdfEscape=function(d,S){return ao(d,S).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fa=g.__private__.beginPage=function(d){Lt[++je]=[],Zt[je]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(d[0]),topRightY:Number(d[1])}},Ah(je),yt(Lt[E])},Ch=function(d,S){var j,H,rt;switch(e=S||e,typeof d=="string"&&(j=x(d.toLowerCase()),Array.isArray(j)&&(H=j[0],rt=j[1])),Array.isArray(d)&&(H=d[0]*Ft,rt=d[1]*Ft),isNaN(H)&&(H=n[0],rt=n[1]),(H>14400||rt>14400)&&(Pe.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),H=Math.min(14400,H),rt=Math.min(14400,rt)),n=[H,rt],e.substr(0,1)){case"l":rt>H&&(n=[rt,H]);break;case"p":H>rt&&(n=[rt,H])}fa(n),Nh(ma),q(yn),ya!==0&&q(ya+" J"),ba!==0&&q(ba+" j"),me.publish("addPage",{pageNumber:je})},jl=function(d){d>0&&d<=je&&(Lt.splice(d,1),Zt.splice(d,1),je--,E>je&&(E=je),this.setPage(E))},Ah=function(d){d>0&&d<=je&&(E=d)},Il=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Lt.length-1},Lh=function(d,S,j){var H,rt=void 0;return j=j||{},d=d!==void 0?d:Ae[oe].fontName,S=S!==void 0?S:Ae[oe].fontStyle,H=d.toLowerCase(),Me[H]!==void 0&&Me[H][S]!==void 0?rt=Me[H][S]:Me[d]!==void 0&&Me[d][S]!==void 0?rt=Me[d][S]:j.disableWarning===!1&&Pe.warn("Unable to look up font label for font '"+d+"', '"+S+"'. Refer to getFontList() for available fonts."),rt||j.noFallback||(rt=Me.times[S])==null&&(rt=Me.times.normal),rt},Bl=g.__private__.putInfo=function(){var d=rr(),S=function(H){return H};for(var j in f!==null&&(S=gr.encryptor(d,0)),q("<<"),q("/Producer ("+Nr(S("jsPDF "+Gt.version))+")"),Xt)Xt.hasOwnProperty(j)&&Xt[j]&&q("/"+j.substr(0,1).toUpperCase()+j.substr(1)+" ("+Nr(S(Xt[j]))+")");q("/CreationDate ("+Nr(S(ht))+")"),q(">>"),q("endobj")},da=g.__private__.putCatalog=function(d){var S=(d=d||{}).rootDictionaryObjId||ri;switch(rr(),q("<<"),q("/Type /Catalog"),q("/Pages "+S+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var j=""+Et;j.substr(j.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&q("/OpenAction [3 0 R /XYZ null null "+dt(Et)+"]")}switch(se||(se="continuous"),se){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}Jt&&q("/PageMode /"+Jt),me.publish("putCatalog"),q(">>"),q("endobj")},Rl=g.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+($+1)),q("/Root "+$+" 0 R"),q("/Info "+($-1)+" 0 R"),f!==null&&q("/Encrypt "+gr.oid+" 0 R"),q("/ID [ <"+it+"> <"+it+"> ]"),q(">>")},ql=g.__private__.putHeader=function(){q("%PDF-"+b),q("%\xBA\xDF\xAC\xE0")},zl=g.__private__.putXRef=function(){var d="0000000000";q("xref"),q("0 "+($+1)),q("0000000000 65535 f ");for(var S=1;S<=$;S++)typeof at[S]=="function"?q((d+at[S]()).slice(-10)+" 00000 n "):at[S]!==void 0?q((d+at[S]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},ni=g.__private__.buildDocument=function(){Ht(),yt(lt),me.publish("buildDocument"),ql(),os(),_h(),xh(),f!==null&&Ml(),Bl(),da();var d=ct;return zl(),Rl(),q("startxref"),q(""+d),q("%%EOF"),yt(Lt[E]),lt.join(`
`)},ho=g.__private__.getBlob=function(d){return new Blob([qt(d)],{type:"application/pdf"})},co=g.output=g.__private__.output=vn(function(d,S){switch(typeof(S=S||{})=="string"?S={filename:S}:S.filename=S.filename||"generated.pdf",d){case void 0:return ni();case"save":g.save(S.filename);break;case"arraybuffer":return qt(ni());case"blob":return ho(ni());case"bloburi":case"bloburl":if(Yt.URL!==void 0&&typeof Yt.URL.createObjectURL=="function")return Yt.URL&&Yt.URL.createObjectURL(ho(ni()))||void 0;Pe.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var j="",H=ni();try{j=Yf(H)}catch{j=Yf(unescape(encodeURIComponent(H)))}return"data:application/pdf;filename="+S.filename+";base64,"+j;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Yt)==="[object Window]"){var rt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",vt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';S.pdfObjectUrl&&(rt=S.pdfObjectUrl,vt="");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+rt+'"'+vt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(S)+");<\/script></body></html>",jt=Yt.open();return jt!==null&&jt.document.write(St),jt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Yt)==="[object Window]"){var Ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(S.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+S.filename+'" width="500px" height="400px" /></body></html>',ee=Yt.open();if(ee!==null){ee.document.write(Ut);var $t=this;ee.document.documentElement.querySelector("#pdfViewer").onload=function(){ee.document.title=S.filename,ee.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open($t.output("bloburl"))}}return ee}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var he='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",S)+'"></iframe></body></html>',Ee=Yt.open();if(Ee!==null&&(Ee.document.write(he),Ee.document.title=S.filename),Ee||typeof safari>"u")return Ee;break;case"datauri":case"dataurl":return Yt.document.location.href=this.output("datauristring",S);default:return null}}),Th=function(d){return Array.isArray(ss)===!0&&ss.indexOf(d)>-1};switch(r){case"pt":Ft=1;break;case"mm":Ft=72/25.4;break;case"cm":Ft=72/2.54;break;case"in":Ft=72;break;case"px":Ft=Th("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ft=12;break;case"ex":Ft=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Ft=r}var gr=null;kt(),Q();var Ul=function(d){return f!==null?gr.encryptor(d,0):function(S){return S}},Ph=g.__private__.getPageInfo=g.getPageInfo=function(d){if(isNaN(d)||d%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Zt[d].objId,pageNumber:d,pageContext:Zt[d]}},Kt=g.__private__.getPageInfoByObjId=function(d){if(isNaN(d)||d%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var S in Zt)if(Zt[S].objId===d)break;return Ph(S)},Wl=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Zt[E].objId,pageNumber:E,pageContext:Zt[E]}};g.addPage=function(){return Ch.apply(this,arguments),this},g.setPage=function(){return Ah.apply(this,arguments),yt.call(this,Lt[E]),this},g.insertPage=function(d){return this.addPage(),this.movePage(E,d),this},g.movePage=function(d,S){var j,H;if(d>S){j=Lt[d],H=Zt[d];for(var rt=d;rt>S;rt--)Lt[rt]=Lt[rt-1],Zt[rt]=Zt[rt-1];Lt[S]=j,Zt[S]=H,this.setPage(S)}else if(d<S){j=Lt[d],H=Zt[d];for(var vt=d;vt<S;vt++)Lt[vt]=Lt[vt+1],Zt[vt]=Zt[vt+1];Lt[S]=j,Zt[S]=H,this.setPage(S)}return this},g.deletePage=function(){return jl.apply(this,arguments),this},g.__private__.text=g.text=function(d,S,j,H,rt){var vt,St,jt,Ut,ee,$t,he,Ee,Ie,Ze=(H=H||{}).scope||this;if(typeof d=="number"&&typeof S=="number"&&(typeof j=="string"||Array.isArray(j))){var pr=j;j=S,S=d,d=pr}if(arguments[3]instanceof Vt?(F("The transform parameter of text() with a Matrix value"),Ie=rt):(jt=arguments[4],Ut=arguments[5],Ce(he=arguments[3])==="object"&&he!==null||(typeof jt=="string"&&(Ut=jt,jt=null),typeof he=="string"&&(Ut=he,he=null),typeof he=="number"&&(jt=he,he=null),H={flags:he,angle:jt,align:Ut})),isNaN(S)||isNaN(j)||d==null)throw new Error("Invalid arguments passed to jsPDF.text");if(d.length===0)return Ze;var sr="",bn=!1,Ur=typeof H.lineHeightFactor=="number"?H.lineHeightFactor:hs,zn=Ze.internal.scaleFactor;function Ih(ke){return ke=ke.split("	").join(Array(H.TabLen||9).join(" ")),Nr(ke,he)}function Ca(ke){for(var Oe,He=ke.concat(),nr=[],hi=He.length;hi--;)typeof(Oe=He.shift())=="string"?nr.push(Oe):Array.isArray(ke)&&(Oe.length===1||Oe[1]===void 0&&Oe[2]===void 0)?nr.push(Oe[0]):nr.push([Oe[0],Oe[1],Oe[2]]);return nr}function Aa(ke,Oe){var He;if(typeof ke=="string")He=Oe(ke)[0];else if(Array.isArray(ke)){for(var nr,hi,Da=ke.concat(),Ao=[],Uh=Da.length;Uh--;)typeof(nr=Da.shift())=="string"?Ao.push(Oe(nr)[0]):Array.isArray(nr)&&typeof nr[0]=="string"&&(hi=Oe(nr[0],nr[1],nr[2]),Ao.push([hi[0],hi[1],hi[2]]));He=Ao}return He}var mo=!1,La=!0;if(typeof d=="string")mo=!0;else if(Array.isArray(d)){var Ta=d.concat();St=[];for(var vo,ur=Ta.length;ur--;)(typeof(vo=Ta.shift())!="string"||Array.isArray(vo)&&typeof vo[0]!="string")&&(La=!1);mo=La}if(mo===!1)throw new Error('Type of text must be string or Array. "'+d+'" is not recognized.');typeof d=="string"&&(d=d.match(/[\r?\n]/)?d.split(/\r\n|\r|\n/g):[d]);var yo=Tt/Ze.internal.scaleFactor,bo=yo*(Ur-1);switch(H.baseline){case"bottom":j-=bo;break;case"top":j+=yo-bo;break;case"hanging":j+=yo-2*bo;break;case"middle":j+=yo/2-bo}if(($t=H.maxWidth||0)>0&&(typeof d=="string"?d=Ze.splitTextToSize(d,$t):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(ke,Oe){return ke.concat(Ze.splitTextToSize(Oe,$t))},[]))),vt={text:d,x:S,y:j,options:H,mutex:{pdfEscape:Nr,activeFontKey:oe,fonts:Ae,activeFontSize:Tt}},me.publish("preProcessText",vt),d=vt.text,jt=(H=vt.options).angle,!(Ie instanceof Vt)&&jt&&typeof jt=="number"){jt*=Math.PI/180,H.rotationDirection===0&&(jt=-jt),I===k.ADVANCED&&(jt=-jt);var wo=Math.cos(jt),Pa=Math.sin(jt);Ie=new Vt(wo,Pa,-Pa,wo,0,0)}else jt&&jt instanceof Vt&&(Ie=jt);I!==k.ADVANCED||Ie||(Ie=jn),(ee=H.charSpace||fo)!==void 0&&(sr+=J(M(ee))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ee=H.horizontalScale)!==void 0&&(sr+=J(100*Ee)+` Tz
`),H.lang;var Mr=-1,Ql=H.renderingMode!==void 0?H.renderingMode:H.stroke,ka=Ze.internal.getCurrentPageInfo().pageContext;switch(Ql){case 0:case!1:case"fill":Mr=0;break;case 1:case!0:case"stroke":Mr=1;break;case 2:case"fillThenStroke":Mr=2;break;case 3:case"invisible":Mr=3;break;case 4:case"fillAndAddForClipping":Mr=4;break;case 5:case"strokeAndAddPathForClipping":Mr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mr=6;break;case 7:case"addToPathForClipping":Mr=7}var Bh=ka.usedRenderingMode!==void 0?ka.usedRenderingMode:-1;Mr!==-1?sr+=Mr+` Tr
`:Bh!==-1&&(sr+=`0 Tr
`),Mr!==-1&&(ka.usedRenderingMode=Mr),Ut=H.align||"left";var $r,xo=Tt*Ur,Rh=Ze.internal.pageSize.getWidth(),qh=Ae[oe];ee=H.charSpace||fo,$t=H.maxWidth||0,he=Object.assign({autoencode:!0,noBOM:!0},H.flags);var Li=[],us=function(ke){return Ze.getStringUnitWidth(ke,{font:qh,charSpace:ee,fontSize:Tt,doKerning:!1})*Tt/zn};if(Object.prototype.toString.call(d)==="[object Array]"){var Dr;St=Ca(d),Ut!=="left"&&($r=St.map(us));var Sr,Ti=0;if(Ut==="right"){S-=$r[0],d=[],ur=St.length;for(var si=0;si<ur;si++)si===0?(Sr=qn(S),Dr=ii(j)):(Sr=M(Ti-$r[si]),Dr=-xo),d.push([St[si],Sr,Dr]),Ti=$r[si]}else if(Ut==="center"){S-=$r[0]/2,d=[],ur=St.length;for(var oi=0;oi<ur;oi++)oi===0?(Sr=qn(S),Dr=ii(j)):(Sr=M((Ti-$r[oi])/2),Dr=-xo),d.push([St[oi],Sr,Dr]),Ti=$r[oi]}else if(Ut==="left"){d=[],ur=St.length;for(var _o=0;_o<ur;_o++)d.push(St[_o])}else if(Ut==="justify"&&qh.encoding==="Identity-H"){d=[],ur=St.length,$t=$t!==0?$t:Rh;for(var ai=0,Ve=0;Ve<ur;Ve++)if(Dr=Ve===0?ii(j):-xo,Sr=Ve===0?qn(S):ai,Ve<ur-1){var Oa=M(($t-$r[Ve])/(St[Ve].split(" ").length-1)),Cr=St[Ve].split(" ");d.push([Cr[0]+" ",Sr,Dr]),ai=0;for(var Qr=1;Qr<Cr.length;Qr++){var So=(us(Cr[Qr-1]+" "+Cr[Qr])-us(Cr[Qr]))*zn+Oa;Qr==Cr.length-1?d.push([Cr[Qr],So,0]):d.push([Cr[Qr]+" ",So,0]),ai-=So}}else d.push([St[Ve],Sr,Dr]);d.push(["",ai,0])}else{if(Ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(d=[],ur=St.length,$t=$t!==0?$t:Rh,Ve=0;Ve<ur;Ve++)Dr=Ve===0?ii(j):-xo,Sr=Ve===0?qn(S):0,Ve<ur-1?Li.push(J(M(($t-$r[Ve])/(St[Ve].split(" ").length-1)))):Li.push(0),d.push([St[Ve],Sr,Dr])}}var zh=typeof H.R2L=="boolean"?H.R2L:zt;zh===!0&&(d=Aa(d,function(ke,Oe,He){return[ke.split("").reverse().join(""),Oe,He]})),vt={text:d,x:S,y:j,options:H,mutex:{pdfEscape:Nr,activeFontKey:oe,fonts:Ae,activeFontSize:Tt}},me.publish("postProcessText",vt),d=vt.text,bn=vt.mutex.isHex||!1;var Na=Ae[oe].encoding;Na!=="WinAnsiEncoding"&&Na!=="StandardEncoding"||(d=Aa(d,function(ke,Oe,He){return[Ih(ke),Oe,He]})),St=Ca(d),d=[];for(var fs,ds,Pi,gs=0,Co=1,ps=Array.isArray(St[0])?Co:gs,ki="",Ma=function(ke,Oe,He){var nr="";return He instanceof Vt?(He=typeof H.angle=="number"?dn(He,new Vt(1,0,0,1,ke,Oe)):dn(new Vt(1,0,0,1,ke,Oe),He),I===k.ADVANCED&&(He=dn(new Vt(1,0,0,-1,0,0),He)),nr=He.join(" ")+` Tm
`):nr=J(ke)+" "+J(Oe)+` Td
`,nr},tn=0;tn<St.length;tn++){switch(ki="",ps){case Co:Pi=(bn?"<":"(")+St[tn][0]+(bn?">":")"),fs=parseFloat(St[tn][1]),ds=parseFloat(St[tn][2]);break;case gs:Pi=(bn?"<":"(")+St[tn]+(bn?">":")"),fs=qn(S),ds=ii(j)}Li!==void 0&&Li[tn]!==void 0&&(ki=Li[tn]+` Tw
`),tn===0?d.push(ki+Ma(fs,ds,Ie)+Pi):ps===gs?d.push(ki+Pi):ps===Co&&d.push(ki+Ma(fs,ds,Ie)+Pi)}d=ps===gs?d.join(` Tj
T* `):d.join(` Tj
`),d+=` Tj
`;var en=`BT
/`;return en+=oe+" "+Tt+` Tf
`,en+=J(Tt*Ur)+` TL
`,en+=cs+`
`,en+=sr,en+=d,q(en+="ET"),v[oe]=!0,Ze};var Vl=g.__private__.clip=g.clip=function(d){return q(d==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Vl("evenodd")},g.__private__.discardPath=g.discardPath=function(){return q("n"),this};var Rn=g.__private__.isValidStyle=function(d){var S=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(d)!==-1&&(S=!0),S};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(d){return Rn(d)&&(l=d),this};var kh=g.__private__.getStyle=g.getStyle=function(d){var S=l;switch(d){case"D":case"S":S="S";break;case"F":S="f";break;case"FD":case"DF":S="B";break;case"f":case"f*":case"B":case"B*":S=d}return S},Oh=g.close=function(){return q("h"),this};g.stroke=function(){return q("S"),this},g.fill=function(d){return lo("f",d),this},g.fillEvenOdd=function(d){return lo("f*",d),this},g.fillStroke=function(d){return lo("B",d),this},g.fillStrokeEvenOdd=function(d){return lo("B*",d),this};var lo=function(d,S){Ce(S)==="object"?Gl(S,d):q(d)},ga=function(d){d===null||I===k.ADVANCED&&d===void 0||(d=kh(d),q(d))};function Hl(d,S,j,H,rt){var vt=new ta(S||this.boundingBox,j||this.xStep,H||this.yStep,this.gState,rt||this.matrix);vt.stream=this.stream;var St=d+"$$"+this.cloneIndex+++"$$";return Or(St,vt),vt}var Gl=function(d,S){var j=is[d.key],H=pe[j];if(H instanceof Ys)q("q"),q(Yl(S)),H.gState&&g.setGState(H.gState),q(d.matrix.toString()+" cm"),q("/"+j+" sh"),q("Q");else if(H instanceof ta){var rt=new Vt(1,0,0,-1,0,Ai());d.matrix&&(rt=rt.multiply(d.matrix||jn),j=Hl.call(H,d.key,d.boundingBox,d.xStep,d.yStep,rt).id),q("q"),q("/Pattern cs"),q("/"+j+" scn"),H.gState&&g.setGState(H.gState),q(S),q("Q")}},Yl=function(d){switch(d){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},pa=g.moveTo=function(d,S){return q(J(M(d))+" "+J(R(S))+" m"),this},as=g.lineTo=function(d,S){return q(J(M(d))+" "+J(R(S))+" l"),this},Si=g.curveTo=function(d,S,j,H,rt,vt){return q([J(M(d)),J(R(S)),J(M(j)),J(R(H)),J(M(rt)),J(R(vt)),"c"].join(" ")),this};g.__private__.line=g.line=function(d,S,j,H,rt){if(isNaN(d)||isNaN(S)||isNaN(j)||isNaN(H)||!Rn(rt))throw new Error("Invalid arguments passed to jsPDF.line");return I===k.COMPAT?this.lines([[j-d,H-S]],d,S,[1,1],rt||"S"):this.lines([[j-d,H-S]],d,S,[1,1]).stroke()},g.__private__.lines=g.lines=function(d,S,j,H,rt,vt){var St,jt,Ut,ee,$t,he,Ee,Ie,Ze,pr,sr,bn;if(typeof d=="number"&&(bn=j,j=S,S=d,d=bn),H=H||[1,1],vt=vt||!1,isNaN(S)||isNaN(j)||!Array.isArray(d)||!Array.isArray(H)||!Rn(rt)||typeof vt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(pa(S,j),St=H[0],jt=H[1],ee=d.length,pr=S,sr=j,Ut=0;Ut<ee;Ut++)($t=d[Ut]).length===2?(pr=$t[0]*St+pr,sr=$t[1]*jt+sr,as(pr,sr)):(he=$t[0]*St+pr,Ee=$t[1]*jt+sr,Ie=$t[2]*St+pr,Ze=$t[3]*jt+sr,pr=$t[4]*St+pr,sr=$t[5]*jt+sr,Si(he,Ee,Ie,Ze,pr,sr));return vt&&Oh(),ga(rt),this},g.path=function(d){for(var S=0;S<d.length;S++){var j=d[S],H=j.c;switch(j.op){case"m":pa(H[0],H[1]);break;case"l":as(H[0],H[1]);break;case"c":Si.apply(this,H);break;case"h":Oh()}}return this},g.__private__.rect=g.rect=function(d,S,j,H,rt){if(isNaN(d)||isNaN(S)||isNaN(j)||isNaN(H)||!Rn(rt))throw new Error("Invalid arguments passed to jsPDF.rect");return I===k.COMPAT&&(H=-H),q([J(M(d)),J(R(S)),J(M(j)),J(M(H)),"re"].join(" ")),ga(rt),this},g.__private__.triangle=g.triangle=function(d,S,j,H,rt,vt,St){if(isNaN(d)||isNaN(S)||isNaN(j)||isNaN(H)||isNaN(rt)||isNaN(vt)||!Rn(St))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[j-d,H-S],[rt-j,vt-H],[d-rt,S-vt]],d,S,[1,1],St,!0),this},g.__private__.roundedRect=g.roundedRect=function(d,S,j,H,rt,vt,St){if(isNaN(d)||isNaN(S)||isNaN(j)||isNaN(H)||isNaN(rt)||isNaN(vt)||!Rn(St))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var jt=4/3*(Math.SQRT2-1);return rt=Math.min(rt,.5*j),vt=Math.min(vt,.5*H),this.lines([[j-2*rt,0],[rt*jt,0,rt,vt-vt*jt,rt,vt],[0,H-2*vt],[0,vt*jt,-rt*jt,vt,-rt,vt],[2*rt-j,0],[-rt*jt,0,-rt,-vt*jt,-rt,-vt],[0,2*vt-H],[0,-vt*jt,rt*jt,-vt,rt,-vt]],d+rt,S,[1,1],St,!0),this},g.__private__.ellipse=g.ellipse=function(d,S,j,H,rt){if(isNaN(d)||isNaN(S)||isNaN(j)||isNaN(H)||!Rn(rt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var vt=4/3*(Math.SQRT2-1)*j,St=4/3*(Math.SQRT2-1)*H;return pa(d+j,S),Si(d+j,S-St,d+vt,S-H,d,S-H),Si(d-vt,S-H,d-j,S-St,d-j,S),Si(d-j,S+St,d-vt,S+H,d,S+H),Si(d+vt,S+H,d+j,S+St,d+j,S),ga(rt),this},g.__private__.circle=g.circle=function(d,S,j,H){if(isNaN(d)||isNaN(S)||isNaN(j)||!Rn(H))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(d,S,j,j,H)},g.setFont=function(d,S,j){return j&&(S=nt(S,j)),oe=Lh(d,S,{disableWarning:!1}),this};var Xl=g.__private__.getFont=g.getFont=function(){return Ae[Lh.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var d,S,j={};for(d in Me)if(Me.hasOwnProperty(d))for(S in j[d]=[],Me[d])Me[d].hasOwnProperty(S)&&j[d].push(S);return j},g.addFont=function(d,S,j,H,rt){var vt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&vt.indexOf(arguments[3])!==-1?rt=arguments[3]:arguments[3]&&vt.indexOf(arguments[3])==-1&&(j=nt(j,H)),rt=rt||"Identity-H",ua.call(this,d,S,j,rt)};var hs,ma=s.lineWidth||.200025,uo=g.__private__.getLineWidth=g.getLineWidth=function(){return ma},Nh=g.__private__.setLineWidth=g.setLineWidth=function(d){return ma=d,q(J(M(d))+" w"),this};g.__private__.setLineDash=Gt.API.setLineDash=Gt.API.setLineDashPattern=function(d,S){if(d=d||[],S=S||0,isNaN(S)||!Array.isArray(d))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return d=d.map(function(j){return J(M(j))}).join(" "),S=J(M(S)),q("["+d+"] "+S+" d"),this};var Mh=g.__private__.getLineHeight=g.getLineHeight=function(){return Tt*hs};g.__private__.getLineHeight=g.getLineHeight=function(){return Tt*hs};var Dh=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(d){return typeof(d=d||1.15)=="number"&&(hs=d),this},Eh=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return hs};Dh(s.lineHeight);var qn=g.__private__.getHorizontalCoordinate=function(d){return M(d)},ii=g.__private__.getVerticalCoordinate=function(d){return I===k.ADVANCED?d:Zt[E].mediaBox.topRightY-Zt[E].mediaBox.bottomLeftY-M(d)},Kl=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(d){return J(qn(d))},Ci=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(d){return J(ii(d))},yn=s.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return pn(yn)},g.__private__.setStrokeColor=g.setDrawColor=function(d,S,j,H){return yn=mn({ch1:d,ch2:S,ch3:j,ch4:H,pdfColorType:"draw",precision:2}),q(yn),this};var va=s.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return pn(va)},g.__private__.setFillColor=g.setFillColor=function(d,S,j,H){return va=mn({ch1:d,ch2:S,ch3:j,ch4:H,pdfColorType:"fill",precision:2}),q(va),this};var cs=s.textColor||"0 g",Jl=g.__private__.getTextColor=g.getTextColor=function(){return pn(cs)};g.__private__.setTextColor=g.setTextColor=function(d,S,j,H){return cs=mn({ch1:d,ch2:S,ch3:j,ch4:H,pdfColorType:"text",precision:3}),this};var fo=s.charSpace,Zl=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(fo||0)};g.__private__.setCharSpace=g.setCharSpace=function(d){if(isNaN(d))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return fo=d,this};var ya=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(d){var S=g.CapJoinStyles[d];if(S===void 0)throw new Error("Line cap style of '"+d+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ya=S,q(S+" J"),this};var ba=0;g.__private__.setLineJoin=g.setLineJoin=function(d){var S=g.CapJoinStyles[d];if(S===void 0)throw new Error("Line join style of '"+d+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ba=S,q(S+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(d){if(d=d||0,isNaN(d))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q(J(M(d))+" M"),this},g.GState=pl,g.setGState=function(d){(d=typeof d=="string"?Fe[fn[d]]:Fh(null,d)).equals(ei)||(q("/"+d.id+" gs"),ei=d)};var Fh=function(d,S){if(!d||!fn[d]){var j=!1;for(var H in Fe)if(Fe.hasOwnProperty(H)&&Fe[H].equals(S)){j=!0;break}if(j)S=Fe[H];else{var rt="GS"+(Object.keys(Fe).length+1).toString(10);Fe[rt]=S,S.id=rt}return d&&(fn[d]=S.id),me.publish("addGState",S),S}};g.addGState=function(d,S){return Fh(d,S),this},g.saveGraphicsState=function(){return q("q"),Dn.push({key:oe,size:Tt,color:cs}),this},g.restoreGraphicsState=function(){q("Q");var d=Dn.pop();return oe=d.key,Tt=d.size,cs=d.color,ei=null,this},g.setCurrentTransformationMatrix=function(d){return q(d.toString()+" cm"),this},g.comment=function(d){return q("#"+d),this};var go=function(d,S){var j=d||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return j},set:function(vt){isNaN(vt)||(j=parseFloat(vt))}});var H=S||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return H},set:function(vt){isNaN(vt)||(H=parseFloat(vt))}});var rt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return rt},set:function(vt){rt=vt.toString()}}),this},wa=function(d,S,j,H){go.call(this,d,S),this.type="rect";var rt=j||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return rt},set:function(St){isNaN(St)||(rt=parseFloat(St))}});var vt=H||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return vt},set:function(St){isNaN(St)||(vt=parseFloat(St))}}),this},xa=function(){this.page=je,this.currentPage=E,this.pages=Lt.slice(0),this.pagesContext=Zt.slice(0),this.x=dr,this.y=fe,this.matrix=un,this.width=ls(E),this.height=Ai(E),this.outputDestination=Ot,this.id="",this.objectNumber=-1};xa.prototype.restore=function(){je=this.page,E=this.currentPage,Zt=this.pagesContext,Lt=this.pages,dr=this.x,fe=this.y,un=this.matrix,_a(E,this.width),Sa(E,this.height),Ot=this.outputDestination};var jh=function(d,S,j,H,rt){Fn.push(new xa),je=E=0,Lt=[],dr=d,fe=S,un=rt,fa([j,H])},$l=function(d){if(En[d])Fn.pop().restore();else{var S=new xa,j="Xo"+(Object.keys(lr).length+1).toString(10);S.id=j,En[d]=j,lr[j]=S,me.publish("addFormObject",S),Fn.pop().restore()}};for(var po in g.beginFormObject=function(d,S,j,H,rt){return jh(d,S,j,H,rt),this},g.endFormObject=function(d){return $l(d),this},g.doFormObject=function(d,S){var j=lr[En[d]];return q("q"),q(S.toString()+" cm"),q("/"+j.id+" Do"),q("Q"),this},g.getFormObject=function(d){var S=lr[En[d]];return{x:S.x,y:S.y,width:S.width,height:S.height,matrix:S.matrix}},g.save=function(d,S){return d=d||"generated.pdf",(S=S||{}).returnPromise=S.returnPromise||!1,S.returnPromise===!1?(Gs(ho(ni()),d),typeof Gs.unload=="function"&&Yt.setTimeout&&setTimeout(Gs.unload,911),this):new Promise(function(j,H){try{var rt=Gs(ho(ni()),d);typeof Gs.unload=="function"&&Yt.setTimeout&&setTimeout(Gs.unload,911),j(rt)}catch(vt){H(vt.message)}})},Gt.API)Gt.API.hasOwnProperty(po)&&(po==="events"&&Gt.API.events.length?function(d,S){var j,H,rt;for(rt=S.length-1;rt!==-1;rt--)j=S[rt][0],H=S[rt][1],d.subscribe.apply(d,[j].concat(typeof H=="function"?[H]:H))}(me,Gt.API.events):g[po]=Gt.API[po]);var ls=g.getPageWidth=function(d){return(Zt[d=d||E].mediaBox.topRightX-Zt[d].mediaBox.bottomLeftX)/Ft},_a=g.setPageWidth=function(d,S){Zt[d].mediaBox.topRightX=S*Ft+Zt[d].mediaBox.bottomLeftX},Ai=g.getPageHeight=function(d){return(Zt[d=d||E].mediaBox.topRightY-Zt[d].mediaBox.bottomLeftY)/Ft},Sa=g.setPageHeight=function(d,S){Zt[d].mediaBox.topRightY=S*Ft+Zt[d].mediaBox.bottomLeftY};return g.internal={pdfEscape:Nr,getStyle:kh,getFont:Xl,getFontSize:Mt,getCharSpace:Zl,getTextColor:Jl,getLineHeight:Mh,getLineHeightFactor:Eh,getLineWidth:uo,write:te,getHorizontalCoordinate:qn,getVerticalCoordinate:ii,getCoordinateString:Kl,getVerticalCoordinateString:Ci,collections:{},newObject:rr,newAdditionalObject:to,newObjectDeferred:Je,newObjectDeferredBegin:zr,getFilters:In,putStream:Zr,events:me,scaleFactor:Ft,pageSize:{getWidth:function(){return ls(E)},setWidth:function(d){_a(E,d)},getHeight:function(){return Ai(E)},setHeight:function(d){Sa(E,d)}},encryptionOptions:f,encryption:gr,getEncryptor:Ul,output:co,getNumberOfPages:Il,pages:Lt,out:q,f2:dt,f3:N,getPageInfo:Ph,getPageInfoByObjId:Kt,getCurrentPageInfo:Wl,getPDFVersion:w,Point:go,Rectangle:wa,Matrix:Vt,hasHotfix:Th},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return ls(E)},set:function(d){_a(E,d)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return Ai(E)},set:function(d){Sa(E,d)},enumerable:!0,configurable:!0}),Fl.call(g,At),oe="F1",Ch(n,e),me.publish("initialized"),g}$o.prototype.lsbFirstWord=function(s){return String.fromCharCode(s>>0&255,s>>8&255,s>>16&255,s>>24&255)},$o.prototype.toHexString=function(s){return s.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},$o.prototype.hexToBytes=function(s){for(var t=[],e=0;e<s.length;e+=2)t.push(String.fromCharCode(parseInt(s.substr(e,2),16)));return t.join("")},$o.prototype.processOwnerPassword=function(s,t){return Kf(Xf(t).substr(0,5),s)},$o.prototype.encryptor=function(s,t){var e=Xf(this.encryptionKey+String.fromCharCode(255&s,s>>8&255,s>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return Kf(e,r)}},pl.prototype.equals=function(s){var t,e="id,objectNumber,equals";if(!s||Ce(s)!==Ce(this))return!1;var r=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!s.hasOwnProperty(t)||this[t]!==s[t])return!1;r++}for(t in s)s.hasOwnProperty(t)&&e.indexOf(t)<0&&r--;return r===0},Gt.API={events:[]},Gt.version="3.0.1";var Ue=Gt.API,Qf=1,Ks=function(s){return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Jo=function(s){return s.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qt=function(s){return s.toFixed(2)},Zi=function(s){return s.toFixed(5)};Ue.__acroform__={};var qr=function(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s},xp=function(s){return s*Qf},$n=function(s){var t=new Bp,e=Rt.internal.getHeight(s)||0,r=Rt.internal.getWidth(s)||0;return t.BBox=[0,0,Number(Qt(r)),Number(Qt(e))],t},Ym=Ue.__acroform__.setBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return s|=1<<t},Xm=Ue.__acroform__.clearBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return s&=~(1<<t)},Km=Ue.__acroform__.getBit=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(s&1<<t)==0?0:1},Ye=Ue.__acroform__.getBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Km(s,t-1)},Xe=Ue.__acroform__.setBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Ym(s,t-1)},Ke=Ue.__acroform__.clearBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Xm(s,t-1)},Jm=Ue.__acroform__.calculateCoordinates=function(s,t){var e=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,n=s[0],i=s[1],o=s[2],a=s[3],h={};return h.lowerLeft_X=e(n)||0,h.lowerLeft_Y=r(i+a)||0,h.upperRight_X=e(n+o)||0,h.upperRight_Y=r(i)||0,[Number(Qt(h.lowerLeft_X)),Number(Qt(h.lowerLeft_Y)),Number(Qt(h.upperRight_X)),Number(Qt(h.upperRight_Y))]},Zm=function(s){if(s.appearanceStreamContent)return s.appearanceStreamContent;if(s.V||s.DV){var t=[],e=s._V||s.DV,r=Jf(s,e),n=s.scope.internal.getFont(s.fontName,s.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(s.scope.__private__.encodeColorString(s.color)),t.push("/"+n+" "+Qt(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=$n(s);return i.scope=s.scope,i.stream=t.join(`
`),i}},Jf=function(s,t){var e=s.fontSize===0?s.maxFontSize:s.fontSize,r={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=s.multiline?n.map(function(N){return N.split(`
`)}):n.map(function(N){return[N]});var i=e,o=Rt.internal.getHeight(s)||0;o=o<0?-o:o;var a=Rt.internal.getWidth(s)||0;a=a<0?-a:a;var h=function(N,M,z){if(N+1<n.length){var R=M+" "+n[N+1][0];return hl(R,s,z).width<=a-4}return!1};i++;t:for(;i>0;){t="",i--;var l,f,p=hl("3",s,i).height,v=s.multiline?o-i:(o-p)/2,g=v+=2,b=0,w=0,C=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+hl(t,s,i=12).width+", FieldWidth:"+a+`
`;break}for(var x="",k=0,I=0;I<n.length;I++)if(n.hasOwnProperty(I)){var G=!1;if(n[I].length!==1&&C!==n[I].length-1){if((p+2)*(k+2)+2>o)continue t;x+=n[I][C],G=!0,w=I,I--}else{x=(x+=n[I][C]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var U=parseInt(I),nt=h(U,x,i),J=I>=n.length-1;if(nt&&!J){x+=" ",C=0;continue}if(nt||J){if(J)w=U;else if(s.multiline&&(p+2)*(k+2)+2>o)continue t}else{if(!s.multiline||(p+2)*(k+2)+2>o)continue t;w=U}}for(var F="",et=b;et<=w;et++){var dt=n[et];if(s.multiline){if(et===w){F+=dt[C]+" ",C=(C+1)%dt.length;continue}if(et===b){F+=dt[dt.length-1]+" ";continue}}F+=dt[0]+" "}switch(F=F.substr(F.length-1)==" "?F.substr(0,F.length-1):F,f=hl(F,s,i).width,s.textAlign){case"right":l=a-f-2;break;case"center":l=(a-f)/2;break;case"left":default:l=2}t+=Qt(l)+" "+Qt(g)+` Td
`,t+="("+Ks(F)+`) Tj
`,t+=-Qt(l)+` 0 Td
`,g=-(i+2),f=0,b=G?w:w+1,k++,x=""}break}return r.text=t,r.fontSize=i,r},hl=function(s,t,e){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(s,{font:r,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:n}},$m={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Qm=function(s,t){var e={type:"reference",object:s};t.internal.getPageInfo(s.page).pageContext.annotations.find(function(r){return r.type===e.type&&r.object===e.object})===void 0&&t.internal.getPageInfo(s.page).pageContext.annotations.push(e)},tv=function(s,t){for(var e in s)if(s.hasOwnProperty(e)){var r=e,n=s[e];t.internal.newObjectDeferredBegin(n.objId,!0),Ce(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete s[r]}},ev=function(s,t){if(t.scope=s,s.internal!==void 0&&(s.internal.acroformPlugin===void 0||s.internal.acroformPlugin.isInitialized===!1)){if(Nn.FieldNum=0,s.internal.acroformPlugin=JSON.parse(JSON.stringify($m)),s.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Qf=s.internal.scaleFactor,s.internal.acroformPlugin.acroFormDictionaryRoot=new Rp,s.internal.acroformPlugin.acroFormDictionaryRoot.scope=s,s.internal.acroformPlugin.acroFormDictionaryRoot._eventID=s.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(s)}),s.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in r)if(r.hasOwnProperty(n)){var i=r[n];i.objId=void 0,i.hasAnnotation&&Qm(i,e)}})(s)}),s.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(s)}),s.internal.events.subscribe("postPutPages",function(e){(function(r,n){var i=!r;for(var o in r||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var a=r[o],h=[],l=a.Rect;if(a.Rect&&(a.Rect=Jm(a.Rect,n)),n.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Rt.createDefaultAppearanceStream(a),Ce(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(h=a.getKeyValueListForStream()),a.Rect=l,a.hasAppearanceStream&&!a.appearanceStreamContent){var f=Zm(a);h.push({key:"AP",value:"<</N "+f+">>"}),n.internal.acroformPlugin.xForms.push(f)}if(a.appearanceStreamContent){var p="";for(var v in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(v)){var g=a.appearanceStreamContent[v];if(p+="/"+v+" ",p+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var b=g[o];typeof b=="function"&&(b=b.call(n,a)),p+="/"+o+" "+b+" ",n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b)}}else typeof(b=g)=="function"&&(b=b.call(n,a)),p+="/"+o+" "+b,n.internal.acroformPlugin.xForms.indexOf(b)>=0||n.internal.acroformPlugin.xForms.push(b);p+=">>"}h.push({key:"AP",value:`<<
`+p+">>"})}n.internal.putStream({additionalKeyValues:h,objectId:a.objId}),n.internal.out("endobj")}i&&tv(n.internal.acroformPlugin.xForms,n)})(e,s)}),s.internal.acroformPlugin.isInitialized=!0}},Ip=Ue.__acroform__.arrayToPdfArray=function(s,t,e){var r=function(o){return o};if(Array.isArray(s)){for(var n="[",i=0;i<s.length;i++)switch(i!==0&&(n+=" "),Ce(s[i])){case"boolean":case"number":case"object":n+=s[i].toString();break;case"string":s[i].substr(0,1)!=="/"?(t!==void 0&&e&&(r=e.internal.getEncryptor(t)),n+="("+Ks(r(s[i].toString()))+")"):n+=s[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Vf=function(s,t,e){var r=function(n){return n};return t!==void 0&&e&&(r=e.internal.getEncryptor(t)),(s=s||"").toString(),s="("+Ks(r(s))+")"},Qn=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(s){this._objId=s}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qn.prototype.toString=function(){return this.objId+" 0 R"},Qn.prototype.putStream=function(){var s=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:s,objectId:this.objId}),this.scope.internal.out("endobj")},Qn.prototype.getKeyValueListForStream=function(){var s=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var r=t[e],n=this[r];n&&(Array.isArray(n)?s.push({key:r,value:Ip(n,this.objId,this.scope)}):n instanceof Qn?(n.scope=this.scope,s.push({key:r,value:n.objId+" 0 R"})):typeof n!="function"&&s.push({key:r,value:n}))}return s};var Bp=function(){Qn.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var s,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){s=e.trim()},get:function(){return s||null}})};qr(Bp,Qn);var Rp=function(){Qn.call(this);var s,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(s){var e=function(r){return r};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Ks(e(s))+")"}},set:function(e){s=e}})};qr(Rp,Qn);var Nn=function s(){Qn.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ye(t,3)},set:function(x){x?this.F=Xe(t,3):this.F=Ke(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');e=x}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(x){r=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(x){r[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(x){r[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(x){r[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(x){r[3]=x}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof ml)return;i="FieldObject"+s.FieldNum++}var x=function(k){return k};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Ks(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(x){h=x}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/Qf:l},set:function(x){l=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof ml||this instanceof Xs))return Vf(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=x}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof cr?v:Vf(v,this.objId,this.scope)},set:function(x){x=x.toString(),v=this instanceof cr?x:x.substr(0,1)==="("?Jo(x.substr(1,x.length-2)):Jo(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof cr?Jo(v.substr(1,v.length-1)):v},set:function(x){x=x.toString(),v=this instanceof cr?"/"+x:x}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof cr?g:Vf(g,this.objId,this.scope)},set:function(x){x=x.toString(),g=this instanceof cr?x:x.substr(0,1)==="("?Jo(x.substr(1,x.length-2)):Jo(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof cr?Jo(g.substr(1,g.length-1)):g},set:function(x){x=x.toString(),g=this instanceof cr?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(x){x=!!x,w=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(x){b=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,1)},set:function(x){x?this.Ff=Xe(this.Ff,1):this.Ff=Ke(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,2)},set:function(x){x?this.Ff=Xe(this.Ff,2):this.Ff=Ke(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,3)},set:function(x){x?this.Ff=Xe(this.Ff,3):this.Ff=Ke(this.Ff,3)}});var C=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(C!==null)return C},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');C=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(C){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:C=2;break;case"center":case 1:C=1;break;case"left":case 0:default:C=0}}})};qr(Nn,Qn);var ea=function(){Nn.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var s=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){s=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Ip(t,this.objId,this.scope)},set:function(e){var r,n;n=[],typeof(r=e)=="string"&&(n=function(i,o,a){a||(a=1);for(var h,l=[];h=o.exec(i);)l.push(h[a]);return l}(r,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,18)},set:function(e){e?this.Ff=Xe(this.Ff,18):this.Ff=Ke(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=Xe(this.Ff,19):this.Ff=Ke(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,20)},set:function(e){e?(this.Ff=Xe(this.Ff,20),t.sort()):this.Ff=Ke(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,22)},set:function(e){e?this.Ff=Xe(this.Ff,22):this.Ff=Ke(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,23)},set:function(e){e?this.Ff=Xe(this.Ff,23):this.Ff=Ke(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,27)},set:function(e){e?this.Ff=Xe(this.Ff,27):this.Ff=Ke(this.Ff,27)}}),this.hasAppearanceStream=!1};qr(ea,Nn);var ra=function(){ea.call(this),this.fontName="helvetica",this.combo=!1};qr(ra,ea);var na=function(){ra.call(this),this.combo=!0};qr(na,ra);var ul=function(){na.call(this),this.edit=!0};qr(ul,na);var cr=function(){Nn.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,15)},set:function(e){e?this.Ff=Xe(this.Ff,15):this.Ff=Ke(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,16)},set:function(e){e?this.Ff=Xe(this.Ff,16):this.Ff=Ke(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,17)},set:function(e){e?this.Ff=Xe(this.Ff,17):this.Ff=Ke(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,26)},set:function(e){e?this.Ff=Xe(this.Ff,26):this.Ff=Ke(this.Ff,26)}});var s,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(i){return i};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,n=[];for(r in n.push("<<"),t)n.push("/"+r+" ("+Ks(e(t[r]))+")");return n.push(">>"),n.join(`
`)}},set:function(e){Ce(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(e){s="/"+e}})};qr(cr,Nn);var fl=function(){cr.call(this),this.pushButton=!0};qr(fl,cr);var ia=function(){cr.call(this),this.radio=!0,this.pushButton=!1;var s=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t!==void 0?t:[]}})};qr(ia,cr);var ml=function(){var s,t;Nn.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return s},set:function(n){s=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),r)o.push("/"+i+" ("+Ks(n(r[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Ce(n)==="object"&&(r=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(n){typeof n=="string"&&(r.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Rt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};qr(ml,Nn),ia.prototype.setAppearance=function(s){if(!("createAppearanceStream"in s)||!("getCA"in s))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=s.createAppearanceStream(e.optionName),e.caption=s.getCA()}},ia.prototype.createOption=function(s){var t=new ml;return t.Parent=this,t.optionName=s,this.Kids.push(t),rv.call(this.scope,t),t};var dl=function(){cr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Rt.CheckBox.createAppearanceStream()};qr(dl,cr);var Xs=function(){Nn.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,13)},set:function(t){t?this.Ff=Xe(this.Ff,13):this.Ff=Ke(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,21)},set:function(t){t?this.Ff=Xe(this.Ff,21):this.Ff=Ke(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,23)},set:function(t){t?this.Ff=Xe(this.Ff,23):this.Ff=Ke(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,24)},set:function(t){t?this.Ff=Xe(this.Ff,24):this.Ff=Ke(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,25)},set:function(t){t?this.Ff=Xe(this.Ff,25):this.Ff=Ke(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,26)},set:function(t){t?this.Ff=Xe(this.Ff,26):this.Ff=Ke(this.Ff,26)}});var s=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){Number.isInteger(t)&&(s=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};qr(Xs,Nn);var gl=function(){Xs.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ye(this.Ff,14)},set:function(s){s?this.Ff=Xe(this.Ff,14):this.Ff=Ke(this.Ff,14)}}),this.password=!0};qr(gl,Xs);var Rt={CheckBox:{createAppearanceStream:function(){return{N:{On:Rt.CheckBox.YesNormal},D:{On:Rt.CheckBox.YesPushDown,Off:Rt.CheckBox.OffPushDown}}},YesPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=[],r=s.scope.internal.getFont(s.fontName,s.fontStyle).id,n=s.scope.__private__.encodeColorString(s.color),i=Jf(s,s.caption);return e.push("0.749023 g"),e.push("0 0 "+Qt(Rt.internal.getWidth(s))+" "+Qt(Rt.internal.getHeight(s))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+r+" "+Qt(i.fontSize)+" Tf "+n),e.push("BT"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(s){var t=$n(s);t.scope=s.scope;var e=s.scope.internal.getFont(s.fontName,s.fontStyle).id,r=s.scope.__private__.encodeColorString(s.color),n=[],i=Rt.internal.getHeight(s),o=Rt.internal.getWidth(s),a=Jf(s,s.caption);return n.push("1 g"),n.push("0 0 "+Qt(o)+" "+Qt(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Qt(o-1)+" "+Qt(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+e+" "+Qt(a.fontSize)+" Tf "+r),n.push(a.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Qt(Rt.internal.getWidth(s))+" "+Qt(Rt.internal.getHeight(s))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(s){var t={D:{Off:Rt.RadioButton.Circle.OffPushDown},N:{}};return t.N[s]=Rt.RadioButton.Circle.YesNormal,t.D[s]=Rt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(s){var t=$n(s);t.scope=s.scope;var e=[],r=Rt.internal.getWidth(s)<=Rt.internal.getHeight(s)?Rt.internal.getWidth(s)/4:Rt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Rt.internal.Bezier_C,i=Number((r*n).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Zi(Rt.internal.getWidth(s)/2)+" "+Zi(Rt.internal.getHeight(s)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),e.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),e.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),e.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=[],r=Rt.internal.getWidth(s)<=Rt.internal.getHeight(s)?Rt.internal.getWidth(s)/4:Rt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),i=Number((n*Rt.internal.Bezier_C).toFixed(5)),o=Number((r*Rt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Zi(Rt.internal.getWidth(s)/2)+" "+Zi(Rt.internal.getHeight(s)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),e.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),e.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),e.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Zi(Rt.internal.getWidth(s)/2)+" "+Zi(Rt.internal.getHeight(s)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),e.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),e.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),e.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=[],r=Rt.internal.getWidth(s)<=Rt.internal.getHeight(s)?Rt.internal.getWidth(s)/4:Rt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),i=Number((n*Rt.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Zi(Rt.internal.getWidth(s)/2)+" "+Zi(Rt.internal.getHeight(s)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),e.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),e.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),e.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(s){var t={D:{Off:Rt.RadioButton.Cross.OffPushDown},N:{}};return t.N[s]=Rt.RadioButton.Cross.YesNormal,t.D[s]=Rt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(s){var t=$n(s);t.scope=s.scope;var e=[],r=Rt.internal.calculateCross(s);return e.push("q"),e.push("1 1 "+Qt(Rt.internal.getWidth(s)-2)+" "+Qt(Rt.internal.getHeight(s)-2)+" re"),e.push("W"),e.push("n"),e.push(Qt(r.x1.x)+" "+Qt(r.x1.y)+" m"),e.push(Qt(r.x2.x)+" "+Qt(r.x2.y)+" l"),e.push(Qt(r.x4.x)+" "+Qt(r.x4.y)+" m"),e.push(Qt(r.x3.x)+" "+Qt(r.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=Rt.internal.calculateCross(s),r=[];return r.push("0.749023 g"),r.push("0 0 "+Qt(Rt.internal.getWidth(s))+" "+Qt(Rt.internal.getHeight(s))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Qt(Rt.internal.getWidth(s)-2)+" "+Qt(Rt.internal.getHeight(s)-2)+" re"),r.push("W"),r.push("n"),r.push(Qt(e.x1.x)+" "+Qt(e.x1.y)+" m"),r.push(Qt(e.x2.x)+" "+Qt(e.x2.y)+" l"),r.push(Qt(e.x4.x)+" "+Qt(e.x4.y)+" m"),r.push(Qt(e.x3.x)+" "+Qt(e.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(s){var t=$n(s);t.scope=s.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Qt(Rt.internal.getWidth(s))+" "+Qt(Rt.internal.getHeight(s))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(s){var t=s.scope.internal.getFont(s.fontName,s.fontStyle).id,e=s.scope.__private__.encodeColorString(s.color);return"/"+t+" "+s.fontSize+" Tf "+e}};Rt.internal={Bezier_C:.551915024494,calculateCross:function(s){var t=Rt.internal.getWidth(s),e=Rt.internal.getHeight(s),r=Math.min(t,e);return{x1:{x:(t-r)/2,y:(e-r)/2+r},x2:{x:(t-r)/2+r,y:(e-r)/2},x3:{x:(t-r)/2,y:(e-r)/2},x4:{x:(t-r)/2+r,y:(e-r)/2+r}}}},Rt.internal.getWidth=function(s){var t=0;return Ce(s)==="object"&&(t=xp(s.Rect[2])),t},Rt.internal.getHeight=function(s){var t=0;return Ce(s)==="object"&&(t=xp(s.Rect[3])),t};var rv=Ue.addField=function(s){if(ev(this,s),!(s instanceof Nn))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=s).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),s.page=s.scope.internal.getCurrentPageInfo().pageNumber,this};Ue.AcroFormChoiceField=ea,Ue.AcroFormListBox=ra,Ue.AcroFormComboBox=na,Ue.AcroFormEditBox=ul,Ue.AcroFormButton=cr,Ue.AcroFormPushButton=fl,Ue.AcroFormRadioButton=ia,Ue.AcroFormCheckBox=dl,Ue.AcroFormTextField=Xs,Ue.AcroFormPasswordField=gl,Ue.AcroFormAppearance=Rt,Ue.AcroForm={ChoiceField:ea,ListBox:ra,ComboBox:na,EditBox:ul,Button:cr,PushButton:fl,RadioButton:ia,CheckBox:dl,TextField:Xs,PasswordField:gl,Appearance:Rt},Gt.AcroForm={ChoiceField:ea,ListBox:ra,ComboBox:na,EditBox:ul,Button:cr,PushButton:fl,RadioButton:ia,CheckBox:dl,TextField:Xs,PasswordField:gl,Appearance:Rt};var Iy=Gt.AcroForm;function qp(s){return s.reduce(function(t,e,r){return t[e]=r,t},{})}(function(s){s.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=s.__addimage__.getImageFileTypeByImageData=function(N,M){var z,R,ht,it,ut,Q=t;if((M=M||t)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(nt(N))for(ut in e)for(ht=e[ut],z=0;z<ht.length;z+=1){for(it=!0,R=0;R<ht[z].length;R+=1)if(ht[z][R]!==void 0&&ht[z][R]!==N[R]){it=!1;break}if(it===!0){Q=ut;break}}else for(ut in e)for(ht=e[ut],z=0;z<ht.length;z+=1){for(it=!0,R=0;R<ht[z].length;R+=1)if(ht[z][R]!==void 0&&ht[z][R]!==N.charCodeAt(R)){it=!1;break}if(it===!0){Q=ut;break}}return Q===t&&M!==t&&(Q=M),Q},n=function N(M){for(var z=this.internal.write,R=this.internal.putStream,ht=(0,this.internal.getFilters)();ht.indexOf("FlateEncode")!==-1;)ht.splice(ht.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var it=[];if(it.push({key:"Type",value:"/XObject"}),it.push({key:"Subtype",value:"/Image"}),it.push({key:"Width",value:M.width}),it.push({key:"Height",value:M.height}),M.colorSpace===C.INDEXED?it.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(it.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===C.DEVICE_CMYK&&it.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),it.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&it.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)){for(var ut="",Q=0,gt=M.transparency.length;Q<gt;Q++)ut+=M.transparency[Q]+" "+M.transparency[Q]+" ";it.push({key:"Mask",value:"["+ut+"]"})}M.sMask!==void 0&&it.push({key:"SMask",value:M.objectId+1+" 0 R"});var pt=M.filter!==void 0?["/"+M.filter]:void 0;if(R({data:M.data,additionalKeyValues:it,alreadyAppliedFilters:pt,objectId:M.objectId}),z("endobj"),"sMask"in M&&M.sMask!==void 0){var kt="/Predictor "+M.predictor+" /Colors 1 /BitsPerComponent "+M.bitsPerComponent+" /Columns "+M.width,T={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:M.bitsPerComponent,decodeParameters:kt,data:M.sMask};"filter"in M&&(T.filter=M.filter),N.call(this,T)}if(M.colorSpace===C.INDEXED){var E=this.internal.newObject();R({data:F(new Uint8Array(M.palette)),objectId:E}),z("endobj")}},i=function(){var N=this.internal.collections.addImage_images;for(var M in N)n.call(this,N[M])},o=function(){var N,M=this.internal.collections.addImage_images,z=this.internal.write;for(var R in M)z("/I"+(N=M[R]).index,N.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var N=this.internal.collections.addImage_images;return a.call(this),N},l=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(N){return typeof s["process"+N.toUpperCase()]=="function"},p=function(N){return Ce(N)==="object"&&N.nodeType===1},v=function(N,M){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var z=""+N.getAttribute("src");if(z.indexOf("data:image/")===0)return ch(unescape(z).split("base64,").pop());var R=s.loadFile(z,!0);if(R!==void 0)return R}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var ht;switch(M){case"PNG":ht="image/png";break;case"WEBP":ht="image/webp";break;case"JPEG":case"JPG":default:ht="image/jpeg"}return ch(N.toDataURL(ht,1).split("base64,").pop())}},g=function(N){var M=this.internal.collections.addImage_images;if(M){for(var z in M)if(N===M[z].alias)return M[z]}},b=function(N,M,z){return N||M||(N=-96,M=-96),N<0&&(N=-1*z.width*72/N/this.internal.scaleFactor),M<0&&(M=-1*z.height*72/M/this.internal.scaleFactor),N===0&&(N=M*z.width/z.height),M===0&&(M=N*z.height/z.width),[N,M]},w=function(N,M,z,R,ht,it){var ut=b.call(this,z,R,ht),Q=this.internal.getCoordinateString,gt=this.internal.getVerticalCoordinateString,pt=h.call(this);if(z=ut[0],R=ut[1],pt[ht.index]=ht,it){it*=Math.PI/180;var kt=Math.cos(it),T=Math.sin(it),E=function(V){return V.toFixed(4)},B=[E(kt),E(T),E(-1*T),E(kt),0,0,"cm"]}this.internal.write("q"),it?(this.internal.write([1,"0","0",1,Q(N),gt(M+R),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([Q(z),"0","0",Q(R),"0","0","cm"].join(" "))):this.internal.write([Q(z),"0","0",Q(R),Q(N),gt(M+R),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ht.index+" Do"),this.internal.write("Q")},C=s.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};s.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=s.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},k=s.__addimage__.sHashCode=function(N){var M,z,R=0;if(typeof N=="string")for(z=N.length,M=0;M<z;M++)R=(R<<5)-R+N.charCodeAt(M),R|=0;else if(nt(N))for(z=N.byteLength/2,M=0;M<z;M++)R=(R<<5)-R+N[M],R|=0;return R},I=s.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var M=!0;return N.length===0&&(M=!1),N.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(M=!1),M},G=s.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var M=N.indexOf(",");return M<0?null:N.substring(0,M).trim().endsWith("base64")?N.substring(M+1):null},U=s.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};s.__addimage__.isArrayBuffer=function(N){return U()&&N instanceof ArrayBuffer};var nt=s.__addimage__.isArrayBufferView=function(N){return U()&&typeof Uint32Array<"u"&&(N instanceof Int8Array||N instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array)},J=s.__addimage__.binaryStringToUint8Array=function(N){for(var M=N.length,z=new Uint8Array(M),R=0;R<M;R++)z[R]=N.charCodeAt(R);return z},F=s.__addimage__.arrayBufferToBinaryString=function(N){for(var M="",z=nt(N)?N:new Uint8Array(N),R=0;R<z.length;R+=8192)M+=String.fromCharCode.apply(null,z.subarray(R,R+8192));return M};s.addImage=function(){var N,M,z,R,ht,it,ut,Q,gt;if(typeof arguments[1]=="number"?(M=t,z=arguments[1],R=arguments[2],ht=arguments[3],it=arguments[4],ut=arguments[5],Q=arguments[6],gt=arguments[7]):(M=arguments[1],z=arguments[2],R=arguments[3],ht=arguments[4],it=arguments[5],ut=arguments[6],Q=arguments[7],gt=arguments[8]),Ce(N=arguments[0])==="object"&&!p(N)&&"imageData"in N){var pt=N;N=pt.imageData,M=pt.format||M||t,z=pt.x||z||0,R=pt.y||R||0,ht=pt.w||pt.width||ht,it=pt.h||pt.height||it,ut=pt.alias||ut,Q=pt.compression||Q,gt=pt.rotation||pt.angle||gt}var kt=this.internal.getFilters();if(Q===void 0&&kt.indexOf("FlateEncode")!==-1&&(Q="SLOW"),isNaN(z)||isNaN(R))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var T=et.call(this,N,M,ut,Q);return w.call(this,z,R,ht,it,T,gt),this};var et=function(N,M,z,R){var ht,it,ut;if(typeof N=="string"&&r(N)===t){N=unescape(N);var Q=dt(N,!1);(Q!==""||(Q=s.loadFile(N,!0))!==void 0)&&(N=Q)}if(p(N)&&(N=v(N,M)),M=r(N,M),!f(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((ut=z)==null||ut.length===0)&&(z=function(gt){return typeof gt=="string"||nt(gt)?k(gt):nt(gt.data)?k(gt.data):null}(N)),(ht=g.call(this,z))||(U()&&(N instanceof Uint8Array||M==="RGBA"||(it=N,N=J(N))),ht=this["process"+M.toUpperCase()](N,l.call(this),z,function(gt){return gt&&typeof gt=="string"&&(gt=gt.toUpperCase()),gt in s.image_compression?gt:x.NONE}(R),it)),!ht)throw new Error("An unknown error occurred whilst processing the image.");return ht},dt=s.__addimage__.convertBase64ToBinaryString=function(N,M){M=typeof M!="boolean"||M;var z,R="";if(typeof N=="string"){var ht;z=(ht=G(N))!==null&&ht!==void 0?ht:N;try{R=ch(z)}catch(it){if(M)throw I(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+it.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return R};s.getImageProperties=function(N){var M,z,R="";if(p(N)&&(N=v(N)),typeof N=="string"&&r(N)===t&&((R=dt(N,!1))===""&&(R=s.loadFile(N)||""),N=R),z=r(N),!f(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(!U()||N instanceof Uint8Array||(N=J(N)),!(M=this["process"+z.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=z,M}})(Gt.API),function(s){var t=function(e){if(e!==void 0&&e!="")return!0};Gt.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),s.events.push(["putPage",function(e){for(var r,n,i,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,h=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,f=!1,p=0;p<l.length&&!f;p++)switch((r=l[p]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<l.length;v++){r=l[v];var g=this.internal.pdfEscape,b=this.internal.getEncryptor(e.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),C=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(w.objId),k=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+g(x(r.contents))+")",i+=" /Popup "+C.objId+" 0 R",i+=" /P "+h.objId+" 0 R",i+=" /T ("+g(x(k))+") >>",w.content=i;var I=w.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+I,r.open&&(i+=" /Open true"),i+=" >>",C.content=i,this.internal.write(w.objId,"0 R",C.objId,"0 R");break;case"freetext":n="/Rect ["+o(r.bounds.x)+" "+a(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var G=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(b(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+G+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var U=this.annotations._nameMap[r.options.name];r.options.pageNumber=U.page,r.options.top=U.y}else r.options.top||(r.options.top=0);if(n="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(b(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var nt=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+nt+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),s.createAnnotation=function(e){var r=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":r.pageContext.annotations.push(e)}},s.link=function(e,r,n,i,o){var a=this.internal.getCurrentPageInfo(),h=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:h(e),y:l(r),w:h(e+n),h:l(r+i)},options:o,type:"link"})},s.textWithLink=function(e,r,n,i){var o,a,h=this.getTextWidth(e),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){a=i.maxWidth;var f=this.splitTextToSize(e,a).length;o=Math.ceil(l*f)}else a=h,o=l;return this.text(e,r,n,i),n+=.2*l,i.align==="center"&&(r-=h/2),i.align==="right"&&(r-=h),this.link(r,n-l,a,o,i),h},s.getTextWidth=function(e){var r=this.internal.getFontSize();return this.getStringUnitWidth(e)*r/this.internal.scaleFactor}}(Gt.API),function(s){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];s.__arabicParser__={};var i=s.__arabicParser__.isInArabicSubstitutionA=function(w){return t[w.charCodeAt(0)]!==void 0},o=s.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},a=s.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&i(w)&&t[w.charCodeAt(0)].length<=2},h=s.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&n.indexOf(w.charCodeAt(0))>=0};s.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&i(w)&&t[w.charCodeAt(0)].length>=1};var l=s.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&i(w)&&t[w.charCodeAt(0)].length>=2};s.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&i(w)&&t[w.charCodeAt(0)].length>=3};var f=s.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&i(w)&&t[w.charCodeAt(0)].length==4},p=s.__arabicParser__.resolveLigatures=function(w){var C=0,x=e,k="",I=0;for(C=0;C<w.length;C+=1)x[w.charCodeAt(C)]!==void 0?(I++,typeof(x=x[w.charCodeAt(C)])=="number"&&(k+=String.fromCharCode(x),x=e,I=0),C===w.length-1&&(x=e,k+=w.charAt(C-(I-1)),C-=I-1,I=0)):(x=e,k+=w.charAt(C-I),C-=I,I=0);return k};s.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&r[w.charCodeAt(0)]!==void 0};var v=s.__arabicParser__.getCorrectForm=function(w,C,x){return o(w)?i(w)===!1?-1:!l(w)||!o(C)&&!o(x)||!o(x)&&a(C)||a(w)&&!o(C)||a(w)&&h(C)||a(w)&&a(C)?0:f(w)&&o(C)&&!a(C)&&o(x)&&l(x)?3:a(w)||!o(x)?1:2:-1},g=function(w){var C=0,x=0,k=0,I="",G="",U="",nt=(w=w||"").split("\\s+"),J=[];for(C=0;C<nt.length;C+=1){for(J.push(""),x=0;x<nt[C].length;x+=1)I=nt[C][x],G=nt[C][x-1],U=nt[C][x+1],o(I)?(k=v(I,G,U),J[C]+=k!==-1?String.fromCharCode(t[I.charCodeAt(0)][k]):I):J[C]+=I;J[C]=p(J[C])}return J.join(" ")},b=s.__arabicParser__.processArabic=s.processArabic=function(){var w,C=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(C)){var k=0;for(x=[],k=0;k<C.length;k+=1)Array.isArray(C[k])?x.push([g(C[k][0]),C[k][1],C[k][2]]):x.push([g(C[k])]);w=x}else w=g(C);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};s.events.push(["preProcessText",b])}(Gt.API),Gt.API.autoPrint=function(s){var t;switch((s=s||{}).variant=s.variant||"non-conform",s.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(s){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(a){e=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(a){i=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,r){var n;if((e=e||"2d")!=="2d")return null;for(n in r)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=r[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},s.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Gt.API),function(s){var t={left:0,top:0,bottom:0,right:0},e=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var h=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(w){l=w}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(w){f=w}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(w){v=w}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(w){g=w}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(w){b=w}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},s.setHeaderFunction=function(h){return r.call(this),this.internal.__cell__.headerFunction=typeof h=="function"?h:void 0,this},s.getTextDimensions=function(h,l){r.call(this);var f=(l=l||{}).fontSize||this.getFontSize(),p=l.font||this.getFont(),v=l.scaleFactor||this.internal.scaleFactor,g=0,b=0,w=0,C=this;if(!Array.isArray(h)&&typeof h!="string"){if(typeof h!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");h=String(h)}var x=l.maxWidth;x>0?typeof h=="string"?h=this.splitTextToSize(h,x):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(I,G){return I.concat(C.splitTextToSize(G,x))},[])):h=Array.isArray(h)?h:[h];for(var k=0;k<h.length;k++)g<(w=this.getStringUnitWidth(h[k],{font:p})*f)&&(g=w);return g!==0&&(b=h.length),{w:g/=v,h:Math.max((b*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},s.cellAddPage=function(){r.call(this),this.addPage();var h=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(h.left,h.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=s.cell=function(){var h;h=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var l=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,v=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===h.lineNumber?(h.x=(l.x||0)+(l.width||0),h.y=l.y||0):l.y+l.height+h.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),h.y=p.top,g&&v&&(this.printHeaderRow(h.lineNumber,!0),h.y+=v[0].height)):h.y=l.y+l.height||h.y),h.text[0]!==void 0&&(this.rect(h.x,h.y,h.width,h.height,e===!0?"FD":void 0),h.align==="right"?this.text(h.text,h.x+h.width-f,h.y+f,{align:"right",baseline:"top"}):h.align==="center"?this.text(h.text,h.x+h.width/2,h.y+f,{align:"center",baseline:"top",maxWidth:h.width-f-f}):this.text(h.text,h.x+f,h.y+f,{align:"left",baseline:"top",maxWidth:h.width-f-f})),this.internal.__cell__.lastCell=h,this};s.table=function(h,l,f,p,v){if(r.call(this),!f)throw new Error("No data for PDF table.");var g,b,w,C,x=[],k=[],I=[],G={},U={},nt=[],J=[],F=(v=v||{}).autoSize||!1,et=v.printHeaders!==!1,dt=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,N=v.margins||Object.assign({width:this.getPageWidth()},t),M=typeof v.padding=="number"?v.padding:3,z=v.headerBackgroundColor||"#c8c8c8",R=v.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=et,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=dt,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=R,this.setFontSize(dt),p==null)k=x=Object.keys(f[0]),I=x.map(function(){return"left"});else if(Array.isArray(p)&&Ce(p[0])==="object")for(x=p.map(function(pt){return pt.name}),k=p.map(function(pt){return pt.prompt||pt.name||""}),I=p.map(function(pt){return pt.align||"left"}),g=0;g<p.length;g+=1)U[p[g].name]=p[g].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(k=x=p,I=x.map(function(){return"left"}));if(F||Array.isArray(p)&&typeof p[0]=="string")for(g=0;g<x.length;g+=1){for(G[C=x[g]]=f.map(function(pt){return pt[C]}),this.setFont(void 0,"bold"),nt.push(this.getTextDimensions(k[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=G[C],this.setFont(void 0,"normal"),w=0;w<b.length;w+=1)nt.push(this.getTextDimensions(b[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[C]=Math.max.apply(null,nt)+M+M,nt=[]}if(et){var ht={};for(g=0;g<x.length;g+=1)ht[x[g]]={},ht[x[g]].text=k[g],ht[x[g]].align=I[g];var it=a.call(this,ht,U);J=x.map(function(pt){return new i(h,l,U[pt],it,ht[pt].text,void 0,ht[pt].align)}),this.setTableHeaderRow(J),this.printHeaderRow(1,!1)}var ut=p.reduce(function(pt,kt){return pt[kt.name]=kt.align,pt},{});for(g=0;g<f.length;g+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:g,data:f[g]},this);var Q=a.call(this,f[g],U);for(w=0;w<x.length;w+=1){var gt=f[g][x[w]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:g,col:w,data:gt},this),o.call(this,new i(h,l,U[x[w]],Q,gt,g+2,ut[x[w]]))}}return this.internal.__cell__.table_x=h,this.internal.__cell__.table_y=l,this};var a=function(h,l){var f=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(h).map(function(g){var b=h[g];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,l[g]-f-f)},this).map(function(g){return this.getLineHeightFactor()*g.length*p/v+f+f},this).reduce(function(g,b){return Math.max(g,b)},0)};s.setTableHeaderRow=function(h){r.call(this),this.internal.__cell__.tableHeaderRow=h},s.printHeaderRow=function(h,l){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){f=this.internal.__cell__.tableHeaderRow[g].clone(),l&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=h;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,f),this.setTextColor(b)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),e=!1}}(Gt.API);var zp={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Up=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Zf=qp(Up),Wp=[100,200,300,400,500,600,700,800,900],nv=qp(Wp);function $f(s){var t=s.family.replace(/"|'/g,"").toLowerCase(),e=function(i){return zp[i=i||"normal"]?i:"normal"}(s.style),r=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(s.weight),n=function(i){return typeof Zf[i=i||"normal"]=="number"?i:"normal"}(s.stretch);return{family:t,style:e,weight:r,stretch:n,src:s.src||[],ref:s.ref||{name:t,style:[n,e,r].join(" ")}}}function _p(s,t,e,r){var n;for(n=e;n>=0&&n<t.length;n+=r)if(s[t[n]])return s[t[n]];for(n=e;n>=0&&n<t.length;n-=r)if(s[t[n]])return s[t[n]]}var iv={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Sp={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Cp(s){return[s.stretch,s.style,s.weight,s.family].join(" ")}function sv(s,t,e){for(var r=(e=e||{}).defaultFontFamily||"times",n=Object.assign({},iv,e.genericFontFamilies||{}),i=null,o=null,a=0;a<t.length;++a)if(n[(i=$f(t[a])).family]&&(i.family=n[i.family]),s.hasOwnProperty(i.family)){o=s[i.family];break}if(!(o=o||s[r]))throw new Error("Could not find a font-family for the rule '"+Cp(i)+"' and default family '"+r+"'.");if(o=function(h,l){if(l[h])return l[h];var f=Zf[h],p=f<=Zf.normal?-1:1,v=_p(l,Up,f,p);if(!v)throw new Error("Could not find a matching font-stretch value for "+h);return v}(i.stretch,o),o=function(h,l){if(l[h])return l[h];for(var f=zp[h],p=0;p<f.length;++p)if(l[f[p]])return l[f[p]];throw new Error("Could not find a matching font-style for "+h)}(i.style,o),!(o=function(h,l){if(l[h])return l[h];if(h===400&&l[500])return l[500];if(h===500&&l[400])return l[400];var f=nv[h],p=_p(l,Wp,f,h<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+h);return p}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Cp(i)+"'.");return o}function Ap(s){return s.trimLeft()}function ov(s,t){for(var e=0;e<s.length;){if(s.charAt(e)===t)return[s.substring(0,e),s.substring(e+1)];e+=1}return null}function av(s){var t=s.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],s.substring(t[0].length)]}var cl,Lp,Tp,Hf=["times"];(function(s){var t,e,r,n,i,o,a,h,l,f=function(T){return T=T||{},this.isStrokeTransparent=T.isStrokeTransparent||!1,this.strokeOpacity=T.strokeOpacity||1,this.strokeStyle=T.strokeStyle||"#000000",this.fillStyle=T.fillStyle||"#000000",this.isFillTransparent=T.isFillTransparent||!1,this.fillOpacity=T.fillOpacity||1,this.font=T.font||"10px sans-serif",this.textBaseline=T.textBaseline||"alphabetic",this.textAlign=T.textAlign||"left",this.lineWidth=T.lineWidth||1,this.lineJoin=T.lineJoin||"miter",this.lineCap=T.lineCap||"butt",this.path=T.path||[],this.transform=T.transform!==void 0?T.transform.clone():new h,this.globalCompositeOperation=T.globalCompositeOperation||"normal",this.globalAlpha=T.globalAlpha||1,this.clip_path=T.clip_path||[],this.currentPoint=T.currentPoint||new o,this.miterLimit=T.miterLimit||10,this.lastPoint=T.lastPoint||new o,this.lineDashOffset=T.lineDashOffset||0,this.lineDash=T.lineDash||[],this.margin=T.margin||[0,0,0,0],this.prevPageLastElemOffset=T.prevPageLastElemOffset||0,this.ignoreClearRect=typeof T.ignoreClearRect!="boolean"||T.ignoreClearRect,this};s.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,e=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,h=this.internal.Matrix,l=new f}]);var p=function(T){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var E=T;Object.defineProperty(this,"pdf",{get:function(){return E}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(yt){B=!!yt}});var V=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return V},set:function(yt){V=!!yt}});var $=0;Object.defineProperty(this,"posX",{get:function(){return $},set:function(yt){isNaN(yt)||($=yt)}});var at=0;Object.defineProperty(this,"posY",{get:function(){return at},set:function(yt){isNaN(yt)||(at=yt)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(yt){var q;typeof yt=="number"?q=[yt,yt,yt,yt]:((q=new Array(4))[0]=yt[0],q[1]=yt.length>=2?yt[1]:q[0],q[2]=yt.length>=3?yt[2]:q[0],q[3]=yt.length>=4?yt[3]:q[1]),l.margin=q}});var lt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return lt},set:function(yt){lt=yt}});var ct=0;Object.defineProperty(this,"lastBreak",{get:function(){return ct},set:function(yt){ct=yt}});var Ct=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ct},set:function(yt){Ct=yt}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(yt){yt instanceof f&&(l=yt)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(yt){l.path=yt}});var Lt=[];Object.defineProperty(this,"ctxStack",{get:function(){return Lt},set:function(yt){Lt=yt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(yt){var q;q=v(yt),this.ctx.fillStyle=q.style,this.ctx.isFillTransparent=q.a===0,this.ctx.fillOpacity=q.a,this.pdf.setFillColor(q.r,q.g,q.b,{a:q.a}),this.pdf.setTextColor(q.r,q.g,q.b,{a:q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(yt){var q=v(yt);this.ctx.strokeStyle=q.style,this.ctx.isStrokeTransparent=q.a===0,this.ctx.strokeOpacity=q.a,q.a===0?this.pdf.setDrawColor(255,255,255):(q.a,this.pdf.setDrawColor(q.r,q.g,q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(yt){["butt","round","square"].indexOf(yt)!==-1&&(this.ctx.lineCap=yt,this.pdf.setLineCap(yt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(yt){isNaN(yt)||(this.ctx.lineWidth=yt,this.pdf.setLineWidth(yt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(yt){["bevel","round","miter"].indexOf(yt)!==-1&&(this.ctx.lineJoin=yt,this.pdf.setLineJoin(yt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(yt){isNaN(yt)||(this.ctx.miterLimit=yt,this.pdf.setMiterLimit(yt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(yt){this.ctx.textBaseline=yt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(yt){["right","end","center","left","start"].indexOf(yt)!==-1&&(this.ctx.textAlign=yt)}});var Dt=null;function Ot(yt,q){if(Dt===null){var te=function(qt){var At=[];return Object.keys(qt).forEach(function(Tt){qt[Tt].forEach(function(Et){var Mt=null;switch(Et){case"bold":Mt={family:Tt,weight:"bold"};break;case"italic":Mt={family:Tt,style:"italic"};break;case"bolditalic":Mt={family:Tt,weight:"bold",style:"italic"};break;case"":case"normal":Mt={family:Tt}}Mt!==null&&(Mt.ref={name:Tt,style:Et},At.push(Mt))})}),At}(yt.getFontList());Dt=function(qt){for(var At={},Tt=0;Tt<qt.length;++Tt){var Et=$f(qt[Tt]),Mt=Et.family,zt=Et.stretch,Jt=Et.style,ne=Et.weight;At[Mt]=At[Mt]||{},At[Mt][zt]=At[Mt][zt]||{},At[Mt][zt][Jt]=At[Mt][zt][Jt]||{},At[Mt][zt][Jt][ne]=Et}return At}(te.concat(q))}return Dt}var Ht=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ht},set:function(yt){Dt=null,Ht=yt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(yt){var q;if(this.ctx.font=yt,(q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(yt))!==null){var te=q[1];q[2];var qt=q[3],At=q[4];q[5];var Tt=q[6],Et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(At)[2];At=Math.floor(Et==="px"?parseFloat(At)*this.pdf.internal.scaleFactor:Et==="em"?parseFloat(At)*this.pdf.getFontSize():parseFloat(At)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(At);var Mt=function(Xt){var oe,Ft,dr=[],fe=Xt.trim();if(fe==="")return Hf;if(fe in Sp)return[Sp[fe]];for(;fe!=="";){switch(Ft=null,oe=(fe=Ap(fe)).charAt(0)){case'"':case"'":Ft=ov(fe.substring(1),oe);break;default:Ft=av(fe)}if(Ft===null||(dr.push(Ft[0]),(fe=Ap(Ft[1]))!==""&&fe.charAt(0)!==","))return Hf;fe=fe.replace(/^,/,"")}return dr}(Tt);if(this.fontFaces){var zt=sv(Ot(this.pdf,this.fontFaces),Mt.map(function(Xt){return{family:Xt,stretch:"normal",weight:qt,style:te}}));this.pdf.setFont(zt.ref.name,zt.ref.style)}else{var Jt="";(qt==="bold"||parseInt(qt,10)>=700||te==="bold")&&(Jt="bold"),te==="italic"&&(Jt+="italic"),Jt.length===0&&(Jt="normal");for(var ne="",se={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ce=0;ce<Mt.length;ce++){if(this.pdf.internal.getFont(Mt[ce],Jt,{noFallback:!0,disableWarning:!0})!==void 0){ne=Mt[ce];break}if(Jt==="bolditalic"&&this.pdf.internal.getFont(Mt[ce],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ne=Mt[ce],Jt="bold";else if(this.pdf.internal.getFont(Mt[ce],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ne=Mt[ce],Jt="normal";break}}if(ne===""){for(var xe=0;xe<Mt.length;xe++)if(se[Mt[xe]]){ne=se[Mt[xe]];break}}ne=ne===""?"Times":ne,this.pdf.setFont(ne,Jt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(yt){this.ctx.globalCompositeOperation=yt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(yt){this.ctx.globalAlpha=yt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(yt){this.ctx.lineDashOffset=yt,kt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(yt){this.ctx.lineDash=yt,kt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(yt){this.ctx.ignoreClearRect=!!yt}})};p.prototype.setLineDash=function(T){this.lineDash=T},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){G.call(this,"fill",!1)},p.prototype.stroke=function(){G.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(T,E){if(isNaN(T)||isNaN(E))throw Pe.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new o(T,E));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(T,E)},p.prototype.closePath=function(){var T=new o(0,0),E=0;for(E=this.path.length-1;E!==-1;E--)if(this.path[E].type==="begin"&&Ce(this.path[E+1])==="object"&&typeof this.path[E+1].x=="number"){T=new o(this.path[E+1].x,this.path[E+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(T.x,T.y)},p.prototype.lineTo=function(T,E){if(isNaN(T)||isNaN(E))throw Pe.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new o(T,E));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new o(B.x,B.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),G.call(this,null,!0)},p.prototype.quadraticCurveTo=function(T,E,B,V){if(isNaN(B)||isNaN(V)||isNaN(T)||isNaN(E))throw Pe.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var $=this.ctx.transform.applyToPoint(new o(B,V)),at=this.ctx.transform.applyToPoint(new o(T,E));this.path.push({type:"qct",x1:at.x,y1:at.y,x:$.x,y:$.y}),this.ctx.lastPoint=new o($.x,$.y)},p.prototype.bezierCurveTo=function(T,E,B,V,$,at){if(isNaN($)||isNaN(at)||isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V))throw Pe.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var lt=this.ctx.transform.applyToPoint(new o($,at)),ct=this.ctx.transform.applyToPoint(new o(T,E)),Ct=this.ctx.transform.applyToPoint(new o(B,V));this.path.push({type:"bct",x1:ct.x,y1:ct.y,x2:Ct.x,y2:Ct.y,x:lt.x,y:lt.y}),this.ctx.lastPoint=new o(lt.x,lt.y)},p.prototype.arc=function(T,E,B,V,$,at){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V)||isNaN($))throw Pe.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(at=!!at,!this.ctx.transform.isIdentity){var lt=this.ctx.transform.applyToPoint(new o(T,E));T=lt.x,E=lt.y;var ct=this.ctx.transform.applyToPoint(new o(0,B)),Ct=this.ctx.transform.applyToPoint(new o(0,0));B=Math.sqrt(Math.pow(ct.x-Ct.x,2)+Math.pow(ct.y-Ct.y,2))}Math.abs($-V)>=2*Math.PI&&(V=0,$=2*Math.PI),this.path.push({type:"arc",x:T,y:E,radius:B,startAngle:V,endAngle:$,counterclockwise:at})},p.prototype.arcTo=function(T,E,B,V,$){throw new Error("arcTo not implemented.")},p.prototype.rect=function(T,E,B,V){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V))throw Pe.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(T,E),this.lineTo(T+B,E),this.lineTo(T+B,E+V),this.lineTo(T,E+V),this.lineTo(T,E),this.lineTo(T+B,E),this.lineTo(T,E)},p.prototype.fillRect=function(T,E,B,V){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V))throw Pe.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var $={};this.lineCap!=="butt"&&($.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&($.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(T,E,B,V),this.fill(),$.hasOwnProperty("lineCap")&&(this.lineCap=$.lineCap),$.hasOwnProperty("lineJoin")&&(this.lineJoin=$.lineJoin)}},p.prototype.strokeRect=function(T,E,B,V){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V))throw Pe.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(T,E,B,V),this.stroke())},p.prototype.clearRect=function(T,E,B,V){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V))throw Pe.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(T,E,B,V))},p.prototype.save=function(T){T=typeof T!="boolean"||T;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(E),T){this.ctx.fontSize=this.pdf.internal.getFontSize();var V=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=V}},p.prototype.restore=function(T){T=typeof T!="boolean"||T;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(E),T&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(T){var E,B,V,$;if(T.isCanvasGradient===!0&&(T=T.getColor()),!T)return{r:0,g:0,b:0,a:0,style:T};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(T))E=0,B=0,V=0,$=0;else{var at=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(T);if(at!==null)E=parseInt(at[1]),B=parseInt(at[2]),V=parseInt(at[3]),$=1;else if((at=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(T))!==null)E=parseInt(at[1]),B=parseInt(at[2]),V=parseInt(at[3]),$=parseFloat(at[4]);else{if($=1,typeof T=="string"&&T.charAt(0)!=="#"){var lt=new Ep(T);T=lt.ok?lt.toHex():"#000000"}T.length===4?(E=T.substring(1,2),E+=E,B=T.substring(2,3),B+=B,V=T.substring(3,4),V+=V):(E=T.substring(1,3),B=T.substring(3,5),V=T.substring(5,7)),E=parseInt(E,16),B=parseInt(B,16),V=parseInt(V,16)}}return{r:E,g:B,b:V,a:$,style:T}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(T,E,B,V){if(isNaN(E)||isNaN(B)||typeof T!="string")throw Pe.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(V=isNaN(V)?void 0:V,!g.call(this)){var $=Q(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;M.call(this,{text:T,x:E,y:B,scale:at,angle:$,align:this.textAlign,maxWidth:V})}},p.prototype.strokeText=function(T,E,B,V){if(isNaN(E)||isNaN(B)||typeof T!="string")throw Pe.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){V=isNaN(V)?void 0:V;var $=Q(this.ctx.transform.rotation),at=this.ctx.transform.scaleX;M.call(this,{text:T,x:E,y:B,scale:at,renderingMode:"stroke",angle:$,align:this.textAlign,maxWidth:V})}},p.prototype.measureText=function(T){if(typeof T!="string")throw Pe.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var E=this.pdf,B=this.pdf.internal.scaleFactor,V=E.internal.getFontSize(),$=E.getStringUnitWidth(T)*V/E.internal.scaleFactor,at=function(lt){var ct=(lt=lt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ct}}),this};return new at({width:$*=Math.round(96*B/72*1e4)/1e4})},p.prototype.scale=function(T,E){if(isNaN(T)||isNaN(E))throw Pe.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new h(T,0,0,E,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},p.prototype.rotate=function(T){if(isNaN(T))throw Pe.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var E=new h(Math.cos(T),Math.sin(T),-Math.sin(T),Math.cos(T),0,0);this.ctx.transform=this.ctx.transform.multiply(E)},p.prototype.translate=function(T,E){if(isNaN(T)||isNaN(E))throw Pe.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new h(1,0,0,1,T,E);this.ctx.transform=this.ctx.transform.multiply(B)},p.prototype.transform=function(T,E,B,V,$,at){if(isNaN(T)||isNaN(E)||isNaN(B)||isNaN(V)||isNaN($)||isNaN(at))throw Pe.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var lt=new h(T,E,B,V,$,at);this.ctx.transform=this.ctx.transform.multiply(lt)},p.prototype.setTransform=function(T,E,B,V,$,at){T=isNaN(T)?1:T,E=isNaN(E)?0:E,B=isNaN(B)?0:B,V=isNaN(V)?1:V,$=isNaN($)?0:$,at=isNaN(at)?0:at,this.ctx.transform=new h(T,E,B,V,$,at)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(T,E,B,V,$,at,lt,ct,Ct){var Lt=this.pdf.getImageProperties(T),Dt=1,Ot=1,Ht=1,yt=1;V!==void 0&&ct!==void 0&&(Ht=ct/V,yt=Ct/$,Dt=Lt.width/V*ct/V,Ot=Lt.height/$*Ct/$),at===void 0&&(at=E,lt=B,E=0,B=0),V!==void 0&&ct===void 0&&(ct=V,Ct=$),V===void 0&&ct===void 0&&(ct=Lt.width,Ct=Lt.height);for(var q,te=this.ctx.transform.decompose(),qt=Q(te.rotate.shx),At=new h,Tt=(At=(At=(At=At.multiply(te.translate)).multiply(te.skew)).multiply(te.scale)).applyToRectangle(new a(at-E*Ht,lt-B*yt,V*Dt,$*Ot)),Et=C.call(this,Tt),Mt=[],zt=0;zt<Et.length;zt+=1)Mt.indexOf(Et[zt])===-1&&Mt.push(Et[zt]);if(I(Mt),this.autoPaging)for(var Jt=Mt[0],ne=Mt[Mt.length-1],se=Jt;se<ne+1;se++){this.pdf.setPage(se);var ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xe=se===1?this.posY+this.margin[0]:this.margin[0],Xt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],oe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ft=se===1?0:Xt+(se-2)*oe;if(this.ctx.clip_path.length!==0){var dr=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(q,this.posX+this.margin[3],-Ft+xe+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=dr}var fe=JSON.parse(JSON.stringify(Tt));fe=k([fe],this.posX+this.margin[3],-Ft+xe+this.ctx.prevPageLastElemOffset)[0];var un=(se>Jt||se<ne)&&w.call(this);un&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ce,oe,null).clip().discardPath()),this.pdf.addImage(T,"JPEG",fe.x,fe.y,fe.w,fe.h,null,null,qt),un&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(T,"JPEG",Tt.x,Tt.y,Tt.w,Tt.h,null,null,qt)};var C=function(T,E,B){var V=[];E=E||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var $=this.posY+this.ctx.prevPageLastElemOffset;switch(T.type){default:case"mt":case"lt":V.push(Math.floor((T.y+$)/B)+1);break;case"arc":V.push(Math.floor((T.y+$-T.radius)/B)+1),V.push(Math.floor((T.y+$+T.radius)/B)+1);break;case"qct":var at=gt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x,T.y);V.push(Math.floor((at.y+$)/B)+1),V.push(Math.floor((at.y+at.h+$)/B)+1);break;case"bct":var lt=pt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,T.x1,T.y1,T.x2,T.y2,T.x,T.y);V.push(Math.floor((lt.y+$)/B)+1),V.push(Math.floor((lt.y+lt.h+$)/B)+1);break;case"rect":V.push(Math.floor((T.y+$)/B)+1),V.push(Math.floor((T.y+T.h+$)/B)+1)}for(var ct=0;ct<V.length;ct+=1)for(;this.pdf.internal.getNumberOfPages()<V[ct];)x.call(this);return V},x=function(){var T=this.fillStyle,E=this.strokeStyle,B=this.font,V=this.lineCap,$=this.lineWidth,at=this.lineJoin;this.pdf.addPage(),this.fillStyle=T,this.strokeStyle=E,this.font=B,this.lineCap=V,this.lineWidth=$,this.lineJoin=at},k=function(T,E,B){for(var V=0;V<T.length;V++)switch(T[V].type){case"bct":T[V].x2+=E,T[V].y2+=B;case"qct":T[V].x1+=E,T[V].y1+=B;case"mt":case"lt":case"arc":default:T[V].x+=E,T[V].y+=B}return T},I=function(T){return T.sort(function(E,B){return E-B})},G=function(T,E){for(var B,V,$=this.fillStyle,at=this.strokeStyle,lt=this.lineCap,ct=this.lineWidth,Ct=Math.abs(ct*this.ctx.transform.scaleX),Lt=this.lineJoin,Dt=JSON.parse(JSON.stringify(this.path)),Ot=JSON.parse(JSON.stringify(this.path)),Ht=[],yt=0;yt<Ot.length;yt++)if(Ot[yt].x!==void 0)for(var q=C.call(this,Ot[yt]),te=0;te<q.length;te+=1)Ht.indexOf(q[te])===-1&&Ht.push(q[te]);for(var qt=0;qt<Ht.length;qt++)for(;this.pdf.internal.getNumberOfPages()<Ht[qt];)x.call(this);if(I(Ht),this.autoPaging)for(var At=Ht[0],Tt=Ht[Ht.length-1],Et=At;Et<Tt+1;Et++){this.pdf.setPage(Et),this.fillStyle=$,this.strokeStyle=at,this.lineCap=lt,this.lineWidth=Ct,this.lineJoin=Lt;var Mt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],zt=Et===1?this.posY+this.margin[0]:this.margin[0],Jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ne=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],se=Et===1?0:Jt+(Et-2)*ne;if(this.ctx.clip_path.length!==0){var ce=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(B,this.posX+this.margin[3],-se+zt+this.ctx.prevPageLastElemOffset),U.call(this,T,!0),this.path=ce}if(V=JSON.parse(JSON.stringify(Dt)),this.path=k(V,this.posX+this.margin[3],-se+zt+this.ctx.prevPageLastElemOffset),E===!1||Et===0){var xe=(Et>At||Et<Tt)&&w.call(this);xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mt,ne,null).clip().discardPath()),U.call(this,T,E),xe&&this.pdf.restoreGraphicsState()}this.lineWidth=ct}else this.lineWidth=Ct,U.call(this,T,E),this.lineWidth=ct;this.path=Dt},U=function(T,E){if((T!=="stroke"||E||!b.call(this))&&(T==="stroke"||E||!g.call(this))){for(var B,V,$=[],at=this.path,lt=0;lt<at.length;lt++){var ct=at[lt];switch(ct.type){case"begin":$.push({begin:!0});break;case"close":$.push({close:!0});break;case"mt":$.push({start:ct,deltas:[],abs:[]});break;case"lt":var Ct=$.length;if(at[lt-1]&&!isNaN(at[lt-1].x)&&(B=[ct.x-at[lt-1].x,ct.y-at[lt-1].y],Ct>0)){for(;Ct>=0;Ct--)if($[Ct-1].close!==!0&&$[Ct-1].begin!==!0){$[Ct-1].deltas.push(B),$[Ct-1].abs.push(ct);break}}break;case"bct":B=[ct.x1-at[lt-1].x,ct.y1-at[lt-1].y,ct.x2-at[lt-1].x,ct.y2-at[lt-1].y,ct.x-at[lt-1].x,ct.y-at[lt-1].y],$[$.length-1].deltas.push(B);break;case"qct":var Lt=at[lt-1].x+2/3*(ct.x1-at[lt-1].x),Dt=at[lt-1].y+2/3*(ct.y1-at[lt-1].y),Ot=ct.x+2/3*(ct.x1-ct.x),Ht=ct.y+2/3*(ct.y1-ct.y),yt=ct.x,q=ct.y;B=[Lt-at[lt-1].x,Dt-at[lt-1].y,Ot-at[lt-1].x,Ht-at[lt-1].y,yt-at[lt-1].x,q-at[lt-1].y],$[$.length-1].deltas.push(B);break;case"arc":$.push({deltas:[],abs:[],arc:!0}),Array.isArray($[$.length-1].abs)&&$[$.length-1].abs.push(ct)}}V=E?null:T==="stroke"?"stroke":"fill";for(var te=!1,qt=0;qt<$.length;qt++)if($[qt].arc)for(var At=$[qt].abs,Tt=0;Tt<At.length;Tt++){var Et=At[Tt];Et.type==="arc"?F.call(this,Et.x,Et.y,Et.radius,Et.startAngle,Et.endAngle,Et.counterclockwise,void 0,E,!te):z.call(this,Et.x,Et.y),te=!0}else if($[qt].close===!0)this.pdf.internal.out("h"),te=!1;else if($[qt].begin!==!0){var Mt=$[qt].start.x,zt=$[qt].start.y;R.call(this,$[qt].deltas,Mt,zt),te=!0}V&&et.call(this,V),E&&dt.call(this)}},nt=function(T){var E=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=E*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return T-B;case"top":return T+E-B;case"hanging":return T+E-2*B;case"middle":return T+E/2-B;case"ideographic":return T;case"alphabetic":default:return T}},J=function(T){return T+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var T=function(){};return T.colorStops=[],T.addColorStop=function(E,B){this.colorStops.push([E,B])},T.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},T.isCanvasGradient=!0,T},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var F=function(T,E,B,V,$,at,lt,ct,Ct){for(var Lt=it.call(this,B,V,$,at),Dt=0;Dt<Lt.length;Dt++){var Ot=Lt[Dt];Dt===0&&(Ct?N.call(this,Ot.x1+T,Ot.y1+E):z.call(this,Ot.x1+T,Ot.y1+E)),ht.call(this,T,E,Ot.x2,Ot.y2,Ot.x3,Ot.y3,Ot.x4,Ot.y4)}ct?dt.call(this):et.call(this,lt)},et=function(T){switch(T){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},dt=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(T,E){this.pdf.internal.out(e(T)+" "+r(E)+" m")},M=function(T){var E;switch(T.align){case"right":case"end":E="right";break;case"center":E="center";break;case"left":case"start":default:E="left"}var B=this.pdf.getTextDimensions(T.text),V=nt.call(this,T.y),$=J.call(this,V)-B.h,at=this.ctx.transform.applyToPoint(new o(T.x,V)),lt=this.ctx.transform.decompose(),ct=new h;ct=(ct=(ct=ct.multiply(lt.translate)).multiply(lt.skew)).multiply(lt.scale);for(var Ct,Lt,Dt,Ot=this.ctx.transform.applyToRectangle(new a(T.x,V,B.w,B.h)),Ht=ct.applyToRectangle(new a(T.x,$,B.w,B.h)),yt=C.call(this,Ht),q=[],te=0;te<yt.length;te+=1)q.indexOf(yt[te])===-1&&q.push(yt[te]);if(I(q),this.autoPaging)for(var qt=q[0],At=q[q.length-1],Tt=qt;Tt<At+1;Tt++){this.pdf.setPage(Tt);var Et=Tt===1?this.posY+this.margin[0]:this.margin[0],Mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],zt=this.pdf.internal.pageSize.height-this.margin[2],Jt=zt-this.margin[0],ne=this.pdf.internal.pageSize.width-this.margin[1],se=ne-this.margin[3],ce=Tt===1?0:Mt+(Tt-2)*Jt;if(this.ctx.clip_path.length!==0){var xe=this.path;Ct=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Ct,this.posX+this.margin[3],-1*ce+Et),U.call(this,"fill",!0),this.path=xe}var Xt=k([JSON.parse(JSON.stringify(Ht))],this.posX+this.margin[3],-ce+Et+this.ctx.prevPageLastElemOffset)[0];T.scale>=.01&&(Lt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Lt*T.scale),Dt=this.lineWidth,this.lineWidth=Dt*T.scale);var oe=this.autoPaging!=="text";if(oe||Xt.y+Xt.h<=zt){if(oe||Xt.y>=Et&&Xt.x<=ne){var Ft=oe?T.text:this.pdf.splitTextToSize(T.text,T.maxWidth||ne-Xt.x)[0],dr=k([JSON.parse(JSON.stringify(Ot))],this.posX+this.margin[3],-ce+Et+this.ctx.prevPageLastElemOffset)[0],fe=oe&&(Tt>qt||Tt<At)&&w.call(this);fe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],se,Jt,null).clip().discardPath()),this.pdf.text(Ft,dr.x,dr.y,{angle:T.angle,align:E,renderingMode:T.renderingMode}),fe&&this.pdf.restoreGraphicsState()}}else Xt.y<zt&&(this.ctx.prevPageLastElemOffset+=zt-Xt.y);T.scale>=.01&&(this.pdf.setFontSize(Lt),this.lineWidth=Dt)}else T.scale>=.01&&(Lt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Lt*T.scale),Dt=this.lineWidth,this.lineWidth=Dt*T.scale),this.pdf.text(T.text,at.x+this.posX,at.y+this.posY,{angle:T.angle,align:E,renderingMode:T.renderingMode,maxWidth:T.maxWidth}),T.scale>=.01&&(this.pdf.setFontSize(Lt),this.lineWidth=Dt)},z=function(T,E,B,V){B=B||0,V=V||0,this.pdf.internal.out(e(T+B)+" "+r(E+V)+" l")},R=function(T,E,B){return this.pdf.lines(T,E,B,null,null)},ht=function(T,E,B,V,$,at,lt,ct){this.pdf.internal.out([t(n(B+T)),t(i(V+E)),t(n($+T)),t(i(at+E)),t(n(lt+T)),t(i(ct+E)),"c"].join(" "))},it=function(T,E,B,V){for(var $=2*Math.PI,at=Math.PI/2;E>B;)E-=$;var lt=Math.abs(B-E);lt<$&&V&&(lt=$-lt);for(var ct=[],Ct=V?-1:1,Lt=E;lt>1e-5;){var Dt=Lt+Ct*Math.min(lt,at);ct.push(ut.call(this,T,Lt,Dt)),lt-=Math.abs(Dt-Lt),Lt=Dt}return ct},ut=function(T,E,B){var V=(B-E)/2,$=T*Math.cos(V),at=T*Math.sin(V),lt=$,ct=-at,Ct=lt*lt+ct*ct,Lt=Ct+lt*$+ct*at,Dt=4/3*(Math.sqrt(2*Ct*Lt)-Lt)/(lt*at-ct*$),Ot=lt-Dt*ct,Ht=ct+Dt*lt,yt=Ot,q=-Ht,te=V+E,qt=Math.cos(te),At=Math.sin(te);return{x1:T*Math.cos(E),y1:T*Math.sin(E),x2:Ot*qt-Ht*At,y2:Ot*At+Ht*qt,x3:yt*qt-q*At,y3:yt*At+q*qt,x4:T*Math.cos(B),y4:T*Math.sin(B)}},Q=function(T){return 180*T/Math.PI},gt=function(T,E,B,V,$,at){var lt=T+.5*(B-T),ct=E+.5*(V-E),Ct=$+.5*(B-$),Lt=at+.5*(V-at),Dt=Math.min(T,$,lt,Ct),Ot=Math.max(T,$,lt,Ct),Ht=Math.min(E,at,ct,Lt),yt=Math.max(E,at,ct,Lt);return new a(Dt,Ht,Ot-Dt,yt-Ht)},pt=function(T,E,B,V,$,at,lt,ct){var Ct,Lt,Dt,Ot,Ht,yt,q,te,qt,At,Tt,Et,Mt,zt,Jt=B-T,ne=V-E,se=$-B,ce=at-V,xe=lt-$,Xt=ct-at;for(Lt=0;Lt<41;Lt++)qt=(q=(Dt=T+(Ct=Lt/40)*Jt)+Ct*((Ht=B+Ct*se)-Dt))+Ct*(Ht+Ct*($+Ct*xe-Ht)-q),At=(te=(Ot=E+Ct*ne)+Ct*((yt=V+Ct*ce)-Ot))+Ct*(yt+Ct*(at+Ct*Xt-yt)-te),Lt==0?(Tt=qt,Et=At,Mt=qt,zt=At):(Tt=Math.min(Tt,qt),Et=Math.min(Et,At),Mt=Math.max(Mt,qt),zt=Math.max(zt,At));return new a(Math.round(Tt),Math.round(Et),Math.round(Mt-Tt),Math.round(zt-Et))},kt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var T,E,B=(T=this.ctx.lineDash,E=this.ctx.lineDashOffset,JSON.stringify({lineDash:T,lineDashOffset:E}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(Gt.API),function(s){var t=function(i){var o,a,h,l,f,p,v,g,b,w;for(/[^\x00-\xFF]/.test(i),a=[],h=0,l=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;l>h;h+=4)(f=(i.charCodeAt(h)<<24)+(i.charCodeAt(h+1)<<16)+(i.charCodeAt(h+2)<<8)+i.charCodeAt(h+3))!==0?(p=(f=((f=((f=((f=(f-(w=f%85))/85)-(b=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)%85,a.push(p+33,v+33,g+33,b+33,w+33)):a.push(122);return function(C,x){for(var k=x;k>0;k--)C.pop()}(a,o.length),String.fromCharCode.apply(String,a)+"~>"},e=function(i){var o,a,h,l,f,p=String,v="length",g=255,b="charCodeAt",w="slice",C="replace";for(i[w](-2),i=i[w](0,-2)[C](/\s/g,"")[C]("z","!!!!!"),h=[],l=0,f=(i+=o="uuuuu"[w](i[v]%5||5))[v];f>l;l+=5)a=52200625*(i[b](l)-33)+614125*(i[b](l+1)-33)+7225*(i[b](l+2)-33)+85*(i[b](l+3)-33)+(i[b](l+4)-33),h.push(g&a>>24,g&a>>16,g&a>>8,g&a);return function(x,k){for(var I=k;I>0;I--)x.pop()}(h,o[v]),p.fromCharCode.apply(p,h)},r=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var a="",h=0;h<i.length;h+=2)a+=String.fromCharCode("0x"+(i[h]+i[h+1]));return a},n=function(i){for(var o=new Uint8Array(i.length),a=i.length;a--;)o[a]=i.charCodeAt(a);return i=(o=ol(o)).reduce(function(h,l){return h+String.fromCharCode(l)},"")};s.processDataByFilters=function(i,o){var a=0,h=i||"",l=[];for(typeof(o=o||[])=="string"&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":h=e(h),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=t(h),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=r(h),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=h.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=n(h),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:h,reverseChain:l.reverse().join(" ")}}}(Gt.API),function(s){s.loadFile=function(t,e,r){return function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=function(h,l,f){var p=new XMLHttpRequest,v=0,g=function(b){var w=b.length,C=[],x=String.fromCharCode;for(v=0;v<w;v+=1)C.push(x(255&b.charCodeAt(v)));return C.join("")};if(p.open("GET",h,!l),p.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(p.onload=function(){p.status===200?f(g(this.responseText)):f(void 0)}),p.send(null),l&&p.status===200)return g(p.responseText)}(n,i,o)}catch{}return a}(t,e,r)},s.loadImageFile=s.loadFile}(Gt.API),function(s){function t(){return(Yt.html2canvas?Promise.resolve(Yt.html2canvas):import("./chunk-AFFSYBOZ.js")).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function e(){return(Yt.DOMPurify?Promise.resolve(Yt.DOMPurify):import("./chunk-THJBZZMO.js")).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var a=Ce(o);return a==="undefined"?"undefined":a==="string"||o instanceof String?"string":a==="number"||o instanceof Number?"number":a==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":a==="object"?"object":"unknown"},n=function(o,a){var h=document.createElement(o);for(var l in a.className&&(h.className=a.className),a.innerHTML&&a.dompurify&&(h.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)h.style[l]=a.style[l];return h},i=function o(a){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),l=o.convert(Promise.resolve(),h);return l=(l=l.setProgress(1,o,1,[o])).set(a)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,a){return o.__proto__=a||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,a){return this.then(function(){switch(a=a||function(h){switch(r(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(e).then(function(h){return this.set({src:n("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function h(l,f){for(var p=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),v=l.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||p.appendChild(h(v,f));return l.nodeType===1&&(l.nodeName==="CANVAS"?(p.width=l.width,p.height=l.height,p.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(p.value=l.value),p.addEventListener("load",function(){p.scrollTop=l.scrollTop,p.scrollLeft=l.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,a(this.prop.container,h)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var h=this.opt.jsPDF,l=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=l,l)for(var v=0;v<l.length;++v){var g=l[v],b=g.src.find(function(w){return w.format==="truetype"});b&&h.addFont(b.url,g.ref.name,g.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,h.context2d.save(!0),a(this.prop.container,p)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,a,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,a):this.outputPdf(o,a)},i.prototype.outputPdf=function(o,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,a)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(r(o)!=="object")return this;var a=Object.keys(o||{}).map(function(h){if(h in i.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(a)})},i.prototype.get=function(o,a){return this.then(function(){var h=o in i.template.prop?this.prop[o]:this.opt[o];return a?a(h):h})},i.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function a(h,l){return Math.floor(h*l/72*96)}return this.then(function(){(o=o||Gt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:a(o.inner.width,o.k),height:a(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,a,h,l){return o!=null&&(this.progress.val=o),a!=null&&(this.progress.state=a),h!=null&&(this.progress.n=h),l!=null&&(this.progress.stack=l),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,a,h,l){return this.setProgress(o?this.progress.val+o:null,a||null,h?this.progress.n+h:null,l?this.progress.stack.concat(l):null)},i.prototype.then=function(o,a){var h=this;return this.thenCore(o,a,function(l,f){return h.updateProgress(null,null,1,[l]),Promise.prototype.then.call(this,function(p){return h.updateProgress(null,l),p}).then(l,f).then(function(p){return h.updateProgress(1),p})})},i.prototype.thenCore=function(o,a,h){h=h||Promise.prototype.then,o&&(o=o.bind(this)),a&&(a=a.bind(this));var l=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),f=h.call(l,o,a);return i.convert(f,this.__proto__)},i.prototype.thenExternal=function(o,a){return Promise.prototype.then.call(this,o,a)},i.prototype.thenList=function(o){var a=this;return o.forEach(function(h){a=a.thenCore(h)}),a},i.prototype.catch=function(o){o&&(o=o.bind(this));var a=Promise.prototype.catch.call(this,o);return i.convert(a,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Gt.getPageSize=function(o,a,h){if(Ce(o)==="object"){var l=o;o=l.orientation,a=l.unit||a,h=l.format||h}a=a||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var f,p=(""+h).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+a}var g,b=0,w=0;if(v.hasOwnProperty(p))b=v[p][1]/f,w=v[p][0]/f;else try{b=h[1],w=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",w>b&&(g=w,w=b,b=g);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",b>w&&(g=w,w=b,b=g)}return{width:w,height:b,unit:a,k:f,orientation:o}},s.html=function(o,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map($f):null;var h=new i(a);return a.worker?h:h.from(o).doCallback()}}(Gt.API),Gt.API.addJS=function(s){return Tp=s,this.internal.events.subscribe("postPutResources",function(){cl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(cl+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Lp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Tp+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){cl!==void 0&&Lp!==void 0&&this.internal.out("/Names <</JavaScript "+cl+" 0 R>>")}),this},function(s){var t;s.events.push(["postPutResources",function(){var e=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=e.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],a=r.exec(o);if(a!=null){var h=a[1];e.internal.newObjectDeferredBegin(h,!1)}e.internal.write(o)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,f=[];for(i=0;i<l;i++){var p=e.internal.newObject();f.push(p);var v=e.internal.getPageInfo(i+1);e.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var g=e.internal.newObject();for(e.internal.write("<< /Names [ "),i=0;i<f.length;i++)e.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+g+" 0 R"),e.internal.write(">>","endobj")}}]),s.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),s.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(r,n,i){var o={title:n,options:i,children:[]};return r==null&&(r=this.root),r.children.push(o),o},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(r){r.id=e.internal.newObjectDeferred();for(var n=0;n<r.children.length;n++)this.genIds_r(r.children[n])},e.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},e.outline.renderItems=function(r){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var o=r.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var h=e.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+h.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var l=0;l<r.children.length;l++)this.renderItems(r.children[l])},e.outline.line=function(r){this.ctx.val+=r+`\r
`},e.outline.makeRef=function(r){return r.id+" 0 R"},e.outline.makeString=function(r){return"("+e.internal.pdfEscape(r)+")"},e.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(r,n){for(var i=0;i<n.children.length;i++)r.count++,this.count_r(r,n.children[i]);return r.count}}])}(Gt.API),function(s){var t=[192,193,194,195,196,197,198,199];s.processJPEG=function(e,r,n,i,o,a){var h,l=this.decode.DCT_DECODE,f=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=o||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(h=function(p){for(var v,g=256*p.charCodeAt(4)+p.charCodeAt(5),b=p.length,w={width:0,height:0,numcomponents:1},C=4;C<b;C+=2){if(C+=g,t.indexOf(p.charCodeAt(C+1))!==-1){v=256*p.charCodeAt(C+5)+p.charCodeAt(C+6),w={width:256*p.charCodeAt(C+7)+p.charCodeAt(C+8),height:v,numcomponents:p.charCodeAt(C+9)};break}g=256*p.charCodeAt(C+2)+p.charCodeAt(C+3)}return w}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}f={data:e,width:h.width,height:h.height,colorSpace:a,bitsPerComponent:8,filter:l,index:r,alias:n}}return f}}(Gt.API);var Zo,ll,Pp,kp,Op,hv=function(){var s,t,e;function r(i){var o,a,h,l,f,p,v,g,b,w,C,x,k,I;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(o=this.readUInt32(),b=(function(){var G,U;for(U=[],G=0;G<4;++G)U.push(String.fromCharCode(this.data[this.pos++]));return U}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),l=this.readUInt16()||100,p.delay=1e3*f/l,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(b==="fdAT"&&(this.pos+=4,o-=4),i=p?.data||this.imgData,x=0;0<=o?x<o:x>o;0<=o?++x:--x)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(h=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>h)throw new Error("More transparent colors than palette size");if((w=h-this.transparency.indexed.length)>0)for(k=0;0<=w?k<w:k>w;0<=w?++k:--k)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":v=(C=this.read(o)).indexOf(0),g=String.fromCharCode.apply(String,C.slice(0,v)),this.text[g]=String.fromCharCode.apply(String,C.slice(v+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(I=this.colorType)===4||I===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(i){var o,a;for(a=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*o),h=0,l=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function f(p,v,g,b){var w,C,x,k,I,G,U,nt,J,F,et,dt,N,M,z,R,ht,it,ut,Q,gt,pt=Math.ceil((l.width-p)/g),kt=Math.ceil((l.height-v)/b),T=l.width==pt&&l.height==kt;for(M=o*pt,dt=T?a:new Uint8Array(M*kt),G=i.length,N=0,C=0;N<kt&&h<G;){switch(i[h++]){case 0:for(k=ht=0;ht<M;k=ht+=1)dt[C++]=i[h++];break;case 1:for(k=it=0;it<M;k=it+=1)w=i[h++],I=k<o?0:dt[C-o],dt[C++]=(w+I)%256;break;case 2:for(k=ut=0;ut<M;k=ut+=1)w=i[h++],x=(k-k%o)/o,z=N&&dt[(N-1)*M+x*o+k%o],dt[C++]=(z+w)%256;break;case 3:for(k=Q=0;Q<M;k=Q+=1)w=i[h++],x=(k-k%o)/o,I=k<o?0:dt[C-o],z=N&&dt[(N-1)*M+x*o+k%o],dt[C++]=(w+Math.floor((I+z)/2))%256;break;case 4:for(k=gt=0;gt<M;k=gt+=1)w=i[h++],x=(k-k%o)/o,I=k<o?0:dt[C-o],N===0?z=R=0:(z=dt[(N-1)*M+x*o+k%o],R=x&&dt[(N-1)*M+(x-1)*o+k%o]),U=I+z-R,nt=Math.abs(U-I),F=Math.abs(U-z),et=Math.abs(U-R),J=nt<=F&&nt<=et?I:F<=et?z:R,dt[C++]=(w+J)%256;break;default:throw new Error("Invalid filter algorithm: "+i[h-1])}if(!T){var E=((v+N*b)*l.width+p)*o,B=N*M;for(k=0;k<pt;k+=1){for(var V=0;V<o;V+=1)a[E++]=dt[B++];E+=(g-1)*o}}N++}}return i=mp(i),l.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),a},r.prototype.decodePalette=function(){var i,o,a,h,l,f,p,v,g;for(a=this.palette,f=this.transparency.indexed||[],l=new Uint8Array((f.length||0)+a.length),h=0,i=0,o=p=0,v=a.length;p<v;o=p+=3)l[h++]=a[o],l[h++]=a[o+1],l[h++]=a[o+2],l[h++]=(g=f[i++])!=null?g:255;return l},r.prototype.copyToImageData=function(i,o){var a,h,l,f,p,v,g,b,w,C,x;if(h=this.colors,w=null,a=this.hasAlphaChannel,this.palette.length&&(w=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),h=4,a=!0),b=(l=i.data||i).length,p=w||o,f=v=0,h===1)for(;f<b;)g=w?4*o[f/4]:v,C=p[g++],l[f++]=C,l[f++]=C,l[f++]=C,l[f++]=a?p[g++]:255,v=g;else for(;f<b;)g=w?4*o[f/4]:v,l[f++]=p[g++],l[f++]=p[g++],l[f++]=p[g++],l[f++]=a?p[g++]:255,v=g},r.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(Yt)==="[object Window]"){try{t=Yt.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return n(),s=function(i){var o;if(n()===!0)return e.width=i.width,e.height=i.height,e.clearRect(0,0,i.width,i.height),e.putImageData(i,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(i){var o,a,h,l,f,p,v,g;if(this.animation){for(g=[],a=f=0,p=(v=this.animation.frames).length;f<p;a=++f)o=v[a],h=i.createImageData(o.width,o.height),l=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(h,l),o.imageData=h,g.push(o.image=s(h));return g}},r.prototype.renderFrame=function(i,o){var a,h,l;return a=(h=this.animation.frames)[o],l=h[o-1],o===0&&i.clearRect(0,0,this.width,this.height),l?.disposeOp===1?i.clearRect(l.xOffset,l.yOffset,l.width,l.height):l?.disposeOp===2&&i.putImageData(l.imageData,l.xOffset,l.yOffset),a.blendOp===0&&i.clearRect(a.xOffset,a.yOffset,a.width,a.height),i.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(i){var o,a,h,l,f,p,v=this;return a=0,p=this.animation,l=p.numFrames,h=p.frames,f=p.numPlays,(o=function(){var g,b;if(g=a++%l,b=h[g],v.renderFrame(i,g),l>1&&a/l<f)return v.animation._timeout=setTimeout(o,b.delay)})()},r.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},r.prototype.render=function(i){var o,a;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(a=o.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),o.putImageData(a,0,0))},r}();function cv(s){var t=0;if(s[t++]!==71||s[t++]!==73||s[t++]!==70||s[t++]!==56||(s[t++]+1&253)!=56||s[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=s[t++]|s[t++]<<8,r=s[t++]|s[t++]<<8,n=s[t++],i=n>>7,o=1<<(7&n)+1;s[t++],s[t++];var a=null,h=null;i&&(a=t,h=o,t+=3*o);var l=!0,f=[],p=0,v=null,g=0,b=null;for(this.width=e,this.height=r;l&&t<s.length;)switch(s[t++]){case 33:switch(s[t++]){case 255:if(s[t]!==11||s[t+1]==78&&s[t+2]==69&&s[t+3]==84&&s[t+4]==83&&s[t+5]==67&&s[t+6]==65&&s[t+7]==80&&s[t+8]==69&&s[t+9]==50&&s[t+10]==46&&s[t+11]==48&&s[t+12]==3&&s[t+13]==1&&s[t+16]==0)t+=14,b=s[t++]|s[t++]<<8,t++;else for(t+=12;;){if(!((N=s[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;case 249:if(s[t++]!==4||s[t+4]!==0)throw new Error("Invalid graphics extension block.");var w=s[t++];p=s[t++]|s[t++]<<8,v=s[t++],(1&w)==0&&(v=null),g=w>>2&7,t++;break;case 254:for(;;){if(!((N=s[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;default:throw new Error("Unknown graphic control label: 0x"+s[t-1].toString(16))}break;case 44:var C=s[t++]|s[t++]<<8,x=s[t++]|s[t++]<<8,k=s[t++]|s[t++]<<8,I=s[t++]|s[t++]<<8,G=s[t++],U=G>>6&1,nt=1<<(7&G)+1,J=a,F=h,et=!1;G>>7&&(et=!0,J=t,F=nt,t+=3*nt);var dt=t;for(t++;;){var N;if(!((N=s[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}f.push({x:C,y:x,width:k,height:I,has_local_palette:et,palette_offset:J,palette_size:F,data_offset:dt,data_length:t-dt,transparent_index:v,interlaced:!!U,delay:p,disposal:g});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+s[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return b},this.frameInfo=function(M){if(M<0||M>=f.length)throw new Error("Frame index out of range.");return f[M]},this.decodeAndBlitFrameBGRA=function(M,z){var R=this.frameInfo(M),ht=R.width*R.height,it=new Uint8Array(ht);Np(s,R.data_offset,it,ht);var ut=R.palette_offset,Q=R.transparent_index;Q===null&&(Q=256);var gt=R.width,pt=e-gt,kt=gt,T=4*(R.y*e+R.x),E=4*((R.y+R.height)*e+R.x),B=T,V=4*pt;R.interlaced===!0&&(V+=4*e*7);for(var $=8,at=0,lt=it.length;at<lt;++at){var ct=it[at];if(kt===0&&(kt=gt,(B+=V)>=E&&(V=4*pt+4*e*($-1),B=T+(gt+pt)*($<<1),$>>=1)),ct===Q)B+=4;else{var Ct=s[ut+3*ct],Lt=s[ut+3*ct+1],Dt=s[ut+3*ct+2];z[B++]=Dt,z[B++]=Lt,z[B++]=Ct,z[B++]=255}--kt}},this.decodeAndBlitFrameRGBA=function(M,z){var R=this.frameInfo(M),ht=R.width*R.height,it=new Uint8Array(ht);Np(s,R.data_offset,it,ht);var ut=R.palette_offset,Q=R.transparent_index;Q===null&&(Q=256);var gt=R.width,pt=e-gt,kt=gt,T=4*(R.y*e+R.x),E=4*((R.y+R.height)*e+R.x),B=T,V=4*pt;R.interlaced===!0&&(V+=4*e*7);for(var $=8,at=0,lt=it.length;at<lt;++at){var ct=it[at];if(kt===0&&(kt=gt,(B+=V)>=E&&(V=4*pt+4*e*($-1),B=T+(gt+pt)*($<<1),$>>=1)),ct===Q)B+=4;else{var Ct=s[ut+3*ct],Lt=s[ut+3*ct+1],Dt=s[ut+3*ct+2];z[B++]=Ct,z[B++]=Lt,z[B++]=Dt,z[B++]=255}--kt}}}function Np(s,t,e,r){for(var n=s[t++],i=1<<n,o=i+1,a=o+1,h=n+1,l=(1<<h)-1,f=0,p=0,v=0,g=s[t++],b=new Int32Array(4096),w=null;;){for(;f<16&&g!==0;)p|=s[t++]<<f,f+=8,g===1?g=s[t++]:--g;if(f<h)break;var C=p&l;if(p>>=h,f-=h,C!==i){if(C===o)break;for(var x=C<a?C:w,k=0,I=x;I>i;)I=b[I]>>8,++k;var G=I;if(v+k+(x!==C?1:0)>r)return void Pe.log("Warning, gif stream longer than expected.");e[v++]=G;var U=v+=k;for(x!==C&&(e[v++]=G),I=x;k--;)I=b[I],e[--U]=255&I,I>>=8;w!==null&&a<4096&&(b[a++]=w<<8|G,a>=l+1&&h<12&&(++h,l=l<<1|1)),w=C}else a=o+1,l=(1<<(h=n+1))-1,w=null}return v!==r&&Pe.log("Warning, gif stream shorter than expected."),e}function Gf(s){var t,e,r,n,i,o=Math.floor,a=new Array(64),h=new Array(64),l=new Array(64),f=new Array(64),p=new Array(65535),v=new Array(65535),g=new Array(64),b=new Array(64),w=[],C=0,x=7,k=new Array(64),I=new Array(64),G=new Array(64),U=new Array(256),nt=new Array(2048),J=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],F=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],et=[0,1,2,3,4,5,6,7,8,9,10,11],dt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ht=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function it(T,E){for(var B=0,V=0,$=new Array,at=1;at<=16;at++){for(var lt=1;lt<=T[at];lt++)$[E[V]]=[],$[E[V]][0]=B,$[E[V]][1]=at,V++,B++;B*=2}return $}function ut(T){for(var E=T[0],B=T[1]-1;B>=0;)E&1<<B&&(C|=1<<x),B--,--x<0&&(C==255?(Q(255),Q(0)):Q(C),x=7,C=0)}function Q(T){w.push(T)}function gt(T){Q(T>>8&255),Q(255&T)}function pt(T,E,B,V,$){for(var at,lt=$[0],ct=$[240],Ct=function(At,Tt){var Et,Mt,zt,Jt,ne,se,ce,xe,Xt,oe,Ft=0;for(Xt=0;Xt<8;++Xt){Et=At[Ft],Mt=At[Ft+1],zt=At[Ft+2],Jt=At[Ft+3],ne=At[Ft+4],se=At[Ft+5],ce=At[Ft+6];var dr=Et+(xe=At[Ft+7]),fe=Et-xe,un=Mt+ce,Ae=Mt-ce,Me=zt+se,Dn=zt-se,pe=Jt+ne,is=Jt-ne,Fe=dr+pe,fn=dr-pe,ei=un+Me,je=un-Me;At[Ft]=Fe+ei,At[Ft+4]=Fe-ei;var Zt=.707106781*(je+fn);At[Ft+2]=fn+Zt,At[Ft+6]=fn-Zt;var me=.382683433*((Fe=is+Dn)-(je=Ae+fe)),ss=.5411961*Fe+me,lr=1.306562965*je+me,En=.707106781*(ei=Dn+Ae),Fn=fe+En,Vt=fe-En;At[Ft+5]=Vt+ss,At[Ft+3]=Vt-ss,At[Ft+1]=Fn+lr,At[Ft+7]=Fn-lr,Ft+=8}for(Ft=0,Xt=0;Xt<8;++Xt){Et=At[Ft],Mt=At[Ft+8],zt=At[Ft+16],Jt=At[Ft+24],ne=At[Ft+32],se=At[Ft+40],ce=At[Ft+48];var dn=Et+(xe=At[Ft+56]),jn=Et-xe,Or=Mt+ce,rr=Mt-ce,Je=zt+se,zr=zt-se,to=Jt+ne,ri=Jt-ne,gn=dn+to,pn=dn-to,mn=Or+Je,In=Or-Je;At[Ft]=gn+mn,At[Ft+32]=gn-mn;var Zr=.707106781*(In+pn);At[Ft+16]=pn+Zr,At[Ft+48]=pn-Zr;var Bn=.382683433*((gn=ri+zr)-(In=rr+jn)),os=.5411961*gn+Bn,eo=1.306562965*In+Bn,ro=.707106781*(mn=zr+rr),no=jn+ro,io=jn-ro;At[Ft+40]=io+os,At[Ft+24]=io-os,At[Ft+8]=no+eo,At[Ft+56]=no-eo,Ft++}for(Xt=0;Xt<64;++Xt)oe=At[Xt]*Tt[Xt],g[Xt]=oe>0?oe+.5|0:oe-.5|0;return g}(T,E),Lt=0;Lt<64;++Lt)b[J[Lt]]=Ct[Lt];var Dt=b[0]-B;B=b[0],Dt==0?ut(V[0]):(ut(V[v[at=32767+Dt]]),ut(p[at]));for(var Ot=63;Ot>0&&b[Ot]==0;)Ot--;if(Ot==0)return ut(lt),B;for(var Ht,yt=1;yt<=Ot;){for(var q=yt;b[yt]==0&&yt<=Ot;)++yt;var te=yt-q;if(te>=16){Ht=te>>4;for(var qt=1;qt<=Ht;++qt)ut(ct);te&=15}at=32767+b[yt],ut($[(te<<4)+v[at]]),ut(p[at]),yt++}return Ot!=63&&ut(lt),B}function kt(T){T=Math.min(Math.max(T,1),100),i!=T&&(function(E){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],V=0;V<64;V++){var $=o((B[V]*E+50)/100);$=Math.min(Math.max($,1),255),a[J[V]]=$}for(var at=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],lt=0;lt<64;lt++){var ct=o((at[lt]*E+50)/100);ct=Math.min(Math.max(ct,1),255),h[J[lt]]=ct}for(var Ct=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Lt=0,Dt=0;Dt<8;Dt++)for(var Ot=0;Ot<8;Ot++)l[Lt]=1/(a[J[Lt]]*Ct[Dt]*Ct[Ot]*8),f[Lt]=1/(h[J[Lt]]*Ct[Dt]*Ct[Ot]*8),Lt++}(T<50?Math.floor(5e3/T):Math.floor(200-2*T)),i=T)}this.encode=function(T,E){E&&kt(E),w=new Array,C=0,x=7,gt(65496),gt(65504),gt(16),Q(74),Q(70),Q(73),Q(70),Q(0),Q(1),Q(1),Q(0),gt(1),gt(1),Q(0),Q(0),function(){gt(65499),gt(132),Q(0);for(var Mt=0;Mt<64;Mt++)Q(a[Mt]);Q(1);for(var zt=0;zt<64;zt++)Q(h[zt])}(),function(Mt,zt){gt(65472),gt(17),Q(8),gt(zt),gt(Mt),Q(3),Q(1),Q(17),Q(0),Q(2),Q(17),Q(1),Q(3),Q(17),Q(1)}(T.width,T.height),function(){gt(65476),gt(418),Q(0);for(var Mt=0;Mt<16;Mt++)Q(F[Mt+1]);for(var zt=0;zt<=11;zt++)Q(et[zt]);Q(16);for(var Jt=0;Jt<16;Jt++)Q(dt[Jt+1]);for(var ne=0;ne<=161;ne++)Q(N[ne]);Q(1);for(var se=0;se<16;se++)Q(M[se+1]);for(var ce=0;ce<=11;ce++)Q(z[ce]);Q(17);for(var xe=0;xe<16;xe++)Q(R[xe+1]);for(var Xt=0;Xt<=161;Xt++)Q(ht[Xt])}(),gt(65498),gt(12),Q(3),Q(1),Q(0),Q(2),Q(17),Q(3),Q(17),Q(0),Q(63),Q(0);var B=0,V=0,$=0;C=0,x=7,this.encode.displayName="_encode_";for(var at,lt,ct,Ct,Lt,Dt,Ot,Ht,yt,q=T.data,te=T.width,qt=T.height,At=4*te,Tt=0;Tt<qt;){for(at=0;at<At;){for(Lt=At*Tt+at,Ot=-1,Ht=0,yt=0;yt<64;yt++)Dt=Lt+(Ht=yt>>3)*At+(Ot=4*(7&yt)),Tt+Ht>=qt&&(Dt-=At*(Tt+1+Ht-qt)),at+Ot>=At&&(Dt-=at+Ot-At+4),lt=q[Dt++],ct=q[Dt++],Ct=q[Dt++],k[yt]=(nt[lt]+nt[ct+256>>0]+nt[Ct+512>>0]>>16)-128,I[yt]=(nt[lt+768>>0]+nt[ct+1024>>0]+nt[Ct+1280>>0]>>16)-128,G[yt]=(nt[lt+1280>>0]+nt[ct+1536>>0]+nt[Ct+1792>>0]>>16)-128;B=pt(k,l,B,t,r),V=pt(I,f,V,e,n),$=pt(G,f,$,e,n),at+=32}Tt+=8}if(x>=0){var Et=[];Et[1]=x+1,Et[0]=(1<<x+1)-1,ut(Et)}return gt(65497),new Uint8Array(w)},s=s||50,function(){for(var T=String.fromCharCode,E=0;E<256;E++)U[E]=T(E)}(),t=it(F,et),e=it(M,z),r=it(dt,N),n=it(R,ht),function(){for(var T=1,E=2,B=1;B<=15;B++){for(var V=T;V<E;V++)v[32767+V]=B,p[32767+V]=[],p[32767+V][1]=B,p[32767+V][0]=V;for(var $=-(E-1);$<=-T;$++)v[32767+$]=B,p[32767+$]=[],p[32767+$][1]=B,p[32767+$][0]=E-1+$;T<<=1,E<<=1}}(),function(){for(var T=0;T<256;T++)nt[T]=19595*T,nt[T+256>>0]=38470*T,nt[T+512>>0]=7471*T+32768,nt[T+768>>0]=-11059*T,nt[T+1024>>0]=-21709*T,nt[T+1280>>0]=32768*T+8421375,nt[T+1536>>0]=-27439*T,nt[T+1792>>0]=-5329*T}(),kt(s)}function On(s,t){if(this.pos=0,this.buffer=s,this.datav=new DataView(s.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Mp(s){function t(F){if(!F)throw Error("assert :P")}function e(F,et,dt){for(var N=0;4>N;N++)if(F[et+N]!=dt.charCodeAt(N))return!0;return!1}function r(F,et,dt,N,M){for(var z=0;z<M;z++)F[et+z]=dt[N+z]}function n(F,et,dt,N){for(var M=0;M<N;M++)F[et+M]=dt}function i(F){return new Int32Array(F)}function o(F,et){for(var dt=[],N=0;N<F;N++)dt.push(new et);return dt}function a(F,et){var dt=[];return function N(M,z,R){for(var ht=R[z],it=0;it<ht&&(M.push(R.length>z+1?[]:new et),!(R.length<z+1));it++)N(M[it],z+1,R)}(dt,0,F),dt}var h=function(){var F=this;function et(c,u){for(var m=1<<u-1>>>0;c&m;)m>>>=1;return m?(c&m-1)+m:c}function dt(c,u,m,y,_){t(!(y%m));do c[u+(y-=m)]=_;while(0<y)}function N(c,u,m,y,_){if(t(2328>=_),512>=_)var A=i(512);else if((A=i(_))==null)return 0;return function(L,P,O,D,Y,st){var ot,tt,xt=P,mt=1<<O,K=i(16),Z=i(16);for(t(Y!=0),t(D!=null),t(L!=null),t(0<O),tt=0;tt<Y;++tt){if(15<D[tt])return 0;++K[D[tt]]}if(K[0]==Y)return 0;for(Z[1]=0,ot=1;15>ot;++ot){if(K[ot]>1<<ot)return 0;Z[ot+1]=Z[ot]+K[ot]}for(tt=0;tt<Y;++tt)ot=D[tt],0<D[tt]&&(st[Z[ot]++]=tt);if(Z[15]==1)return(D=new M).g=0,D.value=st[0],dt(L,xt,1,mt,D),mt;var bt,_t=-1,wt=mt-1,It=0,Pt=1,Wt=1,Nt=1<<O;for(tt=0,ot=1,Y=2;ot<=O;++ot,Y<<=1){if(Pt+=Wt<<=1,0>(Wt-=K[ot]))return 0;for(;0<K[ot];--K[ot])(D=new M).g=ot,D.value=st[tt++],dt(L,xt+It,Y,Nt,D),It=et(It,ot)}for(ot=O+1,Y=2;15>=ot;++ot,Y<<=1){if(Pt+=Wt<<=1,0>(Wt-=K[ot]))return 0;for(;0<K[ot];--K[ot]){if(D=new M,(It&wt)!=_t){for(xt+=Nt,bt=1<<(_t=ot)-O;15>_t&&!(0>=(bt-=K[_t]));)++_t,bt<<=1;mt+=Nt=1<<(bt=_t-O),L[P+(_t=It&wt)].g=bt+O,L[P+_t].value=xt-P-_t}D.g=ot-O,D.value=st[tt++],dt(L,xt+(It>>O),Y,Nt,D),It=et(It,ot)}}return Pt!=2*Z[15]-1?0:mt}(c,u,m,y,_,A)}function M(){this.value=this.g=0}function z(){this.value=this.g=0}function R(){this.G=o(5,M),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ur,z)}function ht(c,u,m,y){t(c!=null),t(u!=null),t(2147483648>y),c.Ca=254,c.I=0,c.b=-8,c.Ka=0,c.oa=u,c.pa=m,c.Jd=u,c.Yc=m+y,c.Zc=4<=y?m+y-4+1:m,at(c)}function it(c,u){for(var m=0;0<u--;)m|=ct(c,128)<<u;return m}function ut(c,u){var m=it(c,u);return lt(c)?-m:m}function Q(c,u,m,y){var _,A=0;for(t(c!=null),t(u!=null),t(4294967288>y),c.Sb=y,c.Ra=0,c.u=0,c.h=0,4<y&&(y=4),_=0;_<y;++_)A+=u[m+_]<<8*_;c.Ra=A,c.bb=y,c.oa=u,c.pa=m}function gt(c){for(;8<=c.u&&c.bb<c.Sb;)c.Ra>>>=8,c.Ra+=c.oa[c.pa+c.bb]<<wo-8>>>0,++c.bb,c.u-=8;B(c)&&(c.h=1,c.u=0)}function pt(c,u){if(t(0<=u),!c.h&&u<=bo){var m=E(c)&yo[u];return c.u+=u,gt(c),m}return c.h=1,c.u=0}function kt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function T(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function E(c){return c.Ra>>>(c.u&wo-1)>>>0}function B(c){return t(c.bb<=c.Sb),c.h||c.bb==c.Sb&&c.u>wo}function V(c,u){c.u=u,c.h=B(c)}function $(c){c.u>=Pa&&(t(c.u>=Pa),gt(c))}function at(c){t(c!=null&&c.oa!=null),c.pa<c.Zc?(c.I=(c.oa[c.pa++]|c.I<<8)>>>0,c.b+=8):(t(c!=null&&c.oa!=null),c.pa<c.Yc?(c.b+=8,c.I=c.oa[c.pa++]|c.I<<8):c.Ka?c.b=0:(c.I<<=8,c.b+=8,c.Ka=1))}function lt(c){return it(c,1)}function ct(c,u){var m=c.Ca;0>c.b&&at(c);var y=c.b,_=m*u>>>8,A=(c.I>>>y>_)+0;for(A?(m-=_,c.I-=_+1<<y>>>0):m=_+1,y=m,_=0;256<=y;)_+=8,y>>=8;return y=7^_+Mr[y],c.b-=y,c.Ca=(m<<y)-1,A}function Ct(c,u,m){c[u+0]=m>>24&255,c[u+1]=m>>16&255,c[u+2]=m>>8&255,c[u+3]=m>>0&255}function Lt(c,u){return c[u+0]<<0|c[u+1]<<8}function Dt(c,u){return Lt(c,u)|c[u+2]<<16}function Ot(c,u){return Lt(c,u)|Lt(c,u+2)<<16}function Ht(c,u){var m=1<<u;return t(c!=null),t(0<u),c.X=i(m),c.X==null?0:(c.Mb=32-u,c.Xa=u,1)}function yt(c,u){t(c!=null),t(u!=null),t(c.Xa==u.Xa),r(u.X,0,c.X,0,1<<u.Xa)}function q(){this.X=[],this.Xa=this.Mb=0}function te(c,u,m,y){t(m!=null),t(y!=null);var _=m[0],A=y[0];return _==0&&(_=(c*A+u/2)/u),A==0&&(A=(u*_+c/2)/c),0>=_||0>=A?0:(m[0]=_,y[0]=A,1)}function qt(c,u){return c+(1<<u)-1>>>u}function At(c,u){return((4278255360&c)+(4278255360&u)>>>0&4278255360)+((16711935&c)+(16711935&u)>>>0&16711935)>>>0}function Tt(c,u){F[u]=function(m,y,_,A,L,P,O){var D;for(D=0;D<L;++D){var Y=F[c](P[O+D-1],_,A+D);P[O+D]=At(m[y+D],Y)}}}function Et(){this.ud=this.hd=this.jd=0}function Mt(c,u){return((4278124286&(c^u))>>>1)+(c&u)>>>0}function zt(c){return 0<=c&&256>c?c:0>c?0:255<c?255:void 0}function Jt(c,u){return zt(c+(c-u+.5>>1))}function ne(c,u,m){return Math.abs(u-m)-Math.abs(c-m)}function se(c,u,m,y,_,A,L){for(y=A[L-1],m=0;m<_;++m)A[L+m]=y=At(c[u+m],y)}function ce(c,u,m,y,_){var A;for(A=0;A<m;++A){var L=c[u+A],P=L>>8&255,O=16711935&(O=(O=16711935&L)+((P<<16)+P));y[_+A]=(4278255360&L)+O>>>0}}function xe(c,u){u.jd=c>>0&255,u.hd=c>>8&255,u.ud=c>>16&255}function Xt(c,u,m,y,_,A){var L;for(L=0;L<y;++L){var P=u[m+L],O=P>>>8,D=P,Y=255&(Y=(Y=P>>>16)+((c.jd<<24>>24)*(O<<24>>24)>>>5));D=255&(D=(D=D+((c.hd<<24>>24)*(O<<24>>24)>>>5))+((c.ud<<24>>24)*(Y<<24>>24)>>>5)),_[A+L]=(4278255360&P)+(Y<<16)+D}}function oe(c,u,m,y,_){F[u]=function(A,L,P,O,D,Y,st,ot,tt){for(O=st;O<ot;++O)for(st=0;st<tt;++st)D[Y++]=_(P[y(A[L++])])},F[c]=function(A,L,P,O,D,Y,st){var ot=8>>A.b,tt=A.Ea,xt=A.K[0],mt=A.w;if(8>ot)for(A=(1<<A.b)-1,mt=(1<<ot)-1;L<P;++L){var K,Z=0;for(K=0;K<tt;++K)K&A||(Z=y(O[D++])),Y[st++]=_(xt[Z&mt]),Z>>=ot}else F["VP8LMapColor"+m](O,D,xt,mt,Y,st,L,P,tt)}}function Ft(c,u,m,y,_){for(m=u+m;u<m;){var A=c[u++];y[_++]=A>>16&255,y[_++]=A>>8&255,y[_++]=A>>0&255}}function dr(c,u,m,y,_){for(m=u+m;u<m;){var A=c[u++];y[_++]=A>>16&255,y[_++]=A>>8&255,y[_++]=A>>0&255,y[_++]=A>>24&255}}function fe(c,u,m,y,_){for(m=u+m;u<m;){var A=(L=c[u++])>>16&240|L>>12&15,L=L>>0&240|L>>28&15;y[_++]=A,y[_++]=L}}function un(c,u,m,y,_){for(m=u+m;u<m;){var A=(L=c[u++])>>16&248|L>>13&7,L=L>>5&224|L>>3&31;y[_++]=A,y[_++]=L}}function Ae(c,u,m,y,_){for(m=u+m;u<m;){var A=c[u++];y[_++]=A>>0&255,y[_++]=A>>8&255,y[_++]=A>>16&255}}function Me(c,u,m,y,_,A){if(A==0)for(m=u+m;u<m;)Ct(y,((A=c[u++])[0]>>24|A[1]>>8&65280|A[2]<<8&16711680|A[3]<<24)>>>0),_+=32;else r(y,_,c,u,m)}function Dn(c,u){F[u][0]=F[c+"0"],F[u][1]=F[c+"1"],F[u][2]=F[c+"2"],F[u][3]=F[c+"3"],F[u][4]=F[c+"4"],F[u][5]=F[c+"5"],F[u][6]=F[c+"6"],F[u][7]=F[c+"7"],F[u][8]=F[c+"8"],F[u][9]=F[c+"9"],F[u][10]=F[c+"10"],F[u][11]=F[c+"11"],F[u][12]=F[c+"12"],F[u][13]=F[c+"13"],F[u][14]=F[c+"0"],F[u][15]=F[c+"0"]}function pe(c){return c==ru||c==nu||c==Xh||c==iu}function is(){this.eb=[],this.size=this.A=this.fb=0}function Fe(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function fn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new is,this.f.kb=new Fe,this.sd=null}function ei(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function je(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Zt(c){return alert("todo:WebPSamplerProcessPlane"),c.T}function me(c,u){var m=c.T,y=u.ba.f.RGBA,_=y.eb,A=y.fb+c.ka*y.A,L=nn[u.ba.S],P=c.y,O=c.O,D=c.f,Y=c.N,st=c.ea,ot=c.W,tt=u.cc,xt=u.dc,mt=u.Mc,K=u.Nc,Z=c.ka,bt=c.ka+c.T,_t=c.U,wt=_t+1>>1;for(Z==0?L(P,O,null,null,D,Y,st,ot,D,Y,st,ot,_,A,null,null,_t):(L(u.ec,u.fc,P,O,tt,xt,mt,K,D,Y,st,ot,_,A-y.A,_,A,_t),++m);Z+2<bt;Z+=2)tt=D,xt=Y,mt=st,K=ot,Y+=c.Rc,ot+=c.Rc,A+=2*y.A,L(P,(O+=2*c.fa)-c.fa,P,O,tt,xt,mt,K,D,Y,st,ot,_,A-y.A,_,A,_t);return O+=c.fa,c.j+bt<c.o?(r(u.ec,u.fc,P,O,_t),r(u.cc,u.dc,D,Y,wt),r(u.Mc,u.Nc,st,ot,wt),m--):1&bt||L(P,O,null,null,D,Y,st,ot,D,Y,st,ot,_,A+y.A,null,null,_t),m}function ss(c,u,m){var y=c.F,_=[c.J];if(y!=null){var A=c.U,L=u.ba.S,P=L==Yh||L==Xh;u=u.ba.f.RGBA;var O=[0],D=c.ka;O[0]=c.T,c.Kb&&(D==0?--O[0]:(--D,_[0]-=c.width),c.j+c.ka+c.T==c.o&&(O[0]=c.o-c.j-D));var Y=u.eb;D=u.fb+D*u.A,c=Oe(y,_[0],c.width,A,O,Y,D+(P?0:3),u.A),t(m==O),c&&pe(L)&&en(Y,D,P,A,O,u.A)}return 0}function lr(c){var u=c.ma,m=u.ba.S,y=11>m,_=m==Hh||m==Gh||m==Yh||m==eu||m==12||pe(m);if(u.memory=null,u.Ib=null,u.Jb=null,u.Nd=null,!La(u.Oa,c,_?11:12))return 0;if(_&&pe(m)&&St(),c.da)alert("todo:use_scaling");else{if(y){if(u.Ib=Zt,c.Kb){if(m=c.U+1>>1,u.memory=i(c.U+2*m),u.memory==null)return 0;u.ec=u.memory,u.fc=0,u.cc=u.ec,u.dc=u.fc+c.U,u.Mc=u.cc,u.Nc=u.dc+m,u.Ib=me,St()}}else alert("todo:EmitYUV");_&&(u.Jb=ss,y&&rt())}if(y&&!Dd){for(c=0;256>c;++c)c2[c]=89858*(c-128)+Jh>>Kh,f2[c]=-22014*(c-128)+Jh,u2[c]=-45773*(c-128),l2[c]=113618*(c-128)+Jh>>Kh;for(c=Fa;c<au;++c)u=76283*(c-16)+Jh>>Kh,d2[c-Fa]=Ur(u,255),g2[c-Fa]=Ur(u+8>>4,15);Dd=1}return 1}function En(c){var u=c.ma,m=c.U,y=c.T;return t(!(1&c.ka)),0>=m||0>=y?0:(m=u.Ib(c,u),u.Jb!=null&&u.Jb(c,u,m),u.Dc+=m,1)}function Fn(c){c.ma.memory=null}function Vt(c,u,m,y){return pt(c,8)!=47?0:(u[0]=pt(c,14)+1,m[0]=pt(c,14)+1,y[0]=pt(c,1),pt(c,3)!=0?0:!c.h)}function dn(c,u){if(4>c)return c+1;var m=c-2>>1;return(2+(1&c)<<m)+pt(u,m)+1}function jn(c,u){return 120<u?u-120:1<=(m=((m=K1[u-1])>>4)*c+(8-(15&m)))?m:1;var m}function Or(c,u,m){var y=E(m),_=c[u+=255&y].g-8;return 0<_&&(V(m,m.u+8),y=E(m),u+=c[u].value,u+=y&(1<<_)-1),V(m,m.u+c[u].g),c[u].value}function rr(c,u,m){return m.g+=c.g,m.value+=c.value<<u>>>0,t(8>=m.g),c.g}function Je(c,u,m){var y=c.xc;return t((u=y==0?0:c.vc[c.md*(m>>y)+(u>>y)])<c.Wb),c.Ya[u]}function zr(c,u,m,y){var _=c.ab,A=c.c*u,L=c.C;u=L+u;var P=m,O=y;for(y=c.Ta,m=c.Ua;0<_--;){var D=c.gc[_],Y=L,st=u,ot=P,tt=O,xt=(O=y,P=m,D.Ea);switch(t(Y<st),t(st<=D.nc),D.hc){case 2:Bh(ot,tt,(st-Y)*xt,O,P);break;case 0:var mt=Y,K=st,Z=O,bt=P,_t=(Nt=D).Ea;mt==0&&(Ql(ot,tt,null,null,1,Z,bt),se(ot,tt+1,0,0,_t-1,Z,bt+1),tt+=_t,bt+=_t,++mt);for(var wt=1<<Nt.b,It=wt-1,Pt=qt(_t,Nt.b),Wt=Nt.K,Nt=Nt.w+(mt>>Nt.b)*Pt;mt<K;){var de=Wt,be=Nt,le=1;for(ka(ot,tt,Z,bt-_t,1,Z,bt);le<_t;){var ae=(le&~It)+wt;ae>_t&&(ae=_t),(0,Li[de[be++]>>8&15])(ot,tt+ +le,Z,bt+le-_t,ae-le,Z,bt+le),le=ae}tt+=_t,bt+=_t,++mt&It||(Nt+=Pt)}st!=D.nc&&r(O,P-xt,O,P+(st-Y-1)*xt,xt);break;case 1:for(xt=ot,K=tt,_t=(ot=D.Ea)-(bt=ot&~(Z=(tt=1<<D.b)-1)),mt=qt(ot,D.b),wt=D.K,D=D.w+(Y>>D.b)*mt;Y<st;){for(It=wt,Pt=D,Wt=new Et,Nt=K+bt,de=K+ot;K<Nt;)xe(It[Pt++],Wt),us(Wt,xt,K,tt,O,P),K+=tt,P+=tt;K<de&&(xe(It[Pt++],Wt),us(Wt,xt,K,_t,O,P),K+=_t,P+=_t),++Y&Z||(D+=mt)}break;case 3:if(ot==O&&tt==P&&0<D.b){for(K=O,ot=xt=P+(st-Y)*xt-(bt=(st-Y)*qt(D.Ea,D.b)),tt=O,Z=P,mt=[],bt=(_t=bt)-1;0<=bt;--bt)mt[bt]=tt[Z+bt];for(bt=_t-1;0<=bt;--bt)K[ot+bt]=mt[bt];$r(D,Y,st,O,xt,O,P)}else $r(D,Y,st,ot,tt,O,P)}P=y,O=m}O!=m&&r(y,m,P,O,A)}function to(c,u){var m=c.V,y=c.Ba+c.c*c.C,_=u-c.C;if(t(u<=c.l.o),t(16>=_),0<_){var A=c.l,L=c.Ta,P=c.Ua,O=A.width;if(zr(c,_,m,y),_=P=[P],t((m=c.C)<(y=u)),t(A.v<A.va),y>A.o&&(y=A.o),m<A.j){var D=A.j-m;m=A.j,_[0]+=D*O}if(m>=y?m=0:(_[0]+=4*A.v,A.ka=m-A.j,A.U=A.va-A.v,A.T=y-m,m=1),m){if(P=P[0],11>(m=c.ca).S){var Y=m.f.RGBA,st=(y=m.S,_=A.U,A=A.T,D=Y.eb,Y.A),ot=A;for(Y=Y.fb+c.Ma*Y.A;0<ot--;){var tt=L,xt=P,mt=_,K=D,Z=Y;switch(y){case Vh:Dr(tt,xt,mt,K,Z);break;case Hh:Sr(tt,xt,mt,K,Z);break;case ru:Sr(tt,xt,mt,K,Z),en(K,Z,0,mt,1,0);break;case Sd:oi(tt,xt,mt,K,Z);break;case Gh:Me(tt,xt,mt,K,Z,1);break;case nu:Me(tt,xt,mt,K,Z,1),en(K,Z,0,mt,1,0);break;case Yh:Me(tt,xt,mt,K,Z,0);break;case Xh:Me(tt,xt,mt,K,Z,0),en(K,Z,1,mt,1,0);break;case eu:Ti(tt,xt,mt,K,Z);break;case iu:Ti(tt,xt,mt,K,Z),ke(K,Z,mt,1,0);break;case Cd:si(tt,xt,mt,K,Z);break;default:t(0)}P+=O,Y+=st}c.Ma+=A}else alert("todo:EmitRescaledRowsYUVA");t(c.Ma<=m.height)}}c.C=u,t(c.C<=c.i)}function ri(c){var u;if(0<c.ua)return 0;for(u=0;u<c.Wb;++u){var m=c.Ya[u].G,y=c.Ya[u].H;if(0<m[1][y[1]+0].g||0<m[2][y[2]+0].g||0<m[3][y[3]+0].g)return 0}return 1}function gn(c,u,m,y,_,A){if(c.Z!=0){var L=c.qd,P=c.rd;for(t(Ni[c.Z]!=null);u<m;++u)Ni[c.Z](L,P,y,_,y,_,A),L=y,P=_,_+=A;c.qd=L,c.rd=P}}function pn(c,u){var m=c.l.ma,y=m.Z==0||m.Z==1?c.l.j:c.C;if(y=c.C<y?y:c.C,t(u<=c.l.o),u>y){var _=c.l.width,A=m.ca,L=m.tb+_*y,P=c.V,O=c.Ba+c.c*y,D=c.gc;t(c.ab==1),t(D[0].hc==3),Rh(D[0],y,u,P,O,A,L),gn(m,y,u,A,L,_)}c.C=c.Ma=u}function mn(c,u,m,y,_,A,L){var P=c.$/y,O=c.$%y,D=c.m,Y=c.s,st=m+c.$,ot=st;_=m+y*_;var tt=m+y*A,xt=280+Y.ua,mt=c.Pb?P:16777216,K=0<Y.ua?Y.Wa:null,Z=Y.wc,bt=st<tt?Je(Y,O,P):null;t(c.C<A),t(tt<=_);var _t=!1;t:for(;;){for(;_t||st<tt;){var wt=0;if(P>=mt){var It=st-m;t((mt=c).Pb),mt.wd=mt.m,mt.xd=It,0<mt.s.ua&&yt(mt.s.Wa,mt.s.vb),mt=P+Z1}if(O&Z||(bt=Je(Y,O,P)),t(bt!=null),bt.Qb&&(u[st]=bt.qb,_t=!0),!_t)if($(D),bt.jc){wt=D,It=u;var Pt=st,Wt=bt.pd[E(wt)&ur-1];t(bt.jc),256>Wt.g?(V(wt,wt.u+Wt.g),It[Pt]=Wt.value,wt=0):(V(wt,wt.u+Wt.g-256),t(256<=Wt.value),wt=Wt.value),wt==0&&(_t=!0)}else wt=Or(bt.G[0],bt.H[0],D);if(D.h)break;if(_t||256>wt){if(!_t)if(bt.nd)u[st]=(bt.qb|wt<<8)>>>0;else{if($(D),_t=Or(bt.G[1],bt.H[1],D),$(D),It=Or(bt.G[2],bt.H[2],D),Pt=Or(bt.G[3],bt.H[3],D),D.h)break;u[st]=(Pt<<24|_t<<16|wt<<8|It)>>>0}if(_t=!1,++st,++O>=y&&(O=0,++P,L!=null&&P<=A&&!(P%16)&&L(c,P),K!=null))for(;ot<st;)wt=u[ot++],K.X[(506832829*wt&4294967295)>>>K.Mb]=wt}else if(280>wt){if(wt=dn(wt-256,D),It=Or(bt.G[4],bt.H[4],D),$(D),It=jn(y,It=dn(It,D)),D.h)break;if(st-m<It||_-st<wt)break t;for(Pt=0;Pt<wt;++Pt)u[st+Pt]=u[st+Pt-It];for(st+=wt,O+=wt;O>=y;)O-=y,++P,L!=null&&P<=A&&!(P%16)&&L(c,P);if(t(st<=_),O&Z&&(bt=Je(Y,O,P)),K!=null)for(;ot<st;)wt=u[ot++],K.X[(506832829*wt&4294967295)>>>K.Mb]=wt}else{if(!(wt<xt))break t;for(_t=wt-280,t(K!=null);ot<st;)wt=u[ot++],K.X[(506832829*wt&4294967295)>>>K.Mb]=wt;wt=st,t(!(_t>>>(It=K).Xa)),u[wt]=It.X[_t],_t=!0}_t||t(D.h==B(D))}if(c.Pb&&D.h&&st<_)t(c.m.h),c.a=5,c.m=c.wd,c.$=c.xd,0<c.s.ua&&yt(c.s.vb,c.s.Wa);else{if(D.h)break t;L?.(c,P>A?A:P),c.a=0,c.$=st-m}return 1}return c.a=3,0}function In(c){t(c!=null),c.vc=null,c.yc=null,c.Ya=null;var u=c.Wa;u!=null&&(u.X=null),c.vb=null,t(c!=null)}function Zr(){var c=new $l;return c==null?null:(c.a=0,c.xb=Td,Dn("Predictor","VP8LPredictors"),Dn("Predictor","VP8LPredictors_C"),Dn("PredictorAdd","VP8LPredictorsAdd"),Dn("PredictorAdd","VP8LPredictorsAdd_C"),Bh=ce,us=Xt,Dr=Ft,Sr=dr,Ti=fe,si=un,oi=Ae,F.VP8LMapColor32b=xo,F.VP8LMapColor8b=qh,c)}function Bn(c,u,m,y,_){var A=1,L=[c],P=[u],O=y.m,D=y.s,Y=null,st=0;t:for(;;){if(m)for(;A&&pt(O,1);){var ot=L,tt=P,xt=y,mt=1,K=xt.m,Z=xt.gc[xt.ab],bt=pt(K,2);if(xt.Oc&1<<bt)A=0;else{switch(xt.Oc|=1<<bt,Z.hc=bt,Z.Ea=ot[0],Z.nc=tt[0],Z.K=[null],++xt.ab,t(4>=xt.ab),bt){case 0:case 1:Z.b=pt(K,3)+2,mt=Bn(qt(Z.Ea,Z.b),qt(Z.nc,Z.b),0,xt,Z.K),Z.K=Z.K[0];break;case 3:var _t,wt=pt(K,8)+1,It=16<wt?0:4<wt?1:2<wt?2:3;if(ot[0]=qt(Z.Ea,It),Z.b=It,_t=mt=Bn(wt,1,0,xt,Z.K)){var Pt,Wt=wt,Nt=Z,de=1<<(8>>Nt.b),be=i(de);if(be==null)_t=0;else{var le=Nt.K[0],ae=Nt.w;for(be[0]=Nt.K[0][0],Pt=1;Pt<1*Wt;++Pt)be[Pt]=At(le[ae+Pt],be[Pt-1]);for(;Pt<4*de;++Pt)be[Pt]=0;Nt.K[0]=null,Nt.K[0]=be,_t=1}}mt=_t;break;case 2:break;default:t(0)}A=mt}}if(L=L[0],P=P[0],A&&pt(O,1)&&!(A=1<=(st=pt(O,4))&&11>=st)){y.a=3;break t}var Le;if(Le=A)e:{var _e,re,$e,Er=y,Qe=L,Fr=P,we=st,Vr=m,Hr=Er.m,or=Er.s,fr=[null],Ar=1,sn=0,Un=J1[we];r:for(;;){if(Vr&&pt(Hr,1)){var ar=pt(Hr,3)+2,li=qt(Qe,ar),ms=qt(Fr,ar),Lo=li*ms;if(!Bn(li,ms,0,Er,fr))break r;for(fr=fr[0],or.xc=ar,_e=0;_e<Lo;++_e){var Mi=fr[_e]>>8&65535;fr[_e]=Mi,Mi>=Ar&&(Ar=Mi+1)}}if(Hr.h)break r;for(re=0;5>re;++re){var Be=Ad[re];!re&&0<we&&(Be+=1<<we),sn<Be&&(sn=Be)}var hu=o(Ar*Un,M),jd=Ar,Id=o(jd,R);if(Id==null)var $h=null;else t(65536>=jd),$h=Id;var ja=i(sn);if($h==null||ja==null||hu==null){Er.a=1;break r}var Qh=hu;for(_e=$e=0;_e<Ar;++_e){var xn=$h[_e],To=xn.G,Po=xn.H,Bd=0,tc=1,Rd=0;for(re=0;5>re;++re){Be=Ad[re],To[re]=Qh,Po[re]=$e,!re&&0<we&&(Be+=1<<we);i:{var ec,cu=Be,rc=Er,Ia=ja,v2=Qh,y2=$e,lu=0,Di=rc.m,b2=pt(Di,1);if(n(Ia,0,0,cu),b2){var w2=pt(Di,1)+1,x2=pt(Di,1),qd=pt(Di,x2==0?1:8);Ia[qd]=1,w2==2&&(Ia[qd=pt(Di,8)]=1);var nc=1}else{var zd=i(19),Ud=pt(Di,4)+4;if(19<Ud){rc.a=3;var ic=0;break i}for(ec=0;ec<Ud;++ec)zd[X1[ec]]=pt(Di,3);var uu=void 0,Ba=void 0,Wd=rc,_2=zd,sc=cu,Vd=Ia,fu=0,Ei=Wd.m,Hd=8,Gd=o(128,M);n:for(;N(Gd,0,7,_2,19);){if(pt(Ei,1)){var S2=2+2*pt(Ei,3);if((uu=2+pt(Ei,S2))>sc)break n}else uu=sc;for(Ba=0;Ba<sc&&uu--;){$(Ei);var Yd=Gd[0+(127&E(Ei))];V(Ei,Ei.u+Yd.g);var ko=Yd.value;if(16>ko)Vd[Ba++]=ko,ko!=0&&(Hd=ko);else{var C2=ko==16,Xd=ko-16,A2=G1[Xd],Kd=pt(Ei,H1[Xd])+A2;if(Ba+Kd>sc)break n;for(var L2=C2?Hd:0;0<Kd--;)Vd[Ba++]=L2}}fu=1;break n}fu||(Wd.a=3),nc=fu}(nc=nc&&!Di.h)&&(lu=N(v2,y2,8,Ia,cu)),nc&&lu!=0?ic=lu:(rc.a=3,ic=0)}if(ic==0)break r;if(tc&&Y1[re]==1&&(tc=Qh[$e].g==0),Bd+=Qh[$e].g,$e+=ic,3>=re){var Ra,du=ja[0];for(Ra=1;Ra<Be;++Ra)ja[Ra]>du&&(du=ja[Ra]);Rd+=du}}if(xn.nd=tc,xn.Qb=0,tc&&(xn.qb=(To[3][Po[3]+0].value<<24|To[1][Po[1]+0].value<<16|To[2][Po[2]+0].value)>>>0,Bd==0&&256>To[0][Po[0]+0].value&&(xn.Qb=1,xn.qb+=To[0][Po[0]+0].value<<8)),xn.jc=!xn.Qb&&6>Rd,xn.jc){var oc,ui=xn;for(oc=0;oc<ur;++oc){var Fi=oc,ji=ui.pd[Fi],ac=ui.G[0][ui.H[0]+Fi];256<=ac.value?(ji.g=ac.g+256,ji.value=ac.value):(ji.g=0,ji.value=0,Fi>>=rr(ac,8,ji),Fi>>=rr(ui.G[1][ui.H[1]+Fi],16,ji),Fi>>=rr(ui.G[2][ui.H[2]+Fi],0,ji),rr(ui.G[3][ui.H[3]+Fi],24,ji))}}}or.vc=fr,or.Wb=Ar,or.Ya=$h,or.yc=hu,Le=1;break e}Le=0}if(!(A=Le)){y.a=3;break t}if(0<st){if(D.ua=1<<st,!Ht(D.Wa,st)){y.a=1,A=0;break t}}else D.ua=0;var gu=y,Jd=L,T2=P,pu=gu.s,mu=pu.xc;if(gu.c=Jd,gu.i=T2,pu.md=qt(Jd,mu),pu.wc=mu==0?-1:(1<<mu)-1,m){y.xb=i2;break t}if((Y=i(L*P))==null){y.a=1,A=0;break t}A=(A=mn(y,Y,0,L,P,P,null))&&!O.h;break t}return A?(_!=null?_[0]=Y:(t(Y==null),t(m)),y.$=0,m||In(D)):In(D),A}function os(c,u){var m=c.c*c.i,y=m+u+16*u;return t(c.c<=u),c.V=i(y),c.V==null?(c.Ta=null,c.Ua=0,c.a=1,0):(c.Ta=c.V,c.Ua=c.Ba+m+u,1)}function eo(c,u){var m=c.C,y=u-m,_=c.V,A=c.Ba+c.c*m;for(t(u<=c.l.o);0<y;){var L=16<y?16:y,P=c.l.ma,O=c.l.width,D=O*L,Y=P.ca,st=P.tb+O*m,ot=c.Ta,tt=c.Ua;zr(c,L,_,A),He(ot,tt,Y,st,D),gn(P,m,m+L,Y,st,O),y-=L,_+=L*c.c,m+=L}t(m==u),c.C=c.Ma=u}function ro(){this.ub=this.yd=this.td=this.Rb=0}function no(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function io(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function yh(){this.Yb=function(){var c=[];return function u(m,y,_){for(var A=_[y],L=0;L<A&&(m.push(_.length>y+1?[]:0),!(_.length<y+1));L++)u(m[L],y+1,_)}(c,0,[3,11]),c}()}function kl(){this.jb=i(3),this.Wc=a([4,8],yh),this.Xc=a([4,17],yh)}function Ol(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function so(){this.ld=this.La=this.dd=this.tc=0}function bh(){this.Na=this.la=0}function Nl(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function la(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ml(){this.uc=this.M=this.Nb=0,this.wa=Array(new so),this.Y=0,this.ya=Array(new la),this.aa=0,this.l=new oo}function wh(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Dl(){this.cb=this.a=0,this.sc="",this.m=new kt,this.Od=new ro,this.Kc=new no,this.ed=new Ol,this.Qa=new io,this.Ic=this.$c=this.Aa=0,this.D=new Ml,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,kt),this.ia=0,this.pb=o(4,Nl),this.Pa=new kl,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new wh),this.Hd=0,this.rb=Array(new bh),this.sb=0,this.wa=Array(new so),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new la),this.L=this.aa=0,this.gd=a([4,2],so),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function oo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function El(){var c=new Dl;return c!=null&&(c.a=0,c.sc="OK",c.cb=0,c.Xb=0,Ea||(Ea=Sh)),c}function We(c,u,m){return c.a==0&&(c.a=u,c.sc=m,c.cb=0),0}function xh(c,u,m){return 3<=m&&c[u+0]==157&&c[u+1]==1&&c[u+2]==42}function _h(c,u){if(c==null)return 0;if(c.a=0,c.sc="OK",u==null)return We(c,2,"null VP8Io passed to VP8GetHeaders()");var m=u.data,y=u.w,_=u.ha;if(4>_)return We(c,7,"Truncated header.");var A=m[y+0]|m[y+1]<<8|m[y+2]<<16,L=c.Od;if(L.Rb=!(1&A),L.td=A>>1&7,L.yd=A>>4&1,L.ub=A>>5,3<L.td)return We(c,3,"Incorrect keyframe parameters.");if(!L.yd)return We(c,4,"Frame not displayable.");y+=3,_-=3;var P=c.Kc;if(L.Rb){if(7>_)return We(c,7,"cannot parse picture header");if(!xh(m,y,_))return We(c,3,"Bad code word");P.c=16383&(m[y+4]<<8|m[y+3]),P.Td=m[y+4]>>6,P.i=16383&(m[y+6]<<8|m[y+5]),P.Ud=m[y+6]>>6,y+=7,_-=7,c.za=P.c+15>>4,c.Ub=P.i+15>>4,u.width=P.c,u.height=P.i,u.Da=0,u.j=0,u.v=0,u.va=u.width,u.o=u.height,u.da=0,u.ib=u.width,u.hb=u.height,u.U=u.width,u.T=u.height,n((A=c.Pa).jb,0,255,A.jb.length),t((A=c.Qa)!=null),A.Cb=0,A.Bb=0,A.Fb=1,n(A.Zb,0,0,A.Zb.length),n(A.Lb,0,0,A.Lb)}if(L.ub>_)return We(c,7,"bad partition length");ht(A=c.m,m,y,L.ub),y+=L.ub,_-=L.ub,L.Rb&&(P.Ld=lt(A),P.Kd=lt(A)),P=c.Qa;var O,D=c.Pa;if(t(A!=null),t(P!=null),P.Cb=lt(A),P.Cb){if(P.Bb=lt(A),lt(A)){for(P.Fb=lt(A),O=0;4>O;++O)P.Zb[O]=lt(A)?ut(A,7):0;for(O=0;4>O;++O)P.Lb[O]=lt(A)?ut(A,6):0}if(P.Bb)for(O=0;3>O;++O)D.jb[O]=lt(A)?it(A,8):255}else P.Bb=0;if(A.Ka)return We(c,3,"cannot parse segment header");if((P=c.ed).zd=lt(A),P.Tb=it(A,6),P.wb=it(A,3),P.Pc=lt(A),P.Pc&&lt(A)){for(D=0;4>D;++D)lt(A)&&(P.vd[D]=ut(A,6));for(D=0;4>D;++D)lt(A)&&(P.od[D]=ut(A,6))}if(c.L=P.Tb==0?0:P.zd?1:2,A.Ka)return We(c,3,"cannot parse filter header");var Y=_;if(_=O=y,y=O+Y,P=Y,c.Xb=(1<<it(c.m,2))-1,Y<3*(D=c.Xb))m=7;else{for(O+=3*D,P-=3*D,Y=0;Y<D;++Y){var st=m[_+0]|m[_+1]<<8|m[_+2]<<16;st>P&&(st=P),ht(c.Jc[+Y],m,O,st),O+=st,P-=st,_+=3}ht(c.Jc[+D],m,O,P),m=O<y?0:5}if(m!=0)return We(c,m,"cannot parse partitions");for(m=it(O=c.m,7),_=lt(O)?ut(O,4):0,y=lt(O)?ut(O,4):0,P=lt(O)?ut(O,4):0,D=lt(O)?ut(O,4):0,O=lt(O)?ut(O,4):0,Y=c.Qa,st=0;4>st;++st){if(Y.Cb){var ot=Y.Zb[st];Y.Fb||(ot+=m)}else{if(0<st){c.pb[st]=c.pb[0];continue}ot=m}var tt=c.pb[st];tt.Sc[0]=su[Ur(ot+_,127)],tt.Sc[1]=ou[Ur(ot+0,127)],tt.Eb[0]=2*su[Ur(ot+y,127)],tt.Eb[1]=101581*ou[Ur(ot+P,127)]>>16,8>tt.Eb[1]&&(tt.Eb[1]=8),tt.Qc[0]=su[Ur(ot+D,117)],tt.Qc[1]=ou[Ur(ot+O,127)],tt.lc=ot+O}if(!L.Rb)return We(c,4,"Not a key frame.");for(lt(A),L=c.Pa,m=0;4>m;++m){for(_=0;8>_;++_)for(y=0;3>y;++y)for(P=0;11>P;++P)D=ct(A,r2[m][_][y][P])?it(A,8):t2[m][_][y][P],L.Wc[m][_].Yb[y][P]=D;for(_=0;17>_;++_)L.Xc[m][_]=L.Wc[m][n2[_]]}return c.kc=lt(A),c.kc&&(c.Bd=it(A,8)),c.cb=1}function Sh(c,u,m,y,_,A,L){var P=u[_].Yb[m];for(m=0;16>_;++_){if(!ct(c,P[m+0]))return _;for(;!ct(c,P[m+1]);)if(P=u[++_].Yb[0],m=0,_==16)return 16;var O=u[_+1].Yb;if(ct(c,P[m+2])){var D=c,Y=0;if(ct(D,(ot=P)[(st=m)+3]))if(ct(D,ot[st+6])){for(P=0,st=2*(Y=ct(D,ot[st+8]))+(ot=ct(D,ot[st+9+Y])),Y=0,ot=$1[st];ot[P];++P)Y+=Y+ct(D,ot[P]);Y+=3+(8<<st)}else ct(D,ot[st+7])?(Y=7+2*ct(D,165),Y+=ct(D,145)):Y=5+ct(D,159);else Y=ct(D,ot[st+4])?3+ct(D,ot[st+5]):2;P=O[2]}else Y=1,P=O[1];O=L+Q1[_],0>(D=c).b&&at(D);var st,ot=D.b,tt=(st=D.Ca>>1)-(D.I>>ot)>>31;--D.b,D.Ca+=tt,D.Ca|=1,D.I-=(st+1&tt)<<ot,A[O]=((Y^tt)-tt)*y[(0<_)+0]}return 16}function ua(c){var u=c.rb[c.sb-1];u.la=0,u.Na=0,n(c.zc,0,0,c.zc.length),c.ja=0}function Fl(c,u){if(c==null)return 0;if(u==null)return We(c,2,"NULL VP8Io parameter in VP8Decode().");if(!c.cb&&!_h(c,u))return 0;if(t(c.cb),u.ac==null||u.ac(u)){u.ob&&(c.L=0);var m=Zh[c.L];if(c.L==2?(c.yb=0,c.zb=0):(c.yb=u.v-m>>4,c.zb=u.j-m>>4,0>c.yb&&(c.yb=0),0>c.zb&&(c.zb=0)),c.Va=u.o+15+m>>4,c.Hb=u.va+15+m>>4,c.Hb>c.za&&(c.Hb=c.za),c.Va>c.Ub&&(c.Va=c.Ub),0<c.L){var y=c.ed;for(m=0;4>m;++m){var _;if(c.Qa.Cb){var A=c.Qa.Lb[m];c.Qa.Fb||(A+=y.Tb)}else A=y.Tb;for(_=0;1>=_;++_){var L=c.gd[m][_],P=A;if(y.Pc&&(P+=y.vd[0],_&&(P+=y.od[0])),0<(P=0>P?0:63<P?63:P)){var O=P;0<y.wb&&(O=4<y.wb?O>>2:O>>1)>9-y.wb&&(O=9-y.wb),1>O&&(O=1),L.dd=O,L.tc=2*P+O,L.ld=40<=P?2:15<=P?1:0}else L.tc=0;L.La=_}}}m=0}else We(c,6,"Frame setup failed"),m=c.a;if(m=m==0){if(m){c.$c=0,0<c.Aa||(c.Ic=m2);t:{m=c.Ic,y=4*(O=c.za);var D=32*O,Y=O+1,st=0<c.L?O*(0<c.Aa?2:1):0,ot=(c.Aa==2?2:1)*O;if((L=y+832+(_=3*(16*m+Zh[c.L])/2*D)+(A=c.Fa!=null&&0<c.Fa.length?c.Kc.c*c.Kc.i:0))!=L)m=0;else{if(L>c.Vb){if(c.Vb=0,c.Ec=i(L),c.Fc=0,c.Ec==null){m=We(c,1,"no memory during frame initialization.");break t}c.Vb=L}L=c.Ec,P=c.Fc,c.Ac=L,c.Bc=P,P+=y,c.Gd=o(D,wh),c.Hd=0,c.rb=o(Y+1,bh),c.sb=1,c.wa=st?o(st,so):null,c.Y=0,c.D.Nb=0,c.D.wa=c.wa,c.D.Y=c.Y,0<c.Aa&&(c.D.Y+=O),t(!0),c.oc=L,c.pc=P,P+=832,c.ya=o(ot,la),c.aa=0,c.D.ya=c.ya,c.D.aa=c.aa,c.Aa==2&&(c.D.aa+=O),c.R=16*O,c.B=8*O,O=(D=Zh[c.L])*c.R,D=D/2*c.B,c.sa=L,c.ta=P+O,c.qa=c.sa,c.ra=c.ta+16*m*c.R+D,c.Ha=c.qa,c.Ia=c.ra+8*m*c.B+D,c.$c=0,P+=_,c.mb=A?L:null,c.nb=A?P:null,t(P+A<=c.Fc+c.Vb),ua(c),n(c.Ac,c.Bc,0,y),m=1}}if(m){if(u.ka=0,u.y=c.sa,u.O=c.ta,u.f=c.qa,u.N=c.ra,u.ea=c.Ha,u.Vd=c.Ia,u.fa=c.R,u.Rc=c.B,u.F=null,u.J=0,!Uh){for(m=-255;255>=m;++m)nr[255+m]=0>m?-m:m;for(m=-1020;1020>=m;++m)hi[1020+m]=-128>m?-128:127<m?127:m;for(m=-112;112>=m;++m)Da[112+m]=-16>m?-16:15<m?15:m;for(m=-255;510>=m;++m)Ao[255+m]=0>m?0:255<m?255:m;Uh=1}_o=Bl,ai=jl,Oa=Ah,Cr=Il,Qr=Lh,Ve=Ch,So=va,zh=cs,Na=Zl,fs=ya,ds=Jl,Pi=fo,gs=ba,Co=Fh,ps=Eh,ki=qn,Ma=ii,tn=Kl,wn[0]=Rn,wn[1]=Rl,wn[2]=Wl,wn[3]=Vl,wn[4]=kh,wn[5]=lo,wn[6]=Oh,wn[7]=ga,wn[8]=Gl,wn[9]=Hl,Oi[0]=Th,Oi[1]=zl,Oi[2]=ni,Oi[3]=ho,Oi[4]=gr,Oi[5]=Ul,Oi[6]=Ph,ci[0]=Si,ci[1]=ql,ci[2]=Yl,ci[3]=pa,ci[4]=hs,ci[5]=Xl,ci[6]=ma,m=1}else m=0}m&&(m=function(tt,xt){for(tt.M=0;tt.M<tt.Va;++tt.M){var mt,K=tt.Jc[tt.M&tt.Xb],Z=tt.m,bt=tt;for(mt=0;mt<bt.za;++mt){var _t=Z,wt=bt,It=wt.Ac,Pt=wt.Bc+4*mt,Wt=wt.zc,Nt=wt.ya[wt.aa+mt];if(wt.Qa.Bb?Nt.$b=ct(_t,wt.Pa.jb[0])?2+ct(_t,wt.Pa.jb[2]):ct(_t,wt.Pa.jb[1]):Nt.$b=0,wt.kc&&(Nt.Ad=ct(_t,wt.Bd)),Nt.Za=!ct(_t,145)+0,Nt.Za){var de=Nt.Ob,be=0;for(wt=0;4>wt;++wt){var le,ae=Wt[0+wt];for(le=0;4>le;++le){ae=e2[It[Pt+le]][ae];for(var Le=Ld[ct(_t,ae[0])];0<Le;)Le=Ld[2*Le+ct(_t,ae[Le])];ae=-Le,It[Pt+le]=ae}r(de,be,It,Pt,4),be+=4,Wt[0+wt]=ae}}else ae=ct(_t,156)?ct(_t,128)?1:3:ct(_t,163)?2:0,Nt.Ob[0]=ae,n(It,Pt,ae,4),n(Wt,0,ae,4);Nt.Dd=ct(_t,142)?ct(_t,114)?ct(_t,183)?1:3:2:0}if(bt.m.Ka)return We(tt,7,"Premature end-of-partition0 encountered.");for(;tt.ja<tt.za;++tt.ja){if(bt=K,_t=(Z=tt).rb[Z.sb-1],It=Z.rb[Z.sb+Z.ja],mt=Z.ya[Z.aa+Z.ja],Pt=Z.kc?mt.Ad:0)_t.la=It.la=0,mt.Za||(_t.Na=It.Na=0),mt.Hc=0,mt.Gc=0,mt.ia=0;else{var _e,re;if(_t=It,It=bt,Pt=Z.Pa.Xc,Wt=Z.ya[Z.aa+Z.ja],Nt=Z.pb[Wt.$b],wt=Wt.ad,de=0,be=Z.rb[Z.sb-1],ae=le=0,n(wt,de,0,384),Wt.Za)var $e=0,Er=Pt[3];else{Le=i(16);var Qe=_t.Na+be.Na;if(Qe=Ea(It,Pt[1],Qe,Nt.Eb,0,Le,0),_t.Na=be.Na=(0<Qe)+0,1<Qe)_o(Le,0,wt,de);else{var Fr=Le[0]+3>>3;for(Le=0;256>Le;Le+=16)wt[de+Le]=Fr}$e=1,Er=Pt[0]}var we=15&_t.la,Vr=15&be.la;for(Le=0;4>Le;++Le){var Hr=1&Vr;for(Fr=re=0;4>Fr;++Fr)we=we>>1|(Hr=(Qe=Ea(It,Er,Qe=Hr+(1&we),Nt.Sc,$e,wt,de))>$e)<<7,re=re<<2|(3<Qe?3:1<Qe?2:wt[de+0]!=0),de+=16;we>>=4,Vr=Vr>>1|Hr<<7,le=(le<<8|re)>>>0}for(Er=we,$e=Vr>>4,_e=0;4>_e;_e+=2){for(re=0,we=_t.la>>4+_e,Vr=be.la>>4+_e,Le=0;2>Le;++Le){for(Hr=1&Vr,Fr=0;2>Fr;++Fr)Qe=Hr+(1&we),we=we>>1|(Hr=0<(Qe=Ea(It,Pt[2],Qe,Nt.Qc,0,wt,de)))<<3,re=re<<2|(3<Qe?3:1<Qe?2:wt[de+0]!=0),de+=16;we>>=2,Vr=Vr>>1|Hr<<5}ae|=re<<4*_e,Er|=we<<4<<_e,$e|=(240&Vr)<<_e}_t.la=Er,be.la=$e,Wt.Hc=le,Wt.Gc=ae,Wt.ia=43690&ae?0:Nt.ia,Pt=!(le|ae)}if(0<Z.L&&(Z.wa[Z.Y+Z.ja]=Z.gd[mt.$b][mt.Za],Z.wa[Z.Y+Z.ja].La|=!Pt),bt.Ka)return We(tt,7,"Premature end-of-file encountered.")}if(ua(tt),Z=xt,bt=1,mt=(K=tt).D,_t=0<K.L&&K.M>=K.zb&&K.M<=K.Va,K.Aa==0)t:{if(mt.M=K.M,mt.uc=_t,Aa(K,mt),bt=1,mt=(re=K.D).Nb,_t=(ae=Zh[K.L])*K.R,It=ae/2*K.B,Le=16*mt*K.R,Fr=8*mt*K.B,Pt=K.sa,Wt=K.ta-_t+Le,Nt=K.qa,wt=K.ra-It+Fr,de=K.Ha,be=K.Ia-It+Fr,Vr=(we=re.M)==0,le=we>=K.Va-1,K.Aa==2&&Aa(K,re),re.uc)for(Hr=(Qe=K).D.M,t(Qe.D.uc),re=Qe.yb;re<Qe.Hb;++re){$e=re,Er=Hr;var or=(fr=(Be=Qe).D).Nb;_e=Be.R;var fr=fr.wa[fr.Y+$e],Ar=Be.sa,sn=Be.ta+16*or*_e+16*$e,Un=fr.dd,ar=fr.tc;if(ar!=0)if(t(3<=ar),Be.L==1)0<$e&&ki(Ar,sn,_e,ar+4),fr.La&&tn(Ar,sn,_e,ar),0<Er&&ps(Ar,sn,_e,ar+4),fr.La&&Ma(Ar,sn,_e,ar);else{var li=Be.B,ms=Be.qa,Lo=Be.ra+8*or*li+8*$e,Mi=Be.Ha,Be=Be.Ia+8*or*li+8*$e;or=fr.ld,0<$e&&(zh(Ar,sn,_e,ar+4,Un,or),fs(ms,Lo,Mi,Be,li,ar+4,Un,or)),fr.La&&(Pi(Ar,sn,_e,ar,Un,or),Co(ms,Lo,Mi,Be,li,ar,Un,or)),0<Er&&(So(Ar,sn,_e,ar+4,Un,or),Na(ms,Lo,Mi,Be,li,ar+4,Un,or)),fr.La&&(ds(Ar,sn,_e,ar,Un,or),gs(ms,Lo,Mi,Be,li,ar,Un,or))}}if(K.ia&&alert("todo:DitherRow"),Z.put!=null){if(re=16*we,we=16*(we+1),Vr?(Z.y=K.sa,Z.O=K.ta+Le,Z.f=K.qa,Z.N=K.ra+Fr,Z.ea=K.Ha,Z.W=K.Ia+Fr):(re-=ae,Z.y=Pt,Z.O=Wt,Z.f=Nt,Z.N=wt,Z.ea=de,Z.W=be),le||(we-=ae),we>Z.o&&(we=Z.o),Z.F=null,Z.J=null,K.Fa!=null&&0<K.Fa.length&&re<we&&(Z.J=Sa(K,Z,re,we-re),Z.F=K.mb,Z.F==null&&Z.F.length==0)){bt=We(K,3,"Could not decode alpha data.");break t}re<Z.j&&(ae=Z.j-re,re=Z.j,t(!(1&ae)),Z.O+=K.R*ae,Z.N+=K.B*(ae>>1),Z.W+=K.B*(ae>>1),Z.F!=null&&(Z.J+=Z.width*ae)),re<we&&(Z.O+=Z.v,Z.N+=Z.v>>1,Z.W+=Z.v>>1,Z.F!=null&&(Z.J+=Z.v),Z.ka=re-Z.j,Z.U=Z.va-Z.v,Z.T=we-re,bt=Z.put(Z))}mt+1!=K.Ic||le||(r(K.sa,K.ta-_t,Pt,Wt+16*K.R,_t),r(K.qa,K.ra-It,Nt,wt+8*K.B,It),r(K.Ha,K.Ia-It,de,be+8*K.B,It))}if(!bt)return We(tt,6,"Output aborted.")}return 1}(c,u)),u.bc!=null&&u.bc(u),m&=1}return m?(c.cb=0,m):0}function vn(c,u,m,y,_){_=c[u+m+32*y]+(_>>3),c[u+m+32*y]=-256&_?0>_?0:255:_}function ao(c,u,m,y,_,A){vn(c,u,0,m,y+_),vn(c,u,1,m,y+A),vn(c,u,2,m,y-A),vn(c,u,3,m,y-_)}function Nr(c){return(20091*c>>16)+c}function fa(c,u,m,y){var _,A=0,L=i(16);for(_=0;4>_;++_){var P=c[u+0]+c[u+8],O=c[u+0]-c[u+8],D=(35468*c[u+4]>>16)-Nr(c[u+12]),Y=Nr(c[u+4])+(35468*c[u+12]>>16);L[A+0]=P+Y,L[A+1]=O+D,L[A+2]=O-D,L[A+3]=P-Y,A+=4,u++}for(_=A=0;4>_;++_)P=(c=L[A+0]+4)+L[A+8],O=c-L[A+8],D=(35468*L[A+4]>>16)-Nr(L[A+12]),vn(m,y,0,0,P+(Y=Nr(L[A+4])+(35468*L[A+12]>>16))),vn(m,y,1,0,O+D),vn(m,y,2,0,O-D),vn(m,y,3,0,P-Y),A++,y+=32}function Ch(c,u,m,y){var _=c[u+0]+4,A=35468*c[u+4]>>16,L=Nr(c[u+4]),P=35468*c[u+1]>>16;ao(m,y,0,_+L,c=Nr(c[u+1]),P),ao(m,y,1,_+A,c,P),ao(m,y,2,_-A,c,P),ao(m,y,3,_-L,c,P)}function jl(c,u,m,y,_){fa(c,u,m,y),_&&fa(c,u+16,m,y+4)}function Ah(c,u,m,y){ai(c,u+0,m,y,1),ai(c,u+32,m,y+128,1)}function Il(c,u,m,y){var _;for(c=c[u+0]+4,_=0;4>_;++_)for(u=0;4>u;++u)vn(m,y,u,_,c)}function Lh(c,u,m,y){c[u+0]&&Cr(c,u+0,m,y),c[u+16]&&Cr(c,u+16,m,y+4),c[u+32]&&Cr(c,u+32,m,y+128),c[u+48]&&Cr(c,u+48,m,y+128+4)}function Bl(c,u,m,y){var _,A=i(16);for(_=0;4>_;++_){var L=c[u+0+_]+c[u+12+_],P=c[u+4+_]+c[u+8+_],O=c[u+4+_]-c[u+8+_],D=c[u+0+_]-c[u+12+_];A[0+_]=L+P,A[8+_]=L-P,A[4+_]=D+O,A[12+_]=D-O}for(_=0;4>_;++_)L=(c=A[0+4*_]+3)+A[3+4*_],P=A[1+4*_]+A[2+4*_],O=A[1+4*_]-A[2+4*_],D=c-A[3+4*_],m[y+0]=L+P>>3,m[y+16]=D+O>>3,m[y+32]=L-P>>3,m[y+48]=D-O>>3,y+=64}function da(c,u,m){var y,_=u-32,A=Wr,L=255-c[_-1];for(y=0;y<m;++y){var P,O=A,D=L+c[u-1];for(P=0;P<m;++P)c[u+P]=O[D+c[_+P]];u+=32}}function Rl(c,u){da(c,u,4)}function ql(c,u){da(c,u,8)}function zl(c,u){da(c,u,16)}function ni(c,u){var m;for(m=0;16>m;++m)r(c,u+32*m,c,u-32,16)}function ho(c,u){var m;for(m=16;0<m;--m)n(c,u,c[u-1],16),u+=32}function co(c,u,m){var y;for(y=0;16>y;++y)n(u,m+32*y,c,16)}function Th(c,u){var m,y=16;for(m=0;16>m;++m)y+=c[u-1+32*m]+c[u+m-32];co(y>>5,c,u)}function gr(c,u){var m,y=8;for(m=0;16>m;++m)y+=c[u-1+32*m];co(y>>4,c,u)}function Ul(c,u){var m,y=8;for(m=0;16>m;++m)y+=c[u+m-32];co(y>>4,c,u)}function Ph(c,u){co(128,c,u)}function Kt(c,u,m){return c+2*u+m+2>>2}function Wl(c,u){var m,y=u-32;for(y=new Uint8Array([Kt(c[y-1],c[y+0],c[y+1]),Kt(c[y+0],c[y+1],c[y+2]),Kt(c[y+1],c[y+2],c[y+3]),Kt(c[y+2],c[y+3],c[y+4])]),m=0;4>m;++m)r(c,u+32*m,y,0,y.length)}function Vl(c,u){var m=c[u-1],y=c[u-1+32],_=c[u-1+64],A=c[u-1+96];Ct(c,u+0,16843009*Kt(c[u-1-32],m,y)),Ct(c,u+32,16843009*Kt(m,y,_)),Ct(c,u+64,16843009*Kt(y,_,A)),Ct(c,u+96,16843009*Kt(_,A,A))}function Rn(c,u){var m,y=4;for(m=0;4>m;++m)y+=c[u+m-32]+c[u-1+32*m];for(y>>=3,m=0;4>m;++m)n(c,u+32*m,y,4)}function kh(c,u){var m=c[u-1+0],y=c[u-1+32],_=c[u-1+64],A=c[u-1-32],L=c[u+0-32],P=c[u+1-32],O=c[u+2-32],D=c[u+3-32];c[u+0+96]=Kt(y,_,c[u-1+96]),c[u+1+96]=c[u+0+64]=Kt(m,y,_),c[u+2+96]=c[u+1+64]=c[u+0+32]=Kt(A,m,y),c[u+3+96]=c[u+2+64]=c[u+1+32]=c[u+0+0]=Kt(L,A,m),c[u+3+64]=c[u+2+32]=c[u+1+0]=Kt(P,L,A),c[u+3+32]=c[u+2+0]=Kt(O,P,L),c[u+3+0]=Kt(D,O,P)}function Oh(c,u){var m=c[u+1-32],y=c[u+2-32],_=c[u+3-32],A=c[u+4-32],L=c[u+5-32],P=c[u+6-32],O=c[u+7-32];c[u+0+0]=Kt(c[u+0-32],m,y),c[u+1+0]=c[u+0+32]=Kt(m,y,_),c[u+2+0]=c[u+1+32]=c[u+0+64]=Kt(y,_,A),c[u+3+0]=c[u+2+32]=c[u+1+64]=c[u+0+96]=Kt(_,A,L),c[u+3+32]=c[u+2+64]=c[u+1+96]=Kt(A,L,P),c[u+3+64]=c[u+2+96]=Kt(L,P,O),c[u+3+96]=Kt(P,O,O)}function lo(c,u){var m=c[u-1+0],y=c[u-1+32],_=c[u-1+64],A=c[u-1-32],L=c[u+0-32],P=c[u+1-32],O=c[u+2-32],D=c[u+3-32];c[u+0+0]=c[u+1+64]=A+L+1>>1,c[u+1+0]=c[u+2+64]=L+P+1>>1,c[u+2+0]=c[u+3+64]=P+O+1>>1,c[u+3+0]=O+D+1>>1,c[u+0+96]=Kt(_,y,m),c[u+0+64]=Kt(y,m,A),c[u+0+32]=c[u+1+96]=Kt(m,A,L),c[u+1+32]=c[u+2+96]=Kt(A,L,P),c[u+2+32]=c[u+3+96]=Kt(L,P,O),c[u+3+32]=Kt(P,O,D)}function ga(c,u){var m=c[u+0-32],y=c[u+1-32],_=c[u+2-32],A=c[u+3-32],L=c[u+4-32],P=c[u+5-32],O=c[u+6-32],D=c[u+7-32];c[u+0+0]=m+y+1>>1,c[u+1+0]=c[u+0+64]=y+_+1>>1,c[u+2+0]=c[u+1+64]=_+A+1>>1,c[u+3+0]=c[u+2+64]=A+L+1>>1,c[u+0+32]=Kt(m,y,_),c[u+1+32]=c[u+0+96]=Kt(y,_,A),c[u+2+32]=c[u+1+96]=Kt(_,A,L),c[u+3+32]=c[u+2+96]=Kt(A,L,P),c[u+3+64]=Kt(L,P,O),c[u+3+96]=Kt(P,O,D)}function Hl(c,u){var m=c[u-1+0],y=c[u-1+32],_=c[u-1+64],A=c[u-1+96];c[u+0+0]=m+y+1>>1,c[u+2+0]=c[u+0+32]=y+_+1>>1,c[u+2+32]=c[u+0+64]=_+A+1>>1,c[u+1+0]=Kt(m,y,_),c[u+3+0]=c[u+1+32]=Kt(y,_,A),c[u+3+32]=c[u+1+64]=Kt(_,A,A),c[u+3+64]=c[u+2+64]=c[u+0+96]=c[u+1+96]=c[u+2+96]=c[u+3+96]=A}function Gl(c,u){var m=c[u-1+0],y=c[u-1+32],_=c[u-1+64],A=c[u-1+96],L=c[u-1-32],P=c[u+0-32],O=c[u+1-32],D=c[u+2-32];c[u+0+0]=c[u+2+32]=m+L+1>>1,c[u+0+32]=c[u+2+64]=y+m+1>>1,c[u+0+64]=c[u+2+96]=_+y+1>>1,c[u+0+96]=A+_+1>>1,c[u+3+0]=Kt(P,O,D),c[u+2+0]=Kt(L,P,O),c[u+1+0]=c[u+3+32]=Kt(m,L,P),c[u+1+32]=c[u+3+64]=Kt(y,m,L),c[u+1+64]=c[u+3+96]=Kt(_,y,m),c[u+1+96]=Kt(A,_,y)}function Yl(c,u){var m;for(m=0;8>m;++m)r(c,u+32*m,c,u-32,8)}function pa(c,u){var m;for(m=0;8>m;++m)n(c,u,c[u-1],8),u+=32}function as(c,u,m){var y;for(y=0;8>y;++y)n(u,m+32*y,c,8)}function Si(c,u){var m,y=8;for(m=0;8>m;++m)y+=c[u+m-32]+c[u-1+32*m];as(y>>4,c,u)}function Xl(c,u){var m,y=4;for(m=0;8>m;++m)y+=c[u+m-32];as(y>>3,c,u)}function hs(c,u){var m,y=4;for(m=0;8>m;++m)y+=c[u-1+32*m];as(y>>3,c,u)}function ma(c,u){as(128,c,u)}function uo(c,u,m){var y=c[u-m],_=c[u+0],A=3*(_-y)+tu[1020+c[u-2*m]-c[u+m]],L=Wh[112+(A+4>>3)];c[u-m]=Wr[255+y+Wh[112+(A+3>>3)]],c[u+0]=Wr[255+_-L]}function Nh(c,u,m,y){var _=c[u+0],A=c[u+m];return rn[255+c[u-2*m]-c[u-m]]>y||rn[255+A-_]>y}function Mh(c,u,m,y){return 4*rn[255+c[u-m]-c[u+0]]+rn[255+c[u-2*m]-c[u+m]]<=y}function Dh(c,u,m,y,_){var A=c[u-3*m],L=c[u-2*m],P=c[u-m],O=c[u+0],D=c[u+m],Y=c[u+2*m],st=c[u+3*m];return 4*rn[255+P-O]+rn[255+L-D]>y?0:rn[255+c[u-4*m]-A]<=_&&rn[255+A-L]<=_&&rn[255+L-P]<=_&&rn[255+st-Y]<=_&&rn[255+Y-D]<=_&&rn[255+D-O]<=_}function Eh(c,u,m,y){var _=2*y+1;for(y=0;16>y;++y)Mh(c,u+y,m,_)&&uo(c,u+y,m)}function qn(c,u,m,y){var _=2*y+1;for(y=0;16>y;++y)Mh(c,u+y*m,1,_)&&uo(c,u+y*m,1)}function ii(c,u,m,y){var _;for(_=3;0<_;--_)Eh(c,u+=4*m,m,y)}function Kl(c,u,m,y){var _;for(_=3;0<_;--_)qn(c,u+=4,m,y)}function Ci(c,u,m,y,_,A,L,P){for(A=2*A+1;0<_--;){if(Dh(c,u,m,A,L))if(Nh(c,u,m,P))uo(c,u,m);else{var O=c,D=u,Y=m,st=O[D-2*Y],ot=O[D-Y],tt=O[D+0],xt=O[D+Y],mt=O[D+2*Y],K=27*(bt=tu[1020+3*(tt-ot)+tu[1020+st-xt]])+63>>7,Z=18*bt+63>>7,bt=9*bt+63>>7;O[D-3*Y]=Wr[255+O[D-3*Y]+bt],O[D-2*Y]=Wr[255+st+Z],O[D-Y]=Wr[255+ot+K],O[D+0]=Wr[255+tt-K],O[D+Y]=Wr[255+xt-Z],O[D+2*Y]=Wr[255+mt-bt]}u+=y}}function yn(c,u,m,y,_,A,L,P){for(A=2*A+1;0<_--;){if(Dh(c,u,m,A,L))if(Nh(c,u,m,P))uo(c,u,m);else{var O=c,D=u,Y=m,st=O[D-Y],ot=O[D+0],tt=O[D+Y],xt=Wh[112+((mt=3*(ot-st))+4>>3)],mt=Wh[112+(mt+3>>3)],K=xt+1>>1;O[D-2*Y]=Wr[255+O[D-2*Y]+K],O[D-Y]=Wr[255+st+mt],O[D+0]=Wr[255+ot-xt],O[D+Y]=Wr[255+tt-K]}u+=y}}function va(c,u,m,y,_,A){Ci(c,u,m,1,16,y,_,A)}function cs(c,u,m,y,_,A){Ci(c,u,1,m,16,y,_,A)}function Jl(c,u,m,y,_,A){var L;for(L=3;0<L;--L)yn(c,u+=4*m,m,1,16,y,_,A)}function fo(c,u,m,y,_,A){var L;for(L=3;0<L;--L)yn(c,u+=4,1,m,16,y,_,A)}function Zl(c,u,m,y,_,A,L,P){Ci(c,u,_,1,8,A,L,P),Ci(m,y,_,1,8,A,L,P)}function ya(c,u,m,y,_,A,L,P){Ci(c,u,1,_,8,A,L,P),Ci(m,y,1,_,8,A,L,P)}function ba(c,u,m,y,_,A,L,P){yn(c,u+4*_,_,1,8,A,L,P),yn(m,y+4*_,_,1,8,A,L,P)}function Fh(c,u,m,y,_,A,L,P){yn(c,u+4,1,_,8,A,L,P),yn(m,y+4,1,_,8,A,L,P)}function go(){this.ba=new fn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new je,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function wa(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function xa(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function jh(){this.ua=0,this.Wa=new q,this.vb=new q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new R,this.yc=new M}function $l(){this.xb=this.a=0,this.l=new oo,this.ca=new fn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new T,this.Pb=0,this.wd=new T,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new jh,this.ab=0,this.gc=o(4,xa),this.Oc=0}function po(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new oo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ls(c,u,m,y,_,A,L){for(c=c==null?0:c[u+0],u=0;u<L;++u)_[A+u]=c+m[y+u]&255,c=_[A+u]}function _a(c,u,m,y,_,A,L){var P;if(c==null)ls(null,null,m,y,_,A,L);else for(P=0;P<L;++P)_[A+P]=c[u+P]+m[y+P]&255}function Ai(c,u,m,y,_,A,L){if(c==null)ls(null,null,m,y,_,A,L);else{var P,O=c[u+0],D=O,Y=O;for(P=0;P<L;++P)D=Y+(O=c[u+P])-D,Y=m[y+P]+(-256&D?0>D?0:255:D)&255,D=O,_[A+P]=Y}}function Sa(c,u,m,y){var _=u.width,A=u.o;if(t(c!=null&&u!=null),0>m||0>=y||m+y>A)return null;if(!c.Cc){if(c.ga==null){var L;if(c.ga=new po,(L=c.ga==null)||(L=u.width*u.o,t(c.Gb.length==0),c.Gb=i(L),c.Uc=0,c.Gb==null?L=0:(c.mb=c.Gb,c.nb=c.Uc,c.rc=null,L=1),L=!L),!L){L=c.ga;var P=c.Fa,O=c.P,D=c.qc,Y=c.mb,st=c.nb,ot=O+1,tt=D-1,xt=L.l;if(t(P!=null&&Y!=null&&u!=null),Ni[0]=null,Ni[1]=ls,Ni[2]=_a,Ni[3]=Ai,L.ca=Y,L.tb=st,L.c=u.width,L.i=u.height,t(0<L.c&&0<L.i),1>=D)u=0;else if(L.$a=P[O+0]>>0&3,L.Z=P[O+0]>>2&3,L.Lc=P[O+0]>>4&3,O=P[O+0]>>6&3,0>L.$a||1<L.$a||4<=L.Z||1<L.Lc||O)u=0;else if(xt.put=En,xt.ac=lr,xt.bc=Fn,xt.ma=L,xt.width=u.width,xt.height=u.height,xt.Da=u.Da,xt.v=u.v,xt.va=u.va,xt.j=u.j,xt.o=u.o,L.$a)t:{t(L.$a==1),u=Zr();e:for(;;){if(u==null){u=0;break t}if(t(L!=null),L.mc=u,u.c=L.c,u.i=L.i,u.l=L.l,u.l.ma=L,u.l.width=L.c,u.l.height=L.i,u.a=0,Q(u.m,P,ot,tt),!Bn(L.c,L.i,1,u,null)||(u.ab==1&&u.gc[0].hc==3&&ri(u.s)?(L.ic=1,P=u.c*u.i,u.Ta=null,u.Ua=0,u.V=i(P),u.Ba=0,u.V==null?(u.a=1,u=0):u=1):(L.ic=0,u=os(u,L.c)),!u))break e;u=1;break t}L.mc=null,u=0}else u=tt>=L.c*L.i;L=!u}if(L)return null;c.ga.Lc!=1?c.Ga=0:y=A-m}t(c.ga!=null),t(m+y<=A);t:{if(u=(P=c.ga).c,A=P.l.o,P.$a==0){if(ot=c.rc,tt=c.Vc,xt=c.Fa,O=c.P+1+m*u,D=c.mb,Y=c.nb+m*u,t(O<=c.P+c.qc),P.Z!=0)for(t(Ni[P.Z]!=null),L=0;L<y;++L)Ni[P.Z](ot,tt,xt,O,D,Y,u),ot=D,tt=Y,Y+=u,O+=u;else for(L=0;L<y;++L)r(D,Y,xt,O,u),ot=D,tt=Y,Y+=u,O+=u;c.rc=ot,c.Vc=tt}else{if(t(P.mc!=null),u=m+y,t((L=P.mc)!=null),t(u<=L.i),L.C>=u)u=1;else if(P.ic||rt(),P.ic){P=L.V,ot=L.Ba,tt=L.c;var mt=L.i,K=(xt=1,O=L.$/tt,D=L.$%tt,Y=L.m,st=L.s,L.$),Z=tt*mt,bt=tt*u,_t=st.wc,wt=K<bt?Je(st,D,O):null;t(K<=Z),t(u<=mt),t(ri(st));e:for(;;){for(;!Y.h&&K<bt;){if(D&_t||(wt=Je(st,D,O)),t(wt!=null),$(Y),256>(mt=Or(wt.G[0],wt.H[0],Y)))P[ot+K]=mt,++K,++D>=tt&&(D=0,++O<=u&&!(O%16)&&pn(L,O));else{if(!(280>mt)){xt=0;break e}mt=dn(mt-256,Y);var It,Pt=Or(wt.G[4],wt.H[4],Y);if($(Y),!(K>=(Pt=jn(tt,Pt=dn(Pt,Y)))&&Z-K>=mt)){xt=0;break e}for(It=0;It<mt;++It)P[ot+K+It]=P[ot+K+It-Pt];for(K+=mt,D+=mt;D>=tt;)D-=tt,++O<=u&&!(O%16)&&pn(L,O);K<bt&&D&_t&&(wt=Je(st,D,O))}t(Y.h==B(Y))}pn(L,O>u?u:O);break e}!xt||Y.h&&K<Z?(xt=0,L.a=Y.h?5:3):L.$=K,u=xt}else u=mn(L,L.V,L.Ba,L.c,L.i,u,eo);if(!u){y=0;break t}}m+y>=A&&(c.Cc=1),y=1}if(!y)return null;if(c.Cc&&((y=c.ga)!=null&&(y.mc=null),c.ga=null,0<c.Ga))return alert("todo:WebPDequantizeLevels"),null}return c.nb+m*_}function d(c,u,m,y,_,A){for(;0<_--;){var L,P=c,O=u+(m?1:0),D=c,Y=u+(m?0:3);for(L=0;L<y;++L){var st=D[Y+4*L];st!=255&&(st*=32897,P[O+4*L+0]=P[O+4*L+0]*st>>23,P[O+4*L+1]=P[O+4*L+1]*st>>23,P[O+4*L+2]=P[O+4*L+2]*st>>23)}u+=A}}function S(c,u,m,y,_){for(;0<y--;){var A;for(A=0;A<m;++A){var L=c[u+2*A+0],P=15&(D=c[u+2*A+1]),O=4369*P,D=(240&D|D>>4)*O>>16;c[u+2*A+0]=(240&L|L>>4)*O>>16&240|(15&L|L<<4)*O>>16>>4&15,c[u+2*A+1]=240&D|P}u+=_}}function j(c,u,m,y,_,A,L,P){var O,D,Y=255;for(D=0;D<_;++D){for(O=0;O<y;++O){var st=c[u+O];A[L+4*O]=st,Y&=st}u+=m,L+=P}return Y!=255}function H(c,u,m,y,_){var A;for(A=0;A<_;++A)m[y+A]=c[u+A]>>8}function rt(){en=d,ke=S,Oe=j,He=H}function vt(c,u,m){F[c]=function(y,_,A,L,P,O,D,Y,st,ot,tt,xt,mt,K,Z,bt,_t){var wt,It=_t-1>>1,Pt=P[O+0]|D[Y+0]<<16,Wt=st[ot+0]|tt[xt+0]<<16;t(y!=null);var Nt=3*Pt+Wt+131074>>2;for(u(y[_+0],255&Nt,Nt>>16,mt,K),A!=null&&(Nt=3*Wt+Pt+131074>>2,u(A[L+0],255&Nt,Nt>>16,Z,bt)),wt=1;wt<=It;++wt){var de=P[O+wt]|D[Y+wt]<<16,be=st[ot+wt]|tt[xt+wt]<<16,le=Pt+de+Wt+be+524296,ae=le+2*(de+Wt)>>3;Nt=ae+Pt>>1,Pt=(le=le+2*(Pt+be)>>3)+de>>1,u(y[_+2*wt-1],255&Nt,Nt>>16,mt,K+(2*wt-1)*m),u(y[_+2*wt-0],255&Pt,Pt>>16,mt,K+(2*wt-0)*m),A!=null&&(Nt=le+Wt>>1,Pt=ae+be>>1,u(A[L+2*wt-1],255&Nt,Nt>>16,Z,bt+(2*wt-1)*m),u(A[L+2*wt+0],255&Pt,Pt>>16,Z,bt+(2*wt+0)*m)),Pt=de,Wt=be}1&_t||(Nt=3*Pt+Wt+131074>>2,u(y[_+_t-1],255&Nt,Nt>>16,mt,K+(_t-1)*m),A!=null&&(Nt=3*Wt+Pt+131074>>2,u(A[L+_t-1],255&Nt,Nt>>16,Z,bt+(_t-1)*m)))}}function St(){nn[Vh]=s2,nn[Hh]=Pd,nn[Sd]=o2,nn[Gh]=kd,nn[Yh]=Od,nn[eu]=Nd,nn[Cd]=a2,nn[ru]=Pd,nn[nu]=kd,nn[Xh]=Od,nn[iu]=Nd}function jt(c){return c&~h2?0>c?0:255:c>>Md}function Ut(c,u){return jt((19077*c>>8)+(26149*u>>8)-14234)}function ee(c,u,m){return jt((19077*c>>8)-(6419*u>>8)-(13320*m>>8)+8708)}function $t(c,u){return jt((19077*c>>8)+(33050*u>>8)-17685)}function he(c,u,m,y,_){y[_+0]=Ut(c,m),y[_+1]=ee(c,u,m),y[_+2]=$t(c,u)}function Ee(c,u,m,y,_){y[_+0]=$t(c,u),y[_+1]=ee(c,u,m),y[_+2]=Ut(c,m)}function Ie(c,u,m,y,_){var A=ee(c,u,m);u=A<<3&224|$t(c,u)>>3,y[_+0]=248&Ut(c,m)|A>>5,y[_+1]=u}function Ze(c,u,m,y,_){var A=240&$t(c,u)|15;y[_+0]=240&Ut(c,m)|ee(c,u,m)>>4,y[_+1]=A}function pr(c,u,m,y,_){y[_+0]=255,he(c,u,m,y,_+1)}function sr(c,u,m,y,_){Ee(c,u,m,y,_),y[_+3]=255}function bn(c,u,m,y,_){he(c,u,m,y,_),y[_+3]=255}function Ur(c,u){return 0>c?0:c>u?u:c}function zn(c,u,m){F[c]=function(y,_,A,L,P,O,D,Y,st){for(var ot=Y+(-2&st)*m;Y!=ot;)u(y[_+0],A[L+0],P[O+0],D,Y),u(y[_+1],A[L+0],P[O+0],D,Y+m),_+=2,++L,++O,Y+=2*m;1&st&&u(y[_+0],A[L+0],P[O+0],D,Y)}}function Ih(c,u,m){return m==0?c==0?u==0?6:5:u==0?4:0:m}function Ca(c,u,m,y,_){switch(c>>>30){case 3:ai(u,m,y,_,0);break;case 2:Ve(u,m,y,_);break;case 1:Cr(u,m,y,_)}}function Aa(c,u){var m,y,_=u.M,A=u.Nb,L=c.oc,P=c.pc+40,O=c.oc,D=c.pc+584,Y=c.oc,st=c.pc+600;for(m=0;16>m;++m)L[P+32*m-1]=129;for(m=0;8>m;++m)O[D+32*m-1]=129,Y[st+32*m-1]=129;for(0<_?L[P-1-32]=O[D-1-32]=Y[st-1-32]=129:(n(L,P-32-1,127,21),n(O,D-32-1,127,9),n(Y,st-32-1,127,9)),y=0;y<c.za;++y){var ot=u.ya[u.aa+y];if(0<y){for(m=-1;16>m;++m)r(L,P+32*m-4,L,P+32*m+12,4);for(m=-1;8>m;++m)r(O,D+32*m-4,O,D+32*m+4,4),r(Y,st+32*m-4,Y,st+32*m+4,4)}var tt=c.Gd,xt=c.Hd+y,mt=ot.ad,K=ot.Hc;if(0<_&&(r(L,P-32,tt[xt].y,0,16),r(O,D-32,tt[xt].f,0,8),r(Y,st-32,tt[xt].ea,0,8)),ot.Za){var Z=L,bt=P-32+16;for(0<_&&(y>=c.za-1?n(Z,bt,tt[xt].y[15],4):r(Z,bt,tt[xt+1].y,0,4)),m=0;4>m;m++)Z[bt+128+m]=Z[bt+256+m]=Z[bt+384+m]=Z[bt+0+m];for(m=0;16>m;++m,K<<=2)Z=L,bt=P+Ed[m],wn[ot.Ob[m]](Z,bt),Ca(K,mt,16*+m,Z,bt)}else if(Z=Ih(y,_,ot.Ob[0]),Oi[Z](L,P),K!=0)for(m=0;16>m;++m,K<<=2)Ca(K,mt,16*+m,L,P+Ed[m]);for(m=ot.Gc,Z=Ih(y,_,ot.Dd),ci[Z](O,D),ci[Z](Y,st),K=mt,Z=O,bt=D,255&(ot=m>>0)&&(170&ot?Oa(K,256,Z,bt):Qr(K,256,Z,bt)),ot=Y,K=st,255&(m>>=8)&&(170&m?Oa(mt,320,ot,K):Qr(mt,320,ot,K)),_<c.Ub-1&&(r(tt[xt].y,0,L,P+480,16),r(tt[xt].f,0,O,D+224,8),r(tt[xt].ea,0,Y,st+224,8)),m=8*A*c.B,tt=c.sa,xt=c.ta+16*y+16*A*c.R,mt=c.qa,ot=c.ra+8*y+m,K=c.Ha,Z=c.Ia+8*y+m,m=0;16>m;++m)r(tt,xt+m*c.R,L,P+32*m,16);for(m=0;8>m;++m)r(mt,ot+m*c.B,O,D+32*m,8),r(K,Z+m*c.B,Y,st+32*m,8)}}function mo(c,u,m,y,_,A,L,P,O){var D=[0],Y=[0],st=0,ot=O!=null?O.kd:0,tt=O??new wa;if(c==null||12>m)return 7;tt.data=c,tt.w=u,tt.ha=m,u=[u],m=[m],tt.gb=[tt.gb];t:{var xt=u,mt=m,K=tt.gb;if(t(c!=null),t(mt!=null),t(K!=null),K[0]=0,12<=mt[0]&&!e(c,xt[0],"RIFF")){if(e(c,xt[0]+8,"WEBP")){K=3;break t}var Z=Ot(c,xt[0]+4);if(12>Z||4294967286<Z){K=3;break t}if(ot&&Z>mt[0]-8){K=7;break t}K[0]=Z,xt[0]+=12,mt[0]-=12}K=0}if(K!=0)return K;for(Z=0<tt.gb[0],m=m[0];;){t:{var bt=c;mt=u,K=m;var _t=D,wt=Y,It=xt=[0];if((Nt=st=[st])[0]=0,8>K[0])K=7;else{if(!e(bt,mt[0],"VP8X")){if(Ot(bt,mt[0]+4)!=10){K=3;break t}if(18>K[0]){K=7;break t}var Pt=Ot(bt,mt[0]+8),Wt=1+Dt(bt,mt[0]+12);if(2147483648<=Wt*(bt=1+Dt(bt,mt[0]+15))){K=3;break t}It!=null&&(It[0]=Pt),_t!=null&&(_t[0]=Wt),wt!=null&&(wt[0]=bt),mt[0]+=18,K[0]-=18,Nt[0]=1}K=0}}if(st=st[0],xt=xt[0],K!=0)return K;if(mt=!!(2&xt),!Z&&st)return 3;if(A!=null&&(A[0]=!!(16&xt)),L!=null&&(L[0]=mt),P!=null&&(P[0]=0),L=D[0],xt=Y[0],st&&mt&&O==null){K=0;break}if(4>m){K=7;break}if(Z&&st||!Z&&!st&&!e(c,u[0],"ALPH")){m=[m],tt.na=[tt.na],tt.P=[tt.P],tt.Sa=[tt.Sa];t:{Pt=c,K=u,Z=m;var Nt=tt.gb;_t=tt.na,wt=tt.P,It=tt.Sa,Wt=22,t(Pt!=null),t(Z!=null),bt=K[0];var de=Z[0];for(t(_t!=null),t(It!=null),_t[0]=null,wt[0]=null,It[0]=0;;){if(K[0]=bt,Z[0]=de,8>de){K=7;break t}var be=Ot(Pt,bt+4);if(4294967286<be){K=3;break t}var le=8+be+1&-2;if(Wt+=le,0<Nt&&Wt>Nt){K=3;break t}if(!e(Pt,bt,"VP8 ")||!e(Pt,bt,"VP8L")){K=0;break t}if(de[0]<le){K=7;break t}e(Pt,bt,"ALPH")||(_t[0]=Pt,wt[0]=bt+8,It[0]=be),bt+=le,de-=le}}if(m=m[0],tt.na=tt.na[0],tt.P=tt.P[0],tt.Sa=tt.Sa[0],K!=0)break}m=[m],tt.Ja=[tt.Ja],tt.xa=[tt.xa];t:if(Nt=c,K=u,Z=m,_t=tt.gb[0],wt=tt.Ja,It=tt.xa,Pt=K[0],bt=!e(Nt,Pt,"VP8 "),Wt=!e(Nt,Pt,"VP8L"),t(Nt!=null),t(Z!=null),t(wt!=null),t(It!=null),8>Z[0])K=7;else{if(bt||Wt){if(Nt=Ot(Nt,Pt+4),12<=_t&&Nt>_t-12){K=3;break t}if(ot&&Nt>Z[0]-8){K=7;break t}wt[0]=Nt,K[0]+=8,Z[0]-=8,It[0]=Wt}else It[0]=5<=Z[0]&&Nt[Pt+0]==47&&!(Nt[Pt+4]>>5),wt[0]=Z[0];K=0}if(m=m[0],tt.Ja=tt.Ja[0],tt.xa=tt.xa[0],u=u[0],K!=0)break;if(4294967286<tt.Ja)return 3;if(P==null||mt||(P[0]=tt.xa?2:1),L=[L],xt=[xt],tt.xa){if(5>m){K=7;break}P=L,ot=xt,mt=A,c==null||5>m?c=0:5<=m&&c[u+0]==47&&!(c[u+4]>>5)?(Z=[0],Nt=[0],_t=[0],Q(wt=new T,c,u,m),Vt(wt,Z,Nt,_t)?(P!=null&&(P[0]=Z[0]),ot!=null&&(ot[0]=Nt[0]),mt!=null&&(mt[0]=_t[0]),c=1):c=0):c=0}else{if(10>m){K=7;break}P=xt,c==null||10>m||!xh(c,u+3,m-3)?c=0:(ot=c[u+0]|c[u+1]<<8|c[u+2]<<16,mt=16383&(c[u+7]<<8|c[u+6]),c=16383&(c[u+9]<<8|c[u+8]),1&ot||3<(ot>>1&7)||!(ot>>4&1)||ot>>5>=tt.Ja||!mt||!c?c=0:(L&&(L[0]=mt),P&&(P[0]=c),c=1))}if(!c||(L=L[0],xt=xt[0],st&&(D[0]!=L||Y[0]!=xt)))return 3;O!=null&&(O[0]=tt,O.offset=u-O.w,t(4294967286>u-O.w),t(O.offset==O.ha-m));break}return K==0||K==7&&st&&O==null?(A!=null&&(A[0]|=tt.na!=null&&0<tt.na.length),y!=null&&(y[0]=L),_!=null&&(_[0]=xt),0):K}function La(c,u,m){var y=u.width,_=u.height,A=0,L=0,P=y,O=_;if(u.Da=c!=null&&0<c.Da,u.Da&&(P=c.cd,O=c.bd,A=c.v,L=c.j,11>m||(A&=-2,L&=-2),0>A||0>L||0>=P||0>=O||A+P>y||L+O>_))return 0;if(u.v=A,u.j=L,u.va=A+P,u.o=L+O,u.U=P,u.T=O,u.da=c!=null&&0<c.da,u.da){if(!te(P,O,m=[c.ib],A=[c.hb]))return 0;u.ib=m[0],u.hb=A[0]}return u.ob=c!=null&&c.ob,u.Kb=c==null||!c.Sd,u.da&&(u.ob=u.ib<3*y/4&&u.hb<3*_/4,u.Kb=0),1}function Ta(c){if(c==null)return 2;if(11>c.S){var u=c.f.RGBA;u.fb+=(c.height-1)*u.A,u.A=-u.A}else u=c.f.kb,c=c.height,u.O+=(c-1)*u.fa,u.fa=-u.fa,u.N+=(c-1>>1)*u.Ab,u.Ab=-u.Ab,u.W+=(c-1>>1)*u.Db,u.Db=-u.Db,u.F!=null&&(u.J+=(c-1)*u.lb,u.lb=-u.lb);return 0}function vo(c,u,m,y){if(y==null||0>=c||0>=u)return 2;if(m!=null){if(m.Da){var _=m.cd,A=m.bd,L=-2&m.v,P=-2&m.j;if(0>L||0>P||0>=_||0>=A||L+_>c||P+A>u)return 2;c=_,u=A}if(m.da){if(!te(c,u,_=[m.ib],A=[m.hb]))return 2;c=_[0],u=A[0]}}y.width=c,y.height=u;t:{var O=y.width,D=y.height;if(c=y.S,0>=O||0>=D||!(c>=Vh&&13>c))c=2;else{if(0>=y.Rd&&y.sd==null){L=A=_=u=0;var Y=(P=O*Fd[c])*D;if(11>c||(A=(D+1)/2*(u=(O+1)/2),c==12&&(L=(_=O)*D)),(D=i(Y+2*A+L))==null){c=1;break t}y.sd=D,11>c?((O=y.f.RGBA).eb=D,O.fb=0,O.A=P,O.size=Y):((O=y.f.kb).y=D,O.O=0,O.fa=P,O.Fd=Y,O.f=D,O.N=0+Y,O.Ab=u,O.Cd=A,O.ea=D,O.W=0+Y+A,O.Db=u,O.Ed=A,c==12&&(O.F=D,O.J=0+Y+2*A),O.Tc=L,O.lb=_)}if(u=1,_=y.S,A=y.width,L=y.height,_>=Vh&&13>_)if(11>_)c=y.f.RGBA,u&=(P=Math.abs(c.A))*(L-1)+A<=c.size,u&=P>=A*Fd[_],u&=c.eb!=null;else{c=y.f.kb,P=(A+1)/2,Y=(L+1)/2,O=Math.abs(c.fa),D=Math.abs(c.Ab);var st=Math.abs(c.Db),ot=Math.abs(c.lb),tt=ot*(L-1)+A;u&=O*(L-1)+A<=c.Fd,u&=D*(Y-1)+P<=c.Cd,u=(u&=st*(Y-1)+P<=c.Ed)&O>=A&D>=P&st>=P,u&=c.y!=null,u&=c.f!=null,u&=c.ea!=null,_==12&&(u&=ot>=A,u&=tt<=c.Tc,u&=c.F!=null)}else u=0;c=u?0:2}}return c!=0||m!=null&&m.fd&&(c=Ta(y)),c}var ur=64,yo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],bo=24,wo=32,Pa=8,Mr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Tt("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(c){return c},F.Predictor2=function(c,u,m){return u[m+0]},F.Predictor3=function(c,u,m){return u[m+1]},F.Predictor4=function(c,u,m){return u[m-1]},F.Predictor5=function(c,u,m){return Mt(Mt(c,u[m+1]),u[m+0])},F.Predictor6=function(c,u,m){return Mt(c,u[m-1])},F.Predictor7=function(c,u,m){return Mt(c,u[m+0])},F.Predictor8=function(c,u,m){return Mt(u[m-1],u[m+0])},F.Predictor9=function(c,u,m){return Mt(u[m+0],u[m+1])},F.Predictor10=function(c,u,m){return Mt(Mt(c,u[m-1]),Mt(u[m+0],u[m+1]))},F.Predictor11=function(c,u,m){var y=u[m+0];return 0>=ne(y>>24&255,c>>24&255,(u=u[m-1])>>24&255)+ne(y>>16&255,c>>16&255,u>>16&255)+ne(y>>8&255,c>>8&255,u>>8&255)+ne(255&y,255&c,255&u)?y:c},F.Predictor12=function(c,u,m){var y=u[m+0];return(zt((c>>24&255)+(y>>24&255)-((u=u[m-1])>>24&255))<<24|zt((c>>16&255)+(y>>16&255)-(u>>16&255))<<16|zt((c>>8&255)+(y>>8&255)-(u>>8&255))<<8|zt((255&c)+(255&y)-(255&u)))>>>0},F.Predictor13=function(c,u,m){var y=u[m-1];return(Jt((c=Mt(c,u[m+0]))>>24&255,y>>24&255)<<24|Jt(c>>16&255,y>>16&255)<<16|Jt(c>>8&255,y>>8&255)<<8|Jt(c>>0&255,y>>0&255))>>>0};var Ql=F.PredictorAdd0;F.PredictorAdd1=se,Tt("Predictor2","PredictorAdd2"),Tt("Predictor3","PredictorAdd3"),Tt("Predictor4","PredictorAdd4"),Tt("Predictor5","PredictorAdd5"),Tt("Predictor6","PredictorAdd6"),Tt("Predictor7","PredictorAdd7"),Tt("Predictor8","PredictorAdd8"),Tt("Predictor9","PredictorAdd9"),Tt("Predictor10","PredictorAdd10"),Tt("Predictor11","PredictorAdd11"),Tt("Predictor12","PredictorAdd12"),Tt("Predictor13","PredictorAdd13");var ka=F.PredictorAdd2;oe("ColorIndexInverseTransform","MapARGB","32b",function(c){return c>>8&255},function(c){return c}),oe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(c){return c},function(c){return c>>8&255});var Bh,$r=F.ColorIndexInverseTransform,xo=F.MapARGB,Rh=F.VP8LColorIndexInverseTransformAlpha,qh=F.MapAlpha,Li=F.VP8LPredictorsAdd=[];Li.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var us,Dr,Sr,Ti,si,oi,_o,ai,Ve,Oa,Cr,Qr,So,zh,Na,fs,ds,Pi,gs,Co,ps,ki,Ma,tn,en,ke,Oe,He,nr=i(511),hi=i(2041),Da=i(225),Ao=i(767),Uh=0,tu=hi,Wh=Da,Wr=Ao,rn=nr,Vh=0,Hh=1,Sd=2,Gh=3,Yh=4,eu=5,Cd=6,ru=7,nu=8,Xh=9,iu=10,H1=[2,3,7],G1=[3,3,11],Ad=[280,256,256,256,40],Y1=[0,1,1,1,0],X1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],K1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],J1=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Z1=8,su=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ou=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ea=null,$1=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Q1=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ld=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],t2=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],e2=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],r2=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],n2=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Oi=[],wn=[],ci=[],i2=1,Td=2,Ni=[],nn=[];vt("UpsampleRgbLinePair",he,3),vt("UpsampleBgrLinePair",Ee,3),vt("UpsampleRgbaLinePair",bn,4),vt("UpsampleBgraLinePair",sr,4),vt("UpsampleArgbLinePair",pr,4),vt("UpsampleRgba4444LinePair",Ze,2),vt("UpsampleRgb565LinePair",Ie,2);var s2=F.UpsampleRgbLinePair,o2=F.UpsampleBgrLinePair,Pd=F.UpsampleRgbaLinePair,kd=F.UpsampleBgraLinePair,Od=F.UpsampleArgbLinePair,Nd=F.UpsampleRgba4444LinePair,a2=F.UpsampleRgb565LinePair,Kh=16,Jh=1<<Kh-1,Fa=-227,au=482,Md=6,h2=(256<<Md)-1,Dd=0,c2=i(256),l2=i(256),u2=i(256),f2=i(256),d2=i(au-Fa),g2=i(au-Fa);zn("YuvToRgbRow",he,3),zn("YuvToBgrRow",Ee,3),zn("YuvToRgbaRow",bn,4),zn("YuvToBgraRow",sr,4),zn("YuvToArgbRow",pr,4),zn("YuvToRgba4444Row",Ze,2),zn("YuvToRgb565Row",Ie,2);var Ed=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Zh=[0,2,8],p2=[8,7,6,4,4,2,2,2,1,1,1,1],m2=1;this.WebPDecodeRGBA=function(c,u,m,y,_){var A=Hh,L=new go,P=new fn;L.ba=P,P.S=A,P.width=[P.width],P.height=[P.height];var O=P.width,D=P.height,Y=new ei;if(Y==null||c==null)var st=2;else t(Y!=null),st=mo(c,u,m,Y.width,Y.height,Y.Pd,Y.Qd,Y.format,null);if(st!=0?O=0:(O!=null&&(O[0]=Y.width[0]),D!=null&&(D[0]=Y.height[0]),O=1),O){P.width=P.width[0],P.height=P.height[0],y!=null&&(y[0]=P.width),_!=null&&(_[0]=P.height);t:{if(y=new oo,(_=new wa).data=c,_.w=u,_.ha=m,_.kd=1,u=[0],t(_!=null),((c=mo(_.data,_.w,_.ha,null,null,null,u,null,_))==0||c==7)&&u[0]&&(c=4),(u=c)==0){if(t(L!=null),y.data=_.data,y.w=_.w+_.offset,y.ha=_.ha-_.offset,y.put=En,y.ac=lr,y.bc=Fn,y.ma=L,_.xa){if((c=Zr())==null){L=1;break t}if(function(ot,tt){var xt=[0],mt=[0],K=[0];e:for(;;){if(ot==null)return 0;if(tt==null)return ot.a=2,0;if(ot.l=tt,ot.a=0,Q(ot.m,tt.data,tt.w,tt.ha),!Vt(ot.m,xt,mt,K)){ot.a=3;break e}if(ot.xb=Td,tt.width=xt[0],tt.height=mt[0],!Bn(xt[0],mt[0],1,ot,null))break e;return 1}return t(ot.a!=0),0}(c,y)){if(y=(u=vo(y.width,y.height,L.Oa,L.ba))==0){e:{y=c;r:for(;;){if(y==null){y=0;break e}if(t(y.s.yc!=null),t(y.s.Ya!=null),t(0<y.s.Wb),t((m=y.l)!=null),t((_=m.ma)!=null),y.xb!=0){if(y.ca=_.ba,y.tb=_.tb,t(y.ca!=null),!La(_.Oa,m,Gh)){y.a=2;break r}if(!os(y,m.width)||m.da)break r;if((m.da||pe(y.ca.S))&&rt(),11>y.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),y.ca.f.kb.F!=null&&rt()),y.Pb&&0<y.s.ua&&y.s.vb.X==null&&!Ht(y.s.vb,y.s.Wa.Xa)){y.a=1;break r}y.xb=0}if(!mn(y,y.V,y.Ba,y.c,y.i,m.o,to))break r;_.Dc=y.Ma,y=1;break e}t(y.a!=0),y=0}y=!y}y&&(u=c.a)}else u=c.a}else{if((c=new El)==null){L=1;break t}if(c.Fa=_.na,c.P=_.P,c.qc=_.Sa,_h(c,y)){if((u=vo(y.width,y.height,L.Oa,L.ba))==0){if(c.Aa=0,m=L.Oa,t((_=c)!=null),m!=null){if(0<(O=0>(O=m.Md)?0:100<O?255:255*O/100)){for(D=Y=0;4>D;++D)12>(st=_.pb[D]).lc&&(st.ia=O*p2[0>st.lc?0:st.lc]>>3),Y|=st.ia;Y&&(alert("todo:VP8InitRandom"),_.ia=1)}_.Ga=m.Id,100<_.Ga?_.Ga=100:0>_.Ga&&(_.Ga=0)}Fl(c,y)||(u=c.a)}}else u=c.a}u==0&&L.Oa!=null&&L.Oa.fd&&(u=Ta(L.ba))}L=u}A=L!=0?null:11>A?P.f.RGBA.eb:P.f.kb.y}else A=null;return A};var Fd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(F,et){for(var dt="",N=0;N<4;N++)dt+=String.fromCharCode(F[et++]);return dt}function f(F,et){return(F[et+0]<<0|F[et+1]<<8|F[et+2]<<16)>>>0}function p(F,et){return(F[et+0]<<0|F[et+1]<<8|F[et+2]<<16|F[et+3]<<24)>>>0}new h;var v=[0],g=[0],b=[],w=new h,C=s,x=function(F,et){var dt={},N=0,M=!1,z=0,R=0;if(dt.frames=[],!function(E,B,V,$){for(var at=0;at<$;at++)if(E[B+at]!=V.charCodeAt(at))return!0;return!1}(F,et,"RIFF",4)){for(p(F,et+=4),et+=8;et<F.length;){var ht=l(F,et),it=p(F,et+=4);et+=4;var ut=it+(1&it);switch(ht){case"VP8 ":case"VP8L":dt.frames[N]===void 0&&(dt.frames[N]={}),(pt=dt.frames[N]).src_off=M?R:et-8,pt.src_size=z+it+8,N++,M&&(M=!1,z=0,R=0);break;case"VP8X":(pt=dt.header={}).feature_flags=F[et];var Q=et+4;pt.canvas_width=1+f(F,Q),Q+=3,pt.canvas_height=1+f(F,Q),Q+=3;break;case"ALPH":M=!0,z=ut+8,R=et-8;break;case"ANIM":(pt=dt.header).bgcolor=p(F,et),Q=et+4,pt.loop_count=(kt=F)[(T=Q)+0]<<0|kt[T+1]<<8,Q+=2;break;case"ANMF":var gt,pt;(pt=dt.frames[N]={}).offset_x=2*f(F,et),et+=3,pt.offset_y=2*f(F,et),et+=3,pt.width=1+f(F,et),et+=3,pt.height=1+f(F,et),et+=3,pt.duration=f(F,et),et+=3,gt=F[et++],pt.dispose=1&gt,pt.blend=gt>>1&1}ht!="ANMF"&&(et+=ut)}var kt,T;return dt}}(C,0);x.response=C,x.rgbaoutput=!0,x.dataurl=!1;var k=x.header?x.header:null,I=x.frames?x.frames:null;if(k){k.loop_counter=k.loop_count,v=[k.canvas_height],g=[k.canvas_width];for(var G=0;G<I.length&&I[G].blend!=0;G++);}var U=I[0],nt=w.WebPDecodeRGBA(C,U.src_off,U.src_size,g,v);U.rgba=nt,U.imgwidth=g[0],U.imgheight=v[0];for(var J=0;J<g[0]*v[0]*4;J++)b[J]=nt[J];return this.width=g,this.height=v,this.data=b,this}(function(s){var t=function(){return typeof ol=="function"},e=function(v,g,b,w){var C=4,x=o;switch(w){case s.image_compression.FAST:C=1,x=i;break;case s.image_compression.MEDIUM:C=6,x=a;break;case s.image_compression.SLOW:C=9,x=h}v=r(v,g,b,x);var k=ol(v,{level:C});return s.__addimage__.arrayBufferToBinaryString(k)},r=function(v,g,b,w){for(var C,x,k,I=v.length/g,G=new Uint8Array(v.length+I),U=f(),nt=0;nt<I;nt+=1){if(k=nt*g,C=v.subarray(k,k+g),w)G.set(w(C,b,x),k+nt);else{for(var J,F=U.length,et=[];J<F;J+=1)et[J]=U[J](C,b,x);var dt=p(et.concat());G.set(et[dt],k+nt)}x=C}return G},n=function(v){var g=Array.apply([],v);return g.unshift(0),g},i=function(v,g){var b,w=[],C=v.length;w[0]=1;for(var x=0;x<C;x+=1)b=v[x-g]||0,w[x+1]=v[x]-b+256&255;return w},o=function(v,g,b){var w,C=[],x=v.length;C[0]=2;for(var k=0;k<x;k+=1)w=b&&b[k]||0,C[k+1]=v[k]-w+256&255;return C},a=function(v,g,b){var w,C,x=[],k=v.length;x[0]=3;for(var I=0;I<k;I+=1)w=v[I-g]||0,C=b&&b[I]||0,x[I+1]=v[I]+256-(w+C>>>1)&255;return x},h=function(v,g,b){var w,C,x,k,I=[],G=v.length;I[0]=4;for(var U=0;U<G;U+=1)w=v[U-g]||0,C=b&&b[U]||0,x=b&&b[U-g]||0,k=l(w,C,x),I[U+1]=v[U]-k+256&255;return I},l=function(v,g,b){if(v===g&&g===b)return v;var w=Math.abs(g-b),C=Math.abs(v-b),x=Math.abs(v+g-b-b);return w<=C&&w<=x?v:C<=x?g:b},f=function(){return[n,i,o,a,h]},p=function(v){var g=v.map(function(b){return b.reduce(function(w,C){return w+Math.abs(C)},0)});return g.indexOf(Math.min.apply(null,g))};s.processPNG=function(v,g,b,w){var C,x,k,I,G,U,nt,J,F,et,dt,N,M,z,R,ht=this.decode.FLATE_DECODE,it="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(k=new hv(v)).imgData,x=k.bits,C=k.colorSpace,G=k.colors,[4,6].indexOf(k.colorType)!==-1){if(k.bits===8){F=(J=k.pixelBitlength==32?new Uint32Array(k.decodePixels().buffer):k.pixelBitlength==16?new Uint16Array(k.decodePixels().buffer):new Uint8Array(k.decodePixels().buffer)).length,dt=new Uint8Array(F*k.colors),et=new Uint8Array(F);var ut,Q=k.pixelBitlength-k.bits;for(z=0,R=0;z<F;z++){for(M=J[z],ut=0;ut<Q;)dt[R++]=M>>>ut&255,ut+=k.bits;et[z]=M>>>ut&255}}if(k.bits===16){F=(J=new Uint32Array(k.decodePixels().buffer)).length,dt=new Uint8Array(F*(32/k.pixelBitlength)*k.colors),et=new Uint8Array(F*(32/k.pixelBitlength)),N=k.colors>1,z=0,R=0;for(var gt=0;z<F;)M=J[z++],dt[R++]=M>>>0&255,N&&(dt[R++]=M>>>16&255,M=J[z++],dt[R++]=M>>>0&255),et[gt++]=M>>>16&255;x=8}w!==s.image_compression.NONE&&t()?(v=e(dt,k.width*k.colors,k.colors,w),nt=e(et,k.width,1,w)):(v=dt,nt=et,ht=void 0)}if(k.colorType===3&&(C=this.color_spaces.INDEXED,U=k.palette,k.transparency.indexed)){var pt=k.transparency.indexed,kt=0;for(z=0,F=pt.length;z<F;++z)kt+=pt[z];if((kt/=255)===F-1&&pt.indexOf(0)!==-1)I=[pt.indexOf(0)];else if(kt!==F){for(J=k.decodePixels(),et=new Uint8Array(J.length),z=0,F=J.length;z<F;z++)et[z]=pt[J[z]];nt=e(et,k.width,1)}}var T=function(E){var B;switch(E){case s.image_compression.FAST:B=11;break;case s.image_compression.MEDIUM:B=13;break;case s.image_compression.SLOW:B=14;break;default:B=12}return B}(w);return ht===this.decode.FLATE_DECODE&&(it="/Predictor "+T+" "),it+="/Colors "+G+" /BitsPerComponent "+x+" /Columns "+k.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(nt&&this.__addimage__.isArrayBuffer(nt)||this.__addimage__.isArrayBufferView(nt))&&(nt=this.__addimage__.arrayBufferToBinaryString(nt)),{alias:b,data:v,index:g,filter:ht,decodeParameters:it,transparency:I,palette:U,sMask:nt,predictor:T,width:k.width,height:k.height,bitsPerComponent:x,colorSpace:C}}}})(Gt.API),function(s){s.processGIF89A=function(t,e,r,n){var i=new cv(t),o=i.width,a=i.height,h=[];i.decodeAndBlitFrameRGBA(0,h);var l={data:h,width:o,height:a},f=new Gf(100).encode(l,100);return s.processJPEG.call(this,f,e,r,n)},s.processGIF87A=s.processGIF89A}(Gt.API),On.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var s=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(s);for(var t=0;t<s;t++){var e=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:r,blue:e,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},On.prototype.parseBGR=function(){this.pos=this.offset;try{var s="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[s]()}catch(e){Pe.log("bit decode error:"+e)}},On.prototype.bit1=function(){var s,t=Math.ceil(this.width/8),e=t%4;for(s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,n=0;n<t;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*n*4,a=0;a<8&&8*n+a<this.width;a++){var h=this.palette[i>>7-a&1];this.data[o+4*a]=h.blue,this.data[o+4*a+1]=h.green,this.data[o+4*a+2]=h.red,this.data[o+4*a+3]=255}e!==0&&(this.pos+=4-e)}},On.prototype.bit4=function(){for(var s=Math.ceil(this.width/2),t=s%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<s;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*n*4,a=i>>4,h=15&i,l=this.palette[a];if(this.data[o]=l.blue,this.data[o+1]=l.green,this.data[o+2]=l.red,this.data[o+3]=255,2*n+1>=this.width)break;l=this.palette[h],this.data[o+4]=l.blue,this.data[o+4+1]=l.green,this.data[o+4+2]=l.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},On.prototype.bit8=function(){for(var s=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*r;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}s!==0&&(this.pos+=4-s)}},On.prototype.bit15=function(){for(var s=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,a=(i>>5&t)/t*255|0,h=(i>>10&t)/t*255|0,l=i>>15?255:0,f=r*this.width*4+4*n;this.data[f]=h,this.data[f+1]=a,this.data[f+2]=o,this.data[f+3]=l}this.pos+=s}},On.prototype.bit16=function(){for(var s=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&t)/t*255|0,h=(o>>5&e)/e*255|0,l=(o>>11)/t*255|0,f=n*this.width*4+4*i;this.data[f]=l,this.data[f+1]=h,this.data[f+2]=a,this.data[f+3]=255}this.pos+=s}},On.prototype.bit24=function(){for(var s=this.height-1;s>=0;s--){for(var t=this.bottom_up?s:this.height-1-s,e=0;e<this.width;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},On.prototype.bit32=function(){for(var s=this.height-1;s>=0;s--)for(var t=this.bottom_up?s:this.height-1-s,e=0;e<this.width;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=i,this.data[a+1]=n,this.data[a+2]=r,this.data[a+3]=o}},On.prototype.getData=function(){return this.data},function(s){s.processBMP=function(t,e,r,n){var i=new On(t,!1),o=i.width,a=i.height,h={data:i.getData(),width:o,height:a},l=new Gf(100).encode(h,100);return s.processJPEG.call(this,l,e,r,n)}}(Gt.API),Mp.prototype.getData=function(){return this.data},function(s){s.processWEBP=function(t,e,r,n){var i=new Mp(t),o=i.width,a=i.height,h={data:i.getData(),width:o,height:a},l=new Gf(100).encode(h,100);return s.processJPEG.call(this,l,e,r,n)}}(Gt.API),Gt.API.processRGBA=function(s,t,e){for(var r=s.data,n=r.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),a=0,h=0,l=0;l<n;l+=4){var f=r[l],p=r[l+1],v=r[l+2],g=r[l+3];i[a++]=f,i[a++]=p,i[a++]=v,o[h++]=g}var b=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:s.width,height:s.height}},Gt.API.setLanguage=function(s){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[s]!==void 0&&(this.internal.languageSettings.languageCode=s,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Zo=Gt.API,ll=Zo.getCharWidthsArray=function(s,t){var e,r,n=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:n.metadata.Unicode.widths,h=a.fof?a.fof:1,l=t.kerning?t.kerning:n.metadata.Unicode.kerning,f=l.fof?l.fof:1,p=t.doKerning!==!1,v=0,g=s.length,b=0,w=a[0]||h,C=[];for(e=0;e<g;e++)r=s.charCodeAt(e),typeof n.metadata.widthOfString=="function"?C.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(r))+o*(1e3/i)||0)/1e3):(v=p&&Ce(l[r])==="object"&&!isNaN(parseInt(l[r][b],10))?l[r][b]/f:0,C.push((a[r]||w)/h+v)),b=r;return C},Pp=Zo.getStringUnitWidth=function(s,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return Zo.processArabic&&(s=Zo.processArabic(s)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(s,e,n)/e:ll.apply(this,arguments).reduce(function(i,o){return i+o},0)},kp=function(s,t,e,r){for(var n=[],i=0,o=s.length,a=0;i!==o&&a+t[i]<e;)a+=t[i],i++;n.push(s.slice(0,i));var h=i;for(a=0;i!==o;)a+t[i]>r&&(n.push(s.slice(h,i)),a=0,h=i),a+=t[i],i++;return h!==i&&n.push(s.slice(h,i)),n},Op=function(s,t,e){e||(e={});var r,n,i,o,a,h,l,f=[],p=[f],v=e.textIndent||0,g=0,b=0,w=s.split(" "),C=ll.apply(this,[" ",e])[0];if(h=e.lineIndent===-1?w[0].length+2:e.lineIndent||0){var x=Array(h).join(" "),k=[];w.map(function(G){(G=G.split(/\s*\n/)).length>1?k=k.concat(G.map(function(U,nt){return(nt&&U.length?`
`:"")+U})):k.push(G[0])}),w=k,h=Pp.apply(this,[x,e])}for(i=0,o=w.length;i<o;i++){var I=0;if(r=w[i],h&&r[0]==`
`&&(r=r.substr(1),I=1),v+g+(b=(n=ll.apply(this,[r,e])).reduce(function(G,U){return G+U},0))>t||I){if(b>t){for(a=kp.apply(this,[r,n,t-(v+g),t]),f.push(a.shift()),f=[a.pop()];a.length;)p.push([a.shift()]);b=n.slice(r.length-(f[0]?f[0].length:0)).reduce(function(G,U){return G+U},0)}else f=[r];p.push(f),v=b+h,g=C}else f.push(r),v+=g+b,g=C}return l=h?function(G,U){return(U?x:"")+G.join(" ")}:function(G){return G.join(" ")},p.map(l)},Zo.splitTextToSize=function(s,t,e){var r,n=(e=e||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var p=this.internal.getFont(f.fontName,f.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);r=Array.isArray(s)?s:String(s).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;i.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=e.lineIndent;var a,h,l=[];for(a=0,h=r.length;a<h;a++)l=l.concat(Op.apply(this,[r[a],o,i]));return l},function(s){s.__fontmetrics__=s.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},r={},n=0;n<t.length;n++)e[t[n]]="0123456789abcdef"[n],r["0123456789abcdef"[n]]=t[n];var i=function(p){return"0x"+parseInt(p,10).toString(16)},o=s.__fontmetrics__.compress=function(p){var v,g,b,w,C=["{"];for(var x in p){if(v=p[x],isNaN(parseInt(x,10))?g="'"+x+"'":(x=parseInt(x,10),g=(g=i(x).slice(2)).slice(0,-1)+r[g.slice(-1)]),typeof v=="number")v<0?(b=i(v).slice(3),w="-"):(b=i(v).slice(2),w=""),b=w+b.slice(0,-1)+r[b.slice(-1)];else{if(Ce(v)!=="object")throw new Error("Don't know what to do with value type "+Ce(v)+".");b=o(v)}C.push(g+b)}return C.push("}"),C.join("")},a=s.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,g,b,w,C={},x=1,k=C,I=[],G="",U="",nt=p.length-1,J=1;J<nt;J+=1)(w=p[J])=="'"?v?(b=v.join(""),v=void 0):v=[]:v?v.push(w):w=="{"?(I.push([k,b]),k={},b=void 0):w=="}"?((g=I.pop())[0][g[1]]=k,b=void 0,k=g[0]):w=="-"?x=-1:b===void 0?e.hasOwnProperty(w)?(G+=e[w],b=parseInt(G,16)*x,x=1,G=""):G+=w:e.hasOwnProperty(w)?(U+=e[w],k[b]=parseInt(U,16)*x,x=1,b=void 0,U=""):U+=w;return C},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},l={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},f={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};s.events.push(["addFont",function(p){var v=p.font,g=f.Unicode[v.postScriptName];g&&(v.metadata.Unicode={},v.metadata.Unicode.widths=g.widths,v.metadata.Unicode.kerning=g.kerning);var b=l.Unicode[v.postScriptName];b&&(v.metadata.Unicode.encoding=b,v.encoding=b.codePages[0])}])}(Gt.API),function(s){var t=function(e){for(var r=e.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=e.charCodeAt(i);return n};s.API.events.push(["addFont",function(e){var r=void 0,n=e.font,i=e.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(r=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(ch(a)),o.metadata=s.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,r)}}])}(Gt),function(s){function t(){return(Yt.canvg?Promise.resolve(Yt.canvg):import("./chunk-U3BZDBMX.js")).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Gt.API.addSvgAsImage=function(e,r,n,i,o,a,h,l){if(isNaN(r)||isNaN(n))throw Pe.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw Pe.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=i,f.height=o;var p=f.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,f.width,f.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return t().then(function(b){return b.fromString(p,e,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(v)}).then(function(){g.addImage(f.toDataURL("image/jpeg",1),r,n,i,o,h,l)})}}(),Gt.API.putTotalPages=function(s){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(s,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(s,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var n=0;n<this.internal.pages[r].length;n++)this.internal.pages[r][n]=this.internal.pages[r][n].replace(t,e);return this},Gt.API.viewerPreferences=function(s,t){var e;s=s||{},t=t||!1;var r,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),h=[],l=0,f=0,p=0;function v(b,w){var C,x=!1;for(C=0;C<b.length;C+=1)b[C]===w&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,s==="reset"||t===!0){var g=a.length;for(p=0;p<g;p+=1)e[a[p]].value=e[a[p]].defaultValue,e[a[p]].explicitSet=!1}if(Ce(s)==="object"){for(n in s)if(i=s[n],v(a,n)&&i!==void 0){if(e[n].type==="boolean"&&typeof i=="boolean")e[n].value=i;else if(e[n].type==="name"&&v(e[n].valueSet,i))e[n].value=i;else if(e[n].type==="integer"&&Number.isInteger(i))e[n].value=i;else if(e[n].type==="array"){for(l=0;l<i.length;l+=1)if(r=!0,i[l].length===1&&typeof i[l][0]=="number")h.push(String(i[l]-1));else if(i[l].length>1){for(f=0;f<i[l].length;f+=1)typeof i[l][f]!="number"&&(r=!1);r===!0&&h.push([i[l][0]-1,i[l][1]-1].join(" "))}e[n].value="["+h.join(" ")+"]"}else e[n].value=e[n].defaultValue;e[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,w=[];for(b in e)e[b].explicitSet===!0&&(e[b].type==="name"?w.push("/"+b+" /"+e[b].value):w.push("/"+b+" "+e[b].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(s){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),h=unescape(encodeURIComponent("</x:xmpmeta>")),l=i.length+o.length+a.length+n.length+h.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+a+h),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};s.addMetadata=function(r,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(Gt.API),function(s){var t=s.API,e=t.pdfEscape16=function(i,o){for(var a,h=o.metadata.Unicode.widths,l=["","0","00","000","0000"],f=[""],p=0,v=i.length;p<v;++p){if(a=o.metadata.characterToGlyph(i.charCodeAt(p)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=i.charCodeAt(p),h.indexOf(a)==-1&&(h.push(a),h.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return f.join("");a=a.toString(16),f.push(l[4-a.length],a)}return f.join("")},r=function(i){var o,a,h,l,f,p,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,h=[],p=0,v=(a=Object.keys(i).sort(function(g,b){return g-b})).length;p<v;p++)o=a[p],h.length>=100&&(f+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar`,h=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(l=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),h.push("<"+o+"><"+l+">"));return h.length&&(f+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var a=o.font,h=o.out,l=o.newObject,f=o.putStream;if(a.metadata instanceof s.API.TTFFont&&a.encoding==="Identity-H"){for(var p=a.metadata.Unicode.widths,v=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),g="",b=0;b<v.length;b++)g+=String.fromCharCode(v[b]);var w=l();f({data:g,addLength1:!0,objectId:w}),h("endobj");var C=l();f({data:r(a.metadata.toUnicode),addLength1:!0,objectId:C}),h("endobj");var x=l();h("<<"),h("/Type /FontDescriptor"),h("/FontName /"+Qo(a.fontName)),h("/FontFile2 "+w+" 0 R"),h("/FontBBox "+s.API.PDFObject.convert(a.metadata.bbox)),h("/Flags "+a.metadata.flags),h("/StemV "+a.metadata.stemV),h("/ItalicAngle "+a.metadata.italicAngle),h("/Ascent "+a.metadata.ascender),h("/Descent "+a.metadata.decender),h("/CapHeight "+a.metadata.capHeight),h(">>"),h("endobj");var k=l();h("<<"),h("/Type /Font"),h("/BaseFont /"+Qo(a.fontName)),h("/FontDescriptor "+x+" 0 R"),h("/W "+s.API.PDFObject.convert(p)),h("/CIDToGIDMap /Identity"),h("/DW 1000"),h("/Subtype /CIDFontType2"),h("/CIDSystemInfo"),h("<<"),h("/Supplement 0"),h("/Registry (Adobe)"),h("/Ordering ("+a.encoding+")"),h(">>"),h(">>"),h("endobj"),a.objectNumber=l(),h("<<"),h("/Type /Font"),h("/Subtype /Type0"),h("/ToUnicode "+C+" 0 R"),h("/BaseFont /"+Qo(a.fontName)),h("/Encoding /"+a.encoding),h("/DescendantFonts ["+k+" 0 R]"),h(">>"),h("endobj"),a.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var a=o.font,h=o.out,l=o.newObject,f=o.putStream;if(a.metadata instanceof s.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var p=a.metadata.rawData,v="",g=0;g<p.length;g++)v+=String.fromCharCode(p[g]);var b=l();f({data:v,addLength1:!0,objectId:b}),h("endobj");var w=l();f({data:r(a.metadata.toUnicode),addLength1:!0,objectId:w}),h("endobj");var C=l();h("<<"),h("/Descent "+a.metadata.decender),h("/CapHeight "+a.metadata.capHeight),h("/StemV "+a.metadata.stemV),h("/Type /FontDescriptor"),h("/FontFile2 "+b+" 0 R"),h("/Flags 96"),h("/FontBBox "+s.API.PDFObject.convert(a.metadata.bbox)),h("/FontName /"+Qo(a.fontName)),h("/ItalicAngle "+a.metadata.italicAngle),h("/Ascent "+a.metadata.ascender),h(">>"),h("endobj"),a.objectNumber=l();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));h("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+Qo(a.fontName)+"/FontDescriptor "+C+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+s.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),h("endobj"),a.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,a=i.text||"",h=i.x,l=i.y,f=i.options||{},p=i.mutex||{},v=p.pdfEscape,g=p.activeFontKey,b=p.fonts,w=g,C="",x=0,k="",I=b[w].encoding;if(b[w].encoding!=="Identity-H")return{text:a,x:h,y:l,options:f,mutex:p};for(k=a,w=g,Array.isArray(a)&&(k=a[0]),x=0;x<k.length;x+=1)b[w].metadata.hasOwnProperty("cmap")&&(o=b[w].metadata.cmap.unicode.codeMap[k[x].charCodeAt(0)]),o||k[x].charCodeAt(0)<256&&b[w].metadata.hasOwnProperty("Unicode")?C+=k[x]:C+="";var G="";return parseInt(w.slice(1))<14||I==="WinAnsiEncoding"?G=v(C,w).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(G=e(C,b[w])),p.isHex=!0,{text:G,x:h,y:l,options:f,mutex:p}};t.events.push(["postProcessText",function(i){var o=i.text||"",a=[],h={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var l=0;for(l=0;l<o.length;l+=1)Array.isArray(o[l])&&o[l].length===3?a.push([n(Object.assign({},h,{text:o[l][0]})).text,o[l][1],o[l][2]]):a.push(n(Object.assign({},h,{text:o[l]})).text);i.text=a}else i.text=n(Object.assign({},h,{text:o})).text}])}(Gt),function(s){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};s.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},s.addFileToVFS=function(e,r){return t.call(this),this.internal.vFS[e]=r,this},s.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(Gt.API),function(s){s.__bidiEngine__=s.prototype.__bidiEngine__=function(r){var n,i,o,a,h,l,f,p=t,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},C=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,I=0;this.__bidiEngine__={};var G=function(N){var M=N.charCodeAt(),z=M>>8,R=w[z];return R!==void 0?p[256*R+(255&M)]:z===252||z===253?"AL":x.test(z)?"L":z===8?"R":"N"},U=function(N){for(var M,z=0;z<N.length;z++){if((M=G(N.charAt(z)))==="L")return!1;if(M==="R")return!0}return!1},nt=function(N,M,z,R){var ht,it,ut,Q,gt=M[R];switch(gt){case"L":case"R":k=!1;break;case"N":case"AN":break;case"EN":k&&(gt="AN");break;case"AL":k=!0,gt="R";break;case"WS":gt="N";break;case"CS":R<1||R+1>=M.length||(ht=z[R-1])!=="EN"&&ht!=="AN"||(it=M[R+1])!=="EN"&&it!=="AN"?gt="N":k&&(it="AN"),gt=it===ht?it:"N";break;case"ES":gt=(ht=R>0?z[R-1]:"B")==="EN"&&R+1<M.length&&M[R+1]==="EN"?"EN":"N";break;case"ET":if(R>0&&z[R-1]==="EN"){gt="EN";break}if(k){gt="N";break}for(ut=R+1,Q=M.length;ut<Q&&M[ut]==="ET";)ut++;gt=ut<Q&&M[ut]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(Q=M.length,ut=R+1;ut<Q&&M[ut]==="NSM";)ut++;if(ut<Q){var pt=N[R],kt=pt>=1425&&pt<=2303||pt===64286;if(ht=M[ut],kt&&(ht==="R"||ht==="AL")){gt="R";break}}}gt=R<1||(ht=M[R-1])==="B"?"N":z[R-1];break;case"B":k=!1,n=!0,gt=I;break;case"S":i=!0,gt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"BN":gt="N"}return gt},J=function(N,M,z){var R=N.split("");return z&&F(R,z,{hiLevel:I}),R.reverse(),M&&M.reverse(),R.join("")},F=function(N,M,z){var R,ht,it,ut,Q,gt=-1,pt=N.length,kt=0,T=[],E=I?g:v,B=[];for(k=!1,n=!1,i=!1,ht=0;ht<pt;ht++)B[ht]=G(N[ht]);for(it=0;it<pt;it++){if(Q=kt,T[it]=nt(N,B,T,it),R=240&(kt=E[Q][b[T[it]]]),kt&=15,M[it]=ut=E[kt][5],R>0)if(R===16){for(ht=gt;ht<it;ht++)M[ht]=1;gt=-1}else gt=-1;if(E[kt][6])gt===-1&&(gt=it);else if(gt>-1){for(ht=gt;ht<it;ht++)M[ht]=ut;gt=-1}B[it]==="B"&&(M[it]=0),z.hiLevel|=ut}i&&function(V,$,at){for(var lt=0;lt<at;lt++)if(V[lt]==="S"){$[lt]=I;for(var ct=lt-1;ct>=0&&V[ct]==="WS";ct--)$[ct]=I}}(B,M,pt)},et=function(N,M,z,R,ht){if(!(ht.hiLevel<N)){if(N===1&&I===1&&!n)return M.reverse(),void(z&&z.reverse());for(var it,ut,Q,gt,pt=M.length,kt=0;kt<pt;){if(R[kt]>=N){for(Q=kt+1;Q<pt&&R[Q]>=N;)Q++;for(gt=kt,ut=Q-1;gt<ut;gt++,ut--)it=M[gt],M[gt]=M[ut],M[ut]=it,z&&(it=z[gt],z[gt]=z[ut],z[ut]=it);kt=Q}kt++}}},dt=function(N,M,z){var R=N.split(""),ht={hiLevel:I};return z||(z=[]),F(R,z,ht),function(it,ut,Q){if(Q.hiLevel!==0&&f)for(var gt,pt=0;pt<it.length;pt++)ut[pt]===1&&(gt=C.indexOf(it[pt]))>=0&&(it[pt]=C[gt+1])}(R,z,ht),et(2,R,M,z,ht),et(1,R,M,z,ht),R.join("")};return this.__bidiEngine__.doBidiReorder=function(N,M,z){if(function(ht,it){if(it)for(var ut=0;ut<ht.length;ut++)it[ut]=ut;a===void 0&&(a=U(ht)),l===void 0&&(l=U(ht))}(N,M),o||!h||l)if(o&&h&&a^l)I=a?1:0,N=J(N,M,z);else if(!o&&h&&l)I=a?1:0,N=dt(N,M,z),N=J(N,M);else if(!o||a||h||l){if(o&&!h&&a^l)N=J(N,M),a?(I=0,N=dt(N,M,z)):(I=1,N=dt(N,M,z),N=J(N,M));else if(o&&a&&!h&&l)I=1,N=dt(N,M,z),N=J(N,M);else if(!o&&!h&&a^l){var R=f;a?(I=1,N=dt(N,M,z),I=0,f=!1,N=dt(N,M,z),f=R):(I=0,N=dt(N,M,z),N=J(N,M),I=1,f=!1,N=dt(N,M,z),f=R,N=J(N,M))}}else I=0,N=dt(N,M,z);else I=a?1:0,N=dt(N,M,z);return N},this.__bidiEngine__.setOptions=function(N){N&&(o=N.isInputVisual,h=N.isOutputVisual,a=N.isInputRtl,l=N.isOutputRtl,f=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new s.__bidiEngine__({isInputVisual:!0});s.API.events.push(["postProcessText",function(r){var n=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,e.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var a=0;for(o=[],a=0;a<n.length;a+=1)Object.prototype.toString.call(n[a])==="[object Array]"?o.push([e.doBidiReorder(n[a][0]),n[a][1],n[a][2]]):o.push([e.doBidiReorder(n[a])]);r.text=o}else r.text=e.doBidiReorder(n);e.setOptions({isInputVisual:!0})}])}(Gt),Gt.API.TTFFont=function(){function s(t){var e;if(this.rawData=t,e=this.contents=new Qi(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Cv(this),this.registerTTF()}return s.open=function(t){return new s(t)},s.prototype.parse=function(){return this.directory=new lv(this.contents),this.head=new fv(this),this.name=new vv(this),this.cmap=new Vp(this),this.toUnicode={},this.hhea=new dv(this),this.maxp=new yv(this),this.hmtx=new bv(this),this.post=new pv(this),this.os2=new gv(this),this.loca=new Sv(this),this.glyf=new wv(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},s.prototype.registerTTF=function(){var t,e,r,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,h,l;for(l=[],o=0,a=(h=this.bbox).length;o<a;o++)t=h[o],l.push(Math.round(t*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(r=255&(n=this.post.italic_angle),(32768&(e=n>>16))!=0&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},s.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},s.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},s.prototype.widthOfString=function(t,e,r){var n,i,o,a;for(o=0,i=0,a=(t=""+t).length;0<=a?i<a:i>a;i=0<=a?++i:--i)n=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/e)||0;return o*(e/1e3)},s.prototype.lineHeight=function(t,e){var r;return e==null&&(e=!1),r=e?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},s}();var Mn,Qi=function(){function s(t){this.data=t??[],this.pos=0,this.length=this.data.length}return s.prototype.readByte=function(){return this.data[this.pos++]},s.prototype.writeByte=function(t){return this.data[this.pos++]=t},s.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},s.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},s.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},s.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},s.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},s.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},s.prototype.readString=function(t){var e,r;for(r=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)r[e]=String.fromCharCode(this.readByte());return r.join("")},s.prototype.writeString=function(t){var e,r,n;for(n=[],e=0,r=t.length;0<=r?e<r:e>r;e=0<=r?++e:--e)n.push(this.writeByte(t.charCodeAt(e)));return n},s.prototype.readShort=function(){return this.readInt16()},s.prototype.writeShort=function(t){return this.writeInt16(t)},s.prototype.readLongLong=function(){var t,e,r,n,i,o,a,h;return t=this.readByte(),e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),a=this.readByte(),h=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^a)+(255^h)+1):72057594037927940*t+281474976710656*e+1099511627776*r+4294967296*n+16777216*i+65536*o+256*a+h},s.prototype.writeLongLong=function(t){var e,r;return e=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},s.prototype.readInt=function(){return this.readInt32()},s.prototype.writeInt=function(t){return this.writeInt32(t)},s.prototype.read=function(t){var e,r;for(e=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)e.push(this.readByte());return e},s.prototype.write=function(t){var e,r,n,i;for(i=[],r=0,n=t.length;r<n;r++)e=t[r],i.push(this.writeByte(e));return i},s}(),lv=function(){var s;function t(e){var r,n,i;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)r={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(e){var r,n,i,o,a,h,l,f,p,v,g,b,w;for(w in g=Object.keys(e).length,h=Math.log(2),p=16*Math.floor(Math.log(g)/h),o=Math.floor(p/h),f=16*g-p,(n=new Qi).writeInt(this.scalarType),n.writeShort(g),n.writeShort(p),n.writeShort(o),n.writeShort(f),i=16*g,l=n.pos+i,a=null,b=[],e)for(v=e[w],n.writeString(w),n.writeInt(s(v)),n.writeInt(l),n.writeInt(v.length),b=b.concat(v),w==="head"&&(a=l),l+=v.length;l%4;)b.push(0),l++;return n.write(b),r=2981146554-s(n.data),n.pos=a+8,n.writeUInt32(r),n.data},s=function(e){var r,n,i,o;for(e=Hp.call(e);e.length%4;)e.push(0);for(i=new Qi(e),n=0,r=0,o=e.length;r<o;r=r+=4)n+=i.readUInt32();return 4294967295&n},t}(),uv={}.hasOwnProperty,ti=function(s,t){for(var e in t)uv.call(t,e)&&(s[e]=t[e]);function r(){this.constructor=s}return r.prototype=t.prototype,s.prototype=new r,s.__super__=t.prototype,s};Mn=function(){function s(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return s.prototype.parse=function(){},s.prototype.encode=function(){},s.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},s}();var fv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var r;return(r=new Qi).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(e),r.writeShort(this.glyphDataFormat),r.data},t}(),Dp=function(){function s(t,e){var r,n,i,o,a,h,l,f,p,v,g,b,w,C,x,k,I;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(h=0;h<256;++h)this.codeMap[h]=t.readByte();break;case 4:for(g=t.readUInt16(),v=g/2,t.pos+=6,i=function(){var G,U;for(U=[],h=G=0;0<=v?G<v:G>v;h=0<=v?++G:--G)U.push(t.readUInt16());return U}(),t.pos+=2,w=function(){var G,U;for(U=[],h=G=0;0<=v?G<v:G>v;h=0<=v?++G:--G)U.push(t.readUInt16());return U}(),l=function(){var G,U;for(U=[],h=G=0;0<=v?G<v:G>v;h=0<=v?++G:--G)U.push(t.readUInt16());return U}(),f=function(){var G,U;for(U=[],h=G=0;0<=v?G<v:G>v;h=0<=v?++G:--G)U.push(t.readUInt16());return U}(),n=(this.length-t.pos+this.offset)/2,a=function(){var G,U;for(U=[],h=G=0;0<=n?G<n:G>n;h=0<=n?++G:--G)U.push(t.readUInt16());return U}(),h=x=0,I=i.length;x<I;h=++x)for(C=i[h],r=k=b=w[h];b<=C?k<=C:k>=C;r=b<=C?++k:--k)f[h]===0?o=r+l[h]:(o=a[f[h]/2+(r-b)-(v-h)]||0)!==0&&(o+=l[h]),this.codeMap[r]=65535&o}t.pos=p}return s.encode=function(t,e){var r,n,i,o,a,h,l,f,p,v,g,b,w,C,x,k,I,G,U,nt,J,F,et,dt,N,M,z,R,ht,it,ut,Q,gt,pt,kt,T,E,B,V,$,at,lt,ct,Ct,Lt,Dt;switch(R=new Qi,o=Object.keys(t).sort(function(Ot,Ht){return Ot-Ht}),e){case"macroman":for(w=0,C=function(){var Ot=[];for(b=0;b<256;++b)Ot.push(0);return Ot}(),k={0:0},i={},ht=0,gt=o.length;ht<gt;ht++)k[ct=t[n=o[ht]]]==null&&(k[ct]=++w),i[n]={old:t[n],new:k[t[n]]},C[n]=k[t[n]];return R.writeUInt16(1),R.writeUInt16(0),R.writeUInt32(12),R.writeUInt16(0),R.writeUInt16(262),R.writeUInt16(0),R.write(C),{charMap:i,subtable:R.data,maxGlyphID:w+1};case"unicode":for(M=[],p=[],I=0,k={},r={},x=l=null,it=0,pt=o.length;it<pt;it++)k[U=t[n=o[it]]]==null&&(k[U]=++I),r[n]={old:U,new:k[U]},a=k[U]-n,x!=null&&a===l||(x&&p.push(x),M.push(n),l=a),x=n;for(x&&p.push(x),p.push(65535),M.push(65535),dt=2*(et=M.length),F=2*Math.pow(Math.log(et)/Math.LN2,2),v=Math.log(F/2)/Math.LN2,J=2*et-F,h=[],nt=[],g=[],b=ut=0,kt=M.length;ut<kt;b=++ut){if(N=M[b],f=p[b],N===65535){h.push(0),nt.push(0);break}if(N-(z=r[N].new)>=32768)for(h.push(0),nt.push(2*(g.length+et-b)),n=Q=N;N<=f?Q<=f:Q>=f;n=N<=f?++Q:--Q)g.push(r[n].new);else h.push(z-N),nt.push(0)}for(R.writeUInt16(3),R.writeUInt16(1),R.writeUInt32(12),R.writeUInt16(4),R.writeUInt16(16+8*et+2*g.length),R.writeUInt16(0),R.writeUInt16(dt),R.writeUInt16(F),R.writeUInt16(v),R.writeUInt16(J),at=0,T=p.length;at<T;at++)n=p[at],R.writeUInt16(n);for(R.writeUInt16(0),lt=0,E=M.length;lt<E;lt++)n=M[lt],R.writeUInt16(n);for(Ct=0,B=h.length;Ct<B;Ct++)a=h[Ct],R.writeUInt16(a);for(Lt=0,V=nt.length;Lt<V;Lt++)G=nt[Lt],R.writeUInt16(G);for(Dt=0,$=g.length;Dt<$;Dt++)w=g[Dt],R.writeUInt16(w);return{charMap:r,subtable:R.data,maxGlyphID:I+1}}},s}(),Vp=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="cmap",t.prototype.parse=function(e){var r,n,i;for(e.pos=this.offset,this.version=e.readUInt16(),i=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new Dp(e,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(e,r){var n,i;return r==null&&(r="macroman"),n=Dp.encode(e,r),(i=new Qi).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t}(),dv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),gv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(e.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),pv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="post",t.prototype.parse=function(e){var r,n,i;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var o;for(n=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],i=[];e.pos<this.offset+this.length;)r=e.readByte(),i.push(this.names.push(e.readString(r)));return i;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 196608:break;case 262144:return this.map=(function(){var a,h,l;for(l=[],o=a=0,h=this.file.maxp.numGlyphs;0<=h?a<h:a>h;o=0<=h?++a:--a)l.push(e.readUInt32());return l}).call(this)}},t}(),mv=function(s,t){this.raw=s,this.length=s.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},vv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="name",t.prototype.parse=function(e){var r,n,i,o,a,h,l,f,p,v,g;for(e.pos=this.offset,e.readShort(),r=e.readShort(),h=e.readShort(),n=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+h+e.readShort()});for(l={},o=p=0,v=n.length;p<v;o=++p)i=n[o],e.pos=i.offset,f=e.readString(i.length),a=new mv(f,i),l[g=i.nameID]==null&&(l[g]=[]),l[i.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},t}(),yv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),bv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="hmtx",t.prototype.parse=function(e){var r,n,i,o,a,h,l;for(e.pos=this.offset,this.metrics=[],r=0,h=this.file.hhea.numberOfMetrics;0<=h?r<h:r>h;r=0<=h?++r:--r)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,p;for(p=[],r=f=0;0<=i?f<i:f>i;r=0<=i?++f:--f)p.push(e.readInt16());return p}(),this.widths=(function(){var f,p,v,g;for(g=[],f=0,p=(v=this.metrics).length;f<p;f++)o=v[f],g.push(o.advance);return g}).call(this),n=this.widths[this.widths.length-1],l=[],r=a=0;0<=i?a<i:a>i;r=0<=i?++a:--a)l.push(this.widths.push(n));return l},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),Hp=[].slice,wv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var r,n,i,o,a,h,l,f,p,v;return e in this.cache?this.cache[e]:(o=this.file.loca,r=this.file.contents,n=o.indexOf(e),(i=o.lengthOf(e))===0?this.cache[e]=null:(r.pos=this.offset+n,a=(h=new Qi(r.read(i))).readShort(),f=h.readShort(),v=h.readShort(),l=h.readShort(),p=h.readShort(),this.cache[e]=a===-1?new _v(h,f,v,l,p):new xv(h,a,f,v,l,p),this.cache[e]))},t.prototype.encode=function(e,r,n){var i,o,a,h,l;for(a=[],o=[],h=0,l=r.length;h<l;h++)i=e[r[h]],o.push(a.length),i&&(a=a.concat(i.encode(n)));return o.push(a.length),{table:a,offsets:o}},t}(),xv=function(){function s(t,e,r,n,i,o){this.raw=t,this.numberOfContours=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return s.prototype.encode=function(){return this.raw.data},s}(),_v=function(){function s(t,e,r,n,i){var o,a;for(this.raw=t,this.xMin=e,this.yMin=r,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return s.prototype.encode=function(){var t,e,r;for(e=new Qi(Hp.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)e.pos=this.glyphOffsets[t];return e.data},s}(),Sv=function(s){function t(){return t.__super__.constructor.apply(this,arguments)}return ti(t,Mn),t.prototype.tag="loca",t.prototype.parse=function(e){var r,n;return e.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=4)o.push(e.readUInt32());return o}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,r){for(var n=new Uint32Array(this.offsets.length),i=0,o=0,a=0;a<n.length;++a)if(n[a]=i,o<r.length&&r[o]==a){++o,n[a]=i;var h=this.offsets[a],l=this.offsets[a+1]-h;l>0&&(i+=l)}for(var f=new Array(4*n.length),p=0;p<n.length;++p)f[4*p+3]=255&n[p],f[4*p+2]=(65280&n[p])>>8,f[4*p+1]=(16711680&n[p])>>16,f[4*p]=(4278190080&n[p])>>24;return f},t}(),Cv=function(){function s(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return s.prototype.generateCmap=function(){var t,e,r,n,i;for(e in n=this.font.cmap.tables[0].codeMap,t={},i=this.subset)r=i[e],t[e]=n[r];return t},s.prototype.glyphsFor=function(t){var e,r,n,i,o,a,h;for(n={},o=0,a=t.length;o<a;o++)n[i=t[o]]=this.font.glyf.glyphFor(i);for(i in e=[],n)(r=n[i])!=null&&r.compound&&e.push.apply(e,r.glyphIDs);if(e.length>0)for(i in h=this.glyphsFor(e))r=h[i],n[i]=r;return n},s.prototype.encode=function(t,e){var r,n,i,o,a,h,l,f,p,v,g,b,w,C,x;for(n in r=Vp.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),g={0:0},x=r.charMap)g[(h=x[n]).old]=h.new;for(b in v=r.maxGlyphID,o)b in g||(g[b]=v++);return f=function(k){var I,G;for(I in G={},k)G[k[I]]=I;return G}(g),p=Object.keys(f).sort(function(k,I){return k-I}),w=function(){var k,I,G;for(G=[],k=0,I=p.length;k<I;k++)a=p[k],G.push(f[a]);return G}(),i=this.font.glyf.encode(o,w,g),l=this.font.loca.encode(i.offsets,w),C={cmap:this.font.cmap.raw(),glyf:i.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(C["OS/2"]=this.font.os2.raw()),this.font.directory.encode(C)},s}();Gt.API.PDFObject=function(){var s;function t(){}return s=function(e,r){return(Array(r+1).join("0")+e).slice(-r)},t.convert=function(e){var r,n,i,o;if(Array.isArray(e))return"["+function(){var a,h,l;for(l=[],a=0,h=e.length;a<h;a++)r=e[a],l.push(t.convert(r));return l}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e?.isString)return"("+e+")";if(e instanceof Date)return"(D:"+s(e.getUTCFullYear(),4)+s(e.getUTCMonth(),2)+s(e.getUTCDate(),2)+s(e.getUTCHours(),2)+s(e.getUTCMinutes(),2)+s(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(n in i=["<<"],e)o=e[n],i.push("/"+n+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+e},t}();export{ft as a,di as b,Vi as c,qc as d,Ka as e,zi as f,Tg as g,Ri as h,bs as i,Ui as j,Io as k,Bo as l,Vn as m,Gt as n,yy as o};
/*! Bundled license information:

jspdf/dist/jspdf.es.min.js:
  (** @license
   *
   * jsPDF - PDF Document creation from JavaScript
   * Version 3.0.1 Built on 2025-03-17T14:19:36.873Z
   *                      CommitID 00000000
   *
   * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
   *               2015-2021 yWorks GmbH, http://www.yworks.com
   *               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
   *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
   *               2010 Aaron Spike, https://github.com/acspike
   *               2012 Willow Systems Corporation, https://github.com/willowsystems
   *               2012 Pablo Hess, https://github.com/pablohess
   *               2012 Florian Jenett, https://github.com/fjenett
   *               2013 Warren Weckesser, https://github.com/warrenweckesser
   *               2013 Youssef Beddad, https://github.com/lifof
   *               2013 Lee Driscoll, https://github.com/lsdriscoll
   *               2013 Stefan Slonevskiy, https://github.com/stefslon
   *               2013 Jeremy Morel, https://github.com/jmorel
   *               2013 Christoph Hartmann, https://github.com/chris-rock
   *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
   *               2014 James Makes, https://github.com/dollaruw
   *               2014 Diego Casorran, https://github.com/diegocr
   *               2014 Steven Spungin, https://github.com/Flamenco
   *               2014 Kenneth Glassey, https://github.com/Gavvers
   *
   * Permission is hereby granted, free of charge, to any person obtaining
   * a copy of this software and associated documentation files (the
   * "Software"), to deal in the Software without restriction, including
   * without limitation the rights to use, copy, modify, merge, publish,
   * distribute, sublicense, and/or sell copies of the Software, and to
   * permit persons to whom the Software is furnished to do so, subject to
   * the following conditions:
   *
   * The above copyright notice and this permission notice shall be
   * included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
   * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
   * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
   * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
   * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   *
   * Contributor(s):
   *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
   *    kim3er, mfo, alnorth, Flamenco
   *)
  (**
   * A class to parse color values
   * @author Stoyan Stefanov <sstoo@gmail.com>
   * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
   * @license Use it if you like it
   *)
  (**
   * @license
   * Joseph Myers does not specify a particular license for his work.
   *
   * Author: Joseph Myers
   * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
   *
   * Modified by: Owen Leong
   *)
  (**
   * @license
   * FPDF is released under a permissive license: there is no usage restriction.
   * You may embed it freely in your application (commercial or not), with or
   * without modifications.
   *
   * Reference: http://www.fpdf.org/en/script/script37.php
   *)
  (**
   * @license
   * Licensed under the MIT License.
   * http://opensource.org/licenses/mit-license
   * Author: Owen Leong (@owenl131)
   * Date: 15 Oct 2020
   * References:
   * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
   * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
   * http://www.fpdf.org/en/script/script37.php
   *)
  (**
   * @license
   *
   * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
   *
   * Permission is hereby granted, free of charge, to any person obtaining
   * a copy of this software and associated documentation files (the
   * "Software"), to deal in the Software without restriction, including
   * without limitation the rights to use, copy, modify, merge, publish,
   * distribute, sublicense, and/or sell copies of the Software, and to
   * permit persons to whom the Software is furnished to do so, subject to
   * the following conditions:
   *
   * The above copyright notice and this permission notice shall be
   * included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
   * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
   * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
   * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
   * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   * ====================================================================
   *)
  (**
   * @license
   * (c) Dean McNamee <dean@gmail.com>, 2013.
   *
   * https://github.com/deanm/omggif
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to
   * deal in the Software without restriction, including without limitation the
   * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
   * sell copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
   * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
   * IN THE SOFTWARE.
   *
   * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
   * including animation and compression.  It does not rely on any specific
   * underlying system, so should run in the browser, Node, or Plask.
   *)
  (**
   * @license
    Copyright (c) 2008, Adobe Systems Incorporated
    All rights reserved.
  
    Redistribution and use in source and binary forms, with or without 
    modification, are permitted provided that the following conditions are
    met:
  
    * Redistributions of source code must retain the above copyright notice, 
      this list of conditions and the following disclaimer.
    
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the 
      documentation and/or other materials provided with the distribution.
    
    * Neither the name of Adobe Systems Incorporated nor the names of its 
      contributors may be used to endorse or promote products derived from 
      this software without specific prior written permission.
  
    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
    IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
    THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
    PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *)
  (**
   * @license
   * Copyright (c) 2017 Aras Abbasi
   *
   * Licensed under the MIT License.
   * http://opensource.org/licenses/mit-license
   *)
*/
