import{a as Qe}from"./chunk-B45V5YRI.js";import{a as Ke}from"./chunk-ZS5CCIUB.js";import{a as Ge}from"./chunk-663N75WB.js";import{a as je}from"./chunk-3AZUY6EQ.js";import{a as Z}from"./chunk-GY3IPELX.js";import"./chunk-MPC7SZEK.js";import{c as ue}from"./chunk-TVASKIN6.js";import{j as We,k as ne,l as Y,m as G}from"./chunk-EDRQHDMA.js";import{a as Le,c as $e,d as Ne,e as qe,g as Fe,h as j,i as ze,j as Be,k as Ve,l as He}from"./chunk-PZ46FPEX.js";import{A as _,Aa as ye,B as we,Bb as Ee,Cc as Ue,Da as y,Gb as l,Ha as Se,Hb as ie,Na as oe,Q as f,Ra as w,Rb as De,S as de,V as Q,Vb as M,Wb as A,Yb as Oe,Z as Ce,_ as T,_b as Re,bc as Te,da as z,ea as B,hb as E,ib as s,j as m,jb as d,k as c,kb as g,l as x,la as ke,lb as S,ma as ae,mb as O,nb as H,ob as J,pb as ee,q as v,r as I,rb as te,sb as V,tb as W,ub as U,w as Pe,wc as Me,yc as Ae,z as he}from"./chunk-DCXCOY7M.js";import"./chunk-LJ5XHLMQ.js";import{a as K,b as X,h as le}from"./chunk-FK42CRUA.js";var re=(r,e)=>{let t=T(G),i=T(j);return t.authState$.pipe(he(n=>!n.loading),v(n=>!!n.user),de(n=>{n||(sessionStorage.setItem("intended-url",e.url),i.navigate([ne.auth.redirectUrls.login],{queryParams:{returnUrl:e.url}}))}))},Ye=(r,e)=>{let t=T(G),i=T(j);return t.authState$.pipe(he(n=>!n.loading),v(n=>!n.user),de(n=>{if(!n){let a=r.queryParams.returnUrl||ne.auth.redirectUrls.success;i.navigateByUrl(a)}}))};var xe=r=>(e,t)=>{let i=T(G),n=T(j);return i.currentUser$.pipe(v(o=>{if(!o)return!1;let a=o.role;return r.includes(a)}),de(o=>{o||n.navigate([ne.auth.redirectUrls.success])}))},F=xe(["admin"]),Xe=xe(["admin","organizer"]),Zt=xe(["admin","organizer","participant"]);var Je=[{path:"",loadComponent:()=>import("./chunk-GI3R2OHS.js").then(r=>r.DashboardComponent),title:"Dashboard - Abel Navarro"},{path:"auth",children:[{path:"callback",loadComponent:()=>import("./chunk-LX2N6HTG.js").then(r=>r.CallbackComponent),title:"Autenticando..."}]},{path:"ingresar",loadComponent:()=>import("./chunk-VHC4O3HC.js").then(r=>r.LoginComponent),canActivate:[Ye],title:"Iniciar Sesi\xF3n - Abel Navarro"},{path:"usuarios",canActivate:[re],children:[{path:"",loadComponent:()=>import("./chunk-NISP6BTE.js").then(r=>r.UserListComponent),title:"Lista de Usuarios"},{path:"nuevo",loadComponent:()=>import("./chunk-D3MFP72L.js").then(r=>r.UserCreateComponent),canActivate:[F],title:"Crear Usuario"},{path:":id/editar",loadComponent:()=>import("./chunk-SU34B3FD.js").then(r=>r.UserEditComponent),canActivate:[F],title:"Editar Usuario"},{path:":id",loadComponent:()=>import("./chunk-PSSKGQFJ.js").then(r=>r.UserDetailComponent),canActivate:[F],title:"Detalle de Usuario"}]},{path:"eventos",canActivate:[re],children:[{path:"",loadComponent:()=>import("./chunk-6YJ54HTL.js").then(r=>r.EventListComponent),title:"Lista de Eventos"},{path:"crear",loadComponent:()=>import("./chunk-RJB6HG6V.js").then(r=>r.EventCreateComponent),canActivate:[F],title:"Crear Evento"},{path:":id",loadComponent:()=>import("./chunk-5CWJOUAV.js").then(r=>r.EventDetailComponent),title:"Detalle del Evento"},{path:":id/editar",loadComponent:()=>import("./chunk-KFBLEVAG.js").then(r=>r.EventEditComponent),canActivate:[F],title:"Editar Evento"},{path:":id/inscritos",loadComponent:()=>import("./chunk-RH2D2F7V.js").then(r=>r.RegistrationListComponent),canActivate:[F],title:"Lista de Inscritos"},{path:":id/asistencia",loadComponent:()=>import("./chunk-RH2D2F7V.js").then(r=>r.RegistrationListComponent),canActivate:[F],title:"Control de Asistencia"}]},{path:"inscripciones",canActivate:[re],children:[{path:"",loadComponent:()=>import("./chunk-RH2D2F7V.js").then(r=>r.RegistrationListComponent),title:"Lista de Inscripciones"},{path:"nueva",loadComponent:()=>import("./chunk-NINRWQR3.js").then(r=>r.RegistrationCreateComponent),title:"Nueva Inscripci\xF3n"},{path:"masiva",loadComponent:()=>import("./chunk-FA34Q6ZP.js").then(r=>r.RegistrationBulkCreateComponent),canActivate:[F],title:"Inscripci\xF3n Masiva"},{path:":id",loadComponent:()=>import("./chunk-XRSLTW72.js").then(r=>r.RegistrationDetailComponent),title:"Detalle de Inscripci\xF3n"},{path:":id/editar",loadComponent:()=>import("./chunk-OGJPYQEQ.js").then(r=>r.RegistrationEditComponent),title:"Editar Inscripci\xF3n"}]},{path:"certificados",canActivate:[re],children:[{path:"",loadComponent:()=>import("./chunk-IVJ7ZZKL.js").then(r=>r.CertificateListComponent),title:"Lista de Certificados"},{path:"generar",loadComponent:()=>import("./chunk-KVZ4QUSN.js").then(r=>r.CertificateGenerateComponent),canActivate:[F],title:"Generar Certificados"},{path:"editor",loadComponent:()=>import("./chunk-YUDECY2F.js").then(r=>r.CertificateEditorComponent),canActivate:[F],title:"Editor de Plantillas"},{path:":id",loadComponent:()=>import("./chunk-IVJ7ZZKL.js").then(r=>r.CertificateListComponent),title:"Detalle del Certificado"}]},{path:"verificar",loadComponent:()=>import("./chunk-PZUTLSE7.js").then(r=>r.CertificateVerifyComponent),title:"Verificar Certificado"},{path:"verificar/:codigo",loadComponent:()=>import("./chunk-PZUTLSE7.js").then(r=>r.CertificateVerifyComponent),title:"Verificando Certificado"},{path:"reportes",canActivate:[re],canActivateChild:[Xe],children:[{path:"",loadComponent:()=>import("./chunk-LY37TRIR.js").then(r=>r.ReportsDashboardComponent),title:"Dashboard de Reportes"},{path:"eventos",loadComponent:()=>import("./chunk-KHBL42AJ.js").then(r=>r.ReportsEventsComponent),title:"Reportes de Eventos"},{path:"certificados",loadComponent:()=>import("./chunk-DC7MAVSA.js").then(r=>r.ReportsCertificatesComponent),title:"Reportes de Certificados"},{path:"participantes",loadComponent:()=>import("./chunk-YLC7AQTG.js").then(r=>r.ReportsParticipantsComponent),title:"Reportes de Participantes"}]},{path:"configuracion",canActivate:[re],canActivateChild:[F],children:[{path:"",redirectTo:"general",pathMatch:"full"},{path:"general",loadComponent:()=>import("./chunk-BOPDLC3P.js").then(r=>r.ConfigGeneralComponent),title:"Configuraci\xF3n General"},{path:"integraciones",loadComponent:()=>import("./chunk-6MR6ZUUR.js").then(r=>r.ConfigIntegrationsComponent),title:"Configuraci\xF3n de Integraciones"}]},{path:"perfil",redirectTo:"/configuracion",pathMatch:"full"},{path:"panel-principal",redirectTo:"/",pathMatch:"full"},{path:"dashboard",redirectTo:"/",pathMatch:"full"},{path:"auth/login",redirectTo:"/ingresar",pathMatch:"full"},{path:"administracion/usuarios",redirectTo:"/usuarios",pathMatch:"full"},{path:"eventos-academicos",redirectTo:"/eventos",pathMatch:"full"},{path:"eventos-academicos/:id",redirectTo:"/eventos/:id"},{path:"eventos-academicos/:id/participantes",redirectTo:"/eventos/:id/inscritos"},{path:"certificados-digitales",redirectTo:"/certificados",pathMatch:"full"},{path:"certificados-digitales/:id",redirectTo:"/certificados/:id"},{path:"verificar-certificado",redirectTo:"/verificar",pathMatch:"full"},{path:"verificar-certificado/:codigo",redirectTo:"/verificar/:codigo"},{path:"certificados-digitales/verificar/:codigo",redirectTo:"/verificar/:codigo"},{path:"users",redirectTo:"/usuarios",pathMatch:"full"},{path:"events",redirectTo:"/eventos",pathMatch:"full"},{path:"registrations",redirectTo:"/inscripciones",pathMatch:"full"},{path:"certificates",redirectTo:"/certificados",pathMatch:"full"},{path:"**",redirectTo:"/"}];var pe=class r{constructor(e,t){this.supabaseService=e;this.staticDataService=t}findById(e){return m(this.supabaseService.client.from("certificates").select(`
          *,
          users:user_id (id, full_name, email, document_number, institution),
          events:event_id (id, title, start_date, end_date, location_type)
        `).eq("id",e).single()).pipe(f(({data:t,error:i})=>i?c({success:!1,error:i.message}):I([c(t),this.staticDataService.participantRoles$]).pipe(v(([n,o])=>({success:!0,data:this.mapToCertificateDto(n,o)})))),_(t=>c({success:!1,error:t.message||"Error buscando certificado"})))}findAll(e){let{page:t=1,pageSize:i=20,search:n,sortBy:o="created_at",sortDirection:a="desc"}=e,p=(t-1)*i,b=p+i-1,u=this.supabaseService.client.from("certificates").select(`
        *,
        users:user_id (id, full_name, email),
        events:event_id (id, title, start_date, end_date)
      `,{count:"exact"});if(e.userId&&(u=u.eq("user_id",e.userId)),e.eventId&&(u=u.eq("event_id",e.eventId)),e.participantRoleId&&(u=u.eq("participant_role_id",e.participantRoleId)),e.templateId&&(u=u.eq("template_id",e.templateId)),e.status){let h=Array.isArray(e.status)?e.status[0]:e.status;typeof h=="string"&&(h.toUpperCase()==="VALID"?u=u.eq("is_valid",!0):h.toUpperCase()==="REVOKED"?u=u.eq("is_valid",!1):h.toUpperCase()==="EXPIRED"&&(u=u.lte("expires_date",new Date().toISOString().slice(0,10))))}if(e.isValid!==void 0&&(u=u.eq("is_valid",e.isValid)),e.dateFrom&&(u=u.gte("created_at",e.dateFrom)),e.dateTo&&(u=u.lte("created_at",e.dateTo)),n){let h=`%${n}%`;u=u.or(`certificate_number.ilike.${h},verification_code.ilike.${h},short_code.ilike.${h}`)}return m(u.order(o,{ascending:a==="asc"}).range(p,b)).pipe(f(({data:h,error:D,count:P})=>{if(D)throw new Error(D.message);return I([c({data:h,count:P}),this.staticDataService.participantRoles$,this.staticDataService.certificateTemplates$]).pipe(v(([k,L,q])=>{let C=k.data?.map(ce=>this.mapToCertificateDto(ce,L,q))||[],R=k.count||0,N=Math.ceil(R/i);return{items:C,total:R,page:t,pageSize:i,totalPages:N,hasNextPage:t<N,hasPreviousPage:t>1}}))}),_(h=>x(()=>h)))}findByUserId(e){return m(this.supabaseService.client.from("certificates").select(`
          *,
          events:event_id (id, title, start_date, end_date)
        `).eq("user_id",e).order("created_at",{ascending:!1})).pipe(f(({data:t,error:i})=>{if(i)throw new Error(i.message);return this.mapArrayToCertificateDtoWithRoles(t||[])}),_(t=>x(()=>t)))}findByEventId(e){return m(this.supabaseService.client.from("certificates").select(`
          *,
          users:user_id (id, full_name, email)
        `).eq("event_id",e).order("created_at",{ascending:!1})).pipe(f(({data:t,error:i})=>{if(i)throw new Error(i.message);return this.mapArrayToCertificateDtoWithRoles(t||[])}),_(t=>x(()=>t)))}create(e){let t={user_id:e.userId,event_id:e.eventId,participant_role_id:e.participantRoleId||1,template_id:e.templateId||1,certificate_number:this.generateCertificateNumber(),verification_code:this.generateVerificationCode(),short_code:this.generateShortCode(),issue_date:new Date().toISOString(),is_valid:!0,download_count:0,verification_count:0,certificate_hash:this.generateHash(),qr_data:this.generateQRData(),metadata:e.customData||{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("certificates").insert([t]).select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title, start_date, end_date)
        `).single()).pipe(f(({data:i,error:n})=>n?c({success:!1,error:n.message}):this.mapToCertificateDtoWithRoles(i).pipe(v(o=>({success:!0,data:o})))),_(i=>c({success:!1,error:i.message||"Error creando certificado"})))}createQuickCertificate(e){let t={user_id:e.userId,event_id:e.eventId,participant_role_id:e.participantRoleId,template_id:e.templateId,certificate_number:this.generateCertificateNumber(),verification_code:this.generateVerificationCode(),short_code:this.generateShortCode(),issue_date:new Date().toISOString(),expires_date:null,is_valid:!0,revocation_reason:null,revoked_at:null,revoked_by:null,download_count:0,verification_count:0,last_downloaded:null,last_verified:null,certificate_hash:this.generateHash(),qr_data:this.generateQRData(),blockchain_tx:null,metadata:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("certificates").insert([t]).select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title, start_date, end_date)
        `).single()).pipe(f(({data:i,error:n})=>n?c({success:!1,error:n.message}):this.mapToCertificateDtoWithRoles(i).pipe(v(o=>({success:!0,data:o})))),_(i=>c({success:!1,error:i.message||"Error creando certificado r\xE1pido"})))}update(e,t){let i=X(K({},this.mapToSupabaseFormat(t)),{updated_at:new Date().toISOString()});return m(this.supabaseService.client.from("certificates").update(i).eq("id",e).select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title, start_date, end_date)
        `).single()).pipe(f(({data:n,error:o})=>o?c({success:!1,error:o.message}):this.mapToCertificateDtoWithRoles(n).pipe(v(a=>({success:!0,data:a})))),_(n=>c({success:!1,error:n.message||"Error actualizando certificado"})))}delete(e){return m(this.supabaseService.client.from("certificates").delete().eq("id",e)).pipe(v(({error:t})=>t?{success:!1,error:t.message}:{success:!0}),_(t=>c({success:!1,error:t.message||"Error eliminando certificado"})))}generateBulk(e){let t=e.userIds.map(i=>({user_id:i,event_id:e.eventId,participant_role_id:e.participantRoleId,template_id:e.templateId||1,issue_date:new Date().toISOString(),is_valid:!0,download_count:0,verification_count:0,metadata:e.customData||{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));return m(this.supabaseService.client.from("certificates").insert(t).select()).pipe(f(({data:i,error:n})=>n?c({success:!1,results:[],summary:{total:t.length,successful:0,failed:t.length,errors:[n.message]}}):I([c(i||[]),this.staticDataService.participantRoles$,this.staticDataService.certificateTemplates$]).pipe(v(([o,a,p])=>{let b=o.map(u=>({success:!0,data:this.mapToCertificateDto(u,a,p)}));return{success:!0,results:b,summary:{total:b.length,successful:b.length,failed:0,errors:[]}}}))),_(i=>c({success:!1,results:[],summary:{total:0,successful:0,failed:0,errors:[i.message||"Error en generaci\xF3n masiva"]}})))}verify(e){let t=this.supabaseService.client.from("certificates").select(`
        *,
        users:user_id (id, full_name, email),
        events:event_id (id, title, start_date, end_date)
      `);return t=t.or(`verification_code.eq.${e.code},short_code.eq.${e.code}`),m(t.single()).pipe(f(({data:i,error:n})=>n||!i?c({success:!0,data:{isValid:!1,result:"invalid",message:"Certificado no encontrado",verifiedAt:new Date().toISOString(),attempts:1}}):m(this.supabaseService.client.from("certificates").update({verification_count:i.verification_count+1,last_verified:new Date().toISOString()}).eq("id",i.id)).pipe(v(()=>{let o=i.is_valid&&(!i.expires_date||new Date(i.expires_date)>new Date);return{success:!0,data:{isValid:o,result:o?"valid":"expired",certificate:o?this.mapToCertificateDto(i):void 0,message:o?"Certificado v\xE1lido":"Certificado expirado o revocado",verifiedAt:new Date().toISOString(),attempts:i.verification_count+1}}}))),_(i=>c({success:!1,error:i.message||"Error verificando certificado"})))}revoke(e,t){let i={is_valid:!1,revocation_reason:t,revoked_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("certificates").update(i).eq("id",e)).pipe(v(({error:n})=>n?{success:!1,error:n.message}:{success:!0}),_(n=>c({success:!1,error:n.message||"Error revocando certificado"})))}changeTemplate(e){let t=K({template_id:e.newTemplateId,updated_at:new Date().toISOString()},e.regenerate&&{status:"pending_regeneration"});return m(this.supabaseService.client.from("certificates").update(t).eq("id",e.certificateId).select(`
          *,
          users:user_id (id, full_name, email, document_number, institution),
          events:event_id (id, title, start_date, end_date, location_type)
        `).single()).pipe(f(({data:i,error:n})=>{if(n)return c({success:!1,error:n.message});let o=e.reason?this.logTemplateChange(e.certificateId,e.newTemplateId,e.reason):Promise.resolve();return m(o).pipe(f(()=>I([c(i),this.staticDataService.participantRoles$]).pipe(v(([a,p])=>({success:!0,data:this.mapToCertificateDto(a,p)})))))}),_(i=>c({success:!1,error:i.message||"Error cambiando plantilla de certificado"})))}findByVerificationCode(e){return m(this.supabaseService.client.from("certificates").select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title, start_date, end_date)
        `).eq("verification_code",e).single()).pipe(v(({data:t,error:i})=>i?{success:!1,error:i.message}:{success:!0,data:this.mapToCertificateDto(t)}),_(t=>c({success:!1,error:t.message||"Certificado no encontrado"})))}findByShortCodeForTemplate(e){return m(this.supabaseService.client.from("certificates").select(`
          id,
          certificate_number,
          verification_code,
          short_code,
          issue_date,
          expires_date,
          is_valid,
          user_id,
          event_id,
          participant_role_id,
          template_id,
          metadata,
          users!inner (
            id,
            full_name,
            document_type,
            document_number,
            email,
            institution
          ),
          events!inner (
            id,
            title,
            start_date,
            end_date,
            duration_hours,
            venue_name,
            venue_city,
            minimum_attendance_percentage,
            metadata
          )
        `).eq("short_code",e).eq("is_valid",!0).single()).pipe(f(({data:t,error:i})=>i||!t?c({success:!1,error:i?.message||"Certificado no encontrado"}):m(this.supabaseService.client.from("registrations").select(`
              participant_role_id,
              attendance_percentage,
              attendance_verified,
              metadata,
              registration_states!inner (display_name)
            `).eq("user_id",t.user_id).eq("event_id",t.event_id).eq("participant_role_id",t.participant_role_id).single()).pipe(f(({data:n,error:o})=>I([c({certificate:t,registration:n}),this.staticDataService.participantRoles$]).pipe(v(([a,p])=>{let b=p?.[t.participant_role_id];return{success:!0,data:{certificate_id:a.certificate.id,certificate_number:a.certificate.certificate_number,verification_code:a.certificate.verification_code,short_code:a.certificate.short_code,issue_date:a.certificate.issue_date,expires_date:a.certificate.expires_date,is_valid:a.certificate.is_valid,user_id:a.certificate.user_id,participant_name:a.certificate.users?.full_name||"",document_type:a.certificate.users?.document_type||"",document_number:a.certificate.users?.document_number||null,participant_email:a.certificate.users?.email||"",participant_institution:a.certificate.users?.institution||null,event_id:a.certificate.event_id,event_title:a.certificate.events?.title||"",event_start_date:a.certificate.events?.start_date||"",event_end_date:a.certificate.events?.end_date||"",duration_hours:a.certificate.events?.duration_hours||null,venue_name:a.certificate.events?.venue_name||null,venue_city:a.certificate.events?.venue_city||null,minimum_attendance_percentage:a.certificate.events?.minimum_attendance_percentage||80,participant_role_id:a.certificate.participant_role_id,attendance_percentage:a.registration?.attendance_percentage||0,attendance_verified:a.registration?.attendance_verified||!1,registration_state:a.registration?.registration_states?.display_name||"",role_name:b?.name||"Participante",role_certificate_title:b?.certificateTitle||"Certificado de Participaci\xF3n",role_description:b?.description||"",role_certificate_text_template:b?.certificateTextTemplate||"",template_id:a.certificate.template_id,certificate_metadata:a.certificate.metadata,event_metadata:a.certificate.events?.metadata,registration_metadata:a.registration?.metadata}}}))))),_(t=>c({success:!1,error:t.message||"Error buscando certificado para template"})))}findByShortCode(e){return m(this.supabaseService.client.from("certificates").select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title, start_date, end_date)
        `).eq("short_code",e).single()).pipe(v(({data:t,error:i})=>i?{success:!1,error:i.message}:{success:!0,data:this.mapToCertificateDto(t)}),_(t=>c({success:!1,error:t.message||"Certificado no encontrado"})))}findExpiringSoon(e){let t=new Date;return t.setDate(t.getDate()+e),m(this.supabaseService.client.from("certificates").select(`
          *,
          users:user_id (id, full_name, email),
          events:event_id (id, title)
        `).lte("expires_date",t.toISOString()).eq("is_valid",!0).order("expires_date",{ascending:!0})).pipe(v(({data:i,error:n})=>{if(n)throw new Error(n.message);return i?.map(o=>this.mapToCertificateDto(o))||[]}),_(i=>x(()=>i)))}getStats(e){let t=this.supabaseService.client.from("certificates").select("*",{count:"exact",head:!0});return e&&(t=t.eq("event_id",e)),m(t).pipe(v(({count:i,error:n})=>{if(n)throw new Error(n.message);return{total:i||0}}),_(i=>x(()=>i)))}getVerificationHistory(e){return c([])}findEligibleRegistrations(e){let t=this.supabaseService.client.from("registrations").select(`
        id,
        user_id,
        event_id,
        participant_role_id,
        registration_date,
        current_state_id,
        users:user_id (
          id,
          full_name,
          email,
          document_number,
          institution
        ),
        events:event_id (
          id,
          title,
          start_date,
          end_date,
          event_type_id
        )
      `).eq("event_id",e.eventId).eq("participant_role_id",e.participantRoleId).eq("current_state_id",9).order("registration_date",{ascending:!0}),i=this.supabaseService.client.from("certificates").select("id, user_id, event_id, participant_role_id, template_id, certificate_number, issue_date, is_valid, download_count").eq("event_id",e.eventId).eq("participant_role_id",e.participantRoleId);return Pe([m(t),m(i)]).pipe(f(([n,o])=>{if(n.error)return c({success:!1,error:n.error.message});if(o.error)return c({success:!1,error:o.error.message});let a=n.data||[],p=o.data||[];return I([c({registrations:a,certificates:p}),this.staticDataService.eventTypes$,this.staticDataService.participantRoles$]).pipe(v(([b,u,h])=>{let D=b.registrations.map($=>this.mapToEligibleRegistrationDto($,u,h,p)),P=D.filter($=>$.hasCertificate).length,k=D.filter($=>!$.hasCertificate).length,L=D[0]?.event.title||"Evento no encontrado",R=Object.values(h||{})[e.participantRoleId-1]?.name||`Rol ${e.participantRoleId}`,N=D;return e.onlyPending?N=D.filter($=>!$.hasCertificate):e.includeWithCertificates||(N=D.filter($=>!$.hasCertificate)),{success:!0,data:{items:N,summary:{total:D.length,withCertificates:P,pendingCertificates:k,eventTitle:L,participantRole:R}}}}))}),_(n=>c({success:!1,error:n.message||"Error cargando registros elegibles para certificados"})))}logTemplateChange(e,t,i){return le(this,null,function*(){try{yield this.supabaseService.client.from("certificate_audit_log").insert({certificate_id:e,action:"template_change",old_template_id:null,new_template_id:t,reason:i,changed_at:new Date().toISOString(),changed_by:null})}catch(n){console.error("Error logging template change:",n)}})}mapToCertificateDtoWithRoles(e){return this.staticDataService.participantRoles$.pipe(v(t=>this.mapToCertificateDto(e,t)))}mapArrayToCertificateDtoWithRoles(e){return this.staticDataService.participantRoles$.pipe(v(t=>e.map(i=>this.mapToCertificateDto(i,t))))}mapToEligibleRegistrationDto(e,t,i,n){let o={id:e.users?.id||e.user_id,fullName:e.users?.full_name||"Usuario sin nombre",email:e.users?.email||"Sin email",documentNumber:e.users?.document_number,institution:e.users?.institution},a={id:e.events?.id||e.event_id,title:e.events?.title||"Evento sin t\xEDtulo",startDate:e.events?.start_date||"",endDate:e.events?.end_date||"",eventType:this.getEventTypeName(e.events?.event_type_id,t)},p=n.find(h=>h.user_id===e.user_id&&h.event_id===e.event_id&&h.participant_role_id===e.participant_role_id),b=p?{id:p.id,certificateNumber:p.certificate_number,issueDate:p.issue_date,isValid:p.is_valid,downloadCount:p.download_count,templateId:p.template_id}:null,u=b!==null;return{registrationId:e.id,userId:e.user_id,eventId:e.event_id,participantRoleId:e.participant_role_id,registrationDate:e.registration_date,currentStateId:e.current_state_id,user:o,event:a,certificate:b,hasCertificate:u,isCheckable:!u}}getEventTypeName(e,t){return t&&Object.values(t).find(n=>n.id===e)?.name||"Tipo desconocido"}mapToCertificateDto(e,t,i){let n;if(t&&e.participant_role_id){let a=t[e.participant_role_id.toString()];a&&(n={name:a.name,certificateTitle:a.certificateTitle,certificateTextTemplate:a.certificateTextTemplate||""})}let o;return i&&e.template_id&&(o=i[e.template_id.toString()]?.templateUrl),{id:e.id,userId:e.user_id,eventId:e.event_id,participantRoleId:e.participant_role_id,templateId:e.template_id,templateUrl:o,certificateNumber:e.certificate_number,verificationCode:e.verification_code,shortCode:e.short_code,issueDate:e.issue_date,expiresDate:e.expires_date,isValid:e.is_valid,revocationReason:e.revocation_reason,revokedAt:e.revoked_at,revokedBy:e.revoked_by,downloadCount:e.download_count,verificationCount:e.verification_count,lastDownloaded:e.last_downloaded,lastVerified:e.last_verified,certificateHash:e.certificate_hash,qrData:e.qr_data,verificationUrl:`${window.location.origin}/verify/${e.short_code}`,blockchainTx:e.blockchain_tx,metadata:e.metadata||{},createdAt:e.created_at,updatedAt:e.updated_at,participant:e.users?{id:e.users.id,fullName:e.users.full_name,email:e.users.email,documentNumber:e.users.document_number,institution:e.users.institution}:void 0,event:e.events?{id:e.events.id,title:e.events.title,startDate:e.events.start_date,endDate:e.events.end_date,locationType:e.events.location_type,venueName:e.events.venue_name,venueCity:e.events.venue_city,durationHours:e.events.duration_hours}:void 0,roleInfo:n}}mapToSupabaseFormat(e){let t={};return e.userId!==void 0&&(t.user_id=e.userId),e.eventId!==void 0&&(t.event_id=e.eventId),e.participantRoleId!==void 0&&(t.participant_role_id=e.participantRoleId),e.templateId!==void 0&&(t.template_id=e.templateId),e.certificateNumber!==void 0&&(t.certificate_number=e.certificateNumber),e.verificationCode!==void 0&&(t.verification_code=e.verificationCode),e.shortCode!==void 0&&(t.short_code=e.shortCode),e.issueDate!==void 0&&(t.issue_date=e.issueDate),e.expiresDate!==void 0&&(t.expires_date=e.expiresDate),e.isValid!==void 0&&(t.is_valid=e.isValid),e.revocationReason!==void 0&&(t.revocation_reason=e.revocationReason),e.revokedAt!==void 0&&(t.revoked_at=e.revokedAt),e.revokedBy!==void 0&&(t.revoked_by=e.revokedBy),e.downloadCount!==void 0&&(t.download_count=e.downloadCount),e.verificationCount!==void 0&&(t.verification_count=e.verificationCount),e.lastDownloaded!==void 0&&(t.last_downloaded=e.lastDownloaded),e.lastVerified!==void 0&&(t.last_verified=e.lastVerified),e.certificateHash!==void 0&&(t.certificate_hash=e.certificateHash),e.qrData!==void 0&&(t.qr_data=e.qrData),e.blockchainTx!==void 0&&(t.blockchain_tx=e.blockchainTx),e.metadata!==void 0&&(t.metadata=e.metadata),t}generateCertificateNumber(){let e=new Date().getFullYear(),t=Date.now();return`CERT-${e}-${t.toString().slice(-6)}`}generateVerificationCode(){return`CERT-${Date.now().toString(36).toUpperCase()}-${Math.random().toString(36).substring(2,8).toUpperCase()}`}generateShortCode(){return Math.random().toString(36).substring(2,8).toUpperCase()}generateHash(){return`hash_${Math.random().toString(36).substring(2,32)}`}generateQRData(){return`${window.location.origin}/verify/${this.generateShortCode()}`}static \u0275fac=function(t){return new(t||r)(Ce(Y),Ce(Z))};static \u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"})};var me=class r{supabase=T(Y);staticData=T(Z);findById(e){return m(this.supabase.client.from("users").select("*").eq("id",e).single()).pipe(f(t=>t.error?c({success:!1,error:`Usuario no encontrado: ${t.error.message}`}):this.mapToUserDtoWithLocation(t.data).pipe(v(i=>({success:!0,data:i})))),_(t=>c({success:!1,error:`Error obteniendo usuario: ${t.message}`})))}findAll(e){let t=this.supabase.client.from("users").select("*",{count:"exact"});t=this.applyFilters(t,e);let i=((e.page||1)-1)*(e.pageSize||10);t=t.range(i,i+(e.pageSize||10)-1);let n=e.sortBy||"created_at",o=e.sortDirection==="asc"?{ascending:!0}:{ascending:!1};return t=t.order(n,o),m(t).pipe(f(a=>{if(a.error)throw new Error(`Error en consulta: ${a.error.message}`);let p=a.data||[],b=a.count||0,u=p.map(h=>this.mapToUserDtoWithLocation(h));return u.length===0?c({items:[],total:0,page:e.page||1,pageSize:e.pageSize||10,totalPages:0,hasNextPage:!1,hasPreviousPage:!1}):I(u).pipe(v(h=>({items:h,total:b,page:e.page||1,pageSize:e.pageSize||10,totalPages:Math.ceil(b/(e.pageSize||10)),hasNextPage:(e.page||1)*(e.pageSize||10)<b,hasPreviousPage:(e.page||1)>1})))}),_(a=>c({items:[],total:0,page:e.page||1,pageSize:e.pageSize||10,totalPages:0,hasNextPage:!1,hasPreviousPage:!1})))}findByEmail(e){return m(this.supabase.client.from("users").select("*").eq("email",e).single()).pipe(f(t=>t.error?c({success:!1,error:`Usuario no encontrado: ${t.error.message}`}):this.mapToUserDtoWithLocation(t.data).pipe(v(i=>({success:!0,data:i})))),_(t=>c({success:!1,error:`Error buscando usuario por email: ${t.message}`})))}findByDocument(e){return m(this.supabase.client.from("users").select("*").eq("document_number",e).single()).pipe(f(t=>t.error?c({success:!1,error:`Usuario no encontrado: ${t.error.message}`}):this.mapToUserDtoWithLocation(t.data).pipe(v(i=>({success:!0,data:i})))),_(t=>c({success:!1,error:`Error buscando usuario por documento: ${t.message}`})))}create(e){return this.staticData.departments$.pipe(f(t=>{if(!t||!t[e.departmentId?.toString()])return c({success:!1,error:`Departamento no v\xE1lido: ${e.departmentId}`});let i={email:e.email,full_name:e.fullName,document_type:e.documentType,document_number:e.documentNumber,phone:e.phone,department_id:e.departmentId,institution:e.institution,job_title:e.jobTitle,role:"participant",is_active:!0,profile_completed:!1,email_verified:!1,phone_verified:!1,accepts_marketing:!1,events_attended:0,certificates_earned:0,login_count:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabase.client.from("users").insert([i]).select("*").single()).pipe(f(n=>n.error?c({success:!1,error:`Error creando usuario: ${n.error.message}`}):this.mapToUserDtoWithLocation(n.data).pipe(v(o=>({success:!0,data:o})))))}),_(t=>c({success:!1,error:`Error creando usuario: ${t.message}`})))}createQuickUser(e){return this.staticData.departments$.pipe(f(i=>{if(!i||!i[15])return c({success:!1,error:"Departamento por defecto no v\xE1lido: 15"});let n={email:e.email,full_name:e.fullName,document_type:"DNI",document_number:"",phone:"",department_id:15,province_id:null,district_id:null,institution:"",job_title:"",role:"participant",is_active:!0,profile_completed:!1,email_verified:!1,phone_verified:!1,accepts_marketing:!1,events_attended:0,certificates_earned:0,login_count:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabase.client.from("users").insert([n]).select("*").single()).pipe(f(o=>o.error?c({success:!1,error:`Error creando usuario r\xE1pido: ${o.error.message}`}):this.mapToUserDtoWithLocation(o.data).pipe(v(a=>({success:!0,data:a})))))}),_(i=>c({success:!1,error:`Error creando usuario r\xE1pido: ${i.message}`})))}update(e,t){return t.departmentId?this.staticData.departments$.pipe(f(i=>!i||!t.departmentId||!i[t.departmentId.toString()]?c({success:!1,error:`Departamento no v\xE1lido: ${t.departmentId}`}):this.performUpdate(e,t)),_(i=>c({success:!1,error:`Error actualizando usuario: ${i.message}`}))):this.performUpdate(e,t)}performUpdate(e,t){let i=this.mapToSupabaseFormat(t);return i.updated_at=new Date().toISOString(),m(this.supabase.client.from("users").update(i).eq("id",e).select("*")).pipe(f(n=>{if(n.error)return c({success:!1,error:`Error actualizando usuario: ${n.error.message}`});if(!n.data||n.data.length===0)return c({success:!1,error:"Usuario no encontrado o sin permisos para actualizar. Verifica las pol\xEDticas RLS."});let o=n.data[0];return this.mapToUserDtoWithLocation(o).pipe(v(a=>({success:!0,data:a})))}),_(n=>c({success:!1,error:`Error actualizando usuario: ${n.message}`})))}delete(e){return m(this.supabase.client.from("users").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",e)).pipe(v(t=>t.error?{success:!1,error:`Error desactivando usuario: ${t.error.message}`}:{success:!0}),_(t=>c({success:!1,error:`Error desactivando usuario: ${t.message}`})))}changeRole(e,t){return m(this.supabase.client.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e).select("*").single()).pipe(f(i=>i.error?c({success:!1,error:`Error cambiando rol: ${i.error.message}`}):this.mapToUserDtoWithLocation(i.data).pipe(v(n=>({success:!0,data:n})))),_(i=>c({success:!1,error:`Error cambiando rol: ${i.message}`})))}activateDeactivate(e,t){return m(this.supabase.client.from("users").update({is_active:t,updated_at:new Date().toISOString()}).eq("id",e).select("*").single()).pipe(f(i=>i.error?c({success:!1,error:`Error cambiando estado: ${i.error.message}`}):this.mapToUserDtoWithLocation(i.data).pipe(v(n=>({success:!0,data:n})))),_(i=>c({success:!1,error:`Error cambiando estado: ${i.message}`})))}verifyEmail(e){return m(this.supabase.client.from("users").update({email_verified:!0,updated_at:new Date().toISOString()}).eq("id",e)).pipe(v(t=>t.error?{success:!1,error:`Error verificando email: ${t.error.message}`}:{success:!0}),_(t=>c({success:!1,error:`Error verificando email: ${t.message}`})))}verifyPhone(e){return m(this.supabase.client.from("users").update({phone_verified:!0,updated_at:new Date().toISOString()}).eq("id",e)).pipe(v(t=>t.error?{success:!1,error:`Error verificando tel\xE9fono: ${t.error.message}`}:{success:!0}),_(t=>c({success:!1,error:`Error verificando tel\xE9fono: ${t.message}`})))}findByRole(e){return m(this.supabase.client.from("users").select("*").eq("role",e).eq("is_active",!0)).pipe(f(t=>{if(t.error)return c([]);let i=t.data||[];if(i.length===0)return c([]);let n=i.map(o=>this.mapToUserDtoWithLocation(o));return I(n)}),_(()=>c([])))}findByDepartment(e){return m(this.supabase.client.from("users").select("*").eq("department_id",e).eq("is_active",!0)).pipe(f(t=>{if(t.error)return c([]);let i=t.data||[];if(i.length===0)return c([]);let n=i.map(o=>this.mapToUserDtoWithLocation(o));return I(n)}),_(()=>c([])))}findRecentlyRegistered(e){let t=new Date;return t.setDate(t.getDate()-e),m(this.supabase.client.from("users").select("*").gte("created_at",t.toISOString()).order("created_at",{ascending:!1}).limit(20)).pipe(f(i=>{if(i.error)return c([]);let n=i.data||[];if(n.length===0)return c([]);let o=n.map(a=>this.mapToUserDtoWithLocation(a));return I(o)}),_(()=>c([])))}search(e){let t=`%${e}%`;return m(this.supabase.client.from("users").select("*").or(`full_name.ilike.${t},email.ilike.${t},document_number.ilike.${t}`).eq("is_active",!0).limit(10)).pipe(f(i=>{if(i.error)return c([]);let n=i.data||[];if(n.length===0)return c([]);let o=n.map(a=>this.mapToUserDtoWithLocation(a));return I(o)}),_(()=>c([])))}queryUsers(e){let{query:t="",limit:i=10}=e;if(!t||t.trim().length<1)return m(this.supabase.client.from("users").select("id, email, full_name, document_number, institution").eq("is_active",!0).order("created_at",{ascending:!1}).limit(Math.min(i,15))).pipe(v(o=>o.error||!o.data?[]:o.data.map(a=>({id:a.id,email:a.email,fullName:a.full_name||"",documentNumber:a.document_number||void 0,institution:a.institution||void 0}))),_(o=>(console.error("Error in queryUsers (preload):",o),c([]))));let n=`%${t.trim()}%`;return m(this.supabase.client.from("users").select("id, email, full_name, document_number, institution").or(`full_name.ilike.${n},email.ilike.${n},document_number.ilike.${n}`).eq("is_active",!0).order("full_name",{ascending:!0}).limit(Math.min(i,20))).pipe(v(o=>o.error||!o.data?[]:o.data.map(a=>({id:a.id,email:a.email,fullName:a.full_name||"",documentNumber:a.document_number||void 0,institution:a.institution||void 0}))),_(o=>(console.error("Error in queryUsers:",o),c([]))))}getStats(e){return e?this.findById(e).pipe(v(t=>{if(!t.success||!t.data)return{eventsAttended:0,certificatesEarned:0,loginCount:0,lastLogin:null};let i=t.data;return{eventsAttended:i.eventsAttended,certificatesEarned:i.certificatesEarned,lastLogin:i.lastLogin}})):m(this.supabase.client.from("users").select("*")).pipe(v(t=>{if(t.error)return{total:0,active:0,byRole:{},recentRegistrations:0};let i=t.data||[],n=new Date,o=new Date(n.getTime()-7*24*60*60*1e3);return{total:i.length,active:i.filter(a=>a.is_active).length,byRole:i.reduce((a,p)=>(a[p.role]=(a[p.role]||0)+1,a),{}),recentRegistrations:i.filter(a=>new Date(a.created_at)>=o).length}}),_(()=>c({total:0,active:0,byRole:{},recentRegistrations:0})))}getDashboardStats(){return this.getStats()}applyFilters(e,t){if(t.search){let i=`%${t.search}%`;e=e.or(`full_name.ilike.${i},email.ilike.${i},document_number.ilike.${i}`)}if(t.role&&(e=e.eq("role",t.role)),t.isActive!==void 0&&(e=e.eq("is_active",t.isActive)),t.departmentId&&(e=e.eq("department_id",t.departmentId)),t.emailVerified!==void 0&&(e=e.eq("email_verified",t.emailVerified)),t.phoneVerified!==void 0&&(e=e.eq("phone_verified",t.phoneVerified)),t.profileCompleted!==void 0&&(e=e.eq("profile_completed",t.profileCompleted)),t.dateFrom&&(e=e.gte("created_at",t.dateFrom)),t.dateTo){let i=new Date(t.dateTo);i.setHours(23,59,59,999),e=e.lte("created_at",i.toISOString())}return e}mapToUserDtoWithLocation(e){return this.staticData.departments$.pipe(v(t=>{let i;if(t&&e.department_id){let n=t[e.department_id.toString()];n&&(i={code:n.code,name:n.name,region:n.region})}return{id:e.id,email:e.email,fullName:e.full_name,documentType:e.document_type,documentNumber:e.document_number,phone:e.phone,departmentId:e.department_id,provinceId:e.province_id,districtId:e.district_id,institution:e.institution,jobTitle:e.job_title,role:e.role,isActive:e.is_active,profileCompleted:e.profile_completed,emailVerified:e.email_verified,phoneVerified:e.phone_verified,eventsAttended:e.events_attended,certificatesEarned:e.certificates_earned,lastLogin:e.last_login,createdAt:e.created_at,updatedAt:e.updated_at,departmentInfo:i}}))}mapToSupabaseFormat(e){let t={};return"fullName"in e&&e.fullName!==void 0&&(t.full_name=e.fullName),"documentType"in e&&e.documentType!==void 0&&(t.document_type=e.documentType),"documentNumber"in e&&e.documentNumber!==void 0&&(t.document_number=e.documentNumber),"phone"in e&&e.phone!==void 0&&(t.phone=e.phone),"departmentId"in e&&e.departmentId!==void 0&&(t.department_id=e.departmentId),"provinceId"in e&&e.provinceId!==void 0&&(t.province_id=e.provinceId),"districtId"in e&&e.districtId!==void 0&&(t.district_id=e.districtId),"institution"in e&&e.institution!==void 0&&(t.institution=e.institution),"jobTitle"in e&&e.jobTitle!==void 0&&(t.job_title=e.jobTitle),"acceptsMarketing"in e&&e.acceptsMarketing!==void 0&&(t.accepts_marketing=e.acceptsMarketing),t}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"})};var fe=class r{supabase=T(Y);staticData=T(Z);findById(e){return m(this.supabase.client.from("events").select("*").eq("id",e).single()).pipe(f(({data:t,error:i})=>i?c({success:!1,error:i.message}):I([c(t),this.staticData.eventTypes$]).pipe(v(([n,o])=>({success:!0,data:this.mapToEventDto(n,o)})))),_(t=>c({success:!1,error:t.message||"Error buscando evento"})))}findAll(e){let{page:t=1,pageSize:i=20,search:n,sortBy:o="created_at",sortDirection:a="desc"}=e,p=(t-1)*i,b=p+i-1,u=this.supabase.client.from("events").select("*",{count:"exact"});return e.status&&(u=u.eq("status",e.status)),e.eventTypeId&&(u=u.eq("event_type_id",e.eventTypeId)),e.organizerId&&(u=u.eq("organizer_id",e.organizerId)),e.location&&(u=u.eq("location_type",e.location)),e.isPublic!==void 0&&(u=u.eq("is_public",e.isPublic)),e.tags&&e.tags.length&&(u=u.contains("tags",e.tags)),e.dateFrom&&(u=u.gte("start_date",e.dateFrom)),e.dateTo&&(u=u.lte("end_date",e.dateTo)),n&&(u=u.or(`title.ilike.%${n}%,description.ilike.%${n}%`)),m(u.order(o,{ascending:a==="asc"}).range(p,b)).pipe(f(({data:h,error:D,count:P})=>{if(D)throw new Error(D.message);return I([c({data:h,count:P}),this.staticData.eventTypes$]).pipe(v(([k,L])=>{let q=k.data?.map(N=>this.mapToEventDto(N,L))||[],C=k.count||0,R=Math.ceil(C/i);return{items:q,total:C,page:t,pageSize:i,totalPages:R,hasNextPage:t<R,hasPreviousPage:t>1}}))}),_(h=>x(()=>h)))}create(e){return this.staticData.eventTypes$.pipe(f(t=>{if(!t||!t[e.eventTypeId?.toString()])return c({success:!1,error:`Tipo de evento no v\xE1lido: ${e.eventTypeId}`});let i={title:e.title,description:e.description,short_description:e.shortDescription,event_type_id:e.eventTypeId,category_id:e.categoryId,organizer_id:null,start_date:e.startDate,end_date:e.endDate,registration_start:e.registrationStart,registration_end:e.registrationEnd,max_participants:e.maxParticipants,current_participants:0,location_type:e.locationType,venue_name:e.venueName,venue_address:e.venueAddress,venue_city:e.venueCity,venue_coordinates:e.venueCoordinates,waitlist_enabled:e.waitlistEnabled||!1,minimum_attendance_percentage:e.minimumAttendancePercentage||80,duration_hours:e.durationHours,cost:e.cost??0,currency:e.currency??"PEN",early_bird_cost:e.earlyBirdCost,early_bird_deadline:e.earlyBirdDeadline,requires_certificate:e.requiresCertificate??!0,is_public:e.isPublic??!0,requires_approval:e.requiresApproval??!1,tags:e.tags??[],keywords:e.keywords??"",status:"draft",is_active:!0,is_featured:!1,metadata:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabase.client.from("events").insert([i]).select("*").single()).pipe(f(({data:n,error:o})=>o?c({success:!1,error:o.message}):this.mapToEventDtoWithTypes(n).pipe(v(a=>({success:!0,data:a})))))}),_(t=>c({success:!1,error:t.message||"Error creando evento"})))}createQuickEvent(e){let t=new Date,i=new Date(t);i.setDate(t.getDate()+1),i.setHours(9,0,0,0);let n=new Date(i);n.setDate(i.getDate()+7),n.setHours(17,0,0,0);let o={title:e.title.trim(),shortDescription:e.shortDescription||`${e.title.substring(0,100)}...`,description:e.description||e.shortDescription||"Descripci\xF3n pendiente de completar.",eventTypeId:e.eventTypeId,startDate:i.toISOString(),endDate:n.toISOString(),registrationStart:t.toISOString(),registrationEnd:i.toISOString(),locationType:"presencial",venueName:"Por definir",venueCity:"Lima",maxParticipants:50,waitlistEnabled:!1,minimumAttendancePercentage:80,durationHours:8,requiresCertificate:!0,cost:0,currency:"PEN",isPublic:!0,requiresApproval:!1,tags:["evento-rapido"],keywords:e.title.toLowerCase().replace(/\s+/g," ").trim(),metadata:{creationType:"quick",createdBy:"quick-create-system",needsCompletion:!0,autoGenerated:!0}};return this.create(o)}update(e,t){return t.eventTypeId?this.staticData.eventTypes$.pipe(f(i=>!i||!t.eventTypeId||!i[t.eventTypeId.toString()]?c({success:!1,error:`Tipo de evento no v\xE1lido: ${t.eventTypeId}`}):this.performUpdate(e,t)),_(i=>c({success:!1,error:i.message||"Error actualizando evento"}))):this.performUpdate(e,t)}performUpdate(e,t){let i=X(K({},this.mapToSupabaseFormat(t)),{updated_at:new Date().toISOString()});return m(this.supabase.client.from("events").update(i).eq("id",e).select("*").single()).pipe(f(({data:n,error:o})=>o?c({success:!1,error:o.message}):this.mapToEventDtoWithTypes(n).pipe(v(a=>({success:!0,data:a})))),_(n=>c({success:!1,error:n.message||"Error actualizando evento"})))}delete(e){return m(this.supabase.client.from("events").delete().eq("id",e)).pipe(v(({error:t})=>t?{success:!1,error:t.message}:{success:!0,data:void 0}),_(t=>c({success:!1,error:t.message||"Error eliminando evento"})))}findByOrganizer(e){return m(this.supabase.client.from("events").select("*").eq("organizer_id",e).order("created_at",{ascending:!1})).pipe(f(({data:t,error:i})=>{if(i)throw new Error(i.message);return this.mapArrayToEventDtoWithTypes(t||[])}),_(t=>x(()=>t)))}findActive(){return m(this.supabase.client.from("events").select("*").eq("is_active",!0).in("status",["published","reg_open"]).order("start_date",{ascending:!0})).pipe(f(({data:e,error:t})=>{if(t)throw new Error(t.message);return this.mapArrayToEventDtoWithTypes(e||[])}),_(e=>x(()=>e)))}findByDateRange(e,t){return m(this.supabase.client.from("events").select("*").gte("start_date",e).lte("end_date",t).order("start_date",{ascending:!0})).pipe(f(({data:i,error:n})=>{if(n)throw new Error(n.message);return this.mapArrayToEventDtoWithTypes(i||[])}),_(i=>x(()=>i)))}queryEvents(e){let{query:t,limit:i=10}=e,n=this.supabase.client.from("events").select("id, title, start_date, end_date, cost, venue_name").eq("is_active",!0).order("start_date",{ascending:!1}).limit(i);return t&&t.trim()&&(n=n.ilike("title",`%${t.trim()}%`)),m(n).pipe(v(({data:o,error:a})=>{if(a)throw a;return(o||[]).map(p=>({id:p.id,title:p.title,startDate:p.start_date,endDate:p.end_date,cost:p.cost||null,location:p.venue_name||null}))}),_(o=>(console.error("Error en queryEvents:",o),c([]))))}getStats(e){let t=m(this.supabase.client.from("registrations").select("id, confirmation_date, attendance_verified, attendance_percentage").eq("event_id",e)),i=m(this.supabase.client.from("certificates").select("id, revoked_at, download_count, verification_count").eq("event_id",e));return I([t,i]).pipe(v(([n,o])=>{if(n.error)throw new Error(n.error.message);if(o.error)throw new Error(o.error.message);let a=n.data||[],p=o.data||[],b=a.length,u=a.filter(C=>!!C.confirmation_date).length,h=a.filter(C=>C.attendance_verified===!0).length,D=b>0?Math.round(a.reduce((C,R)=>C+(Number(R.attendance_percentage)||0),0)/b):0,P=p.filter(C=>!C.revoked_at).length,k=p.reduce((C,R)=>C+(Number(R.download_count)||0),0),L=p.reduce((C,R)=>C+(Number(R.verification_count)||0),0);return{totalRegistrations:b,confirmedRegistrations:u,attendedCount:h,attendanceRate:D,certificatesIssued:P,certificatesDownloaded:k,certificatesVerified:L}}),_(n=>c({totalRegistrations:0,confirmedRegistrations:0,attendedCount:0,attendanceRate:0,certificatesIssued:0,certificatesDownloaded:0,certificatesVerified:0})))}findBySlug(e){return m(this.supabase.client.from("events").select("*").eq("slug",e).single()).pipe(f(({data:t,error:i})=>i?c({success:!1,error:i.message}):t?I([c(t),this.staticData.eventTypes$]).pipe(v(([n,o])=>({success:!0,data:this.mapToEventDto(n,o)}))):c({success:!1,error:"Event not found"})),_(t=>c({success:!1,error:t.message})))}changeStatus(e,t){return m(this.supabase.client.from("events").update({status:t}).eq("id",e).select("*").single()).pipe(f(({data:i,error:n})=>n?c({success:!1,error:n.message}):I([c(i),this.staticData.eventTypes$]).pipe(v(([o,a])=>({success:!0,data:this.mapToEventDto(o,a)})))),_(i=>c({success:!1,error:i.message})))}duplicate(e,t){return this.findById(e).pipe(f(i=>{if(!i.success||!i.data)return c({success:!1,error:i.error||"Original event not found"});let n=i.data,o={title:t,description:n.description,eventTypeId:n.eventTypeId,startDate:n.startDate,endDate:n.endDate,locationType:n.locationType,maxParticipants:n.maxParticipants,cost:n.cost,currency:n.currency,venueName:n.venueName,venueAddress:n.venueAddress,venueCity:n.venueCity,venueCoordinates:n.venueCoordinates,durationHours:n.durationHours,tags:n.tags,requiresCertificate:n.requiresCertificate,waitlistEnabled:n.waitlistEnabled,minimumAttendancePercentage:n.minimumAttendancePercentage,isPublic:n.isPublic,requiresApproval:n.requiresApproval};return this.create(o)}))}findFeatured(){return m(this.supabase.client.from("events").select("*").eq("is_featured",!0).eq("is_active",!0)).pipe(f(({data:e,error:t})=>{if(t)throw new Error(t.message);return I([c(e||[]),this.staticData.eventTypes$]).pipe(v(([i,n])=>i.map(o=>this.mapToEventDto(o,n))))}),_(e=>(console.error("Error finding featured events:",e),c([]))))}findUpcoming(e=10){let t=new Date().toISOString();return m(this.supabase.client.from("events").select("*").gte("start_date",t).eq("is_active",!0).order("start_date",{ascending:!0}).limit(e)).pipe(f(({data:i,error:n})=>{if(n)throw new Error(n.message);return I([c(i||[]),this.staticData.eventTypes$]).pipe(v(([o,a])=>o.map(p=>this.mapToEventDto(p,a))))}),_(i=>(console.error("Error finding upcoming events:",i),c([]))))}search(e,t){let i=this.supabase.client.from("events").select("*");return e&&(i=i.or(`title.ilike.%${e}%,description.ilike.%${e}%`)),t?.eventTypeId?.length&&(i=i.in("event_type_id",t.eventTypeId)),t?.status?.length&&(i=i.in("status",t.status)),t?.locationType?.length&&(i=i.in("location_type",t.locationType)),t?.dateFrom&&(i=i.gte("start_date",t.dateFrom)),t?.dateTo&&(i=i.lte("end_date",t.dateTo)),t?.organizerId&&(i=i.eq("organizer_id",t.organizerId)),t?.isFeatured!==void 0&&(i=i.eq("is_featured",t.isFeatured)),t?.isPublic!==void 0&&(i=i.eq("is_public",t.isPublic)),m(i).pipe(f(({data:n,error:o})=>{if(o)throw new Error(o.message);return I([c(n||[]),this.staticData.eventTypes$]).pipe(v(([a,p])=>a.map(b=>this.mapToEventDto(b,p))))}),_(n=>(console.error("Error searching events:",n),c([]))))}getDashboardStats(){return m(this.supabase.client.from("events").select("*")).pipe(v(({data:e})=>{let t={totalEvents:e?.length||0,totalParticipants:0,averageParticipants:0,statusBreakdown:{}};if(t.totalEvents>0){t.totalParticipants=e?.reduce((n,o)=>n+(o.current_participants||0),0)||0,t.averageParticipants=Math.round(t.totalParticipants/t.totalEvents);let i={};e?.forEach(n=>{let o=n.status||"unknown";i[o]=(i[o]||0)+1}),t.statusBreakdown=i}return t}),_(e=>x(()=>e)))}mapToEventDtoWithTypes(e){return this.staticData.eventTypes$.pipe(v(t=>this.mapToEventDto(e,t)))}mapArrayToEventDtoWithTypes(e){return this.staticData.eventTypes$.pipe(v(t=>e.map(i=>this.mapToEventDto(i,t))))}mapToEventDto(e,t){let i;if(t&&e.event_type_id){let n=t[e.event_type_id.toString()];n&&(i={name:n.name,description:n.description,icon:n.icon,color:n.color})}return{id:e.id,title:e.title,slug:e.slug,shortDescription:e.short_description,description:e.description,eventTypeId:e.event_type_id,categoryId:e.category_id,organizerId:e.organizer_id,startDate:e.start_date,endDate:e.end_date,registrationStart:e.registration_start,registrationEnd:e.registration_end,maxParticipants:e.max_participants,currentParticipants:e.current_participants||0,locationType:e.location_type,venueName:e.venue_name,venueAddress:e.venue_address,venueCity:e.venue_city,venueCoordinates:e.venue_coordinates,durationHours:e.duration_hours,cost:e.cost,currency:e.currency,earlyBirdCost:e.early_bird_cost,earlyBirdDeadline:e.early_bird_deadline,tags:e.tags||[],keywords:e.keywords,status:e.status,isActive:e.is_active,isFeatured:e.is_featured,isPublic:e.is_public,requiresApproval:e.requires_approval,requiresCertificate:e.requires_certificate,waitlistEnabled:e.waitlist_enabled,minimumAttendancePercentage:e.minimum_attendance_percentage||0,metadata:e.metadata||{},createdAt:e.created_at,updatedAt:e.updated_at,eventTypeInfo:i}}mapToSupabaseFormat(e){let t={};return"title"in e&&e.title!==void 0&&(t.title=e.title),"shortDescription"in e&&e.shortDescription!==void 0&&(t.short_description=e.shortDescription),"description"in e&&e.description!==void 0&&(t.description=e.description),"eventTypeId"in e&&e.eventTypeId!==void 0&&(t.event_type_id=e.eventTypeId),"organizerId"in e&&e.organizerId!==void 0&&(t.organizer_id=e.organizerId),"startDate"in e&&e.startDate!==void 0&&(t.start_date=e.startDate),"endDate"in e&&e.endDate!==void 0&&(t.end_date=e.endDate),"registrationStart"in e&&e.registrationStart!==void 0&&(t.registration_start=e.registrationStart),"registrationEnd"in e&&e.registrationEnd!==void 0&&(t.registration_end=e.registrationEnd),"maxParticipants"in e&&e.maxParticipants!==void 0&&(t.max_participants=e.maxParticipants),"currentParticipants"in e&&e.currentParticipants!==void 0&&(t.current_participants=e.currentParticipants),"locationType"in e&&e.locationType!==void 0&&(t.location_type=e.locationType),"venueName"in e&&e.venueName!==void 0&&(t.venue_name=e.venueName),"venueAddress"in e&&e.venueAddress!==void 0&&(t.venue_address=e.venueAddress),"venueCity"in e&&e.venueCity!==void 0&&(t.venue_city=e.venueCity),"durationHours"in e&&e.durationHours!==void 0&&(t.duration_hours=e.durationHours),"cost"in e&&e.cost!==void 0&&(t.cost=e.cost),"currency"in e&&e.currency!==void 0&&(t.currency=e.currency),"waitlistEnabled"in e&&e.waitlistEnabled!==void 0&&(t.waitlist_enabled=e.waitlistEnabled),"minimumAttendancePercentage"in e&&e.minimumAttendancePercentage!==void 0&&(t.minimum_attendance_percentage=e.minimumAttendancePercentage),"requiresCertificate"in e&&e.requiresCertificate!==void 0&&(t.requires_certificate=e.requiresCertificate),"earlyBirdCost"in e&&e.earlyBirdCost!==void 0&&(t.early_bird_cost=e.earlyBirdCost),"earlyBirdDeadline"in e&&e.earlyBirdDeadline!==void 0&&(t.early_bird_deadline=e.earlyBirdDeadline),"isPublic"in e&&e.isPublic!==void 0&&(t.is_public=e.isPublic),"requiresApproval"in e&&e.requiresApproval!==void 0&&(t.requires_approval=e.requiresApproval),"tags"in e&&e.tags!==void 0&&(t.tags=e.tags),"keywords"in e&&e.keywords!==void 0&&(t.keywords=e.keywords),"status"in e&&e.status!==void 0&&(t.status=e.status),"isActive"in e&&e.isActive!==void 0&&(t.is_active=e.isActive),"isFeatured"in e&&e.isFeatured!==void 0&&(t.is_featured=e.isFeatured),"metadata"in e&&e.metadata!==void 0&&(t.metadata=e.metadata),t}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"})};var et="PEN",ot=80,ge=class r{supabaseService=T(Y);staticDataService=T(Z);loading=ae(!1);lastError=ae(null);participantRolesSig=ue(this.staticDataService.participantRoles$,{initialValue:null});registrationStatesSig=ue(this.staticDataService.registrationStates$,{initialValue:null});eventTypesSig=ue(this.staticDataService.eventTypes$,{initialValue:null});stateKeyToId=ae({});buildStateIndex=Te(()=>{let e=this.registrationStatesSig();if(!e)return;let t={};for(let[i,n]of Object.entries(e))n?.stateKey&&(t[n.stateKey]=Number(i));this.stateKeyToId.set(t)});findById(e){return m(this.supabaseService.client.from("registrations").select(`
          *,
          users!inner (
            id,
            full_name,
            email,
            document_number,
            institution
          ),
          events!inner (
            id,
            title,
            short_description,
            start_date,
            end_date,
            cost,
            currency,
            venue_name,
            venue_city,
            location_type,
            event_type_id
          ),
          registration_states!inner (
            id,
            state_key,
            display_name,
            description
          )
        `).eq("id",e).single()).pipe(f(({data:t,error:i})=>i?c({success:!1,error:i.message}):this.mapToRegistrationDtoWithRoles(t).pipe(v(n=>({success:!0,data:n})))),_(t=>c({success:!1,error:t.message})))}findAll(e){let t=e.page||1,i=e.pageSize||20,n=(t-1)*i;return this.resolveStateId(e.status).pipe(f(o=>{let a=this.supabaseService.client.from("registrations").select(`
            *,
            users!inner (
              id,
              full_name,
              email,
              document_number,
              institution
            ),
            events!inner (
              id,
              title,
              short_description,
              start_date,
              end_date,
              cost,
              currency,
              venue_name,
              venue_city,
              location_type,
              event_type_id
            ),
            registration_states!inner (
              id,
              state_key,
              display_name,
              description
            )
          `,{count:"exact"});if(e.eventId&&(a=a.eq("event_id",e.eventId)),e.userId&&(a=a.eq("user_id",e.userId)),e.participantRoleId&&(a=a.eq("participant_role_id",e.participantRoleId)),e.dateFrom&&(a=a.gte("registration_date",e.dateFrom)),e.dateTo&&(a=a.lte("registration_date",e.dateTo)),o!==null&&(a=a.eq("current_state_id",o)),typeof e.attendanceVerified=="boolean"&&(a=a.eq("attendance_verified",e.attendanceVerified)),e.search){let u=`%${e.search}%`;a=a.or(`payment_reference.ilike.${u},notes.ilike.${u},registration_source.ilike.${u}`)}let p=e.sortBy||"created_at",b=(e.sortDirection||"desc")==="asc";return a=a.order(p,{ascending:b,nullsFirst:!1}),a=a.range(n,n+i-1),m(a).pipe(f(({data:u,error:h,count:D})=>h?x(()=>h):this.mapToRegistrationDtosWithRoles(u||[]).pipe(v(P=>{let k=D||0,L=Math.ceil(k/i);return{items:P,total:k,page:t,pageSize:i,totalPages:L,hasNextPage:t<L,hasPreviousPage:t>1}}))))}),_(o=>x(()=>o)))}findByEventId(e){return m(this.supabaseService.client.from("registrations").select("*").eq("event_id",e)).pipe(f(({data:t,error:i})=>i?x(()=>i):this.mapToRegistrationDtosWithRoles(t||[])),_(t=>x(()=>t)))}findByUserId(e){return m(this.supabaseService.client.from("registrations").select("*").eq("user_id",e)).pipe(f(({data:t,error:i})=>i?x(()=>i):this.mapToRegistrationDtosWithRoles(t||[])),_(t=>x(()=>t)))}getRegisteredUserIds(e,t){let i=this.supabaseService.client.from("registrations").select("user_id");return e&&(i=i.eq("event_id",e)),t&&(i=i.eq("participant_role_id",t)),m(i).pipe(v(({data:n,error:o})=>{if(o)throw o;let a=n?.map(b=>b.user_id)||[];return{userIds:[...new Set(a)]}}),_(n=>x(()=>n)))}create(e){let t=e.initialState||"draft";return I([this.staticDataService.participantRoles$,this.getStateIdByKey(t)]).pipe(f(([i,n])=>{if(!i||e.participantRoleId&&!i[e.participantRoleId.toString()])return c({success:!1,error:`Rol de participante no v\xE1lido: ${e.participantRoleId}`});let o=new Date().toISOString(),a=i?Number(Object.entries(i).find(([,b])=>b.isDefault)?.[0]??Object.keys(i)[0]):1,p={event_id:e.eventId,user_id:e.userId,participant_role_id:e.participantRoleId??a,current_state_id:n,registration_date:o,amount_paid:0,currency:et,registration_source:"web",notes:e.notes,metadata:e.metadata||{},created_at:o,updated_at:o};return m(this.supabaseService.client.from("registrations").insert([p]).select("*").single()).pipe(f(({data:b,error:u})=>u?c({success:!1,error:u.message}):this.mapToRegistrationDtoWithRoles(b).pipe(v(h=>({success:!0,data:h})))))}),_(i=>c({success:!1,error:i.message||"Error creando inscripci\xF3n"})))}update(e,t){return t.participantRoleId?this.staticDataService.participantRoles$.pipe(f(i=>!i||!t.participantRoleId||!i[t.participantRoleId.toString()]?c({success:!1,error:`Rol de participante no v\xE1lido: ${t.participantRoleId}`}):this.performUpdate(e,t)),_(i=>c({success:!1,error:i.message||"Error actualizando inscripci\xF3n"}))):this.performUpdate(e,t)}performUpdate(e,t){let i=X(K({},this.mapToSupabaseFormat(t)),{updated_at:new Date().toISOString()});return m(this.supabaseService.client.from("registrations").update(i).eq("id",e).select("*").single()).pipe(f(({data:n,error:o})=>o?c({success:!1,error:o.message}):this.mapToRegistrationDtoWithRoles(n).pipe(v(a=>({success:!0,data:a})))),_(n=>c({success:!1,error:n.message||"Error actualizando inscripci\xF3n"})))}delete(e){return m(this.supabaseService.client.from("registrations").delete().eq("id",e)).pipe(v(({error:t})=>t?{success:!1,error:t.message}:{success:!0,data:void 0}),_(t=>c({success:!1,error:t.message||"Error eliminando inscripci\xF3n"})))}changeState(e,t){return this.getStateIdByKey(t.newStateKey).pipe(f(i=>m(this.supabaseService.client.from("registrations").select("current_state_id").eq("id",e).single()).pipe(f(({data:n,error:o})=>{if(o)return c({success:!1,error:o.message});let a=n?.current_state_id;return a==null?c({success:!1,error:"Estado actual no disponible"}):this.staticDataService.registrationStates$.pipe(f(p=>{let u=(p?p[String(a)]:void 0)?.stateKey;if(u&&!We(u,t.newStateKey))return c({success:!1,error:`Transici\xF3n inv\xE1lida de ${u} a ${t.newStateKey}`});let h={previous_state_id:a??null,current_state_id:i,state_changed_at:new Date().toISOString(),state_changed_by:null,notes:t.notes,metadata:t.metadata,updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("registrations").update(h).eq("id",e).select("*").single()).pipe(f(({data:D,error:P})=>P?c({success:!1,error:P.message}):this.mapToRegistrationDtoWithRoles(D).pipe(v(k=>({success:!0,data:k})))))}))}))),_(i=>c({success:!1,error:i.message||"Error cambiando estado"})))}bulkRegister(e){let t=(e.users||[]).map(i=>i.email.toLowerCase().trim());return t.length===0?c({success:!1,results:[],summary:{total:0,successful:0,failed:0,errors:["Lista vac\xEDa"]}}):m(this.supabaseService.client.from("users").select("id,email").in("email",t)).pipe(f(({data:i,error:n})=>{if(n)return c({success:!1,results:[],summary:{total:0,successful:0,failed:0,errors:[n.message]}});let o=new Map;(i||[]).forEach(u=>o.set(String(u.email).toLowerCase(),u.id));let a=[],p=[],b=new Date().toISOString();return this.getStateIdByKey("draft").pipe(f(u=>{for(let h of e.users){let D=o.get(h.email.toLowerCase());if(!D){p.push(h.email);continue}a.push({event_id:e.eventId,user_id:D,participant_role_id:h.participantRoleId??1,current_state_id:u,registration_date:b,amount_paid:0,currency:et,registration_source:"admin",notes:h.notes,metadata:{batch:!0,createdAt:b}})}return a.length===0?c({success:!1,results:[],summary:{total:0,successful:0,failed:0,errors:[`Usuarios no encontrados: ${p.join(", ")}`]}}):m(this.supabaseService.client.from("registrations").insert(a).select("*")).pipe(f(({data:h,error:D})=>D?c({success:!1,results:[],summary:{total:0,successful:0,failed:0,errors:[D.message]}}):this.mapToRegistrationDtosWithRoles(h||[]).pipe(f(P=>{let k=P.map(C=>({success:!0,data:C}));if(e.autoConfirm)return m(P).pipe(f(C=>this.changeState(C.id,{newStateKey:"confirmed"})),we(),v(C=>{let R=k.map(($,Ie)=>C[Ie]?.success?C[Ie]:$),N=[];p.length&&N.push(`No encontrados: ${p.join(", ")}`);let ce={total:(e.users||[]).length,successful:R.filter($=>$.success).length,failed:R.filter($=>!$.success).length,errors:N};return{success:ce.failed===0,results:R,summary:ce}}));let L=[];p.length&&L.push(`No encontrados: ${p.join(", ")}`);let q={total:(e.users||[]).length,successful:k.length,failed:(e.users||[]).length-k.length,errors:L};return c({success:q.failed===0,results:k,summary:q})}))))}))}))}checkIn(e){return this.getStateIdByKey("checked_in").pipe(f(t=>{let i={current_state_id:t,check_in_date:new Date().toISOString(),updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("registrations").update(i).eq("id",e).select("*").single()).pipe(f(({data:n,error:o})=>o?c({success:!1,error:o.message}):this.mapToRegistrationDtoWithRoles(n).pipe(v(a=>({success:!0,data:a})))),_(n=>c({success:!1,error:n.message||"Error en check-in"})))}))}verifyAttendance(e,t){return m(this.supabaseService.client.from("registrations").select("event_id").eq("id",e).single()).pipe(f(({data:i,error:n})=>{if(n)return c({success:!1,error:n.message});let o=i?.event_id;return m(this.supabaseService.client.from("events").select("event_type_id, minimum_attendance_percentage").eq("id",o).single()).pipe(f(({data:a,error:p})=>{if(p)return c({success:!1,error:p.message});let b=a?.event_type_id,u=a?.minimum_attendance_percentage;return this.staticDataService.eventTypes$.pipe(f(h=>{let D=b&&h?h[String(b)]?.minAttendancePercentage:void 0,P=u??D??ot,k=t>=P?"attended":"no_show";return this.getStateIdByKey(k).pipe(f(L=>{let q={attendance_percentage:t,attendance_verified:!0,attendance_verified_date:new Date().toISOString(),certificate_eligible:t>=P,current_state_id:L,updated_at:new Date().toISOString()};return m(this.supabaseService.client.from("registrations").update(q).eq("id",e).select("*").single()).pipe(f(({data:C,error:R})=>R?c({success:!1,error:R.message}):this.mapToRegistrationDtoWithRoles(C).pipe(v(N=>({success:!0,data:N})))),_(C=>c({success:!1,error:C.message||"Error verificando asistencia"})))}))}))}))}))}findPendingPayments(e){return this.getStateIdsByKeys(["payment_required","payment_pending"]).pipe(f(t=>{let i=this.supabaseService.client.from("registrations").select("*").in("current_state_id",t);return e&&(i=i.eq("event_id",e)),m(i).pipe(f(({data:n,error:o})=>o?x(()=>o):this.mapToRegistrationDtosWithRoles(n||[])))}),_(t=>x(()=>t)))}findEligibleForCertificates(e){return m(this.supabaseService.client.from("registrations").select("*").eq("event_id",e).eq("certificate_eligible",!0).eq("certificate_issued",!1)).pipe(f(({data:t,error:i})=>i?x(()=>i):this.mapToRegistrationDtosWithRoles(t||[])),_(t=>x(()=>t)))}findByState(e){return m(this.supabaseService.client.from("registrations").select("*").eq("current_state_id",e)).pipe(f(({data:t,error:i})=>i?x(()=>i):this.mapToRegistrationDtosWithRoles(t||[])),_(t=>x(()=>t)))}getEventStats(e){return this.getStateIdsByKeys(["confirmed","checked_in","attended","payment_required","payment_pending"]).pipe(f(([t,i,n,o,a])=>m(this.supabaseService.client.from("registrations").select("current_state_id, certificate_eligible, certificate_issued").eq("event_id",e)).pipe(v(({data:p,error:b})=>{if(b)throw b;let u=p||[],h=u.length,D=u.filter(C=>C.current_state_id===t).length,P=u.filter(C=>C.current_state_id===i).length,k=u.filter(C=>C.current_state_id===n).length,L=u.filter(C=>C.current_state_id===o||C.current_state_id===a).length,q=u.filter(C=>C.certificate_eligible===!0).length;return{totalRegistrations:h,confirmedRegistrations:D,checkedInCount:P,attendedCount:k,pendingPayments:L,certificateEligible:q}}))))}getUserStats(e){return this.getStateIdsByKeys(["attended","cancelled_by_admin","cancelled_by_user"]).pipe(f(([t,i,n])=>m(this.supabaseService.client.from("registrations").select("current_state_id, certificate_issued").eq("user_id",e)).pipe(v(({data:o,error:a})=>{if(a)throw a;let p=o||[],b=p.length,u=p.filter(P=>P.current_state_id===t).length,h=p.filter(P=>P.certificate_issued===!0).length,D=p.filter(P=>![t,i,n].includes(P.current_state_id)).length;return{totalRegistrations:b,attendedEvents:u,certificatesReceived:h,pendingRegistrations:D}}))))}mapToRegistrationDtosWithRoles(e){return I([this.staticDataService.participantRoles$]).pipe(v(([t])=>e.map(i=>this.mapToRegistrationDto(i,t))))}mapToRegistrationDtoWithRoles(e){return I([this.staticDataService.participantRoles$]).pipe(v(([t])=>this.mapToRegistrationDto(e,t)))}mapToRegistrationDto(e,t){let i;if(t&&e.participant_role_id){let n=t[e.participant_role_id.toString()];n&&(i={name:n.name,description:n.description,permissions:n.permissions,canReceiveCertificate:n.canReceiveCertificate})}return{id:e.id,eventId:e.event_id,userId:e.user_id,participantRoleId:e.participant_role_id,currentStateId:e.current_state_id,previousStateId:e.previous_state_id,stateChangedAt:e.state_changed_at,stateChangedBy:e.state_changed_by,registrationDate:e.registration_date,confirmationDate:e.confirmation_date,paymentDate:e.payment_date,checkInDate:e.check_in_date,attendanceVerifiedDate:e.attendance_verified_date,attendancePercentage:e.attendance_percentage,attendanceVerified:e.attendance_verified,certificateEligible:e.certificate_eligible,certificateIssued:e.certificate_issued,amountPaid:e.amount_paid,currency:e.currency,paymentMethod:e.payment_method,paymentReference:e.payment_reference,paymentGateway:e.payment_gateway,registrationSource:e.registration_source,notes:e.notes,metadata:e.metadata,createdAt:e.created_at,updatedAt:e.updated_at,user:e.users?{id:e.users.id,fullName:e.users.full_name||"Usuario desconocido",email:e.users.email||"",documentNumber:e.users.document_number,institution:e.users.institution}:void 0,event:e.events?{id:e.events.id,title:e.events.title||`Evento ${e.event_id}`,startDate:e.events.start_date,endDate:e.events.end_date,status:"active",cost:e.events.cost||0,currency:e.events.currency||"PEN"}:void 0,currentState:e.registration_states?{id:e.registration_states.id,stateKey:e.registration_states.state_key,displayName:e.registration_states.display_name,description:e.registration_states.description}:void 0}}mapToSupabaseFormat(e){let t={};return"eventId"in e&&e.eventId!==void 0&&(t.event_id=e.eventId),"userId"in e&&e.userId!==void 0&&(t.user_id=e.userId),"participantRoleId"in e&&e.participantRoleId!==void 0&&(t.participant_role_id=e.participantRoleId),"currentStateId"in e&&e.currentStateId!==void 0&&(t.current_state_id=e.currentStateId),"previousStateId"in e&&e.previousStateId!==void 0&&(t.previous_state_id=e.previousStateId),"stateChangedAt"in e&&e.stateChangedAt!==void 0&&(t.state_changed_at=e.stateChangedAt),"stateChangedBy"in e&&e.stateChangedBy!==void 0&&(t.state_changed_by=e.stateChangedBy),"confirmationDate"in e&&e.confirmationDate!==void 0&&(t.confirmation_date=e.confirmationDate),"paymentDate"in e&&e.paymentDate!==void 0&&(t.payment_date=e.paymentDate),"checkInDate"in e&&e.checkInDate!==void 0&&(t.check_in_date=e.checkInDate),"attendanceVerifiedDate"in e&&e.attendanceVerifiedDate!==void 0&&(t.attendance_verified_date=e.attendanceVerifiedDate),"attendancePercentage"in e&&e.attendancePercentage!==void 0&&(t.attendance_percentage=e.attendancePercentage),"attendanceVerified"in e&&e.attendanceVerified!==void 0&&(t.attendance_verified=e.attendanceVerified),"certificateEligible"in e&&e.certificateEligible!==void 0&&(t.certificate_eligible=e.certificateEligible),"certificateIssued"in e&&e.certificateIssued!==void 0&&(t.certificate_issued=e.certificateIssued),"amountPaid"in e&&e.amountPaid!==void 0&&(t.amount_paid=e.amountPaid),"currency"in e&&e.currency!==void 0&&(t.currency=e.currency),"paymentMethod"in e&&e.paymentMethod!==void 0&&(t.payment_method=e.paymentMethod),"paymentReference"in e&&e.paymentReference!==void 0&&(t.payment_reference=e.paymentReference),"paymentGateway"in e&&e.paymentGateway!==void 0&&(t.payment_gateway=e.paymentGateway),"registrationSource"in e&&e.registrationSource!==void 0&&(t.registration_source=e.registrationSource),"notes"in e&&e.notes!==void 0&&(t.notes=e.notes),"metadata"in e&&e.metadata!==void 0&&(t.metadata=e.metadata),t}quickRegister(e,t,i=1){return this.getStateIdByKey("draft").pipe(f(n=>{let o={event_id:e,user_id:t,participant_role_id:i,current_state_id:n,registration_date:new Date().toISOString(),notes:"Registro r\xE1pido - completado autom\xE1ticamente",metadata:{registrationType:"quick",autoProcessed:!0,processedAt:new Date().toISOString()}},a=this.supabaseService.client.from("registrations").insert([o]).select().single();return m(a).pipe(f(p=>p.error?c({success:!1,error:`Error creando registro r\xE1pido: ${p.error.message}`}):this.staticDataService.participantRoles$.pipe(v(b=>({success:!0,data:this.mapToRegistrationDto(p.data,b)})))),f(p=>{if(!p.success)return c(p);if(!("data"in p)||!p.data)return c({success:!1,error:"No se pudo crear el registro"});let b=p.data.id;return this.processQuickRegistrationSequence(b).pipe(v(u=>X(K({},u),{data:u.data??p.data})))}),_(p=>c({success:!1,error:`Error en registro r\xE1pido: ${p.message}`})))}))}processQuickRegistrationSequence(e){let t={newStateKey:"confirmed",notes:"Auto-confirmado en registro r\xE1pido"};return this.changeState(e,t).pipe(f(i=>i.success?this.checkIn(e):c(i)),f(i=>i.success?this.verifyAttendance(e,100):c(i)))}resolveStateId(e){if(!e)return c(null);let t=Number(e);return Number.isNaN(t)?this.getStateIdByKey(e).pipe(v(i=>i)):c(t)}getStateIdByKey(e){return this.staticDataService.registrationStates$.pipe(v(t=>{if(!t)return 1;let i=Object.entries(t).find(([,o])=>o.stateKey===e);return i?Number(i[0]):1}))}getStateIdsByKeys(e){return this.staticDataService.registrationStates$.pipe(v(t=>t?e.map(i=>{let n=Object.entries(t).find(([,o])=>o.stateKey===i);return n?Number(n[0]):1}):e.map(()=>1)))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"})};var tt=(r,e)=>{let t=T(G),i=T(j);if(["/auth","/assets","/data","supabase.co"].some(p=>r.url.includes(p)))return e(r);let a=t.currentSession;if(a?.access_token){let p=r.clone({setHeaders:{Authorization:`Bearer ${a.access_token}`}});return e(p).pipe(_(b=>((b.status===401||b.status===403)&&t.signOut().then(()=>{i.navigate([ne.auth.redirectUrls.login],{queryParams:{error:"session_expired",returnUrl:i.url}})}),x(()=>b))))}return e(r).pipe(_(p=>x(()=>p)))};var it={providers:[ke(),Re(),Ve(Je),$e(qe(),Ne([tt])),{provide:Qe,useClass:pe},{provide:je,useClass:me},{provide:Ge,useClass:fe},{provide:Ke,useClass:ge}]};var rt=()=>({exact:!0});function st(r,e){r&1&&(J(0),s(1,"li",25)(2,"a",26),g(3,"i",27),s(4,"span"),l(5,"Inicio"),d()()(),s(6,"li",25)(7,"a",28),g(8,"i",29),s(9,"span"),l(10,"Talleres"),d()()(),s(11,"li",25)(12,"a",30),g(13,"i",31),s(14,"span"),l(15,"Contacto"),d()()(),s(16,"li",25)(17,"a",32),g(18,"i",33),s(19,"span"),l(20,"Verificar Certificado"),d()()(),ee())}function ct(r,e){r&1&&(s(0,"li")(1,"a",52),g(2,"i",53),l(3," Crear Evento"),d()())}function lt(r,e){r&1&&(s(0,"li")(1,"a",54),g(2,"i",55),l(3," Inscripci\xF3n Masiva"),d()())}function dt(r,e){r&1&&(s(0,"li")(1,"a",56),g(2,"i",57),l(3," Generar Certificados"),d()())}function ut(r,e){r&1&&(s(0,"li",35)(1,"a",36),g(2,"i",58),s(3,"span"),l(4,"Reportes"),d()(),s(5,"ul",38)(6,"li")(7,"a",59),g(8,"i",60),l(9," Dashboard"),d()(),s(10,"li")(11,"a",61),g(12,"i",62),l(13," Reporte de Eventos"),d()(),s(14,"li")(15,"a",63),g(16,"i",64),l(17," Reporte de Participantes"),d()(),s(18,"li")(19,"a",65),g(20,"i",66),l(21," Reporte de Certificados"),d()()()())}function pt(r,e){r&1&&(s(0,"li",35)(1,"a",36),g(2,"i",67),s(3,"span"),l(4,"Administraci\xF3n"),d()(),s(5,"ul",38)(6,"li")(7,"h6",39),g(8,"i",55),l(9," Gesti\xF3n de Usuarios"),d()(),s(10,"li")(11,"a",68),g(12,"i",64),l(13," Lista de Usuarios"),d()(),s(14,"li")(15,"a",69),g(16,"i",48),l(17," Crear Usuario"),d()(),s(18,"li"),g(19,"hr",43),d(),s(20,"li")(21,"h6",39),g(22,"i",70),l(23," Configuraci\xF3n"),d()(),s(24,"li")(25,"a",71),g(26,"i",72),l(27," Configuraci\xF3n General"),d()(),s(28,"li")(29,"a",73),g(30,"i",74),l(31," Editor de Plantillas"),d()(),s(32,"li")(33,"a",75),g(34,"i",76),l(35," Integraciones"),d()()()())}function mt(r,e){if(r&1&&(J(0),s(1,"li",25)(2,"a",34),g(3,"i",27),s(4,"span"),l(5,"Inicio"),d()()(),s(6,"li",35)(7,"a",36),g(8,"i",37),s(9,"span"),l(10,"Eventos"),d()(),s(11,"ul",38)(12,"li")(13,"h6",39),g(14,"i",40),l(15," Gesti\xF3n de Eventos"),d()(),s(16,"li")(17,"a",41),g(18,"i",42),l(19," Ver Eventos"),d()(),w(20,ct,4,0,"li",12),s(21,"li"),g(22,"hr",43),d(),s(23,"li")(24,"h6",39),g(25,"i",44),l(26," Inscripciones"),d()(),s(27,"li")(28,"a",45),g(29,"i",46),l(30," Ver Inscripciones"),d()(),s(31,"li")(32,"a",47),g(33,"i",48),l(34," Nueva Inscripci\xF3n"),d()(),w(35,lt,4,0,"li",12),d()(),s(36,"li",35)(37,"a",36),g(38,"i",49),s(39,"span"),l(40,"Certificados"),d()(),s(41,"ul",38)(42,"li")(43,"a",50),g(44,"i",51),l(45," Ver Certificados"),d()(),w(46,dt,4,0,"li",12),d()(),w(47,ut,22,0,"li",15)(48,pt,36,0,"li",15),ee()),r&2){let t=U();y(2),E("routerLinkActiveOptions",De(6,rt)),y(18),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(15),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(11),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(),E("ngIf",t.isCurrentUserAdmin)}}function ft(r,e){r&1&&(s(0,"div",25)(1,"span",77),g(2,"div",78),s(3,"span"),l(4,"Cargando..."),d()()())}function gt(r,e){if(r&1){let t=te();s(0,"div",25)(1,"button",79),V("click",function(){z(t);let n=U();return B(n.signInWithGoogle())}),g(2,"i",80),s(3,"span"),l(4,"Iniciar Sesi\xF3n"),d()()()}}function vt(r,e){if(r&1&&g(0,"img",98),r&2){let t=U(2);E("src",t.getUserAvatar(),ye)("alt",t.getUserDisplayName())}}function _t(r,e){r&1&&(s(0,"div",99),g(1,"i",100),d())}function bt(r,e){r&1&&(s(0,"li"),g(1,"hr",43),d())}function ht(r,e){if(r&1){let t=te();s(0,"li")(1,"button",93),V("click",function(){z(t);let n=U(2);return B(n.navigateTo("/usuarios"))}),g(2,"i",33),s(3,"span"),l(4,"Panel de Administraci\xF3n"),d()()()}}function Ct(r,e){if(r&1){let t=te();s(0,"div",35)(1,"button",81)(2,"div",82)(3,"div",83),w(4,vt,1,2,"img",84)(5,_t,2,0,"ng-template",null,0,Oe),d(),s(7,"div",85)(8,"div",86),l(9),d(),s(10,"div",87),l(11),d()()()(),s(12,"ul",88)(13,"li",89)(14,"div",90)(15,"strong",91),l(16),d(),s(17,"div",92),l(18),d()()(),s(19,"li",89),g(20,"hr",43),d(),s(21,"li")(22,"button",93),V("click",function(){z(t);let n=U();return B(n.navigateTo("/perfil"))}),g(23,"i",94),s(24,"span"),l(25,"Mi Perfil"),d()()(),s(26,"li")(27,"button",93),V("click",function(){z(t);let n=U();return B(n.navigateTo("/configuracion"))}),g(28,"i",95),s(29,"span"),l(30,"Configuraci\xF3n"),d()()(),w(31,bt,2,0,"li",12)(32,ht,5,0,"li",12),s(33,"li"),g(34,"hr",43),d(),s(35,"li")(36,"button",96),V("click",function(){z(t);let n=U();return B(n.logout())}),g(37,"i",97),s(38,"span"),l(39,"Cerrar Sesi\xF3n"),d()()()()()}if(r&2){let t=Ee(6),i=U();y(4),E("ngIf",i.getUserAvatar())("ngIfElse",t),y(5),ie(i.getUserDisplayName()),y(2),ie(i.getUserEmail()),y(5),ie(i.getUserDisplayName()),y(2),ie(i.getUserEmail()),y(13),E("ngIf",i.isCurrentUserAdmin),y(),E("ngIf",i.isCurrentUserAdmin)}}function yt(r,e){if(r&1&&g(0,"img",107),r&2){let t=U(2);E("src",t.getUserAvatar(),ye)("alt",t.getUserDisplayName())}}function St(r,e){r&1&&(s(0,"div",108),g(1,"i",109),d())}function Et(r,e){if(r&1&&(s(0,"div",101)(1,"div",102),w(2,yt,1,2,"img",103)(3,St,2,0,"ng-template",null,1,Oe),d(),s(5,"div",104)(6,"div",105),l(7),d(),s(8,"div",106),l(9),d()()()),r&2){let t=Ee(4),i=U();y(2),E("ngIf",i.getUserAvatar())("ngIfElse",t),y(5),ie(i.getUserDisplayName()),y(2),ie(i.getUserEmail())}}function Dt(r,e){r&1&&(s(0,"div",101),g(1,"i",110),s(2,"div",104)(3,"div",105),l(4,"Bienvenido"),d(),s(5,"div",106),l(6,"Inicia sesi\xF3n para acceder"),d()()())}function Ot(r,e){r&1&&(s(0,"div",111),g(1,"div",112),s(2,"span",113),l(3,"Cargando..."),d()())}function xt(r,e){r&1&&(J(0),s(1,"li",25)(2,"a",114),g(3,"i",115),s(4,"span",116),l(5,"Inicio"),d()()(),s(6,"li",25)(7,"a",117),g(8,"i",118),s(9,"span",116),l(10,"Talleres"),d()()(),s(11,"li",25)(12,"a",119),g(13,"i",120),s(14,"span",116),l(15,"Contacto"),d()()(),s(16,"li",25)(17,"a",121),g(18,"i",122),s(19,"span",116),l(20,"Verificar Certificado"),d()()(),ee())}function It(r,e){r&1&&(s(0,"a",136),g(1,"i",137),s(2,"span",116),l(3,"Crear Evento"),d()())}function Pt(r,e){r&1&&(s(0,"a",138),g(1,"i",139),s(2,"span",116),l(3,"Inscripci\xF3n Masiva"),d()())}function wt(r,e){r&1&&(s(0,"a",140),g(1,"i",141),s(2,"span",116),l(3,"Generar Certificados"),d()())}function kt(r,e){r&1&&(J(0),s(1,"li",25)(2,"div",124),g(3,"i",142),l(4," Reportes "),d()(),s(5,"li",25)(6,"a",143),g(7,"i",144),s(8,"span",116),l(9,"Dashboard"),d()()(),s(10,"li",25)(11,"a",145),g(12,"i",146),s(13,"span",116),l(14,"Reporte de Eventos"),d()()(),s(15,"li",25)(16,"a",147),g(17,"i",148),s(18,"span",116),l(19,"Reporte de Participantes"),d()()(),s(20,"li",25)(21,"a",149),g(22,"i",150),s(23,"span",116),l(24,"Reporte de Certificados"),d()()(),ee())}function Rt(r,e){r&1&&(J(0),s(1,"li",25)(2,"div",124),g(3,"i",151),l(4," Administraci\xF3n "),d()(),s(5,"li",25)(6,"a",152),g(7,"i",148),s(8,"span",116),l(9,"Gesti\xF3n de Usuarios"),d()()(),s(10,"li",25)(11,"a",153),g(12,"i",131),s(13,"span",116),l(14,"Crear Usuario"),d()()(),s(15,"li",25)(16,"a",154),g(17,"i",155),s(18,"span",116),l(19,"Configuraci\xF3n General"),d()()(),s(20,"li",25)(21,"a",156),g(22,"i",157),s(23,"span",116),l(24,"Editor de Plantillas"),d()()(),s(25,"li",25)(26,"a",158),g(27,"i",159),s(28,"span",116),l(29,"Integraciones"),d()()(),ee())}function Tt(r,e){if(r&1&&(J(0),s(1,"li",25)(2,"a",123),g(3,"i",115),s(4,"span",116),l(5,"Inicio"),d()()(),s(6,"li",25)(7,"div",124),g(8,"i",40),l(9," Eventos "),d()(),s(10,"li",25)(11,"a",125),g(12,"i",126),s(13,"span",116),l(14,"Ver Eventos"),d()()(),s(15,"li",25),w(16,It,4,0,"a",127),d(),s(17,"li",25)(18,"div",124),g(19,"i",44),l(20," Inscripciones "),d()(),s(21,"li",25)(22,"a",128),g(23,"i",129),s(24,"span",116),l(25,"Ver Inscripciones"),d()()(),s(26,"li",25)(27,"a",130),g(28,"i",131),s(29,"span",116),l(30,"Nueva Inscripci\xF3n"),d()()(),s(31,"li",25),w(32,Pt,4,0,"a",132),d(),s(33,"li",25)(34,"div",124),g(35,"i",66),l(36," Certificados "),d()(),s(37,"li",25)(38,"a",133),g(39,"i",134),s(40,"span",116),l(41,"Ver Certificados"),d()()(),s(42,"li",25),w(43,wt,4,0,"a",135),d(),w(44,kt,25,0,"ng-container",12)(45,Rt,30,0,"ng-container",12),ee()),r&2){let t=U();y(2),E("routerLinkActiveOptions",De(6,rt)),y(14),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(16),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(11),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(),E("ngIf",t.isCurrentUserAdminOrOrganizer),y(),E("ngIf",t.isCurrentUserAdmin)}}function Mt(r,e){if(r&1){let t=te();s(0,"div")(1,"button",160),V("click",function(){z(t);let n=U();return B(n.signInWithGoogle())}),g(2,"i",80),s(3,"span"),l(4,"Iniciar Sesi\xF3n con Google"),d()()()}}function At(r,e){if(r&1){let t=te();s(0,"button",166),V("click",function(){z(t);let n=U(2);return B(n.navigateTo("/usuarios"))}),g(1,"i",33),s(2,"span"),l(3,"Panel de Administraci\xF3n"),d()()}}function Ut(r,e){if(r&1){let t=te();s(0,"div",161)(1,"button",162),V("click",function(){z(t);let n=U();return B(n.navigateTo("/perfil"))}),g(2,"i",94),s(3,"span"),l(4,"Mi Perfil"),d()(),s(5,"button",163),V("click",function(){z(t);let n=U();return B(n.navigateTo("/configuracion"))}),g(6,"i",95),s(7,"span"),l(8,"Configuraci\xF3n"),d()(),w(9,At,4,0,"button",164),s(10,"button",165),V("click",function(){z(t);let n=U();return B(n.logout())}),g(11,"i",97),s(12,"span"),l(13,"Cerrar Sesi\xF3n"),d()()()}if(r&2){let t=U();y(9),E("ngIf",t.isCurrentUserAdmin)}}var ve=class r{constructor(e,t){this.authService=e;this.router=t;this.currentUser$=this.authService.currentUser$,this.currentUserAuth$=this.authService.currentUserAuth$,this.isAuthenticated$=this.authService.isAuthenticated$,this.combinedUserData$=I([this.currentUser$,this.currentUserAuth$]).pipe(v(([i,n])=>({user:i,userAuth:n})))}isMenuOpen=!1;currentUser$;currentUserAuth$;combinedUserData$;isAuthenticated$;isCurrentUserAdmin=!1;isCurrentUserOrganizer=!1;isCurrentUserAdminOrOrganizer=!1;ngOnInit(){this.combinedUserData$.subscribe(e=>{let t=e?.user?.role;this.isCurrentUserAdmin=t==="admin",this.isCurrentUserOrganizer=t==="organizer",this.isCurrentUserAdminOrOrganizer=t==="admin"||t==="organizer"})}toggleMenu(){this.isMenuOpen=!this.isMenuOpen}logout(){return le(this,null,function*(){try{yield this.authService.signOut(),this.router.navigate(["/"])}catch(e){console.error("Error al cerrar sesi\xF3n:",e)}})}signInWithGoogle(){return le(this,null,function*(){try{yield this.authService.signInWithGoogle()}catch(e){console.error("Error al iniciar sesi\xF3n:",e)}})}getUserDisplayName(){let e=this.authService.currentUser,t=this.authService.currentUserAuth;return e?t?.fullName||e.fullName||e.email.split("@")[0]:""}getUserEmail(){return this.authService.currentUser?.email||""}getUserAvatar(){let e=this.authService.currentUserAuth,t=this.authService.currentUser;if(e?.avatarUrl)return e.avatarUrl;if(t?.email){let i=t.fullName||t.email.split("@")[0];return`https://ui-avatars.com/api/?name=${encodeURIComponent(i)}&background=007bff&color=fff&size=32`}return"https://ui-avatars.com/api/?name=User&background=6c757d&color=fff&size=32"}scrollToSection(e){this.router.navigate(["/"],{fragment:e}).then(()=>{let t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})})}navigateTo(e){this.router.navigate([e])}static \u0275fac=function(t){return new(t||r)(Se(G),Se(j))};static \u0275cmp=oe({type:r,selectors:[["app-header"]],decls:50,vars:48,consts:[["defaultAvatar",""],["defaultAvatarMobile",""],[1,"navbar","navbar-expand-lg","bg-light","shadow-sm","fixed-top"],[1,"container-fluid","px-3"],["routerLink","/",1,"navbar-brand","d-flex","align-items-center"],["src","abel-navarro-icon.svg","alt","Abel Navarro Logo","width","40","height","40","loading","lazy",1,"d-inline-block","align-text-top","me-2"],[1,"fw-bold","text-dark"],[1,"text-muted","d-block","lh-1",2,"font-size","0.7rem","text-transform","uppercase","letter-spacing","0.5px"],["type","button","data-bs-toggle","offcanvas","data-bs-target","#offcanvasNavbar","aria-controls","offcanvasNavbar","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler","border-0","shadow-none","d-lg-none"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse","d-none","d-lg-flex"],[1,"navbar-nav","mx-auto"],[4,"ngIf"],[1,"navbar-nav","ms-auto"],["class","nav-item",4,"ngIf"],["class","nav-item dropdown",4,"ngIf"],["tabindex","-1","id","offcanvasNavbar","aria-labelledby","offcanvasNavbarLabel",1,"offcanvas","offcanvas-start"],[1,"offcanvas-header","bg-light","text-dark","py-3","border-bottom"],["class","d-flex align-items-center w-100",4,"ngIf"],["class","d-flex align-items-center text-dark w-100",4,"ngIf"],["type","button","data-bs-dismiss","offcanvas","aria-label","Close",1,"btn-close"],[1,"offcanvas-body","d-flex","flex-column","p-0"],[1,"navbar-nav","flex-grow-1","px-3","pt-3"],[1,"mt-auto","border-top","bg-light","p-3"],["class","d-grid gap-2",4,"ngIf"],[1,"nav-item"],["href","#banner",1,"nav-link","d-flex","align-items-center","px-3","py-2"],[1,"bi","bi-house-door","me-2"],["href","#workshops",1,"nav-link","d-flex","align-items-center","px-3","py-2"],[1,"bi","bi-mortarboard","me-2"],["href","#contact",1,"nav-link","d-flex","align-items-center","px-3","py-2"],[1,"bi","bi-envelope","me-2"],["routerLink","/verificar",1,"nav-link","d-flex","align-items-center","px-3","py-2"],[1,"bi","bi-shield-check","me-2"],["routerLink","/","routerLinkActive","active",1,"nav-link","d-flex","align-items-center","px-3","py-2",3,"routerLinkActiveOptions"],[1,"nav-item","dropdown"],["href","#","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle","d-flex","align-items-center","px-3","py-2"],[1,"bi","bi-calendar-event","me-2"],[1,"dropdown-menu"],[1,"dropdown-header"],[1,"bi","bi-calendar3","me-1"],["routerLink","/eventos","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-calendar2-week","me-1"],[1,"dropdown-divider"],[1,"bi","bi-person-vcard","me-1"],["routerLink","/inscripciones","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-card-checklist","me-1"],["routerLink","/inscripciones/nueva","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-person-plus","me-1"],[1,"bi","bi-award","me-2"],["routerLink","/certificados","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-file-earmark-text","me-1"],["routerLink","/eventos/crear","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-calendar-plus","me-1"],["routerLink","/inscripciones/masiva","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-people","me-1"],["routerLink","/certificados/generar","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-stars","me-1"],[1,"bi","bi-bar-chart","me-2"],["routerLink","/reportes","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-speedometer2","me-1"],["routerLink","/reportes/eventos","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-calendar3-event","me-1"],["routerLink","/reportes/participantes","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-person-lines-fill","me-1"],["routerLink","/reportes/certificados","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-award","me-1"],[1,"bi","bi-gear","me-2"],["routerLink","/usuarios","routerLinkActive","active",1,"dropdown-item"],["routerLink","/usuarios/nuevo","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-sliders","me-1"],["routerLink","/configuracion/general","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-toggles","me-1"],["routerLink","/certificados/editor","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-palette","me-1"],["routerLink","/configuracion/integraciones","routerLinkActive","active",1,"dropdown-item"],[1,"bi","bi-link-45deg","me-1"],[1,"nav-link","d-flex","align-items-center"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],["type","button",1,"btn","btn-outline-primary","ms-2","d-flex","align-items-center",3,"click"],[1,"bi","bi-google","me-2"],["type","button","id","userDropdown","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-link","nav-link","dropdown-toggle","d-flex","align-items-center","text-decoration-none","border-0","bg-transparent","p-2"],[1,"d-flex","align-items-center"],[1,"me-2"],["class","rounded-circle border","width","32","height","32","loading","lazy",3,"src","alt",4,"ngIf","ngIfElse"],[1,"text-start","d-none","d-xl-block"],[1,"fw-semibold","small","text-dark"],[1,"text-muted","lh-1",2,"font-size","0.75rem"],[1,"dropdown-menu","dropdown-menu-end","shadow","border-0"],[1,"d-xl-none"],[1,"dropdown-header","px-3","py-2"],[1,"text-dark"],[1,"text-muted","small"],["type","button",1,"dropdown-item","d-flex","align-items-center","px-3","py-2",3,"click"],[1,"bi","bi-person-circle","me-2"],[1,"bi","bi-gear-fill","me-2"],["type","button",1,"dropdown-item","d-flex","align-items-center","px-3","py-2","text-danger",3,"click"],[1,"bi","bi-box-arrow-right","me-2"],["width","32","height","32","loading","lazy",1,"rounded-circle","border",3,"src","alt"],[1,"bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","border",2,"width","32px","height","32px"],[1,"bi","bi-person-fill"],[1,"d-flex","align-items-center","w-100"],[1,"me-3"],["class","rounded-circle border border-2","width","48","height","48","loading","lazy",3,"src","alt",4,"ngIf","ngIfElse"],[1,"text-dark","flex-grow-1"],[1,"fw-bold"],[1,"opacity-75","small"],["width","48","height","48","loading","lazy",1,"rounded-circle","border","border-2",3,"src","alt"],[1,"bg-primary","text-white","rounded-circle","d-flex","align-items-center","justify-content-center","border","border-2",2,"width","48px","height","48px"],[1,"bi","bi-person-fill","fs-4"],[1,"bi","bi-person-circle","me-3","fs-1"],[1,"d-flex","align-items-center","text-dark","w-100"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-3"],[1,"flex-grow-1"],["href","#banner","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-house-door","me-3"],[1,"fw-medium"],["href","#workshops","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-mortarboard","me-3"],["href","#contact","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-envelope","me-3"],["routerLink","/verificar","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-shield-check","me-3"],["routerLink","/","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1",3,"routerLinkActiveOptions"],[1,"text-muted","small","px-3","py-2","fw-bold","text-uppercase",2,"font-size","0.75rem"],["routerLink","/eventos","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-calendar2-week","me-3"],["class","nav-link d-flex align-items-center py-2 px-4 rounded-3 mb-1","routerLink","/eventos/crear","routerLinkActive","active","data-bs-dismiss","offcanvas",4,"ngIf"],["routerLink","/inscripciones","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-card-checklist","me-3"],["routerLink","/inscripciones/nueva","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-person-plus","me-3"],["class","nav-link d-flex align-items-center py-2 px-4 rounded-3 mb-1","routerLink","/inscripciones/masiva","routerLinkActive","active","data-bs-dismiss","offcanvas",4,"ngIf"],["routerLink","/certificados","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-file-earmark-text","me-3"],["class","nav-link d-flex align-items-center py-2 px-4 rounded-3 mb-1","routerLink","/certificados/generar","routerLinkActive","active","data-bs-dismiss","offcanvas",4,"ngIf"],["routerLink","/eventos/crear","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-calendar-plus","me-3"],["routerLink","/inscripciones/masiva","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-people","me-3"],["routerLink","/certificados/generar","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-stars","me-3"],[1,"bi","bi-bar-chart","me-1"],["routerLink","/reportes","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-speedometer2","me-3"],["routerLink","/reportes/eventos","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-calendar3-event","me-3"],["routerLink","/reportes/participantes","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-person-lines-fill","me-3"],["routerLink","/reportes/certificados","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-award","me-3"],[1,"bi","bi-gear","me-1"],["routerLink","/usuarios","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],["routerLink","/usuarios/nuevo","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],["routerLink","/configuracion/general","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-toggles","me-3"],["routerLink","/certificados/editor","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-palette","me-3"],["routerLink","/configuracion/integraciones","routerLinkActive","active","data-bs-dismiss","offcanvas",1,"nav-link","d-flex","align-items-center","py-2","px-4","rounded-3","mb-1"],[1,"bi","bi-link-45deg","me-3"],["type","button","data-bs-dismiss","offcanvas",1,"btn","btn-primary","w-100","d-flex","align-items-center","justify-content-center","py-3",3,"click"],[1,"d-grid","gap-2"],["type","button","data-bs-dismiss","offcanvas",1,"btn","btn-outline-primary","d-flex","align-items-center","justify-content-center","py-2",3,"click"],["type","button","data-bs-dismiss","offcanvas",1,"btn","btn-outline-secondary","d-flex","align-items-center","justify-content-center","py-2",3,"click"],["type","button","class","btn btn-outline-info d-flex align-items-center justify-content-center py-2","data-bs-dismiss","offcanvas",3,"click",4,"ngIf"],["type","button","data-bs-dismiss","offcanvas",1,"btn","btn-outline-danger","d-flex","align-items-center","justify-content-center","py-2",3,"click"],["type","button","data-bs-dismiss","offcanvas",1,"btn","btn-outline-info","d-flex","align-items-center","justify-content-center","py-2",3,"click"]],template:function(t,i){t&1&&(s(0,"nav",2)(1,"div",3)(2,"a",4),g(3,"img",5),s(4,"div")(5,"div",6),l(6,"Abel Navarro"),d(),s(7,"small",7),l(8,"Psic\xF3logo Organizacional"),d()()(),s(9,"button",8),g(10,"span",9),d(),s(11,"div",10)(12,"ul",11),w(13,st,21,0,"ng-container",12),M(14,"async"),w(15,mt,49,7,"ng-container",12),M(16,"async"),d(),s(17,"div",13),w(18,ft,5,0,"div",14),M(19,"async"),w(20,gt,5,0,"div",14),M(21,"async"),M(22,"async"),w(23,Ct,40,8,"div",15),M(24,"async"),M(25,"async"),d()(),s(26,"div",16)(27,"div",17),w(28,Et,10,4,"div",18),M(29,"async"),M(30,"async"),w(31,Dt,7,0,"div",18),M(32,"async"),M(33,"async"),w(34,Ot,4,0,"div",19),M(35,"async"),g(36,"button",20),d(),s(37,"div",21)(38,"ul",22),w(39,xt,21,0,"ng-container",12),M(40,"async"),w(41,Tt,46,7,"ng-container",12),M(42,"async"),d(),s(43,"div",23),w(44,Mt,5,0,"div",12),M(45,"async"),M(46,"async"),w(47,Ut,14,1,"div",24),M(48,"async"),M(49,"async"),d()()()()()),t&2&&(y(13),E("ngIf",!A(14,12,i.isAuthenticated$)),y(2),E("ngIf",A(16,14,i.isAuthenticated$)),y(3),E("ngIf",A(19,16,i.authService.loading$)),y(2),E("ngIf",!A(21,18,i.authService.loading$)&&!A(22,20,i.isAuthenticated$)),y(3),E("ngIf",!A(24,22,i.authService.loading$)&&A(25,24,i.isAuthenticated$)),y(5),E("ngIf",!A(29,26,i.authService.loading$)&&A(30,28,i.isAuthenticated$)),y(3),E("ngIf",!A(32,30,i.authService.loading$)&&!A(33,32,i.isAuthenticated$)),y(3),E("ngIf",A(35,34,i.authService.loading$)),y(5),E("ngIf",!A(40,36,i.isAuthenticated$)),y(2),E("ngIf",A(42,38,i.isAuthenticated$)),y(3),E("ngIf",!A(45,40,i.authService.loading$)&&!A(46,42,i.isAuthenticated$)),y(3),E("ngIf",!A(48,44,i.authService.loading$)&&A(49,46,i.isAuthenticated$)))},dependencies:[Ue,Me,He,ze,Be,Ae],styles:[".navbar-toggler[_ngcontent-%COMP%]:focus{box-shadow:none}.nav-link[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%], .offcanvas[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:var(--bs-primary)!important;transition:color .2s ease-in-out}.dropdown-menu[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow-lg)}@media (min-width: 992px){.offcanvas-start[_ngcontent-%COMP%]{display:none!important}}@media (max-width: 767px){.navbar-brand[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{font-size:1.1rem}.navbar-brand[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.65rem!important}}"]})};var _e=class r{scrollToSection(e){let t=document.getElementById(e);if(t){let o=t.offsetTop-80;window.scrollTo({top:o,behavior:"smooth"})}}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=oe({type:r,selectors:[["app-footer"]],decls:108,vars:0,consts:[[1,"professional-footer"],[1,"container"],[1,"footer-main"],[1,"row","g-4"],[1,"col-lg-4","col-md-6"],[1,"footer-brand"],[1,"brand-container"],[1,"brand-logo"],["src","abel-navarro-icon.svg","alt","Abel Navarro Logo",1,"logo-img"],[1,"brand-text"],[1,"brand-description"],[1,"contact-info"],[1,"contact-item"],[1,"bi","bi-patch-check-fill"],[1,"bi","bi-building"],[1,"col-lg-2","col-md-6"],[1,"footer-section"],[1,"footer-title"],[1,"footer-links"],["href","#workshops",3,"click"],[1,"col-lg-3","col-md-6"],["href","#about",3,"click"],[1,"contact-methods"],["href","https://wa.me/tu-numero","target","_blank",1,"contact-method","whatsapp"],[1,"bi","bi-whatsapp"],[1,"method-info"],["href","https://facebook.com/tu-pagina","target","_blank",1,"contact-method","facebook"],[1,"bi","bi-facebook"],["href","mailto:tu.email@example.com",1,"contact-method","email"],[1,"bi","bi-envelope-fill"],[1,"footer-bottom"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"copyright"],[1,"footer-meta"],[1,"professional-badges"],[1,"badge","badge-professional"],[1,"bi","bi-shield-check"],[1,"badge","badge-certified"],[1,"bi","bi-award"],[1,"footer-decoration"],[1,"decoration-pattern"]],template:function(t,i){t&1&&(S(0,"footer",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),H(8,"img",8),O(),S(9,"div",9)(10,"h5"),l(11,"Abel Navarro"),O(),S(12,"p"),l(13,"Psic\xF3logo Organizacional"),O()()(),S(14,"p",10),l(15," Especialista en desarrollo del talento humano y transformaci\xF3n organizacional. Brindo talleres, charlas y programas de capacitaci\xF3n para instituciones y empresas. "),O(),S(16,"div",11)(17,"div",12),H(18,"i",13),S(19,"span"),l(20,"C.Ps.P. N\xB0 64179"),O()(),S(21,"div",12),H(22,"i",14),S(23,"span"),l(24,"RUC: 10758489677"),O()()()()(),S(25,"div",15)(26,"div",16)(27,"h6",17),l(28,"Servicios"),O(),S(29,"ul",18)(30,"li")(31,"a",19),W("click",function(){return i.scrollToSection("workshops")}),l(32,"Talleres Institucionales"),O()(),S(33,"li")(34,"a",19),W("click",function(){return i.scrollToSection("workshops")}),l(35,"Capacitaci\xF3n Empresarial"),O()(),S(36,"li")(37,"a",19),W("click",function(){return i.scrollToSection("workshops")}),l(38,"Charlas Especializadas"),O()(),S(39,"li")(40,"a",19),W("click",function(){return i.scrollToSection("workshops")}),l(41,"Consultor\xEDa Organizacional"),O()()()()(),S(42,"div",20)(43,"div",16)(44,"h6",17),l(45,"Especializaciones"),O(),S(46,"ul",18)(47,"li")(48,"a",21),W("click",function(){return i.scrollToSection("about")}),l(49,"Psicolog\xEDa Organizacional"),O()(),S(50,"li")(51,"a",21),W("click",function(){return i.scrollToSection("about")}),l(52,"Liderazgo y Equipos"),O()(),S(53,"li")(54,"a",21),W("click",function(){return i.scrollToSection("about")}),l(55,"Bienestar Laboral"),O()(),S(56,"li")(57,"a",21),W("click",function(){return i.scrollToSection("about")}),l(58,"Habilidades Blandas"),O()(),S(59,"li")(60,"a",21),W("click",function(){return i.scrollToSection("about")}),l(61,"Desarrollo Humano"),O()()()()(),S(62,"div",20)(63,"div",16)(64,"h6",17),l(65,"Contacto"),O(),S(66,"div",22)(67,"a",23),H(68,"i",24),S(69,"div",25)(70,"span"),l(71,"WhatsApp"),O(),S(72,"small"),l(73,"Consulta r\xE1pida"),O()()(),S(74,"a",26),H(75,"i",27),S(76,"div",25)(77,"span"),l(78,"Facebook"),O(),S(79,"small"),l(80,"S\xEDgueme"),O()()(),S(81,"a",28),H(82,"i",29),S(83,"div",25)(84,"span"),l(85,"Email"),O(),S(86,"small"),l(87,"Contacto formal"),O()()()()()()()(),S(88,"div",30)(89,"div",31)(90,"div",32)(91,"div",33)(92,"p"),l(93,"\xA9 2025 "),S(94,"strong"),l(95,"Abel Uriaz Navarro Carrasco"),O(),l(96,". Todos los derechos reservados."),O()()(),S(97,"div",32)(98,"div",34)(99,"div",35)(100,"span",36),H(101,"i",37),l(102," Psic\xF3logo Colegiado "),O(),S(103,"span",38),H(104,"i",39),l(105," Especialista Certificado "),O()()()()()()(),S(106,"div",40),H(107,"div",41),O()())},styles:[`.professional-footer[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a365d,#2d3748,#4a5568,#2b6cb0,#1a202c);color:var(--bs-white);position:relative;overflow:hidden;margin-top:5rem;border-top:4px solid transparent;border-image:linear-gradient(90deg,var(--bs-primary) 0%,var(--bs-warning) 25%,var(--bs-info) 50%,var(--bs-warning) 75%,var(--bs-primary) 100%) 1;box-shadow:0 -10px 30px #0003,0 -2px 10px #0000001a}.professional-footer[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 80% 20%,rgba(var(--bs-warning-rgb),.12) 0%,transparent 50%),radial-gradient(circle at 20% 80%,rgba(var(--bs-primary-rgb),.15) 0%,transparent 50%),radial-gradient(circle at 50% 50%,rgba(255,255,255,.05) 0%,transparent 60%);z-index:1}.professional-footer[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");z-index:1}.professional-footer[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;z-index:2}.footer-main[_ngcontent-%COMP%]{padding:4rem 0 2rem;border-bottom:1px solid rgba(255,255,255,.15)}.footer-brand[_ngcontent-%COMP%]   .brand-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.footer-brand[_ngcontent-%COMP%]   .brand-container[_ngcontent-%COMP%]   .brand-logo[_ngcontent-%COMP%]{width:55px;height:55px;display:flex;align-items:center;justify-content:center;background:#ffffff1a;border-radius:var(--border-radius-lg);box-shadow:0 8px 25px #0003}.footer-brand[_ngcontent-%COMP%]   .brand-container[_ngcontent-%COMP%]   .brand-logo[_ngcontent-%COMP%]   .logo-img[_ngcontent-%COMP%]{width:45px;height:45px;object-fit:contain;filter:brightness(1.1)}.footer-brand[_ngcontent-%COMP%]   .brand-container[_ngcontent-%COMP%]   .brand-text[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:1.5rem;font-weight:700;color:var(--bs-white);margin:0;line-height:1.2}.footer-brand[_ngcontent-%COMP%]   .brand-container[_ngcontent-%COMP%]   .brand-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fffc;font-size:.9rem;font-weight:500;margin:0;letter-spacing:.5px}.footer-brand[_ngcontent-%COMP%]   .brand-description[_ngcontent-%COMP%]{color:#fffc;line-height:1.6;margin-bottom:1.5rem;font-size:.95rem}.footer-brand[_ngcontent-%COMP%]   .contact-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.footer-brand[_ngcontent-%COMP%]   .contact-info[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;color:#ffffffe6;font-size:.9rem;font-weight:500}.footer-brand[_ngcontent-%COMP%]   .contact-info[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--bs-warning);font-size:1.1rem;width:20px;text-align:center}.footer-section[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]{font-family:var(--font-secondary);font-size:1.1rem;font-weight:700;color:var(--bs-white);margin-bottom:1.5rem;position:relative}.footer-section[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:0;width:30px;height:2px;background:linear-gradient(90deg,var(--bs-warning),var(--accent-color));border-radius:1px}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.75rem}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fffc;text-decoration:none;font-size:.9rem;transition:var(--transition-smooth);display:flex;align-items:center;padding:.25rem 0}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{content:"";width:4px;height:4px;background:var(--bs-warning);border-radius:50%;margin-right:.75rem;transition:var(--transition-smooth);opacity:.6}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--bs-white);transform:translate(8px)}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before{background:var(--bs-white);opacity:1;transform:scale(1.5)}.contact-methods[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;background:#ffffff1a;border-radius:var(--border-radius);text-decoration:none;color:#ffffffe6;transition:var(--transition-smooth);border:1px solid rgba(255,255,255,.15)}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]:hover{background:#ffffff26;transform:translateY(-3px);box-shadow:0 8px 25px #0003;color:var(--bs-white);border-color:#ffffff4d}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem;width:35px;height:35px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:var(--transition-smooth)}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   .method-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:.9rem;line-height:1.2}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   .method-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#ffffffb3;font-size:.75rem}.contact-methods[_ngcontent-%COMP%]   .contact-method.whatsapp[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{background:#25d366;color:var(--bs-white);transform:scale(1.1)}.contact-methods[_ngcontent-%COMP%]   .contact-method.facebook[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{background:#1877f2;color:var(--bs-white);transform:scale(1.1)}.contact-methods[_ngcontent-%COMP%]   .contact-method.email[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{background:var(--bs-warning);color:var(--bs-dark);transform:scale(1.1)}.footer-bottom[_ngcontent-%COMP%]{padding:2rem 0}.footer-bottom[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#fffc;font-size:.9rem}.footer-bottom[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--bs-white);font-weight:600}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]{text-align:right}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;flex-wrap:wrap}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#ffffff26;color:var(--bs-white);border:1px solid rgba(255,255,255,.2);padding:.5rem 1rem;border-radius:20px;font-size:.8rem;font-weight:500;display:flex;align-items:center;gap:.5rem;transition:var(--transition-smooth)}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-2px);box-shadow:0 5px 15px #0003}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.9rem}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge.badge-professional[_ngcontent-%COMP%]:hover{background:rgba(var(--bs-success-rgb),.8);border-color:var(--bs-success)}.footer-bottom[_ngcontent-%COMP%]   .footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge.badge-certified[_ngcontent-%COMP%]:hover{background:rgba(var(--bs-warning-rgb),.8);border-color:var(--bs-warning);color:var(--bs-dark)}.footer-decoration[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:0;overflow:hidden}.footer-decoration[_ngcontent-%COMP%]   .decoration-pattern[_ngcontent-%COMP%]{position:absolute;top:15%;right:5%;width:250px;height:250px;background:radial-gradient(circle at 30% 30%,rgba(var(--bs-warning-rgb),.15) 0%,transparent 50%),radial-gradient(circle at 70% 70%,rgba(var(--bs-primary-rgb),.12) 0%,transparent 60%);border-radius:50%;animation:_ngcontent-%COMP%_float 8s ease-in-out infinite}.footer-decoration[_ngcontent-%COMP%]   .decoration-pattern[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:180px;height:180px;background:radial-gradient(circle at 40% 60%,rgba(var(--bs-info-rgb),.1) 0%,transparent 50%),conic-gradient(from 0deg,transparent,rgba(255,255,255,.05),transparent);border-radius:50%;animation:_ngcontent-%COMP%_float 6s ease-in-out infinite reverse}.footer-decoration[_ngcontent-%COMP%]   .decoration-pattern[_ngcontent-%COMP%]:after{content:"";position:absolute;top:-50%;left:-50%;width:100px;height:100px;background:radial-gradient(circle,rgba(var(--bs-success-rgb),.08) 0%,transparent 70%);border-radius:50%;animation:_ngcontent-%COMP%_float 10s ease-in-out infinite}.footer-decoration[_ngcontent-%COMP%]:before{content:"";position:absolute;top:60%;left:8%;width:120px;height:120px;background:radial-gradient(circle,rgba(var(--bs-warning-rgb),.08) 0%,transparent 60%),linear-gradient(45deg,transparent 30%,rgba(255,255,255,.02) 50%,transparent 70%);border-radius:50%;animation:_ngcontent-%COMP%_float 12s ease-in-out infinite reverse}.footer-decoration[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:20%;right:15%;width:80px;height:80px;background:radial-gradient(circle,rgba(var(--bs-info-rgb),.06) 0%,transparent 70%);border-radius:50%;animation:_ngcontent-%COMP%_float 9s ease-in-out infinite}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-20px)}}@media (max-width: 991.98px){.footer-main[_ngcontent-%COMP%]{padding:3rem 0 1.5rem}.footer-section[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center}.footer-meta[_ngcontent-%COMP%]{text-align:center;margin-top:1rem}.footer-meta[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]{justify-content:center}.brand-container[_ngcontent-%COMP%]{justify-content:center;text-align:center}.brand-description[_ngcontent-%COMP%], .contact-info[_ngcontent-%COMP%]{text-align:center}}@media (max-width: 767.98px){.footer-main[_ngcontent-%COMP%]{padding:2rem 0 1rem}.brand-container[_ngcontent-%COMP%]{justify-content:center;text-align:center}.brand-container[_ngcontent-%COMP%]   .brand-text[_ngcontent-%COMP%]{text-align:center}.brand-description[_ngcontent-%COMP%]{text-align:center;font-size:.9rem}.contact-info[_ngcontent-%COMP%]{align-items:center;justify-content:center}.footer-section[_ngcontent-%COMP%]{text-align:center}.footer-section[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]{font-size:1rem}.footer-section[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]:after{left:50%;transform:translate(-50%)}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]{font-size:.9rem}.contact-methods[_ngcontent-%COMP%]{align-items:center;flex-direction:column;gap:1rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]{width:100%;max-width:250px;justify-content:center}.copyright[_ngcontent-%COMP%]{text-align:center;margin-bottom:1rem}.copyright[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem}.professional-badges[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}.professional-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 575.98px){.professional-footer[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.footer-main[_ngcontent-%COMP%]{padding:1.5rem 0 1rem}.brand-container[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.brand-container[_ngcontent-%COMP%]   .brand-icon[_ngcontent-%COMP%]{width:60px;height:60px}.brand-description[_ngcontent-%COMP%]{font-size:.85rem;line-height:1.5}.contact-info[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]{font-size:.8rem;gap:.5rem}.footer-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.footer-section[_ngcontent-%COMP%]   .footer-title[_ngcontent-%COMP%]{font-size:.95rem;margin-bottom:1rem}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.75rem}.footer-section[_ngcontent-%COMP%]   .footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:.85rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]{padding:.75rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   .method-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem}.contact-methods[_ngcontent-%COMP%]   .contact-method[_ngcontent-%COMP%]   .method-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem}.footer-bottom[_ngcontent-%COMP%]{padding:1rem 0}.footer-bottom[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:.5rem}.footer-bottom[_ngcontent-%COMP%]   .professional-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .8rem}}`]})};var be=class r{title=ae("GESTION-EVENTOS");static \u0275fac=function(t){return new(t||r)};static \u0275cmp=oe({type:r,selectors:[["app-root"]],decls:4,vars:0,consts:[[1,"content-container"]],template:function(t,i){t&1&&(g(0,"app-header"),s(1,"div",0),g(2,"router-outlet"),d(),g(3,"app-footer"))},dependencies:[Fe,ve,_e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.content-container[_ngcontent-%COMP%]{padding-top:65px;flex:1;display:flex;flex-direction:column;width:100%}"]})};Le(be,it).catch(r=>console.error(r));
