import{b as Le}from"./chunk-22IHSIXM.js";import{a as Te}from"./chunk-4XQXH5E7.js";import{a as Fe}from"./chunk-W55XPYIR.js";import{c as ue,e as _e,f as ve,h as be,k as ge,l as Ce,m as fe,n as xe,o as Ee,s as he,t as Se,u as ye}from"./chunk-KBXA6SDK.js";import{a as we}from"./chunk-CYLPXQIR.js";import"./chunk-MPC7SZEK.js";import{a as P,c as D}from"./chunk-TMGCMHHJ.js";import{a as me,b as pe,j as R}from"./chunk-IIPOJGOQ.js";import{i as ce,l as de}from"./chunk-C3HOFUSH.js";import{$a as M,A as U,Aa as W,Ab as ee,Bb as S,Bc as se,D as H,Da as r,Db as k,Fb as y,Gb as l,H as Q,Hb as E,Ib as h,Jb as te,Na as X,Ob as ie,Q as K,Ra as Y,Rb as B,Sb as F,Vb as ne,Wb as oe,_ as I,ab as A,ac as w,bb as u,cb as _,da as v,ea as b,eb as z,fb as L,g as G,gb as V,gc as re,hb as m,ia as J,ib as t,jb as i,k as q,kb as s,ma as x,q as j,rb as f,sb as g,ub as d,uc as ae,zb as Z,zc as le}from"./chunk-5W5GNUFO.js";import"./chunk-LJ5XHLMQ.js";import{a as O,b as $}from"./chunk-FK42CRUA.js";var Ie=["confirmModal"],ke=()=>[1,2,3,4,5,6,7,8],N=o=>["/eventos",o],Pe=o=>["/eventos",o,"editar"],Me=(o,n)=>n.key;function De(o,n){if(o&1&&(t(0,"span",16),l(1),i()),o&2){let e=d();r(),E(e.totalItems())}}function Ne(o,n){o&1&&s(0,"span",20)}function Ae(o,n){o&1&&s(0,"i",21)}function ze(o,n){if(o&1&&(t(0,"span",32),l(1),i()),o&2){let e=d();r(),E(e.activeFiltersCount())}}function Be(o,n){if(o&1){let e=f();t(0,"button",58),g("click",function(){v(e);let c=d();return b(c.clearFilters())}),s(1,"i",59),i()}}function Re(o,n){if(o&1){let e=f();t(0,"button",80),g("click",function(){v(e),d();let c=S(10);return d().clearSearch(),b(c.focus())}),s(1,"i",81),i()}}function Oe(o,n){if(o&1&&(t(0,"option",71),l(1),i()),o&2){let e=n.$implicit;m("value",e.key),r(),E(e.value.name)}}function $e(o,n){if(o&1&&(L(0,Oe,2,2,"option",71,Me),ne(2,"keyvalue")),o&2){let e=d(2);V(oe(2,0,e.eventTypes()))}}function Ge(o,n){if(o&1&&(t(0,"div",37)(1,"form",60)(2,"div",61)(3,"div",62)(4,"label",63),l(5,"Buscar por texto"),i(),t(6,"div",64)(7,"span",65),s(8,"i",66),i(),s(9,"input",67,1),u(11,Re,2,0,"button",68),i()(),t(12,"div",62)(13,"label",63),l(14,"Estado del evento"),i(),t(15,"select",69)(16,"option",70),l(17,"Todos los estados"),i(),t(18,"option",71),l(19,"Borrador"),i(),t(20,"option",71),l(21,"Publicado"),i(),t(22,"option",71),l(23,"Inscripciones Abiertas"),i(),t(24,"option",71),l(25,"Inscripciones Cerradas"),i(),t(26,"option",71),l(27,"En Curso"),i(),t(28,"option",71),l(29,"Finalizado"),i(),t(30,"option",71),l(31,"Cancelado"),i()()(),t(32,"div",62)(33,"label",63),l(34,"Tipo de evento"),i(),t(35,"select",72)(36,"option",70),l(37,"Todos los tipos"),i(),u(38,$e,3,2),i()(),t(39,"div",73)(40,"label",63),l(41,"Modalidad"),i(),t(42,"select",74)(43,"option",70),l(44,"Todas"),i(),t(45,"option",71),l(46,"Presencial"),i(),t(47,"option",71),l(48,"Virtual"),i(),t(49,"option",71),l(50,"H\xEDbrido"),i()()(),t(51,"div",73)(52,"label",63),l(53,"Fecha desde"),i(),s(54,"input",75),i(),t(55,"div",73)(56,"label",63),l(57,"Fecha hasta"),i(),s(58,"input",76),i(),t(59,"div",73)(60,"label",63),l(61,"Acceso"),i(),t(62,"select",77)(63,"option",70),l(64,"Todos"),i(),t(65,"option",78),l(66,"P\xFAblico"),i(),t(67,"option",79),l(68,"Privado"),i()()()()()()),o&2){let e,a=d();r(),m("formGroup",a.form),r(10),_((e=a.form.get("search"))!=null&&e.value?11:-1),r(7),m("value",a.EventStatus.DRAFT),r(2),m("value",a.EventStatus.PUBLISHED),r(2),m("value",a.EventStatus.REG_OPEN),r(2),m("value",a.EventStatus.REG_CLOSED),r(2),m("value",a.EventStatus.ACTIVE),r(2),m("value",a.EventStatus.COMPLETED),r(2),m("value",a.EventStatus.CANCELLED),r(8),_(a.eventTypes()?38:-1),r(7),m("value",a.LocationType.PRESENCIAL),r(2),m("value",a.LocationType.VIRTUAL),r(2),m("value",a.LocationType.HIBRIDO)}}function qe(o,n){if(o&1&&(t(0,"span",41),l(1),i()),o&2){let e=d();r(),E(e.totalItems())}}function je(o,n){if(o&1&&(t(0,"option",71),l(1),i()),o&2){let e=n.$implicit;m("value",e),r(),E(e)}}function Ue(o,n){o&1&&(t(0,"div",88)(1,"div",89)(2,"div",90)(3,"div",91),s(4,"span",92)(5,"span",93),i()(),t(6,"div",37)(7,"div",94)(8,"div",95),s(9,"span",96)(10,"span",97)(11,"span",98),i()(),t(12,"div",99)(13,"div",100)(14,"div",28),s(15,"span",101)(16,"span",102),i()(),t(17,"div",100)(18,"div",28),s(19,"span",103)(20,"span",98),i()()(),t(21,"div",61)(22,"div",100)(23,"div",28),s(24,"span",104)(25,"span",105),i()(),t(26,"div",100)(27,"div",28),s(28,"span",106)(29,"span",107),i()()()(),t(30,"div",108)(31,"div",109),s(32,"span",110)(33,"span",110)(34,"span",110),i()()()())}function He(o,n){o&1&&(t(0,"div",82),L(1,Ue,35,0,"div",88,z),i()),o&2&&(r(),V(B(0,ke)))}function Qe(o,n){o&1&&(t(0,"tr")(1,"td",119),s(2,"span",120),i(),t(3,"td",119)(4,"div",95),s(5,"span",121)(6,"span",97)(7,"span",98),i()(),t(8,"td",122)(9,"div",95),s(10,"span",97)(11,"span",98),i()(),t(12,"td",119),s(13,"span",123),i(),t(14,"td",124),s(15,"span",125),i(),t(16,"td",126),s(17,"span",127),i(),t(18,"td",119)(19,"div",128),s(20,"span",110)(21,"span",110)(22,"span",110),i()()())}function Ke(o,n){o&1&&(t(0,"div",83)(1,"table",111)(2,"thead",112)(3,"tr")(4,"th",113),l(5,"Sel."),i(),t(6,"th",114),l(7,"Evento"),i(),t(8,"th",115),l(9,"Fechas"),i(),t(10,"th",114),l(11,"Estado"),i(),t(12,"th",116),l(13,"Tipo"),i(),t(14,"th",117),l(15,"Modalidad"),i(),t(16,"th",118),l(17,"Acciones"),i()()(),t(18,"tbody"),L(19,Qe,23,0,"tr",null,z),i()()()),o&2&&(r(19),V(B(0,ke)))}function Je(o,n){if(o&1&&(t(0,"div",55),u(1,He,3,1,"div",82)(2,Ke,21,1,"div",83),t(3,"div",84)(4,"div",85)(5,"span",86),l(6,"Cargando..."),i()(),t(7,"span",87),l(8,"Cargando eventos..."),i()()()),o&2){let e=d();r(),_(e.view()==="cards"?1:2)}}function We(o,n){if(o&1){let e=f();t(0,"div",56)(1,"div",129),s(2,"i",130),i(),t(3,"h5",131),l(4,"Error al cargar eventos"),i(),t(5,"p",132),l(6),i(),t(7,"button",133),g("click",function(){v(e);let c=d();return b(c.load())}),s(8,"i",134),l(9,"Reintentar "),i()()}if(o&2){let e=d();r(6),E(e.errorMessage())}}function Xe(o,n){if(o&1){let e=f();t(0,"h5",136),l(1,"No se encontraron eventos"),i(),t(2,"p",132),l(3,"Intenta ajustar los filtros de b\xFAsqueda"),i(),t(4,"button",133),g("click",function(){v(e);let c=d(2);return b(c.clearFilters())}),s(5,"i",137),l(6,"Limpiar filtros "),i()}}function Ye(o,n){o&1&&(t(0,"h5",136),l(1,"No hay eventos registrados"),i(),t(2,"p",132),l(3,"Comienza creando el primer evento"),i(),t(4,"a",138),s(5,"i",139),l(6,"Nuevo Evento "),i())}function Ze(o,n){if(o&1&&(t(0,"div",56)(1,"div",132),s(2,"i",135),i(),u(3,Xe,7,0)(4,Ye,7,0),i()),o&2){let e=d();r(3),_(e.hasActiveFilters()?3:4)}}function et(o,n){if(o&1&&(t(0,"p",151),l(1),i()),o&2){let e=d().$implicit;m("title",e.shortDescription),r(),h(" ",e.shortDescription," ")}}function tt(o,n){if(o&1&&l(0),o&2){let e=d().$implicit;h(" / ",e.maxParticipants," ")}}function it(o,n){if(o&1){let e=f();t(0,"button",169),g("click",function(c){v(e);let p=d().$implicit,C=d(3),T=S(2);return c.preventDefault(),c.stopPropagation(),b(C.openConfirm(T,"Publicar evento","\xBFConfirma que desea publicar este evento?","publish",p.id))}),s(1,"i",170),i()}}function nt(o,n){if(o&1){let e=f();t(0,"button",171),g("click",function(c){v(e);let p=d().$implicit,C=d(3),T=S(2);return c.preventDefault(),c.stopPropagation(),b(C.openConfirm(T,"Abrir inscripciones","\xBFAbrir inscripciones para este evento?","open",p.id))}),s(1,"i",172),i()}}function ot(o,n){if(o&1){let e=f();t(0,"button",173),g("click",function(c){v(e);let p=d().$implicit,C=d(3),T=S(2);return c.preventDefault(),c.stopPropagation(),b(C.openConfirm(T,"Cerrar inscripciones","\xBFCerrar inscripciones para este evento?","close",p.id))}),s(1,"i",174),i()}}function rt(o,n){if(o&1){let e=f();t(0,"button",175),g("click",function(c){v(e);let p=d().$implicit,C=d(3),T=S(2);return c.preventDefault(),c.stopPropagation(),b(C.openConfirm(T,"Cancelar evento","\xBFEst\xE1 seguro de cancelar este evento?","cancel",p.id))}),s(1,"i",59),i()}}function at(o,n){if(o&1){let e=f();t(0,"div",88)(1,"div",142)(2,"div",143),s(3,"img",144),t(4,"span",145),s(5,"i",146),l(6),i()(),t(7,"div",37)(8,"div",147),s(9,"i",148),t(10,"small",87),l(11),i()(),t(12,"h6",149)(13,"a",150),l(14),i()(),u(15,et,2,2,"p",151),t(16,"div",94)(17,"div",147),s(18,"i",152),t(19,"span",153),l(20),i()(),t(21,"div",147),s(22,"i",154),t(23,"span",155),l(24),u(25,tt,1,1),i()(),t(26,"div",28),s(27,"i",156),t(28,"span",153),l(29),i()()()(),t(30,"div",157)(31,"div",158)(32,"button",159),g("click",function(c){let p=v(e).$implicit,C=d(3);return c.preventDefault(),c.stopPropagation(),b(C.toggleFeatured(p.id))}),s(33,"i",160),i(),t(34,"a",161),g("click",function(c){return v(e),b(c.stopPropagation())}),s(35,"i",162),i(),t(36,"a",163),g("click",function(c){return v(e),b(c.stopPropagation())}),s(37,"i",164),i(),u(38,it,2,0,"button",165),u(39,nt,2,0,"button",166),u(40,ot,2,0,"button",167),u(41,rt,2,0,"button",168),i()()()()}if(o&2){let e=n.$implicit,a=d(3);r(3),m("alt",ie("Imagen de ",e.title))("src","assets/sinimagen.png",W),r(),y(a.getStateBadgeClass(e.status)),r(),y("bi-"+a.getStateIcon(e.status)),r(),h(" ",a.getStatusLabel(e.status)," "),r(5),te(" ",e.startDate," \u2192 ",e.endDate," "),r(),m("title",e.title),r(),m("routerLink",F(27,N,e.id)),r(),h(" ",e.title," "),r(),_(e.shortDescription?15:-1),r(5),E(e.eventType),r(4),h(" ",e.currentParticipants),r(),_(e.maxParticipants?25:-1),r(4),E(e.location),r(3),y(e.isFeatured?"btn-warning":"btn-outline-warning"),M("aria-pressed",e.isFeatured),r(2),m("routerLink",F(29,N,e.id)),r(2),m("routerLink",F(31,Pe,e.id)),r(2),_(a.canPublish(e)?38:-1),r(),_(a.canOpenReg(e)?39:-1),r(),_(a.canCloseReg(e)?40:-1),r(),_(a.canCancel(e)?41:-1)}}function lt(o,n){if(o&1&&(t(0,"div",140)(1,"div",141),L(2,at,42,33,"div",88,A().trackById,!0),i()()),o&2){let e=d(2);r(2),V(e.events())}}function st(o,n){if(o&1&&s(0,"i",35),o&2){let e=d(3);y(e.sortSig().direction==="asc"?"bi-arrow-up":"bi-arrow-down")}}function ct(o,n){o&1&&s(0,"i",178)}function dt(o,n){if(o&1&&s(0,"i",35),o&2){let e=d(3);y(e.sortSig().direction==="asc"?"bi-arrow-up":"bi-arrow-down")}}function mt(o,n){o&1&&s(0,"i",178)}function pt(o,n){if(o&1&&s(0,"i",35),o&2){let e=d(3);y(e.sortSig().direction==="asc"?"bi-arrow-up":"bi-arrow-down")}}function ut(o,n){o&1&&s(0,"i",178)}function _t(o,n){if(o&1&&(t(0,"small",186),l(1),i()),o&2){let e=d().$implicit;m("title",e.shortDescription),r(),h(" ",e.shortDescription," ")}}function vt(o,n){if(o&1&&(t(0,"small",87),l(1),i()),o&2){let e=d().$implicit;r(),h("/ ",e.maxParticipants)}}function bt(o,n){if(o&1){let e=f();t(0,"button",198),g("click",function(){v(e);let c=d().$implicit,p=d(3),C=S(2);return b(p.openConfirm(C,"Publicar evento","\xBFConfirma que desea publicar este evento?","publish",c.id))}),s(1,"i",170),i()}}function gt(o,n){if(o&1){let e=f();t(0,"button",199),g("click",function(){v(e);let c=d().$implicit,p=d(3),C=S(2);return b(p.openConfirm(C,"Abrir inscripciones","\xBFAbrir inscripciones para este evento?","open",c.id))}),s(1,"i",172),i()}}function Ct(o,n){if(o&1){let e=f();t(0,"button",200),g("click",function(){v(e);let c=d().$implicit,p=d(3),C=S(2);return b(p.openConfirm(C,"Cerrar inscripciones","\xBFCerrar inscripciones para este evento?","close",c.id))}),s(1,"i",174),i()}}function ft(o,n){if(o&1){let e=f();t(0,"button",201),g("click",function(){v(e);let c=d().$implicit,p=d(3),C=S(2);return b(p.openConfirm(C,"Cancelar evento","\xBFEst\xE1 seguro de cancelar este evento?","cancel",c.id))}),s(1,"i",59),i()}}function xt(o,n){if(o&1){let e=f();t(0,"tr")(1,"td",119)(2,"span",182),s(3,"i",146),t(4,"span",183),l(5),i()()(),t(6,"td",119)(7,"div",184)(8,"a",185),l(9),i()(),u(10,_t,2,2,"small",186),i(),t(11,"td",122)(12,"small",187),l(13),i()(),t(14,"td",124)(15,"small",87)(16,"div"),l(17),i(),t(18,"div"),l(19),i()()(),t(20,"td",126)(21,"small",188),l(22),i()(),t(23,"td",124)(24,"span",189),l(25),i(),u(26,vt,2,1,"small",87),i(),t(27,"td",119)(28,"div",190)(29,"button",191),g("click",function(){let c=v(e).$implicit,p=d(3);return b(p.toggleFeatured(c.id))}),s(30,"i",160),i(),t(31,"a",192),s(32,"i",162),i(),t(33,"a",193),s(34,"i",164),i(),u(35,bt,2,0,"button",194),u(36,gt,2,0,"button",195),u(37,Ct,2,0,"button",196),u(38,ft,2,0,"button",197),i()()()}if(o&2){let e=n.$implicit,a=d(3);r(2),y(a.getStateBadgeClass(e.status)),r(),y("bi-"+a.getStateIcon(e.status)),r(2),E(a.getStatusLabel(e.status)),r(2),m("title",e.title),r(),m("routerLink",F(26,N,e.id)),r(),h(" ",e.title," "),r(),_(e.shortDescription?10:-1),r(2),m("title",e.eventType),r(),h(" ",e.eventType," "),r(4),E(e.startDate),r(2),E(e.endDate),r(2),m("title",e.location),r(),h(" ",e.location," "),r(3),E(e.currentParticipants),r(),_(e.maxParticipants?26:-1),r(3),y(e.isFeatured?"btn-warning":"btn-outline-warning"),M("aria-pressed",e.isFeatured),r(2),m("routerLink",F(28,N,e.id)),r(2),m("routerLink",F(30,Pe,e.id)),r(2),_(a.canPublish(e)?35:-1),r(),_(a.canOpenReg(e)?36:-1),r(),_(a.canCloseReg(e)?37:-1),r(),_(a.canCancel(e)?38:-1)}}function Et(o,n){if(o&1){let e=f();t(0,"div",83)(1,"table",111)(2,"thead",112)(3,"tr")(4,"th",114),l(5,"Estado"),i(),t(6,"th",176),g("click",function(){v(e);let c=d(2);return b(c.setSort("title"))}),t(7,"div",27)(8,"span"),l(9,"Evento"),i(),u(10,st,1,2,"i",177)(11,ct,1,0,"i",178),i()(),t(12,"th",115),l(13,"Tipo"),i(),t(14,"th",179),g("click",function(){v(e);let c=d(2);return b(c.setSort("start_date"))}),t(15,"div",27)(16,"span"),l(17,"Fechas"),i(),u(18,dt,1,2,"i",177)(19,mt,1,0,"i",178),i()(),t(20,"th",117),l(21,"Ubicaci\xF3n"),i(),t(22,"th",180),g("click",function(){v(e);let c=d(2);return b(c.setSort("current_participants"))}),t(23,"div",27)(24,"span"),l(25,"Participantes"),i(),u(26,pt,1,2,"i",177)(27,ut,1,0,"i",178),i()(),t(28,"th",181),l(29,"Acciones"),i()()(),t(30,"tbody"),L(31,xt,39,32,"tr",null,A().trackById,!0),i()()()}if(o&2){let e=d(2);r(6),k("text-primary",e.sortSig().field==="title"),r(4),_(e.sortSig().field==="title"?10:11),r(4),k("text-primary",e.sortSig().field==="start_date"),r(4),_(e.sortSig().field==="start_date"?18:19),r(4),k("text-primary",e.sortSig().field==="current_participants"),r(4),_(e.sortSig().field==="current_participants"?26:27),r(5),V(e.events())}}function ht(o,n){if(o&1&&(u(0,lt,4,0,"div",140),u(1,Et,33,9,"div",83)),o&2){let e=d();_(e.view()==="cards"?0:-1),r(),_(e.view()==="table"?1:-1)}}function St(o,n){if(o&1){let e=f();t(0,"div",57)(1,"app-pagination",202),g("pageChange",function(c){v(e);let p=d();return b(p.goToPage(c))})("pageSizeChange",function(c){v(e);let p=d();return b(p.onPageSizeChange(c))}),i()()}if(o&2){let e=d();r(),m("totalItems",e.totalItems())("pageSize",e.pageSize())("currentPage",e.currentPage())("showPageSizeSelector",!0)("pageSizeOptions",e.pageSizeOptions)("showGoToPage",!0)("showRangeInfo",!0)("showFirstLastButtons",!0)("maxVisiblePages",5)("density","compact")}}var Ve=class o{fb=I(he);destroyRef=I(J);eventService=I(Le);staticData=I(we);confirmModal=re("confirmModal");EventStatus=me;LocationType=pe;pageSizeOptions=R.pagination.pageSizeOptions;currentPage=x(1);pageSize=x(R.pagination.defaultPageSize);sortSig=x({field:"start_date",direction:"asc"});showFilters=x(!1);viewSig=x("cards");errorSig=x(null);queryParams=w(()=>({page:this.currentPage(),size:this.pageSize(),filters:this.buildFilters(this.formFilters()),sort:this.sortSig()}));eventsSig=D(this.eventService.events$,{initialValue:[],requireSync:!1});loadingSig=D(this.eventService.loading$,{initialValue:!1,requireSync:!1});eventTypesSig=D(this.staticData.eventTypes$,{initialValue:null,requireSync:!1});events=w(()=>this.eventsSig()??[]);isLoading=w(()=>this.loadingSig()??!1);eventTypes=w(()=>this.eventTypesSig());totalItems=x(0);totalPages=w(()=>Math.ceil(this.totalItems()/this.pageSize()));errorMessage=w(()=>this.errorSig());confirmTitle=x("");confirmMessage=x("");pendingActionSig=x(null);pendingEventIdSig=x(null);form=this.fb.group({search:this.fb.control(""),status:this.fb.control(""),eventTypeId:this.fb.control(""),locationType:this.fb.control(""),dateFrom:this.fb.control(""),dateTo:this.fb.control(""),isPublic:this.fb.control("")});refresh$=new G(!0);formFilters=x({search:null,status:null,eventTypeId:null,locationType:null,dateFrom:null,dateTo:null,isPublic:null});hasActiveFilters=w(()=>{let n=this.formFilters();return!!(n.search?.trim()||n.status||n.eventTypeId||n.locationType||n.dateFrom||n.dateTo||n.isPublic)});activeFiltersCount=w(()=>{let n=this.formFilters(),e=0;return n.search?.trim()&&e++,n.status&&e++,n.eventTypeId&&e++,n.locationType&&e++,(n.dateFrom||n.dateTo)&&e++,n.isPublic&&e++,e});trackById=(n,e)=>e.id;trackByPageSize=(n,e)=>e;ngOnInit(){this.staticData.loadEventTypes().pipe(P(this.destroyRef)).subscribe(),this.form.valueChanges.pipe(H(250),Q(),P(this.destroyRef)).subscribe(n=>{this.formFilters.set(n),this.currentPage.set(1),this.load()}),this.refresh$.pipe(K(()=>this.fetch()),P(this.destroyRef)).subscribe()}fetch(){this.errorSig.set(null);let n=this.currentPage(),e=this.pageSize(),a=this.sortSig();return this.eventService.getEvents(n,e,this.buildFilters(this.form.value),a).pipe(j(c=>{this.totalItems.set(c.pagination.totalItems)}),U(c=>(console.error("Error al cargar eventos:",c),this.errorSig.set("Error al cargar eventos"),q(null))))}load(){this.refresh$.next(!0)}buildFilters(n){let e={};return n.search&&(e.query=n.search),n.status&&(e.status=[n.status]),n.eventTypeId&&(e.eventTypeId=[Number(n.eventTypeId)]),n.locationType&&(e.locationType=[n.locationType]),n.dateFrom&&(e.dateFrom=n.dateFrom),n.dateTo&&(e.dateTo=n.dateTo),n.isPublic==="true"&&(e.isPublic=!0),n.isPublic==="false"&&(e.isPublic=!1),e}view=()=>this.viewSig();toggleFiltersPanel(){this.showFilters.update(n=>!n)}clearSearch(){this.form.patchValue({search:""})}clearFilters(){this.errorSig.set(null),this.form.reset({search:"",status:"",eventTypeId:"",locationType:"",dateFrom:"",dateTo:"",isPublic:""}),this.formFilters.set({search:null,status:null,eventTypeId:null,locationType:null,dateFrom:null,dateTo:null,isPublic:null}),this.sortSig.set({field:"start_date",direction:"asc"}),this.currentPage.set(1),this.load()}setView(n){this.viewSig.set(n)}setPageSize(n){this.pageSize.set(Number(n)),this.currentPage.set(1),this.load()}setSort(n){this.sortSig().field===n?this.sortSig.update(a=>$(O({},a),{direction:a.direction==="asc"?"desc":"asc"})):this.sortSig.set({field:n,direction:"asc"}),this.load()}onPageChange(n){this.currentPage.set(n),this.load()}onPageSizeChange(n){if(typeof n=="number")this.pageSize.set(n);else{let e=n.target;this.pageSize.set(Number(e.value))}this.currentPage.set(1),this.load()}goToPage(n){n>=1&&n<=this.totalPages()&&(this.currentPage.set(n),this.load())}getStateBadgeClass(n){switch(n){case"draft":return"bg-secondary-subtle text-secondary";case"published":return"bg-info-subtle text-info";case"reg_open":return"bg-success-subtle text-success";case"reg_closed":return"bg-warning-subtle text-warning";case"active":return"bg-primary-subtle text-primary";case"completed":return"bg-success-subtle text-success";case"cancelled":return"bg-danger-subtle text-danger";default:return"bg-secondary-subtle text-secondary"}}getStateIcon(n){switch(n){case"draft":return"pencil-square";case"published":return"eye";case"reg_open":return"door-open";case"reg_closed":return"door-closed";case"active":return"play-circle";case"completed":return"check-circle";case"cancelled":return"x-circle";default:return"circle"}}getStatusLabel(n){switch(n){case"draft":return"Borrador";case"published":return"Publicado";case"reg_open":return"Inscripciones Abiertas";case"reg_closed":return"Inscripciones Cerradas";case"active":return"En Curso";case"completed":return"Finalizado";case"cancelled":return"Cancelado";default:return"Desconocido"}}toggleFeatured(n){this.eventService.toggleFeatured(n).pipe(P(this.destroyRef)).subscribe({next:()=>this.load(),error:e=>console.error("Error al destacar evento:",e)})}canPublish=n=>n.status==="draft"||n.status==="published";canOpenReg=n=>n.status==="published";canCloseReg=n=>n.status==="reg_open";canCancel=n=>n.status!=="cancelled"&&n.status!=="completed";openConfirm(n,e,a,c,p){this.confirmTitle.set(e),this.confirmMessage.set(a),this.pendingActionSig.set(c),this.pendingEventIdSig.set(p),n.show()}onConfirmAccepted(){let n=this.pendingEventIdSig(),e=this.pendingActionSig();if(!n||!e){this.pendingActionSig.set(null),this.pendingEventIdSig.set(null);return}(e==="publish"?this.eventService.publishEvent(n):e==="open"?this.eventService.openRegistrations(n):e==="close"?this.eventService.closeRegistrations(n):this.eventService.changeEventStatus(n,"cancelled")).pipe(P(this.destroyRef)).subscribe({next:()=>this.load(),error:c=>console.error("Error en operaci\xF3n:",c)}),this.pendingActionSig.set(null),this.pendingEventIdSig.set(null)}onConfirmCancelled(){this.pendingActionSig.set(null),this.pendingEventIdSig.set(null)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=X({type:o,selectors:[["app-event-list"]],viewQuery:function(e,a){e&1&&Z(a.confirmModal,Ie,5),e&2&&ee()},decls:76,vars:25,consts:[["confirmModal",""],["searchInput",""],[1,"container-fluid","py-3"],[3,"accepted","cancelled","title","message","confirmText"],["aria-label","breadcrumb",1,"mb-3"],[1,"breadcrumb","mb-0","small"],[1,"breadcrumb-item"],["routerLink","/",1,"text-decoration-none","link-primary"],[1,"bi","bi-house-door","me-1"],[1,"d-none","d-sm-inline"],["aria-current","page",1,"breadcrumb-item","active"],[1,"d-flex","flex-column","flex-md-row","align-items-start","align-items-md-center","justify-content-between","gap-3","mb-4"],[1,"order-1","order-md-0"],[1,"h6","mb-1","fw-normal","d-flex","align-items-center"],[1,"bi","bi-calendar-event","me-2","text-primary"],[1,"small"],[1,"badge","text-bg-primary","ms-2","small"],[1,"text-muted","small","mb-0"],[1,"d-flex","flex-wrap","gap-2","order-0","order-md-1"],["type","button","title","Actualizar datos",1,"btn","btn-outline-secondary","btn-sm","d-flex","align-items-center",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],[1,"bi","bi-arrow-clockwise","me-1"],[1,"d-none","d-sm-inline","small"],["routerLink","/eventos/crear","title","Crear nuevo evento",1,"btn","btn-primary","btn-sm","d-flex","align-items-center"],[1,"bi","bi-plus-circle","me-1"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-light","border-bottom","py-2"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center","gap-2"],[1,"d-flex","align-items-center","gap-1"],[1,"bi","bi-funnel","text-primary"],[1,"mb-0","fw-normal","small"],[1,"badge","text-bg-primary","rounded-pill","small"],["role","group",1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary","border-0","btn-sm",3,"click","title"],[1,"bi"],["type","button","title","Limpiar todos los filtros",1,"btn","btn-outline-danger","border-0","btn-sm"],[1,"card-body","py-3"],[1,"card","border-0","shadow-sm"],[1,"d-flex","align-items-center","gap-2","flex-grow-1","overflow-hidden"],[1,"bi","bi-list-ul","text-primary"],[1,"badge","text-bg-info","small"],[1,"d-flex","align-items-center","gap-1","ms-auto","me-2"],[1,"form-label","mb-0","text-muted","small","d-none","d-md-inline"],[1,"form-select","form-select-sm","small",2,"width","auto","min-width","60px",3,"change","value"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["role","group","aria-label","Modo de vista",1,"btn-group","btn-group-sm","flex-shrink-0"],["type","radio","name","viewMode","id","cardsView","autocomplete","off",1,"btn-check",3,"change","checked"],["for","cardsView","title","Vista tarjetas",1,"btn","btn-outline-primary","btn-sm","px-2"],[1,"bi","bi-grid-3x3-gap"],[1,"d-none","d-xl-inline","ms-1","small"],["type","radio","name","viewMode","id","tableView","autocomplete","off",1,"btn-check",3,"change","checked"],["for","tableView","title","Vista tabla",1,"btn","btn-outline-primary","btn-sm","px-2"],[1,"bi","bi-table"],[1,"card-body","p-0"],[1,"p-3"],[1,"text-center","py-5"],[1,"card-footer","bg-light","border-top","py-2"],["type","button","title","Limpiar todos los filtros",1,"btn","btn-outline-danger","border-0","btn-sm",3,"click"],[1,"bi","bi-x-circle"],["role","search","aria-label","Filtros de eventos",3,"formGroup"],[1,"row","g-2"],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],[1,"form-label","fw-normal","small","mb-1"],[1,"input-group","input-group-sm"],[1,"input-group-text","bg-light","border-end-0"],[1,"bi","bi-search","text-muted"],["type","search","placeholder","Buscar eventos, t\xEDtulo, descripci\xF3n...","formControlName","search",1,"form-control","border-start-0","bg-light","form-control-sm"],["type","button","title","Limpiar b\xFAsqueda",1,"btn","btn-outline-secondary","border-start-0","btn-sm"],["formControlName","status","aria-label","Estado",1,"form-select","bg-light","form-select-sm"],["value",""],[3,"value"],["formControlName","eventTypeId","aria-label","Tipo",1,"form-select","bg-light","form-select-sm"],[1,"col-12","col-md-6","col-lg-3","col-xl-2"],["formControlName","locationType","aria-label","Modalidad",1,"form-select","bg-light","form-select-sm"],["type","date","formControlName","dateFrom","aria-label","Fecha desde",1,"form-control","bg-light","form-control-sm"],["type","date","formControlName","dateTo","aria-label","Fecha hasta",1,"form-control","bg-light","form-control-sm"],["formControlName","isPublic","aria-label","Acceso",1,"form-select","bg-light","form-select-sm"],["value","true"],["value","false"],["type","button","title","Limpiar b\xFAsqueda",1,"btn","btn-outline-secondary","border-start-0","btn-sm",3,"click"],[1,"bi","bi-x"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","row-cols-lg-4","row-cols-xl-5","g-3"],[1,"table-responsive"],[1,"text-center","mt-4"],["role","status",1,"spinner-border","text-primary","me-2",2,"width","1.25rem","height","1.25rem"],[1,"visually-hidden"],[1,"text-muted"],[1,"col"],[1,"card","h-100","border-0","shadow-sm"],[1,"card-header","bg-light","py-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"placeholder","col-3","bg-secondary","rounded",2,"height","18px"],[1,"placeholder","col-4","bg-primary","rounded-pill",2,"height","20px"],[1,"mb-3"],[1,"placeholder-glow"],[1,"placeholder","col-10","mb-2","fw-bold",2,"height","20px"],[1,"placeholder","col-8","mb-1"],[1,"placeholder","col-6"],[1,"row","g-2","mb-3"],[1,"col-6"],[1,"placeholder","bg-primary","rounded-circle",2,"width","16px","height","16px"],[1,"placeholder","col-8"],[1,"placeholder","bg-success","rounded-circle",2,"width","16px","height","16px"],[1,"placeholder","bg-info","rounded-circle",2,"width","16px","height","16px"],[1,"placeholder","col-7"],[1,"placeholder","bg-warning","rounded-circle",2,"width","16px","height","16px"],[1,"placeholder","col-5"],[1,"card-footer","bg-transparent","py-2"],[1,"d-flex","gap-2","justify-content-end"],[1,"placeholder","bg-secondary","rounded",2,"width","32px","height","28px"],[1,"table","table-hover","mb-0"],[1,"table-light"],["scope","col",1,"border-0",2,"width","40px"],["scope","col",1,"fw-semibold","border-0"],["scope","col",1,"fw-semibold","border-0","d-none","d-md-table-cell"],["scope","col",1,"fw-semibold","border-0","d-none","d-lg-table-cell"],["scope","col",1,"fw-semibold","border-0","d-none","d-xl-table-cell"],["scope","col",1,"fw-semibold","border-0",2,"width","120px"],[1,"border-0"],[1,"placeholder","bg-secondary","rounded",2,"width","16px","height","16px"],[1,"placeholder","col-10","mb-1","fw-bold"],[1,"border-0","d-none","d-md-table-cell"],[1,"placeholder","bg-primary","rounded-pill",2,"width","90px","height","22px"],[1,"border-0","d-none","d-lg-table-cell"],[1,"placeholder","bg-info","rounded-pill",2,"width","80px","height","20px"],[1,"border-0","d-none","d-xl-table-cell"],[1,"placeholder","bg-success","rounded-pill",2,"width","70px","height","18px"],[1,"d-flex","gap-1"],[1,"text-danger","mb-4"],[1,"bi","bi-exclamation-triangle","display-1","opacity-25"],[1,"text-danger","mb-2"],[1,"text-muted","mb-4"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-arrow-clockwise","me-2"],[1,"bi","bi-calendar-x","display-1","opacity-25"],[1,"text-muted","mb-2"],[1,"bi","bi-funnel","me-2"],["routerLink","/eventos/crear",1,"btn","btn-primary"],[1,"bi","bi-plus-circle","me-2"],[1,"p-3","p-md-4"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","row-cols-lg-4","row-cols-xl-5","row-cols-xxl-6","g-3"],[1,"card","h-100","border-0","shadow-sm","position-relative"],[1,"position-relative"],[1,"card-img-top",2,"height","180px","object-fit","cover",3,"src","alt"],[1,"badge","position-absolute","top-0","start-0","m-2"],[1,"bi","me-1"],[1,"d-flex","align-items-center","gap-2","mb-2"],[1,"bi","bi-calendar-date","text-primary","small"],[1,"card-title","mb-2","lh-base","fw-semibold","text-truncate",3,"title"],[1,"text-decoration-none","text-dark","stretched-link",3,"routerLink"],[1,"card-text","text-muted","small","mb-3","lh-sm","text-truncate",3,"title"],[1,"bi","bi-tag","text-muted","small"],[1,"text-muted","small","text-truncate"],[1,"bi","bi-people","text-success","small"],[1,"text-success","small","fw-medium"],[1,"bi","bi-geo-alt","text-muted","small"],[1,"card-footer","bg-transparent","border-top","py-2"],[1,"d-flex","gap-1","justify-content-end"],["type","button","title","Destacar evento",1,"btn","btn-sm","position-relative",2,"z-index","10",3,"click"],[1,"bi","bi-star-fill"],["title","Ver detalles",1,"btn","btn-outline-info","btn-sm","position-relative",2,"z-index","10",3,"click","routerLink"],[1,"bi","bi-eye"],["title","Editar evento",1,"btn","btn-outline-primary","btn-sm","position-relative",2,"z-index","10",3,"click","routerLink"],[1,"bi","bi-pencil"],["title","Publicar evento",1,"btn","btn-outline-success","btn-sm","position-relative",2,"z-index","10"],["title","Abrir inscripciones",1,"btn","btn-outline-info","btn-sm","position-relative",2,"z-index","10"],["title","Cerrar inscripciones",1,"btn","btn-outline-warning","btn-sm","position-relative",2,"z-index","10"],["title","Cancelar evento",1,"btn","btn-outline-danger","btn-sm","position-relative",2,"z-index","10"],["title","Publicar evento",1,"btn","btn-outline-success","btn-sm","position-relative",2,"z-index","10",3,"click"],[1,"bi","bi-megaphone"],["title","Abrir inscripciones",1,"btn","btn-outline-info","btn-sm","position-relative",2,"z-index","10",3,"click"],[1,"bi","bi-door-open"],["title","Cerrar inscripciones",1,"btn","btn-outline-warning","btn-sm","position-relative",2,"z-index","10",3,"click"],[1,"bi","bi-door-closed"],["title","Cancelar evento",1,"btn","btn-outline-danger","btn-sm","position-relative",2,"z-index","10",3,"click"],["scope","col","title","Ordenar por t\xEDtulo",1,"fw-semibold","border-0","cursor-pointer","user-select-none",3,"click"],[1,"bi",3,"class"],[1,"bi","bi-arrow-down-up","opacity-50"],["scope","col","title","Ordenar por fecha",1,"fw-semibold","border-0","cursor-pointer","user-select-none","d-none","d-lg-table-cell",3,"click"],["scope","col","title","Ordenar por participantes",1,"fw-semibold","border-0","cursor-pointer","user-select-none","d-none","d-lg-table-cell",3,"click"],["scope","col",1,"fw-semibold","border-0",2,"width","140px"],[1,"badge","rounded-pill"],[1,"d-none","d-lg-inline"],[1,"fw-medium","text-truncate",2,"max-width","200px",3,"title"],[1,"text-decoration-none","text-dark",3,"routerLink"],[1,"text-muted","text-truncate","d-block",2,"max-width","200px",3,"title"],[1,"text-truncate",2,"max-width","100px",3,"title"],[1,"text-truncate",2,"max-width","120px",3,"title"],[1,"fw-medium"],[1,"btn-group","btn-group-sm"],["type","button","title","Destacar evento",1,"btn","btn-sm",3,"click"],["title","Ver detalles",1,"btn","btn-outline-info","btn-sm",3,"routerLink"],["title","Editar evento",1,"btn","btn-outline-primary","btn-sm",3,"routerLink"],["title","Publicar evento",1,"btn","btn-outline-success","btn-sm"],["title","Abrir inscripciones",1,"btn","btn-outline-info","btn-sm"],["title","Cerrar inscripciones",1,"btn","btn-outline-warning","btn-sm"],["title","Cancelar evento",1,"btn","btn-outline-danger","btn-sm"],["title","Publicar evento",1,"btn","btn-outline-success","btn-sm",3,"click"],["title","Abrir inscripciones",1,"btn","btn-outline-info","btn-sm",3,"click"],["title","Cerrar inscripciones",1,"btn","btn-outline-warning","btn-sm",3,"click"],["title","Cancelar evento",1,"btn","btn-outline-danger","btn-sm",3,"click"],["containerClass","justify-content-between align-items-center",1,"mb-0",3,"pageChange","pageSizeChange","totalItems","pageSize","currentPage","showPageSizeSelector","pageSizeOptions","showGoToPage","showRangeInfo","showFirstLastButtons","maxVisiblePages","density"]],template:function(e,a){if(e&1){let c=f();t(0,"div",2)(1,"app-confirm-modal",3,0),g("accepted",function(){return v(c),b(a.onConfirmAccepted())})("cancelled",function(){return v(c),b(a.onConfirmCancelled())}),i(),t(3,"nav",4)(4,"ol",5)(5,"li",6)(6,"a",7),s(7,"i",8),t(8,"span",9),l(9,"Inicio"),i()()(),t(10,"li",10),l(11,"Eventos"),i()()(),t(12,"div",11)(13,"div",12)(14,"h1",13),s(15,"i",14),t(16,"span",15),l(17,"Gesti\xF3n de Eventos"),i(),u(18,De,2,1,"span",16),i(),t(19,"p",17),l(20,"Administra eventos acad\xE9micos y corporativos"),i()(),t(21,"div",18)(22,"button",19),g("click",function(){return v(c),b(a.load())}),u(23,Ne,1,0,"span",20)(24,Ae,1,0,"i",21),t(25,"span",22),l(26,"Actualizar"),i()(),t(27,"a",23),s(28,"i",24),t(29,"span",15),l(30,"Nuevo"),i()()()(),t(31,"div",25)(32,"div",26)(33,"div",27)(34,"div",28)(35,"div",29),s(36,"i",30),t(37,"h6",31),l(38,"Filtros"),i()(),u(39,ze,2,1,"span",32),i(),t(40,"div",33)(41,"button",34),g("click",function(){return v(c),b(a.toggleFiltersPanel())}),s(42,"i",35),i(),u(43,Be,2,0,"button",36),i()()(),u(44,Ge,69,13,"div",37),i(),t(45,"div",38)(46,"div",26)(47,"div",27)(48,"div",39)(49,"div",29),s(50,"i",40),t(51,"h6",31),l(52,"Eventos"),i()(),u(53,qe,2,1,"span",41),t(54,"div",42)(55,"label",43),l(56,"Mostrar:"),i(),t(57,"select",44),g("change",function(C){return v(c),b(a.onPageSizeChange(C))}),Y(58,je,2,2,"option",45),i()()(),t(59,"div",46)(60,"input",47),g("change",function(){return v(c),b(a.setView("cards"))}),i(),t(61,"label",48),s(62,"i",49),t(63,"span",50),l(64,"Tarjetas"),i()(),t(65,"input",51),g("change",function(){return v(c),b(a.setView("table"))}),i(),t(66,"label",52),s(67,"i",53),t(68,"span",50),l(69,"Tabla"),i()()()()(),t(70,"div",54),u(71,Je,9,1,"div",55)(72,We,10,1,"div",56)(73,Ze,5,1,"div",56)(74,ht,2,2),i(),u(75,St,2,10,"div",57),i()()}e&2&&(r(),m("title",a.confirmTitle())("message",a.confirmMessage())("confirmText","Confirmar"),r(17),_(a.totalItems()>0?18:-1),r(4),m("disabled",a.isLoading()),r(),_(a.isLoading()?23:24),r(8),k("border-primary",a.hasActiveFilters()),r(8),_(a.hasActiveFilters()?39:-1),r(2),m("title",a.showFilters()?"Ocultar filtros":"Mostrar filtros"),M("aria-expanded",a.showFilters()),r(),k("bi-chevron-up",a.showFilters())("bi-chevron-down",!a.showFilters()),r(),_(a.hasActiveFilters()?43:-1),r(),_(a.showFilters()?44:-1),r(9),_(a.totalItems()>0?53:-1),r(4),m("value",a.pageSize()),r(),m("ngForOf",a.pageSizeOptions)("ngForTrackBy",a.trackByPageSize),r(2),m("checked",a.view()==="cards"),r(5),m("checked",a.view()==="table"),r(6),_(a.isLoading()?71:a.errorMessage()?72:a.events().length===0?73:74),r(4),_(a.totalPages()>1?75:-1))},dependencies:[se,ae,de,ce,ye,be,xe,Ee,ue,fe,_e,ve,ge,Ce,Se,Fe,Te,le],encapsulation:2,changeDetection:0})};export{Ve as EventListComponent};
